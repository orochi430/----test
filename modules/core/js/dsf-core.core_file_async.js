/*!
 * Name: @dsf/cli-core
 * Version: 5.17.0-alpha.5
 * Description: 核心模块
 * BuildTime: 2024/6/19 17:49:24
*/
(("undefined"!==typeof self?self:this)["webpackJsonpcore"]=("undefined"!==typeof self?self:this)["webpackJsonpcore"]||[]).push([[5],{294:function(e,t,n){"use strict";n.r(t);var r=n(45),s=n.n(r),i=n(24),a=n.n(i),o={text:"readAsText",base64:"readAsDataURL",binary:"readAsBinaryString",buffer:"readAsArrayBuffer"};function u(e){if(/filename==\?UTF-8\?B\?.+\?=/.test(e)){var t=e.match(/filename==\?UTF-8\?B\?(.+)\?=/);if(t[1])return dsf.base64.decode(t[1])}var n=e.match(/filename=(.+)/);return n[1]}function f(e,t){return this.$getWebPath?this.$getWebPath(e,t):(!0===t&&(t=""),dsf.url.getWebPath(e,t))}function l(e,t){t||(e.headers["content-disposition"]?(t=u(e.headers["content-disposition"]),t=decodeURIComponent(t)):t=e.config.url.split("/").pop()),dsf.file.saveAs(new Blob([e.data]),t)}function d(e,t){if(dsf.isObject(e.data)&&"[object Blob]"==e.data.toString()){var n,r,s=null===(n=(r=e.data).text)||void 0===n?void 0:n.call(r);if(dsf.isPromise(s))return s.then((function(n){if(dsf.isString(n))try{return n=JSON.parse(n),!1===n.success?n:(l(e,t),n)}catch(r){}return l(e,t),e}));l(e,t)}return e}t["default"]={load:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(n,r){var s=document.createElement("input");s.setAttribute("type","file"),s.setAttribute("accept",e),t&&s.setAttribute("multiple",!0),s.onchange=function(){var e=s.files;t?n(e):e.length?n(e[0]):n(null),s=void 0},s.onerror=function(e){r(e),s=void 0},s.onclick=function(){setTimeout((function(){var e=function e(){setTimeout((function(){window.removeEventListener("mousemove",e),n(null),s=void 0}),50)};window.addEventListener("mousemove",e)}),500)},s.click()}))},fileReader:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"UTF-8";return new Promise((function(r,s){var i=new FileReader;i.onload=function(){r(i.result)},i.onerror=s,t===dsf.file.READER_TYPE.text?i[o.text](e,n):i[o[t]](e)}))},readXlsx:function(){var e=s()(a.a.mark((function e(){var t,n,r,s=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:".xlsx,.xls,.csv",window.XLSX){e.next=4;break}return e.next=4,dsf.http.importFiles(dsf.url.getWebPath("$/js/libs/js-xlsx/xlsx.core.min.js"));case 4:return e.next=6,dsf.file.load(t);case 6:if(n=e.sent,n){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,dsf.file.fileReader(n,dsf.file.READER_TYPE.binary);case 11:return r=e.sent,e.abrupt("return",window.XLSX.read(r,{type:"binary"}));case 13:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),readTxt:function(){var e=s()(a.a.mark((function e(){var t,n,r=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:".txt",e.next=3,dsf.file.load(t);case 3:if(n=e.sent,n){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,dsf.file.fileReader(n);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),readJSON:function(){var e=s()(a.a.mark((function e(){var t,n,r,s=arguments;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:".json",e.next=3,dsf.file.load(t);case 3:if(n=e.sent,n){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,dsf.file.fileReader(n);case 8:return r=e.sent,e.abrupt("return",JSON.parse(r));case 10:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),saveAs:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;window.saveAs?(r=window).saveAs.apply(r,t):dsf.http.importFiles(dsf.url.getWebPath("$/js/libs/fileSaver/FileSaver-2.0.4.min.js")).then((function(){var e;(e=window).saveAs.apply(e,t)}))},download:function(e,t,n,r){dsf.isObject(t)?e=dsf.url.addQuery(e,t):n=t,e=f.call(this,e,r),dsf.file.saveAs(e,n)},getDownload:function(e,t,n,r,s){return"string"==dsf.type(n)&&(r=n,n={}),"object"!=dsf.type(n)&&(n={}),Object.assign(n,{responseType:"blob",timeout:0}),"boolean"!=dsf.type(r)||null!==this&&void 0!==this&&this.$http||(r=""),e=f.call(this,e,r),dsf.http.get(e,t,n,"/").then((function(e){return d(e,s)}))},postDownload:function(e,t,n,r,s){return"string"==dsf.type(n)&&(r=n,n={}),"object"!=dsf.type(n)&&(n={}),Object.assign(n,{responseType:"blob",timeout:0}),"boolean"!=dsf.type(r)||null!==this&&void 0!==this&&this.$http||(r=""),e=f.call(this,e,r),dsf.http.post(e,t,n,"/").then((function(e){return d(e,s)}))}}}}]);
//# sourceMappingURL=../../../smap/core/dsf-core.core_file_async.js.map