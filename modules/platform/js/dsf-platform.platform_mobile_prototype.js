/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[25],{1186:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ds-control ds-datagrid ds-static-list mobile ds-no-padding",staticStyle:{height:"100%"}},[t.showSearch?a("div",{staticClass:"ds-datagrid-search"},[t._t("search-before",null,{owner:t._self}),a("van-search",{attrs:{placeholder:t.searchPlaceholder,shape:"round"},on:{search:t.search},model:{value:t.searchStr,callback:function(e){t.searchStr=e},expression:"searchStr"}}),t._t("search-after",null,{owner:t._self})],2):t._e(),t.superSearchInfo.length||t.customerOrder.length?a("dsf-mobile-super-search",{attrs:{"is-design":t.isDesign,owner:t._self,"search-item-setting":t.superSearchInfo,"customer-order":t.customerOrder},on:{loaded:t.superSearchLoadedHandler,change:t.superSearchChangeHandler},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("super-search",null,{owner:t._self},e)]}}],null,!0)}):t._e(),t.isDesign?[a("div",{directives:[{name:"show",rawName:"v-show",value:"grid"===t.layoutType,expression:"layoutType === 'grid'"}]},[t.showCheckbox&&!t.isSingleChecked?a("div",{staticClass:"ds-datagrid-item check-all"},[a("van-checkbox",{attrs:{shape:"square"},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),a("span",{staticClass:"tips"},[t._v("已选 0 个")])],1):t._e()])]:["grid"===t.layoutType&&t.showCheckbox&&!t.isSingleChecked?a("div",{staticClass:"ds-datagrid-item check-all"},[a("van-checkbox",{on:{change:t.handleSelectionAll},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),a("span",{staticClass:"tips"},[t._v("已选 "+t._s(t.multipleSelection.length)+" 个")])],1):t._e()],a("div",{directives:[{name:"mobile-scroll",rawName:"v-mobile-scroll"}],staticClass:"ds-datagrid-wrap",class:{"has-search":t.showSearch},style:{padding:t.$padding}},[t.isDesign?[a("div",{directives:[{name:"show",rawName:"v-show",value:"grid"===t.layoutType,expression:"layoutType === 'grid'"}]},[a("van-list",{class:[t.splitWidthHorizontal]},[t._l(t.staticValue,(function(e,i){return[a("div",{key:e._id,staticClass:"ds-datagrid-item",style:{"border-radius":t.$borderRadius,"margin-top":t.dsf.pxToRem(t.dataMarginTop)},attrs:{"row-key":e._id,"row-index":i}},[t.showCheckbox?a("van-checkbox",{attrs:{shape:t.isSingleChecked?"round":"square"}}):t._e(),a("DsfMobilGridLayout",{attrs:{areas:t.areas,"is-design":t.isDesign,"design-only-slot":!0,owner:t._self,"grid-rows":t.contentLayout.heights,"grid-columns":t.contentLayout.widths,"grid-template":t.matrix},scopedSlots:t._u([t._l(t.areas,(function(i){return{key:i.name,fn:function(){return[a("div",{key:i.name,staticClass:"grid-area-content",class:i.setting.class,style:{overflow:"hidden",color:i.setting.color,padding:i.setting.padding,height:i.setting.height,"min-height":"100%"}},[a("dsf-div-editor",{staticClass:"grid-area-content-cell",class:["ds-multi-ellipsis-"+i.setting.lineNum],staticStyle:{width:"100%",height:"100%"},style:{color:i.setting.color,padding:i.setting.padding,height:i.setting.height,"max-height":i.setting.height,"line-height":i.setting.lineHeight},attrs:{tag:"div",placeholder:i.name,"filter-style":"style"},on:{blur:t.resize},model:{value:e[i.name],callback:function(a){t.$set(e,i.name,a)},expression:"row[area.name]"}})],1)]},proxy:!0}}))],null,!0)}),t.isButtonBar?a("div",{staticClass:"ds-datagrid-item-footer",style:t.rowFooterStyle()},[t._t("row-footer",(function(){return[t.rowButtons.length<=0?a("span",{staticClass:"ds-datagrid-item-footer-title"},[t._v("按钮栏")]):t._e(),a("DsfMobileButtonBar",{attrs:{align:t.rowButtonsAlign,"more-button-text":t.rowButtonsMoreButtonText,"more-button-style":t.rowButtonsMoreButtonStyle,"max-number":t.rowButtonsMaxNumber,buttons:t.rowButtons,size:"small"}})]}))],2):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:t.rangeWrap.show&&t.rangeWrap.active==i,expression:"rangeWrap.show && rangeWrap.active == index"}],staticClass:"selected-range",style:{height:t.rangeWrap.height+"px",width:t.rangeWrap.width+"px",top:t.rangeWrap.top+"px",left:t.rangeWrap.left+"px"}})],1)]}))],2)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"cardList"===t.layoutType,expression:"layoutType === 'cardList'"}]},[a("van-list",{class:[t.splitWidthHorizontal]},[a("dsf-mobile-platform-card-box",{attrs:{"is-design":t.isDesign,data:t.staticValue,loading:t.loading||t.refreshing,"column-number":t.cardListColumnNumber,"column-width":t.cardListColumnWidth,"margin-top":t.cardListMarginTop,padding:t.cardListPadding,checkbox:t.showCheckbox,"max-check-num":t.isSingleChecked?1:0},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"ds-datagrid-slot",attrs:{"slot-name":"gridList"}},[t._t("gridList",null,null,e)],2)]}}],null,!0)})],1)],1)]:[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},["grid"===t.layoutType?[a("van-checkbox-group",{ref:"checkboxGroup",on:{change:t.checkboxGroupChange},model:{value:t.multipleSelectionCopy,callback:function(e){t.multipleSelectionCopy=e},expression:"multipleSelectionCopy"}},[a("van-list",{class:[t.splitWidthHorizontal],attrs:{finished:!0,"finished-text":t.refreshing?"":t.staticValue&&t.staticValue.length>0?t.finishedText:"","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.refreshing?[]:t.staticValue,(function(e,i){return a("div",{key:e._id,staticClass:"ds-datagrid-item",style:{"border-radius":t.$borderRadius,"margin-top":t.dsf.pxToRem(t.dataMarginTop)},on:{click:function(i){return t.itemClickHandler(e,i)}}},[t.showCheckbox?a("van-checkbox",{attrs:{name:e,shape:t.isSingleChecked?"round":"square",disabled:e.disabled||t.renderDisabled(e)},on:{click:function(i){return t.handleSelection(e)}},nativeOn:{click:function(t){t.stopPropagation()}}}):t._e(),a("DsfMobilGridLayout",{attrs:{areas:t.areas,"is-design":t.isDesign,"design-only-slot":!0,"grid-rows":t.contentLayout.heights,"grid-columns":t.contentLayout.widths,"grid-template":t.matrix},scopedSlots:t._u([t._l(t.areas,(function(i){return{key:i.name,fn:function(){return[a("div",{key:i.name,staticClass:"grid-area-content",class:i.setting.class,style:{overflow:"hidden",color:i.setting.color,padding:i.setting.padding,height:i.setting.height}},[a("div",{staticClass:"grid-area-content-cell"},[a("div",{staticClass:"grid-area-conent-wrap",class:["ds-multi-ellipsis-"+i.setting.lineNum],style:{"max-height":i.setting.height,"line-height":i.setting.lineHeight},domProps:{innerHTML:t._s(e[i.name])}})])])]},proxy:!0}}))],null,!0)}),t.isButtonBar?a("div",{staticClass:"ds-datagrid-item-footer",style:t.rowFooterStyle()},[a("DsfMobileButtonBar",{attrs:{size:"small",local:e,"emit-prefix":"row-button","more-button-text":t.rowButtonsMoreButtonText,"more-button-style":t.rowButtonsMoreButtonStyle,"max-number":t.rowButtonsMaxNumber,align:t.rowButtonsAlign,buttons:t.rowButtons}})],1):t._e()],1)})),t.finished&&t.staticValue&&0===t.staticValue.length?a("div",{staticClass:"nodata"},[a("img",{attrs:{src:i(65),alt:""}})]):t._e()],2)],1)]:"cardList"===t.layoutType?[a("van-list",{class:[t.splitWidthHorizontal],attrs:{finished:!0,"finished-text":t.staticValue&&t.staticValue.length>0?t.finishedText:"","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[a("dsf-mobile-platform-card-box",{attrs:{data:t.staticValue,loading:t.loading||t.refreshing,"column-number":t.cardListColumnNumber,"column-width":t.cardListColumnWidth,"margin-top":t.cardListMarginTop,padding:t.cardListPadding,checkbox:t.showCheckbox,"max-check-num":t.isSingleChecked?1:0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._t("gridList",null,null,e)]}}],null,!0)})],1)]:t._e()],2)]],2)],2)},n=[],r=i(4),s=i.n(r),l=i(3),o=i.n(l),c=i(2),d=i.n(c),u=i(1),h=i.n(u),p=i(467),g="_id",f="grid-area-",m=dsf.component({name:"DsfMobileStaticList",ctrlCaption:"静态列表",mixins:[$mixins.layout,$mixins.list,$mixins.dataResult],components:{DsfMobilGridLayout:p["a"]},provide:function(){return{$list:this,$buttonOwner:this}},data:function(){return{rangeWrap:{show:!1,width:0,height:0,top:0,left:0,cells:[],selected:[],dataListMap:{}},isreload:!1,loading:!1,finished:!1,refreshing:!1,currentPage:0,matrix:null,searchStr:"",checkAll:!1,multipleSelectionCopy:[],superValue:[]}},props:{staticValue:{type:Array,default:function(){return[{_id:dsf.uuid(8)}]}},layoutType:{type:String,default:"grid"},showSearch:{type:Boolean,default:!0},showCheckbox:{type:Boolean,default:!1},isSingleChecked:{type:Boolean,default:!1},isSearchResetSelect:{type:Boolean,default:!0},topBottom:{type:String,default:""},padding:{type:Array,default:function(){return["8","8","8","8"]}},dataMarginTop:{type:String,default:function(){return"10px"}},borderRadius:{type:Array,default:function(){return["0","0"]}},isButtonBar:{type:Boolean,default:!0},cardListColumnNumber:{type:Number,default:2},cardListColumnWidth:{type:String,default:"150px"},cardListMarginTop:{type:String,default:"25px"},cardListPadding:{type:Array,default:function(){return["0","0","0","0"]}},rowButtonsAlign:{type:String,default:"right"},rowButtons:{type:Array,default:function(){return[]}},rowButtonsMaxNumber:{type:Number,default:2},rowButtonsMoreButtonStyle:{type:String,default:""},rowButtonsMoreButtonText:{type:String,default:"更多"},rowClickToUrl:{type:String,default:""},superSearchInfo:{type:Array,default:function(){return[]}},customerOrder:{type:Array,default:function(){return[]}},searchPlaceholder:{type:String,default:"请输入搜索关键词"},finishedText:{type:String,default:"没有更多了"},contentLayout:{type:Object,default:function(){return{grid:[],widths:[],heights:[],setting:{}}}},cellSerial:{type:Number,default:0},mountedRequestData:{type:Boolean,default:!0},slots:{type:Array,default:function(){return[{name:"gridList",controls:[],scope:"scope",dataKey:"row",repeat:!0,textProxy:!0}]}},getSearchStr:{type:Function,default:null},total:{type:String,default:"0"},isQueryTotal:{type:Boolean,default:!1},renderDisabled:{type:Function,default:function(t){return!1}},getAttachRequestParams:{type:Function,default:null},getFilter:{type:Function,default:function(){return{}}}},computed:{multipleSelection:{get:function(){var t=this.__defaultSelection||[];return t.length>0?[].concat(d()(this.multipleSelectionCopy),d()(t)):this.multipleSelectionCopy},set:function(t){var e=this;if(this.isSingleChecked){var i=t.length>1?1:0;this.multipleSelectionCopy=t.splice(i,1)||[]}else{this.multipleSelectionCopy=t||[];var a=this.staticValue.filter((function(t){return!t.disabled&&!e.renderDisabled(t)}));this.checkAll=t.length===a.length&&0!==this.staticValue.length}this.$dispatch("selection",this.multipleSelectionCopy)}},areas:function(){var t=this.matrix,e=[];return t&&_.each(t,(function(t){_.each(t,(function(t){dsf.array.ensure(e,t,(function(e){return e.name==t.name}))}))})),e},$borderRadius:function(){return[this.pxToRem(this.borderRadius[0]),this.pxToRem(this.borderRadius[0]),this.pxToRem(this.borderRadius[1]),this.pxToRem(this.borderRadius[1])].join(" ")},$padding:function(){var t=this.padding;return[this.pxToRem(t[0]),this.pxToRem(t[1]),this.pxToRem(t[2]),this.pxToRem(t[3])].join(" ")},splitWidthHorizontal:function(){return"split-small"==this.topBottom?"split-horizontal--8":"split-medium"==this.topBottom?"split-horizontal--10":"split-big"==this.topBottom?"split-horizontal--15":""}},created:function(){},mounted:function(){var t=this;this.isDesign||(this.mountedRequestData&&this.$nextTick((function(){var e,i;null!==(e=t.superSearchInfo)&&void 0!==e&&e.length||null!==(i=t.customerOrder)&&void 0!==i&&i.length||(t.currentPage=1,t.loadData())})),this.defaultSelected())},methods:{resize:function(){this.isDesign&&this.rangeWrap.cells.length>0&&S.call(this,this.rangeWrap.cells)},getLastColumns:function(){var t=[];return _.each(this.areas,(function(e){e.rowSpan&&e.colSpan&&t.push({label:e.name,columnId:e.name})})),t},$getChildMetadataList:function(){if(this.isDesign)return E},checkboxGroupChange:function(t){var e=this,i=new Set(t),a=new Set(this.multipleSelectionCopy),n=new Set(d()(i).filter((function(t){return!a.has(t)}))),r=new Set(d()(a).filter((function(t){return!i.has(t)})));(Array.from(n).length||Array.from(r).length)&&(this.multipleSelection=t),this.isSingleChecked&&this.$nextTick((function(){var t;e.multipleSelection.length&&(null===(t=e.$vm.$parent)||void 0===t||t.$emit("select-change",e.multipleSelection))}))},onLoad:function(){this.currentPage++,this.loadData()},rowFooterStyle:function(){if(!this.isDesign)return{"margin-right":this.pxToRem(-1*this.padding[1]),"margin-bottom":this.pxToRem(-1*this.padding[2]),"margin-left":this.pxToRem(-1*this.padding[3])}},defaultSelected:function(){this.loadSelected()},loadSelected:function(){var t=this.isSingleChecked,e=this.$choiceParams,i=this.data;if(e){var a=e.value||[];t&&a.length>1&&(a=[a[0]]);var n=_.map(a,(function(t){return o()(o()(o()({},g,t.value||t._value||t[g]||t.id),"name",t.text||t._text||t.name||t._name||t.label||t._label),"$makeup",!0)}));this.__defaultSelection=n,this.updateSelection(i)}},updateSelection:function(t){var e=this.__defaultSelection;if(null!==e&&void 0!==e&&e.length){var i=this.multipleSelectionCopy;_.each(t,(function(t){var a=_.findIndex(e,(function(e){return e[g]===t[g]}));a>-1&&(e.splice(a,1),_.find(i,(function(e){return e[g]===t[g]}))||i.push(t))}))}},onRefresh:function(){var t=this;return s()(h.a.mark((function e(){var i;return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.checkAll,t.isSearchResetSelect?i=!1:t.__defaultSelection=t.multipleSelection,t.multipleSelection=[],t.checkAll=i,t.refreshing=!0,t.finished=!1,t.loading=!0,e.next=9,t.loadData();case 9:case"end":return e.stop()}}),e)})))()},search:function(){var t=this;return s()(h.a.mark((function e(){return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isDesign){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.onRefresh();case 4:t.$emit("search");case 5:case"end":return e.stop()}}),e)})))()},doLayout:function(){},getCellSetting:function(t){return this.contentLayout.setting&&this.contentLayout.setting[t.name]?this.contentLayout.setting[t.name]:{}},getCellFontColor:function(t){var e=this.getCellSetting(t);return e.color},getCellPadding:function(t){var e=this.getCellSetting(t),i=[this.pxToRem(e.paddingTop||0),this.pxToRem(e.paddingRight||0),this.pxToRem(e.paddingBottom||0),this.pxToRem(e.paddingLeft||0)];return i.join(" ")},getCellClass:function(t){var e=this.getCellSetting(t);return[(null===e||void 0===e?void 0:e.fontSize)||"ds-font5",(null===e||void 0===e?void 0:e.align)||"left",(null===e||void 0===e?void 0:e.verticalAlign)||"middle",1==(null===e||void 0===e?void 0:e.bold)?"bold":""]},getLineNum:function(t){var e=this.getCellSetting(t);return e&&e.lineNum?e.lineNum:"auto"},getLineHeight:function(t){var e=this.getCellSetting(t);return e&&e.lineHeight?this.pxToRem(e.lineHeight||"normal"):"auto"},getCellHeight:function(t){var e="auto",i=this.getCellSetting(t);return i&&i.height&&(e=this.pxToRem(i.height||"auto")),this.isDesign&&"auto"==e?"100%":e},loadData:function(){var t=this;return s()(h.a.mark((function e(){return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.loadStaticData());case 1:case"end":return e.stop()}}),e)})))()},loadStaticData:function(){var t=this;this.loading=!0,this.refreshing&&(this.currentPage=1),setTimeout((function(){t.loading=!1,t.finished=!0,t.refreshing=!1}),300)},reloadData:function(){var t=this;return s()(h.a.mark((function e(){return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isreload){e.next=13;break}return e.prev=1,t.isreload=!0,e.next=5,t.onRefresh();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),dsf.error(e.t0);case 10:return e.prev=10,t.isreload=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})))()},handleSelectionAll:function(t){var e=this;this._checkAllLock?this._checkAllLock=!1:(this.$refs.checkboxGroup.toggleAll({checked:this.checkAll,skipDisabled:!0}),t||(this.__defaultSelection=[],this.multipleSelection=[]),this.$nextTick((function(){e.$emit("handleSelectionAll",e.multipleSelection,e.staticValue)})))},handleSelection:function(t){var e=this,i=-1===_.findIndex(this.multipleSelection,(function(e){return e._id===t._id}));this.$nextTick((function(){e.$emit("handleSelection",i,e.multipleSelection,t)}))},itemClickHandler:function(t,e){if(this.$listeners["row-click"])this.$dispatch("row-click",t);else if(this.rowClickToUrl){var i=this.$replace(this.rowClickToUrl,t);i=dsf.url.toRoutePath(i),this.$router.push({path:i})}},superSearchLoadedHandler:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!this.isDesign&&this.mountedRequestData&&(this.superValue=t,this.currentPage=1,this.onRefresh())},superSearchChangeHandler:function(t,e){this.superValue=t,e&&this.search()},getReturnValue:function(){return this.multipleSelection}},watch:{"contentLayout.grid":{handler:function(t){if(this.isDesign){x.call(this),this.matrix=v.call(this),y.call(this);var e=this.contentLayout.widths.slice(0),i=this.contentLayout.heights.slice(0);dsf.array.removeAll(this.contentLayout.widths),dsf.array.removeAll(this.contentLayout.heights);for(var a=0;a<this.matrix.length;a++){i[a]?this.contentLayout.heights[a]=i[a]:this.contentLayout.heights[a]="auto";for(var n=0;n<this.matrix[a].length;n++)e[n]?this.contentLayout.widths[n]=e[n]:this.contentLayout.widths[n]="auto"}}else this.matrix=v.call(this)},immediate:!0},"contentLayout.setting":{handler:function(t){if(this.isDesign){x.call(this),this.matrix=v.call(this),y.call(this);var e=this.contentLayout.widths.slice(0),i=this.contentLayout.heights.slice(0);dsf.array.removeAll(this.contentLayout.widths),dsf.array.removeAll(this.contentLayout.heights);for(var a=0;a<this.matrix.length;a++){i[a]?this.contentLayout.heights[a]=i[a]:this.contentLayout.heights[a]="auto";for(var n=0;n<this.matrix[a].length;n++)e[n]?this.contentLayout.widths[n]=e[n]:this.contentLayout.widths[n]="auto"}}else this.matrix=v.call(this)}},"staticValue.length":function(t){var e=this.multipleSelectionCopy.length===t.length;!e&&this.checkAll&&(this._checkAllLock=!0),this.checkAll=e},staticValue:{handler:function(t){for(var e=0;e<t.length;e++)"$editing"in t[e]||(t[e].$editing=!1),!("$editing"in t[e])&&this.$set(t[e],"$editing",!1),!("$hash"in t[e])&&this.$set(t[e],"$hash",dsf.uuid()),"$order"in t[e]?this.$set(t[e],"$order",e):t[e]["$order"]=e,t[e].$index=e}}},design:{isMask:!1,settingMenus:function(){return d()($mixins.list.design.settingMenus()||[])},contextMenuHandler:function(t){var e=R.call(this,$(t.target));if(e&&e.length){var i=_.findIndex(this.rangeWrap.selected,(function(t){return t.gridIndex==~~e.attr("index")}));if(i<0){this.downCell=e;var a=b.call(this,this.downCell,null);S.call(this,a)}return[{text:"合并单元格",disabled:!1,handler:H},{text:"拆分单元格",disabled:!1,handler:V},"-",{text:"插入行(前)",disabled:!1,handler:z},{text:"插入行(后)",disabled:!1,handler:F},{text:"插入列(前)",disabled:!1,handler:O},{text:"插入列(后)",disabled:!1,handler:j},"-",{text:"删除整行",disabled:!1,handler:q},{text:"删除整列",disabled:!1,handler:G},"-",{text:"单元格格式",disabled:!1,handler:P}]}},clearMouseDownHandler:function(){this.isDown=!1,D.call(this)},mouseDownHandler:function(t,e,i){if(this.isDesign&&0===t.button){this.isDown=!0,this.downCell=R.call(this,$(t.target));var a=b.call(this,this.downCell,null);S.call(this,a),t.stopPropagation()}},mouseMoveHandler:function(t){if(this.isDown){var e=R.call(this,$(t.target)),i=this.downCell&&this.downCell.length?this.downCell:null;if(e&&i){var a=b.call(this,this.downCell,e);S.call(this,a),t.stopPropagation()}}},mouseUpHandler:function(){this.isDown=!1}}});function v(){for(var t=[],e=this.contentLayout.grid,i=0;i<e.length;i++){t[i]||(t[i]=[]);for(var a=0;a<e[i].length;a++)t[i][a]=null,this.contentLayout.widths[a]||(this.contentLayout.widths[a]="auto")}for(var n={},r=0;r<e.length;r++)for(var s=e[r],l=0;l<s.length;l++){var o=s[l];if(n[o]){var c=Math.abs(r-n[o].rowIndex)+1,d=Math.abs(l-n[o].colIndex)+1;n[o].rowSpan=c,n[o].colSpan=d}else n[o]={areaName:f+o,name:o,rowIndex:r,colIndex:l,rowSpan:1,colSpan:1};n[o].setting={padding:this.getCellPadding(n[o]),height:this.getCellHeight(n[o]),lineHeight:this.getLineHeight(n[o]),color:this.getCellFontColor(n[o]),class:this.getCellClass(n[o]),lineNum:this.getLineNum(n[o])},t[r][l]=n[o]}return t}function x(){var t=this.cellSerial;if(this.contentLayout.grid.length<=0)for(var e=0;e<3;e++){for(var i=[],a=0;a<4;a++){t++;var n=dsf.math.numToEnglishLetter(t);i.push(n)}this.contentLayout.grid.push(i)}this.$emit("update:cellSerial",t)}function y(){var t=this;this.slots.slice(0);if(dsf.array.removeWith(this.slots,(function(t){return 0==t.name.indexOf(f)})),this.matrix)for(var e=0;e<this.matrix.length;e++)for(var i=function(){var i=t.matrix[e][a],n=_.find(t.slots,(function(t){return t.name==i.name}));n||(n={name:i.name,controls:[],scope:"scope",dataKey:"row",repeat:!0,textProxy:!0},t.slots.push(n)),n.controls=n?n.controls:[]},a=0;a<this.matrix[e].length;a++)i()}function w(t){var e=[];return t=t||this.matrix,_.each(t,(function(t){var i=[];_.each(t,(function(t){i.push(t.name.replace(f,""))})),e.push(i)})),e}function S(t){var e,i;if(this.isDesign){if(!t||!t.length)return this.rangeWrap.show=!1,void(this.rangeWrap.cells=[]);var a=(window.$designerSscale||100)/100,n=[],r=[],s=[],l=[],o=t.map((function(t){var e=t.position(),i=e.top,o=void 0===i?0:i,c=e.left,d=void 0===c?0:c;if(o/=a,d/=a,o&&d){n.push(o),r.push(d),s.push(o+t.height()),l.push(d+t.width());var u=~~t.attr("index"),h=~~t.attr("row-index"),p=~~t.attr("col-index"),g=t.attr("name");return{areaName:f+g,name:g,gridIndex:u,rowIndex:~~h,colIndex:~~p}}}));n=Math.min.apply(Math,d()(n)),r=Math.min.apply(Math,d()(r)),s=Math.max.apply(Math,d()(s)),l=Math.max.apply(Math,d()(l)),this.rangeWrap={show:!0,width:l-r,height:s-n-1,top:n-4,left:r-4,selected:o,cells:t,active:t[0].closest(".ds-datagrid-item").attr("row-index")},null===(e=this.$designer)||void 0===e||null===(i=e.recordPageChange)||void 0===i||i.call(e)}}function b(t,e){if(e&&t.get(0)!=e.get(0)){var i=k.call(this,t,e),a=i.minRowIndex,n=i.maxRowIndex,r=i.minColIndex,s=i.maxColIndex;return C.call(this,a,n,r,s)}return t?[$(t)]:[]}function k(t,e){var i=~~e.attr("row-index"),a=~~e.attr("col-index"),n=~~e.attr("rowspan")-1,r=~~e.attr("colspan")-1,s=~~t.attr("row-index"),l=~~t.attr("col-index"),o=~~t.attr("rowspan")-1,c=~~t.attr("colspan")-1,d=Math.min(s,i),u=Math.max(s+o,i+n),h=Math.min(l,a),p=Math.max(l+c,a+r);return L.call(this,d,u,h,p)}function C(t,e,i,a){for(var n=[],r=t;r<=e;r++)for(var s=i;s<=a;s++){var l=T.call(this,r,s);l&&n.push(l)}return n}function L(t,e,i,a){var n=C.call(this,t,e,i,a),r=[],s=[],l=[],o=[];n.forEach((function(t){l.push(+t.attr("row-index")),o.push(+t.attr("col-index")),r.push(+t.attr("row-index")+ +t.attr("rowspan")-1),s.push(+t.attr("col-index")+ +t.attr("colspan")-1)}));var c=Math.min.apply(Math,l),d=Math.max.apply(Math,r),u=Math.min.apply(Math,o),h=Math.max.apply(Math,s);return c==t&&d==e&&u==i&&h==a?{minRowIndex:c,maxRowIndex:d,minColIndex:u,maxColIndex:h}:L.call(this,c,d,u,h)}function T(t,e){var i=this.downCell.closest(".ds-datagrid-item"),a=this.matrix[t][e];if(a){var n=f+a.name,r=i.find("."+n);return r}return null}function A(t){var e=this,i=[];return _.each(t,(function(t){var a=f+t.name,n=e.$el.querySelector("."+a);n&&i.push($(n))})),i}function D(){this.downCell=null,this.rangeWrap={show:!1,width:0,height:0,top:-10,left:-10,cells:[],selected:[]}}function R(t){for(var e=0;e<t.length;e++){var i=t.eq(e);i.hasClass("grid-area")||(i=i.closest(".grid-area"));var a=i.closest(".ds-datagrid");if(this.$el===a.get(0))return i}return null}function M(t,e,i,a){var n=this,r=dsf.mix(!0,[],this.matrix),s=this.matrix[t][i];if(s)for(var l=t;l<=e;l++)for(var o=i;o<=a;o++)r[l][o]=s;var c=w.call(this,r);this.contentLayout.grid=c,this.$nextTick((function(){var t=A.call(n,n.rangeWrap.selected);S.call(n,t)}))}function B(t){var e=[];return t.forEach((function(t){var i=t.get?t:$(t),a=+i.attr("rowspan"),n=+i.attr("colspan");(a>1||n>1)&&e.push(i)})),e}function W(t){var e=this,i=dsf.mix(!0,[],this.matrix),a=this.cellSerial;t.forEach((function(t){for(var e=~~t.attr("row-index"),n=~~t.attr("col-index"),r=~~t.attr("colspan")-1,s=~~t.attr("rowspan")-1,l=t.attr("name"),o=e,c=e+s;o<=c;o++)for(var d=n,u=n+r;d<=u;d++)i[o][d]=o==e&&d==n?{name:l}:{name:dsf.math.numToEnglishLetter(++a)}})),this.$emit("update:cellSerial",a);var n=w.call(this,i);this.contentLayout.grid=n,this.$nextTick((function(){var t=A.call(e,e.rangeWrap.selected);S.call(e,t)}))}function I(t,e){for(var i=this,a=dsf.mix(!0,[],this.matrix),n=[],r=0,s=a[t],l=0;l<s.length;l++)r++;for(var o=this.cellSerial,c=0;c<r;c++){var d=s[c],u=d.rowIndex,h=u+d.rowSpan-1,p={};p.name=u<t&&h>=t?d.name:dsf.math.numToEnglishLetter(++o),n.push(p)}a.splice("before"==e?t:t+1,0,n);var g=w.call(this,a);this.contentLayout.grid=g,this.$emit("update:cellSerial",o),this.$nextTick((function(){var t=A.call(i,i.rangeWrap.selected);S.call(i,t)}))}function N(t,e){for(var i=this,a=dsf.mix(!0,[],this.matrix),n=this.cellSerial,r=0;r<a.length;r++){var s=a[r],l={},o=s[t],c=o.colIndex,d=c+o.colSpan-1;l.name=c<t&&d>=t?o.name:dsf.math.numToEnglishLetter(++n),s.splice("before"==e?t:t+1,0,l)}var u=w.call(this,a);this.contentLayout.grid=u,this.$emit("update:cellSerial",n),this.$nextTick((function(){var t=A.call(i,i.rangeWrap.selected);S.call(i,t)}))}function H(){var t=A.call(this,this.rangeWrap.selected),e=t[0],i=t[t.length-1],a=~~i.attr("row-index"),n=~~i.attr("col-index"),r=~~i.attr("rowspan"),s=~~i.attr("colspan"),l=~~e.attr("row-index"),o=~~e.attr("col-index");M.call(this,l,a+r-1,o,n+s-1)}function P(){var t=this,e=A.call(this,this.rangeWrap.selected),i=[];_.each(e,(function(e,a){var n=~~e.attr("row-index"),r=~~e.attr("col-index"),s=t.matrix[n][r];i.push(s)}));var a=this;this.$openDialog({title:"单元格设置",content:"DesGridLayoutCellSetting",width:"40vw",height:"60vh",params:{cells:i,owner:a},btns:[{text:"确定",handler:function(t){var e=t.yes();a.contentLayout.setting||a.$set(a.contentLayout,"setting",{}),_.each(e,(function(t,e){a.$set(a.contentLayout.setting,e,t)}));var i=w.call(a);a.contentLayout.grid=i,a.$nextTick((function(){var t=A.call(a,a.rangeWrap.selected);S.call(a,t)}))}},{text:"取消"}]})}function V(){var t=A.call(this,this.rangeWrap.selected),e=B.call(this,t);W.call(this,e)}function z(){var t=A.call(this,this.rangeWrap.selected),e=t[0],i=~~e.attr("row-index");I.call(this,i,"before")}function F(){var t=A.call(this,this.rangeWrap.selected),e=t[t.length-1],i=~~e.attr("row-index")+~~e.attr("rowspan")-1;I.call(this,i,"after")}function O(){var t=A.call(this,this.rangeWrap.selected),e=t[0],i=~~e.attr("col-index");N.call(this,i,"before")}function j(){var t=A.call(this,this.rangeWrap.selected),e=t[t.length-1],i=~~e.attr("col-index")+~~e.attr("colspan")-1;N.call(this,i,"after")}function q(){var t=this,e=A.call(this,this.rangeWrap.selected),i=e[0],a=e[e.length-1],n=~~i.attr("row-index"),r=~~a.attr("row-index")+~~a.attr("rowspan")-1,s=r-n+1,l=dsf.mix(!0,[],this.matrix);l.splice(n,s);var o=w.call(this,l);this.contentLayout.grid=o,this.$nextTick((function(){var e=A.call(t,t.rangeWrap.selected);S.call(t,e)}))}function G(){for(var t=this,e=A.call(this,this.rangeWrap.selected),i=e[0],a=e[e.length-1],n=+i.attr("col-index"),r=+a.attr("col-index")+ +a.attr("colspan")-1,s=r-n+1,l=dsf.mix(!0,[],this.matrix),o=0;o<l.length;o++)l[o].splice(n,s);var c=w.call(this,l);this.contentLayout.grid=c,this.$nextTick((function(){var e=A.call(t,t.rangeWrap.selected);S.call(t,e)}))}var E=[{key:"dsfa_rm.name",metadata:{name:"名称",at:"dsfa.rm",code:"name",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.ID",metadata:{name:"标识",at:"dsfa.rm",code:"ID",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.type",metadata:{name:"类型",at:"dsfa.rm",code:"type",valueAttributes:[{name:"文本",code:"text"},{name:"值",code:"value"}]}},{key:"dsfa_rm.code",metadata:{name:"标识",at:"dsfa.rm",code:"code",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.path",metadata:{name:"标识",at:"dsfa.rm",code:"path",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.treeinfo",metadata:{name:"树信息",at:"dsfa.rm",code:"treeinfo",valueAttributes:[{name:"tree节点类型",code:"type"},{name:"tree节点父标识",code:"pid"},{name:"tree节点图标",code:"icon"},{name:"tree全局标识",code:"globalid"},{name:"tree节点等级",code:"level"}]}},{key:"dsfa_rm.ds_update_user_name",metadata:{name:"修改人",at:"dsfa.rm",code:"ds_update_user_name",valueAttributes:[{name:"修改人姓名",code:"ds_update_user_name"}]}},{key:"dsfa_rm.ds_update_time",metadata:{name:"修改时间",at:"dsfa.rm",code:"ds_update_time",valueAttributes:[{name:"修改时间",code:"ds_update_time"}]}},{key:"dsfa_rm.ds_order",metadata:{name:"排序码",at:"dsfa.rm",code:"ds_order",valueAttributes:[{name:"排序码",code:"ds_order"}]}}],J=m,U=i(0),K=Object(U["a"])(J,a,n,!1,null,null,null);e["default"]=K.exports},467:function(t,e,i){"use strict";var a=function(t,e){var i=e._c;return i("div",{staticClass:"ds-grid-layout mobile",style:e.$options.getStyle(e)},[e._l(e.props.areas,(function(t,a){return[e.props.isDesign?i("div",{key:t.areaName,ref:"gridAreas",refInFor:!0,class:["grid-area",t.areaName],style:e.$options.getAreaStyle(e,t),attrs:{index:a,"grid-index":t.index,"row-index":t.rowIndex,"col-index":t.colIndex,colspan:t.colSpan,rowspan:t.rowSpan,name:t.name}},[e._t(t.name,null,{area:t})],2):i("div",{key:t.areaName,ref:"gridAreas",refInFor:!0,staticClass:"grid-area",style:e.$options.getAreaStyle(e,t),attrs:{index:a,name:t.name}},[e._t(t.name,null,{area:t})],2)]})),e.props.isDesign?[e._l(e.props.gridTemplate,(function(t,e){return[i("div",{key:"-"+e,class:["grid-area","area-bracket","e-"+e,"ds-pointer-none"],style:{"grid-area":"e-"+e,border:"none"}})]}))]:e._e()],2)},n=[],r={name:"DsfMobileDataGridItemLayout",props:{isDesign:{type:Boolean,default:!1},gridTemplate:{type:Array,default:function(){return[]}},gridColumns:{type:Array,default:function(){return[]}},gridRows:{type:Array,default:function(){return[]}},areas:{type:Array,default:function(){return[]}}},getAreaStyle:function(t,e){var i={"grid-area":e.areaName};return t.props.isDesign&&(i["min-height"]=t.$options.getRowHeight(t,e.rowIndex,e.colIndex,e.colspan,e.rowspan)),i},getTemplate:function(t){var e=t.props.gridTemplate,i=_.map(e,(function(e,i){var a=_.map(e,(function(t){return t.areaName}));return t.props.isDesign&&a.push("e-"+i),"'"+a.join(" ")+"'"}));return i.join(" ")},getStyle:function(t){var e=t.props.gridColumns,i=t.props.gridRows;t.props.isDesign&&(e=JSON.parse(JSON.stringify(e)),e.push("0"));var a={height:"100%","grid-template-columns":_.map(e,(function(t){return dsf.pxToRem(t)})).join(" "),"grid-template-areas":t.$options.getTemplate(t)};return!t.parent.isDesign&&i.length&&(a["grid-template-rows"]=_.map(i,(function(t){return dsf.pxToRem(t)})).join(" ")),a},getRowHeight:function(t,e,i,a,n){return t.parent.isDesign?a>1&&n>1?"auto":dsf.pxToRem(t.props.gridRows[e]):"auto"}},s=r,l=i(0),o=Object(l["a"])(s,a,n,!0,null,null,null);e["a"]=o.exports}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_mobile_prototype.js.map