/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[39],{1094:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",e._g(e._b({key:e.index,ref:"dialog",staticClass:"ds-dialog",class:e.elClass,attrs:{"dialog-no":e.no,index:e.index,"modal-class":"ds-dialog-modal-"+e.no},scopedSlots:e._u([{key:"title",fn:function(){return[e._t("title")]},proxy:!0},{key:"default",fn:function(){return[e._t("default")]},proxy:!0},{key:"footer",fn:function(){return[e._t("footer")]},proxy:!0}],null,!0)},"el-dialog",e.$attrs,!1,!0),e.$listeners))},n=[],s={name:"DsfDialog",inheritAttrs:!1,provide:function(){return{$dialog:this}},props:{index:{type:String,default:""},noTitle:{type:Boolean,default:!1},options:{type:Object,default:function(){return{}}},dialogArgs:{type:Object,default:function(){return null}},openerVm:{type:Object,default:function(){return null}},footerAlign:{type:String,required:!1},conentBorder:{type:Boolean,default:!1},allowDraggable:{type:Boolean,default:!0},appendToDom:{type:null,default:!0}},data:function(){return{destoryElDialog:!1,no:dsf.uuid()}},created:function(){this.currentView=null},computed:{elClass:function(){var e=[],t=this.footerAlign||dsf.config.setting_public_default_dialog_footer_align;return t&&"right"!=t&&e.push("dialog-footer-"+t),this.$attrs["show-close"]&&e.push("show-close"),this.noTitle&&e.push("no-title"),this.options.className&&e.push(this.options.className),this.conentBorder&&e.push("ds-dialog-content-border"),this.allowDraggable&&e.push("ds-dialog-allow-draggable"),e}},methods:{close:function(){var e;null===this||void 0===this||null===(e=this.$refs)||void 0===e||null===(e=e.dialog)||void 0===e||e.handleClose()},btnLoading:function(e,t){var i=this.options.btns[e];i&&this.$set(i,"loading",t)},dialogSure:function(){this.$emit("dialog-yes")},updateElInfo:function(){this.windowWidth=document.documentElement.clientWidth,this.windowHeight=document.documentElement.clientHeight;var e=this.dialogEl[0].getBoundingClientRect();this.elTop=e.top,this.elRight=e.right,this.elBottom=e.bottom,this.elLeft=e.left,this.elWidth=this.dialogEl.width(),this.elHeight=this.dialogEl.height(),this.elBodyHeight=this.dialogEl.find(".el-dialog__body").height(),void 0==this.isMarginCenter&&(this.isMarginCenter=!0)},draggable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.disable;t||(this.headEl=this.dialogEl.find(".el-dialog__header"),this.headEl.get(0).addEventListener("mousedown",this.draggableMouseDown))},dragSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.disable;this.sizeHandleEl=$('<div class="el-dialog__size-handle"></div>');var t=this.sizeHandleEl;this.dialogEl.append(t),t.get(0).addEventListener("mousedown",this.dragSizeMouseDown)},draggableMouseDown:function(e){this.headEl.css({userSelect:"none"}),this.updateElInfo(),this.moveType="position",this.sizeDownX=e.pageX,this.sizeDownY=e.pageY,this.isSizeDown=!0},dragSizeMouseDown:function(e){this.updateElInfo(),this.moveType="size",this.sizeDownX=e.pageX,this.sizeDownY=e.pageY,this.isSizeDown=!0},bodyMousemove:function(e){if(this.moveType){var t=e.pageX-this.sizeDownX,i=e.pageY-this.sizeDownY;if("size"==this.moveType&&(this.isSizeDown&&this.elWidth,this.elBodyHeight)){this.isMarginCenter&&(t*=2);var o=this.elWidth+t,n=this.elBodyHeight+i;o>this.windowWidth&&(o=this.windowWidth),n>this.windowHeight&&(n=this.windowHeight),this.dialogEl.width(o),this.dialogEl.find(".el-dialog__body").height(n)}else if("position"==this.moveType){var s=this.elLeft+t,l=this.elTop+i;s>this.windowWidth-this.elWidth&&(s=this.windowWidth-this.elWidth),l>this.windowHeight-this.elHeight&&(l=this.windowHeight-this.elHeight),s<0&&(s=0),l<0&&(l=0),this.isMarginCenter=!1,dsf.closeAllPopover(),this.dialogEl.css({left:s,top:l,margin:0})}}},bodyMouseup:function(e){this.isSizeDown=!1,this.moveType=null,this.elWidth=null,this.elHeight=null,this.elBodyHeight=null,this.headEl.css({userSelect:"text"})},destroyOnClose:function(){this.$refs.dialog.key++}},mounted:function(){this.bodyMousemove=this.bodyMousemove.bind(this),this.bodyMouseup=this.bodyMouseup.bind(this),document.addEventListener("mousemove",this.bodyMousemove),document.addEventListener("mouseup",this.bodyMouseup),this.dialogEl=$(this.$refs.dialog.$el).find(".el-dialog"),this.draggable({disable:!this.allowDraggable})},beforeDestroy:function(){this.sizeHandleEl&&this.sizeHandleEl.length&&(this.sizeHandleEl.get(0).removeEventListener("mousedown",this.dragSizeMouseDown),this.sizeHandleEl.remove()),this.headEl&&this.headEl.length&&this.headEl.get(0).removeEventListener("mousedown",this.draggableMouseDown),this.currentView=null,this.destoryElDialog=!0},destroyed:function(){document.removeEventListener("mousemove",this.bodyMousemove),document.removeEventListener("mouseup",this.bodyMouseup),this.draggable({disable:!0})}},l=s,d=i(0),a=Object(d["a"])(l,o,n,!1,null,null,null);t["default"]=a.exports},1095:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-control ds-section",class:e.getCss,staticStyle:{height:"100%"}},[i("iframe",{key:e.key,ref:"iframe",staticStyle:{flex:"auto",height:"0"},attrs:{src:e.getPath(),width:"100%",frameborder:"0"}})])},n=[],s=i(2),l=i.n(s),d=dsf.component({name:"DsfDialogIframe",ctrlCaption:"采用iframe的弹窗",mixins:[$mixins.control],data:function(){return{iframeUrl:"",key:0}},props:{rmiframeUrl:{type:String,default:""}},computed:{getCss:function(){return[].concat(l()(this.$getClass()),[this.showBorder?"":"ds-no-border",this.noPadding?"":"ds-no-padding"])},contentWindow:function(){return this.$refs.iframe?this.$refs.iframe.contentWindow:null}},watch:{},created:function(){},mounted:function(){if(this.$refs.iframe){this.$refs.iframe.$dialog=this.$dialog;var e=this.$refs.iframe;e.attachEvent?e.attachEvent("onload",this.$iframeLoaded):e.onload=this.$iframeLoaded}},methods:{$iframeLoaded:function(){var e=this.$refs.iframe;this.iframeLoaded(e)},getPath:function(){if(!this.isDesign){var e=this.$replace(this.rmiframeUrl);return e.startsWith(":/")&&(e=e.substr(1)),this.analysis(e)}return""},analysis:function(e){e.substr(e.indexOf("?"));var t=/[\?&](\w+)=([^&]+)?/gi;return e=e.replace(t,(function(e,t,i,o){var n=e.substr(0,1);return n+=t+"="+encodeURI(i||""),n})),decodeURIComponent(e)},iframeLoaded:function(e){var t,i,o,n,s=e.contentWindow;s&&this.$dialog&&(e.$dialog=this.$dialog,"4.0"!=(null===(t=this.$dialog)||void 0===t||null===(t=t.options)||void 0===t?void 0:t.version)&&dsf.isDsf5(s.dsf)?(e.dsfVersion="5.0",e.args=this.$dialog.dialogArgs?JSON.stringify(this.$dialog.dialogArgs):null,e.openerVm=this.$dialog.openerVm):(e.dsfVersion="4.0",e.args=this.$dialog.dialogArgs,e.dialogLoaded=null===(i=this.$dialog)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.dialogLoaded,e.closeWindow=this.$dialog.close.bind(this.$dialog),e.dialogIndex=null===(o=this.$dialog)||void 0===o?void 0:o.index,e.ownerWin=window,e.opener=null===(n=this.$dialog)||void 0===n||null===(n=n.options)||void 0===n?void 0:n.currentWindow,this.dsf4IframeDialogCallBack(e)));this.$dispatch("loaded",this)},dsf4IframeDialogCallBack:function(e){var t=this,i=e.contentWindow;if(i.page){if(e.dialogLoaded){var o=i.page._isRender,n=0;if(o)(null===e||void 0===e?void 0:e.dialogLoaded)&&e.dialogLoaded($(t.$dialog.$el),t.$dialog.index,i),(null===i||void 0===i?void 0:i.dialogInit)&&i.dialogInit(e.args);else var s=window.setInterval((function(){o=i.page._isRender,n++,(o||n>50)&&(window.clearInterval(s),(null===e||void 0===e?void 0:e.dialogLoaded)&&e.dialogLoaded($(t.$dialog.$el),t.$dialog.index,i),(null===i||void 0===i?void 0:i.dialogInit)&&i.dialogInit(e.args))}),100)}}else(null===e||void 0===e?void 0:e.dialogLoaded)&&e.dialogLoaded($(t.$dialog.$el),t.$dialog.index,i),(null===i||void 0===i?void 0:i.dialogInit)&&i.dialogInit(e.args)},destoryIframe:function(){if(this.$refs.iframe){var e=this.$refs.iframe;if(e.detachEvent?e.detachEvent("load",this.$iframeLoaded):e.onload=null,e.contentWindow)try{var t=[],i=e.contentWindow.document.body.querySelectorAll("*");i.forEach((function(e){null!==e&&void 0!==e&&e.__vue__&&dsf.array.ensure(t,e.__vue__.$root)})),t.forEach((function(e){e.$destroy()})),t=null,i=null,e.contentWindow.document.write(""),e.contentWindow.close()}catch(o){}e.src="about:blank",e.ownerWin=null,e.dialogIndex=null,e.opener=null,e.args=null,e.$dialog=null,e.closeWindow=null,e.dialogLoaded=null,e.openerVm=null,e.dsfVersion=null,e.parentNode&&e.parentNode.removeChild(e);try{window.CollectGarbage()}catch(o){}}}},beforeDestroy:function(){this.destoryIframe()}}),a=d,r=i(0),u=Object(r["a"])(a,o,n,!1,null,null,null);t["default"]=u.exports},1096:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-drawer",e._g(e._b({key:e.index,ref:"dialog",staticClass:"ds-drawer",class:e.elClass,attrs:{index:e.index,"dialog-no":e.uuid,"modal-class":"ds-dialog-modal-"+e.uuid,"modal-append-to-body":"","append-to-body":""},scopedSlots:e._u([{key:"title",fn:function(){return[e._t("title")]},proxy:!0},{key:"default",fn:function(){return[e._t("default")]},proxy:!0}],null,!0)},"el-drawer",e.$attrs,!1,!0),e.$listeners))},n=[],s={name:"DsfDrawer",inheritAttrs:!1,provide:function(){return{$dialog:this}},props:{index:{type:String,default:""},noTitle:{type:Boolean,default:!1},options:{type:Object,default:function(){return{}}},dialogArgs:{type:Object,default:function(){return null}},openerVm:{type:Object,default:function(){return null}},footerAlign:{type:String,required:!1},conentBorder:{type:Boolean,default:!1}},data:function(){return{uuid:dsf.uuid()}},computed:{elClass:function(){var e=[],t=this.footerAlign||dsf.config.setting_public_default_dialog_footer_align;return t&&"right"!=t&&e.push("ds-drawer-footer-"+t),this.$attrs["show-close"]&&e.push("show-close"),this.noTitle&&e.push("no-title"),this.options.className&&e.push(this.options.className),this.conentBorder&&e.push("ds-drawer-content-border"),e}},methods:{close:function(){this.$refs.dialog.handleClose()},btnLoading:function(e,t){var i=this.options.btns[e];i&&this.$set(i,"loading",t)},dialogSure:function(){this.$emit("dialog-yes")},destroyOnClose:function(){this.$refs.dialog.key++}}},l=s,d=(i(679),i(0)),a=Object(d["a"])(l,o,n,!1,null,null,null);t["default"]=a.exports},525:function(e,t,i){var o=i(680);"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var n=i(19).default;n("45ac2cd0",o,!0,{sourceMap:!1,shadowMode:!1})},679:function(e,t,i){"use strict";i(525)},680:function(e,t,i){"use strict";i.r(t)}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_pc_dialog.js.map