/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[18],{1240:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ds-control mobile ds-hometop",style:t.style},[n("div",{staticClass:"ds-hometop-logo"},[t.realSrc?n("img",{attrs:{src:t.realSrc}}):t._e()]),n("div",{staticClass:"ds-hometop-tools"},[t._t("right",(function(){return[t.buttons.length<=2?t._l(t.buttons,(function(e,i){return n("DsfIcon",{key:i,attrs:{name:t.getIcon(e.icon)},on:{click:function(n){return t.clickHandler(e,n)}}})})):[t.buttons[0]?n("DsfIcon",{key:0,attrs:{name:t.getIcon(t.buttons[0].icon)},on:{click:function(e){return t.clickHandler(t.buttons[0],e)}}}):t._e(),n("van-popover",{ref:"popover",staticClass:"menu",attrs:{trigger:"click",offset:[10,5],placement:"bottom-end"},on:{open:function(e){return t.open(e)}},scopedSlots:t._u([{key:"reference",fn:function(){return[n("DsfIcon",{staticClass:"ds-hometop-more",attrs:{name:"gengduo"}})]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[[t._l(t.buttons,(function(e,i){return[i>0?n("div",{key:i,staticClass:"ds-hometop-menu-item van-popover__action",on:{click:function(n){return t.clickHandler(e,n)}}},[n("DsfIcon",{attrs:{name:t.getIcon(e.icon)}}),t._v(" "+t._s(e.text)+" ")],1):t._e()]}))]],2)]]}))],2)])},s=[],o=n(4),a=n.n(o),r=n(1),l=n.n(r),c=dsf.component({name:"DsfMobileHomeTop",ctrlCaption:"首页顶部",mixins:[$mixins.control,$mixins.buttonBar],data:function(){return{showPopover:!1,offset:[],buttonHandler:dsf.buttons.getButtonHander,client:"mobile",realSrc:""}},props:{logo:{type:String,default:function(){return dsf.config.setting_public_mobile_logo_image||dsf.config.setting_public_logo_image||""}},buttons:{type:Array,default:function(){return[]}},padding:{type:Array,default:function(){return["8.5px","15px","8.5px","15px"]}}},computed:{style:function(){return{"padding-left":this.pxToRem(this.padding[3]),"padding-right":this.pxToRem(this.padding[1]),"padding-top":this.pxToRem(this.padding[0]),"padding-bottom":this.pxToRem(this.padding[2])}},$logoSrc:function(){var t=this.logo||dsf.config.setting_public_mobile_logo_image||dsf.config.setting_public_logo_image||"";return this.$replace(dsf.url.getWebPath(t))}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},methods:{clickHandler:function(t,e,n){var i=this;return a()(l.a.mark((function s(){var o;return l.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return o=$mixins.buttonBar.methods.clickHandler,s.next=3,o.call(i,t,e,n);case 3:i.showPopover=!1;case 4:case"end":return s.stop()}}),s)})))()},getIcon:function(t){return t.replace(/^icon-/,"")},open:function(t){var e=this;this.$nextTick((function(){var t=e.$refs.popover.$refs.popover.$el,n=t.querySelector(".van-popover__arrow");n.style.right="8px"}))}},beforeDestroy:function(){},destroyed:function(){},watch:{$logoSrc:{handler:function(t){var e=this;if(t){var n=new Image;n.src=t,n.onload=function(){e.realSrc=t},n.onerror=function(){e.realSrc=""}}},immediate:!0}}}),u=c,d=n(0),p=Object(d["a"])(u,i,s,!1,null,null,null);e["default"]=p.exports},1241:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dsf-control ds-nav-menu-setting ds-convenient-menu mobile"},[t.scriptLoaded?n("header",[t._m(0),n("draggable",t._b({ref:"menus",staticClass:"group-content",model:{value:t.selectMenus,callback:function(e){t.selectMenus=e},expression:"selectMenus"}},"draggable",t.options,!1),[t._l(t.selectMenus,(function(e){return[n("div",{key:e._id,staticClass:"dsf-convenient-menu-col",style:t.colStyle},[n("div",{staticClass:"dsf-convenient-menu-box",style:t.boxStyle},[n("dsf-convenient-menu-item",{attrs:{item:e,"display-style":"style1"}},[n("i",{staticClass:"menu-item-bt iconfont icon-shanchu1",on:{click:function(n){return n.stopPropagation(),t.remove(e)}}})])],1)])]}))],2)],1):t._e(),n("van-divider",[t._v("点击下方按钮，可添加菜单到我的应用")]),n("main",[t.menuList.length?t._e():n("div",{staticClass:"no-data"},[t._v("暂无数据")]),t._l(t.menuList,(function(e){return[e.children&&e.children.length>0?n("div",{key:e._id,staticClass:"group"},[n("div",{staticClass:"group-title"},[n("span",[t._v(t._s(e.name))])]),n("div",{staticClass:"group-content"},[t._l(e.children,(function(e){return[n("div",{directives:[{name:"show",rawName:"v-show",value:-1===t.checkList.indexOf(e._id),expression:"checkList.indexOf(group2._id) === -1"}],key:e._id,staticClass:"dsf-convenient-menu-col",style:t.colStyle},[n("div",{staticClass:"dsf-convenient-menu-box",style:t.boxStyle,on:{click:function(n){return t.selectChange(e)}}},[n("dsf-convenient-menu-item",{attrs:{item:e,"display-style":"style1"}})],1)])]}))],2)]):t._e()]}))],2)],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[n("span",[t._v("我的应用")]),n("span",[t._v("拖动可调整应用位置与排序")])])}],o=n(465),a=n(466),r=dsf.component({name:"DsfMobileNavMenuSetting",mixins:[$mixins.control],ctrlCaption:"菜单定制",components:{DsfConvenientMenuGroup:o["a"],DsfConvenientMenuItem:a["a"]},props:{max:{type:Number,default:0},getMobileMenu:{type:String,default:"/mobileMenu/getMobileMenu?code=stuManager&roleSerialNum=MC101"},getAppTree:{type:String,default:"/mobileMenu/getAppTree"},saveMobileMenu:{type:String,default:"/mobileMenu/saveMobileMenu"},cellMargin:{type:Array,default:function(){return["5px","5px","5px","5px"]}},cellPadding:{type:Array,default:function(){return["0px","0px","0px","0px"]}},cellWidth:{type:String,default:"100%"},cellRadius:{type:String,default:"0px"},cellColor:{type:String,default:""},hasDesc:{type:Boolean,default:!1},iconAndInfoOfSpacing:{type:String,default:"0px"},colNum:{type:Number,default:5},showPriority:{type:String,default:"img"},defaultIcon:{type:String,default:""},iconWidth:{type:String,default:"50px"},iconHeight:{type:String,default:"50px"},iconRadius:{type:String,default:"5px"},iconBgColor:{type:String,default:"#fff"},iconBgShadow:{type:Boolean,default:!0},iconFontSize:{type:String,default:"25px"},iconFontBold:{type:Boolean,default:!1},iconFontColor:{type:String,default:"@normal"},iconFontShadow:{type:Boolean,default:!0}},data:function(){return{scriptLoaded:!1,options:{animation:300,delay:300,forceFallback:!0,draggable:".dsf-convenient-menu-col",ghostClass:"ghost",chosenClass:"active"},menuList:[],checkList:[],selectMenus:[]}},computed:{colStyle:function(){var t=this;return{width:"calc(100% / ".concat(this.colNum,")"),padding:this.cellMargin.map((function(e){return t.pxToRem(e)})).join(" ")}},boxStyle:function(){var t=this;return{padding:this.cellPadding.map((function(e){return t.pxToRem(e)})).join(" "),"background-color":this.cellColor,width:this.pxToRem(this.cellWidth),"border-radius":this.pxToRem(this.cellRadius)}},iconStyle:function(){var t={width:this.pxToRem(this.iconWidth),height:this.pxToRem(this.iconHeight),"border-radius":this.pxToRem(this.iconRadius),"background-color":this.$compileColor(this.iconBgColor),color:this.$compileColor(this.iconFontColor),"font-size":this.pxToRem(this.iconFontSize),"font-weight":this.iconFontBold?"bold":"normal"};return this.iconBgShadow&&(t["box-shadow"]="0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)"),this.iconFontShadow&&(t["text-shadow"]="0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)"),t}},created:function(){this.isDesign?(this.loadScript(),this.$dispatch("design-height-change","100%"),this.selectMenus=$mixins.convenientMenu.defaultData,this.menuList=[{_id:1,name:"示例数据1",children:$mixins.convenientMenu.defaultData},{_id:2,name:"示例数据2",children:$mixins.convenientMenu.defaultData}]):(this.loadScript(this.postData),this.init())},methods:{loadScript:function(t){var e=this;dsf.http.importFiles([dsf.url.getWebPath("$/js/libs/vuedraggable/Sortable-1.13.0.js"),dsf.url.getWebPath("$/js/libs/vuedraggable/vuedraggable.umd.js")]).then((function(){e.scriptLoaded=!0,null===t||void 0===t||t()})).catch((function(t){console.error(t),dsf.layer.message("加载fabric文件报错",!1)}))},init:function(){var t=this,e=dsf.layer.loading();this.$http.get(this.$replace(this.getMobileMenu,this),{},{},!0).done((function(e){var n=e.success,i=e.data,s=e.message;n?(t.checkList=i.map((function(t){return t._id=t.id,t.id})),t.selectMenus=i):dsf.layer.message(s,!1)})).error((function(t){dsf.error(t),dsf.layer.message(t.message||"请求异常",!1)})).always((function(){dsf.layer.closeLoading(e)}))},postData:function(){var t=this,e=dsf.layer.loading();this.$http.get(this.$replace(this.getAppTree,this),{},{},!0).done((function(e){var n=e.success,i=e.data,s=e.message;n?t.menuList=i:dsf.layer.message(s,!1)})).error((function(t){dsf.error(t),dsf.layer.message(t.message||"请求异常",!1)})).always((function(){dsf.layer.closeLoading(e)}))},selectChange:function(t){if(!this.isDesign)if(this.max&&this.selectMenus.length>=this.max)dsf.layer.message("最多只能选".concat(this.max,"个"));else{var e=-1===this.checkList.indexOf(t._id);e?(this.checkList.push(t._id),this.selectMenus.push(t)):this.remove(t)}},remove:function(t){if(!this.isDesign){var e=this.checkList.indexOf(t._id);this.checkList.splice(e,1),e=this.selectMenus.findIndex((function(e){return t._id===e.id})),this.selectMenus.splice(e,1)}},sortData:function(){return this.selectMenus.map((function(t,e){return{menuId:t._id,ds_order:e}}))},submit:function(t){if(!this.isDesign){var e=dsf.layer.loading();this.$http.post(this.$replace(this.saveMobileMenu,this),{data:JSON.stringify(this.sortData())},{},!0).done((function(e){var n=e.success,i=(e.data,e.message);n?(dsf.layer.message("保存成功",!0),t&&t()):dsf.layer.message(i,!1)})).error((function(t){dsf.error(t),dsf.layer.message(t.message||"请求异常",!1)})).finally((function(){dsf.layer.closeLoading(e)}))}},getImgUrl:function(t){var e=t.imgUrl,n=t.picture,i=t.icon;return"img"==this.showPriority?e||n:i&&""!=i?"":e||n},getIcon:function(t){return t&&""!=t||(t=this.defaultIcon),t?"".concat(t," icon-").concat(t):""},getIconStyle:function(t){var e=dsf.mix({},this.iconStyle);return t.backgroundColor&&(e["background-color"]=t.backgroundColor),t.foreColor&&(e.color=t.foreColor),e}}}),l=r,c=(n(821),n(0)),u=Object(c["a"])(l,i,s,!1,null,null,null);e["default"]=u.exports},1242:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{staticClass:"ds-control mobile ds-changeRole"},[n("div",{staticClass:"hander",on:{click:t.changeHandler}},[t._t("default",(function(){return["0"==t.styleMethod?n("DsfMobileButton",{staticClass:"ds-button-bar-item"},[t._v("切换角色")]):n("i",{staticClass:"iconfont icon-zhihuan"})]}))],2),n("DsfMobileDialog",{attrs:{hasHeader:"true",hasFooter:"true",round:"true",visible:t.dialogVisible,width:"100vw",height:t.height,position:"bottom",btnPosition:"bottom"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.confirmCancel}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("切换角色组")]),n("div",{staticClass:"ds-changeRole-cancel",attrs:{slot:"buttons"},on:{click:t.confirmCancel},slot:"buttons"},[t._v("取消")]),n("div",{staticClass:"ds-changeRole-content",style:{maxHeight:t.maxHeight,minHeight:t.minHeight}},t._l(t.group,(function(e){return n("div",{key:e.groupId,staticClass:"group"},[n("div",{staticClass:"title"},[t._v(t._s(e.groupName))]),t._l(e.unitInfoList,(function(i){return n("div",{key:i.unitId,staticClass:"list"},[n("div",{staticClass:"item",class:{active:t.groupId==e.groupId&&t.unitGlobalId==i.unitGlobalId},on:{click:function(n){return t.handleChangeGroup(e.groupId,i.unitGlobalId)}}},[t._v(" "+t._s(i.unitName)+" ")])])}))],2)})),0),n("template",{slot:"buttonBar"},[n("DsfMobileButton",{staticClass:"ds-button-bar-item",on:{click:t.handleSetGroup}},[t._v("确定")])],1)],2)],1):t._e()},s=[],o=dsf.component({name:"DsfMobileHomeChangeRole",ctrlCaption:"切换角色组",mixins:[$mixins.control],props:{height:{type:[String,Number],default:"auto"},maxHeight:{type:[String,Number],default:"calc(100vh - 114px)"},minHeight:{type:[String,Number],default:"auto"},styleMethod:{type:String,default:"0"}},design:{isMask:!0},data:function(){return{dialogVisible:!1,group:[],groupId:null,unitGlobalId:null,visible:!0}},methods:{confirmCancel:function(){this.groupId=null,this.unitGlobalId=null,this.dialogVisible=!1},handleGetGroups:function(){var t=this,e=dsf.layer.loading();this.$http.get(dsf.config.setting_public_group_list_src||"/oua2/groupList").done((function(e){e.success?(t.group=e.data.appUnitGroupInfoList||[],t.group.length||(t.visible=!1)):dsf.layer.message(e.message,!1)})).error((function(){dsf.layer.message("服务器异常",!1)})).always((function(){dsf.layer.closeLoading(e)}))},handleChangeGroup:function(t,e){this.groupId=t,this.unitGlobalId=e},handleSetGroup:function(){var t=this;if(this.groupId&&this.unitGlobalId){var e=dsf.layer.loading();this.$http.post(dsf.config.setting_public_switch_group_src||"/oua2/switchGroup",{groupId:this.groupId,unitGlobalId:this.unitGlobalId}).done((function(e){t.$listeners.changeAfter?t.$dispatch("changeAfter",e):e.success?(dsf.layer.message("切换成功",!0),setTimeout((function(){this.dialogVisible=!1,location.reload()}),1500)):dsf.layer.message(e.message,!1)})).error((function(){dsf.layer.message("服务器异常")})).always((function(){dsf.layer.closeLoading(e)}))}else dsf.layer.message("请选择",!1)},changeHandler:function(){var t=this;if(1==this.group.length&&1==this.group[0].unitInfoList.length){var e=this.group[0],n=e.unitInfoList[0];dsf.layer.confirm({message:"是否切换至【".concat(n.unitName,"】下的【").concat(e.groupName,"】角色？切换后将会刷新当前页面！"),confirmButtonText:"是",cancelButtonText:"否"}).then((function(){t.handleChangeGroup(e.groupId,n.unitGlobalId),t.handleSetGroup()}))}else this.dialogVisible=!0}},created:function(){this.isDesign||this.handleGetGroups()}}),a=o,r=n(0),l=Object(r["a"])(a,i,s,!1,null,null,null);e["default"]=l.exports},465:function(t,e,n){"use strict";var i=function(t,e){var n=e._c;return n("div",{staticClass:"dsf-convenient-menu-group"},e._l(e.props.group,(function(t,i){return n("div",{key:i,staticClass:"dsf-convenient-menu-row"},e._l(t,(function(t,s){return n("div",{key:t._id,staticClass:"dsf-convenient-menu-col",style:e.parent.colStyle},[t.unvisible?n("div",{staticClass:"dsf-convenient-menu-box unvisible",style:e.parent.boxStyle},[e._t("default",null,{item:t,rowIndex:i,colIndex:s})],2):t._hide?e._e():n("div",{staticClass:"dsf-convenient-menu-box",style:e.parent.boxStyle,on:{click:function(n){return e.parent._clickBefore(e.parent.onClick,t)}}},[e._t("default",null,{item:t,rowIndex:i,colIndex:s})],2)])})),0)})),0)},s=[],o={name:"DsfConvenientMenuGroup",props:{group:{type:Array,default:function(){return[]}}}},a=o,r=n(0),l=Object(r["a"])(a,i,s,!0,null,null,null);e["a"]=l.exports},466:function(t,e,n){"use strict";var i=function(t,e){var n=e._c;return n("div",{staticClass:"dsf-convenient-menu-item mobile",class:[e.props.displayStyle],style:e.props.itemStyle},[n("div",{staticClass:"icon",class:{foldBox:e.props.item.children&&e.parent.enableLevel},style:e.parent.getIconStyle(e.props.item)},[e.props.item.children&&e.parent.enableLevel?n("div",{on:{click:function(t){return t.stopPropagation(),e.parent.openFloderPopup(e.props.item)}}},[e._l(e.props.item.children.filter((function(t,e){return e<9})),(function(t,i){return[e.parent.getImgUrl(t)?n("van-image",{key:i+"img",attrs:{src:e._f("imgFormat")(e.parent.getImgUrl(t))}},[n("template",{slot:"error"},[n("i",{staticClass:"iconfont",class:[e.parent.getIcon(t.icon)]})])],2):n("div",{key:i+"icon",staticClass:"van-image"},[n("div",{staticClass:"van-image__error"},[n("i",{staticClass:"iconfont",class:[e.parent.getIcon(t.icon)]})])])]}))],2):e.parent.getImgUrl(e.props.item)?n("van-image",{attrs:{src:e._f("imgFormat")(e.parent.getImgUrl(e.props.item))}},[n("template",{slot:"error"},[n("i",{staticClass:"iconfont",class:[e.parent.getIcon(e.props.item.icon)]})])],2):n("div",{staticClass:"van-image vvvv"},[n("div",{staticClass:"van-image__error"},[n("i",{staticClass:"iconfont",class:[e.parent.getIcon(e.props.item.icon)]})])]),e._t("default")],2),n("div",{staticClass:"info",style:e.parent.infoStyle},[n("div",{staticClass:"name ellipsis"},[e._v(e._s(e.props.item.name||""))]),e.parent.hasDesc?n("div",{staticClass:"desc ellipsis-2"},[e._v(e._s(e.props.item.desc||""))]):e._e()])])},s=[],o={name:"DsfConvenientMenuItem",inject:{$mobileConvenientMenu:{default:{}}},props:{item:{type:Object,required:!0},displayStyle:{type:String,required:"style1"},itemStyle:{type:Object,default:function(){return{}}}}},a=o,r=n(0),l=Object(r["a"])(a,i,s,!0,null,null,null);e["a"]=l.exports},592:function(t,e,n){var i=n(822);"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=n(19).default;s("084dcfa0",i,!0,{sourceMap:!1,shadowMode:!1})},821:function(t,e,n){"use strict";n(592)},822:function(t,e,n){"use strict";n.r(e)}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_mobile_homepage.js.map