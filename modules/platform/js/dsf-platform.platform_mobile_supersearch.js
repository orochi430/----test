/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[29],{1181:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search mobile"},[e._t("default",(function(){return[i("div",{staticClass:"ds-super-search-box",class:{flex:e.btList.length<3}},[e._l(e.btList,(function(e,t){return[e.id?i("dsf-super-search-bt-down",{key:t,attrs:{item:e}}):i("dsf-super-search-bt-sort",{key:t,attrs:{item:e}})]}))],2),e.moreList.length?i("div",{staticClass:"ds-super-search-more",on:{click:e.moreBtClick}},[i("span",[e._v("筛选")]),i("i",{staticClass:"iconfont icon-shaixuan"})]):e._e(),e.isDesign?e._e():i("transition",{attrs:{name:"van-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!!e.dropdownActive,expression:"!!dropdownActive"}],ref:"dropdownBox",staticClass:"dropdown-box",style:e.dropdownBoxStyle,on:{click:e.maskClick}},[i("div",{staticClass:"dropdown-box-mask",style:e.dropdownBoxMaskStyle}),i("div",{staticClass:"dropdown-box-content"},[e._l(e.btList,(function(t,s){return[t.id?i("dsf-super-search-down-item",{key:s,ref:"downItem",refInFor:!0,attrs:{show:e.dropdownActive===t.id,item:t}}):e._e()]}))],2)])]),e.moreList.length&&!e.isDesign?i("dsf-super-search-more-popup",{attrs:{"more-list":e.moreList}}):e._e()]}),{searchItems:e.searchItems,customerOrder:e.customerOrder,dropdownBoxMaskStyle:e.dropdownBoxMaskStyle,dropdownBoxStyle:e.dropdownBoxStyle})],2)},a=[],n=i(3),r=i.n(n),o=i(4),l=i.n(o),u=i(2),c=i.n(u),d=i(1),h=i.n(d);function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var m={name:"DsfMobileSuperSearch",inject:{$list:{default:null}},provide:function(){return{$superSearch:this}},props:{isDesign:{type:Boolean,default:!1},owner:{type:Object,default:function(){return null}},searchItemSetting:{type:Array,default:function(){return[]}},customerOrder:{type:Array,default:function(){return[]}},queryValue:{type:Object,default:function(){return{}}}},data:function(){return{dropdownActive:null,moreShow:!1,dropdownBoxMaskStyle:{},dropdownBoxStyle:{},searchItems:[],loaded:!1,isFirstLoad:!1}},computed:{btList:function(){var e=this.customerOrder.length;if(e<3){var t=[],i=this.searchItems.length;i=i<3-e?i:3-e;for(var s=0;s<i;s++)t.push(this.searchItems[s]);return[].concat(t,c()(this.customerOrder))}return this.customerOrder.slice(0,3)},moreList:function(){var e=this.customerOrder.length;if(e>=3)return this.searchItems;for(var t=this.searchItems.length,i=[],s=3-e;s<t;s++)i.push(this.searchItems[s]);return i}},watch:{searchItemSetting:{handler:function(e){this.updateSearchItemSetting()},immediate:!0},dropdownActive:function(){this.updateStyle()}},mounted:function(){this.updateStyle(),this.isDesign||document.body.appendChild(this.$refs.dropdownBox)},beforeDestroy:function(){this.isDesign||this.$refs.dropdownBox.remove()},methods:{updateStyle:function(){var e=this.$el.getBoundingClientRect(),t=e.bottom,i=e.left,s=e.width,a={top:t+"px",left:i+"px",width:s+"px"};this.isDesign&&(a.height="613px"),this.dropdownBoxStyle=a,this.dropdownBoxMaskStyle={top:0,height:a.top,width:a.width,left:a.left}},maskClick:function(){var e,t=this,i=_.find(this.$refs.downItem,(function(e){return t.dropdownActive===e.item.id}));this.dropdownActive=null,null===i||void 0===i||null===(e=i.close)||void 0===e||e.call(i)},moreBtClick:function(){this.dropdownActive=null,this.moreShow=!0},emitChange:function(){var e=this,t=this.emitValue();this.$nextTick((function(){e.$emit("change",t,!0)}))},updateSearchItemSetting:function(){var e=this;return l()(h.a.mark((function t(){return h.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.searchItems=_.map(e.searchItemSetting,(function(t){var i=null;return dsf.isDef(t.defaultValue)&&""!=t.defaultValue&&(i=e.owner.$eval(t.defaultValue,e.owner.$vm)),"enum"==t.searchType?(i=dsf.isDef(i)?"array"!=dsf.type(i)?[i]:i:[],"dataChoice"!=t.model&&(i=_.map(i,(function(e){return e+""})))):"datetime"==t.searchType?"between"==t.operator&&(dsf.isDef(i)?dsf.isString(i)?i=[i,i]:dsf.isArray(i)||(i=[]):i=[]):i=dsf.isDef(i)?i+"":"",{id:t.id,field:t.field,label:t.fieldCaption,valueSource:t.setting,operator:t.operator,type:t.searchType,optionKey:t.id||"",options:[],treeNodeSelected:[],defaultValue:i,values:i,showModel:t.model,isExtend:!1,isMore:!1,multiple:!1,isAllowMultipe:"enum"!==t.searchType||-1===["between","eq"].indexOf(t.operator),layout:t.layout||24,customerBetween:[],isFilterExtend:!1,fields:_.filter(t.children,(function(e){return 1==e.join})),isLineBreak:t.isLineBreak||!1,childField:t.childField||null,placeholder:t.placeholder||""}})),t.next=3,e.updateData();case 3:e.optionsMap=t.sent,_.each(e.searchItems,(function(t,i){e.optionsMap[t.id]&&(t.options=e.optionsMap[t.id])})),e.loaded=!0,e.$nextTick((function(){if(!e.isFirstLoad){e.isFirstLoad=!0;var t=e.emitValue();e.$nextTick((function(){e.$emit("loaded",t)}))}}));case 7:case"end":return t.stop()}}),t)})))()},updateData:function(){var e=this;return l()(h.a.mark((function t(){var i,s,a,n,r;return h.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.owner.isDesign){t.next=2;break}return t.abrupt("return",{});case 2:return i={},s=[],a=[],_.each(e.searchItems,(function(t){var n,r,o;if("enum"==t.type)if("dict"==(null===(n=t.valueSource)||void 0===n?void 0:n.type)){var l={key:t.id,dictId:t.valueSource.value.key};a.push(l)}else if("dbsource"==(null===(r=t.valueSource)||void 0===r?void 0:r.type)){var u=t.valueSource.value.key.replace(/\./g,"/");s.push({id:t.id,request:function(t){var i,s=f(f({},(null===(i=e.owner)||void 0===i?void 0:i.queryString)||{}),t||{});return e.$webAPI.dbSourceInterface(s,u)}})}else"interface"==(null===(o=t.valueSource)||void 0===o?void 0:o.type)?s.push({id:t.id,request:function(i){var s,a=f(f({},(null===(s=e.owner)||void 0===s?void 0:s.queryString)||{}),i||{});return e.$http.get(e.$replace(t.valueSource.value),a)}}):t.valueSource&&t.valueSource.value?i[t.id]=t.valueSource.value:i[t.id]=[]})),a.length>0&&(n={dicts:a},s.unshift({id:"dicts",request:function(){return e.$webAPI.getBatchDict(n)}})),t.prev=7,t.next=10,e.loopOptionsHttps(s);case 10:return r=t.sent,t.abrupt("return",dsf.mix(i,r,{}));case 14:t.prev=14,t.t0=t["catch"](7),dsf.layer.mobile.message("查询检索选项出现错误,页面无法创建",!1);case 17:case"end":return t.stop()}}),t,null,[[7,14]])})))()},loopOptionsHttps:function(e,t){var i={},s=new Promise((function(s,a){var n=-1,r=function(){n++,n>=e.length?s(i):e.length>0&&o()};function o(){var s=e[n];s.request().then((function(a){var o=a.data;if("dicts"==s.id)for(var l in o.data)i[l]=o.data[l];else i[s.id]=o.data;t?t({request:e[n],data:o.data},r):r()})).catch((function(e){a()}))}r()}));return s},emitValue:function(){var e={};for(var t in _.each(this.searchItems,(function(t){if("datetime"==t.type){var i="yyyy-mm-dd";if("between"==t.operator){var s="array"==dsf.type(t.values)?t.values:[t.values];s=_.filter(s,(function(e){return e})),e[t.field]=_.map(s,(function(e,s){if("ym"==t.showModel&&1==s){var a=e.getMonth()+1,n=e.getFullYear(),r=new Date(n,a,0);return dsf.date.format(r,i)}return dsf.date.format(e,i)}))}else if("gt"==t.operator||"lteq"==t.operator){var a="array"==dsf.type(t.values)?t.values[0]:t.values;if("ym"==t.showModel)if(a){var n=a.getMonth()+1,r=a.getFullYear(),o=new Date(r,n,0);e[t.field]=a?dsf.date.format(o,i):""}else e[t.field]="";else e[t.field]=a?dsf.date.format(a,i):""}else if("gteq"==t.operator||"lt"==t.operator)if("ym"==t.showModel)if(t.values){var l=t.values.getMonth(),u=t.values.getFullYear(),c=new Date(u,l,1);e[t.field]=t.values?dsf.date.format(c,i):""}else e[t.field]="";else e[t.field]=t.values?dsf.date.format(t.values,i):"";else if("eq"==t.operator){var d="array"==dsf.type(t.values)?t.values[0]:t.values;if("ym"==t.showModel)if(d){var h=d.getMonth()+1,p=d.getFullYear(),f=new Date(p,h,0);e[t.field]=d?dsf.date.format(f,i):""}else e[t.field]="";else e[t.field]=d?dsf.date.format(d,i):""}}else if("number"==t.type)"between"==t.operator&&t.values[0]==dsf.enums.numberBoundary.MIN&&t.values[1]==dsf.enums.numberBoundary.MAX?e[t.field]=null:e[t.field]=t.values;else if("enum"==t.type){var m=t.values;if("dataChoice"==t.showModel&&(m=_.map(m,"value")||[]),"between"==t.operator)if(t.customerBetween.length>0&&t.customerBetween[0]&&t.customerBetween[1])e[t.field]=t.customerBetween;else{var v,y=null!==(v=m)&&void 0!==v&&v[0]?m[0].split(";"):"";2==y.length?e[t.field]=y:1==y.length?e[t.field]=[y[0],y[0]]:e[t.field]=[]}else if("like"==t.operator||"slike"==t.operator||"elike"==t.operator){var w="array"==dsf.type(m)?m:[m];e[t.field]=w.join(" ")}else{var b="array"==dsf.type(m)?m:[m],g=_.filter(b,(function(e){return dsf.isDef(e)&&""!==e}));e[t.field]=g}}else if("text"==t.type){var S="";S="between"==t.operator?(t.values||[]).join(""):t.values,e[t.field]=S?t.values:""}else e[t.field]=t.values})),e)dsf.isEmptyObject(e[t])&&delete e[t];return e}}},v=m,y=i(0),w=Object(y["a"])(v,s,a,!1,null,null,null);t["default"]=w.exports},1182:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-bt"},[i("div",{staticClass:"content",on:{click:e.itemClick}},["enum"==e.item.type&&"treeselect"==e.item.showModel?[i("i",{staticClass:"iconfont icon-qiapianmoshi_kuai"}),i("span",[e._v(e._s(e.item.label))])]:[i("span",[e._v(e._s(e.item.label))]),i("i",{staticClass:"down-bar",class:{opened:e.opened}})]],2)])},a=[],n={name:"DsfSuperSearchBtDown",inject:{$superSearch:{default:null}},data:function(){return{}},props:{item:{type:Object,required:!0}},computed:{opened:function(){return this.$superSearch.dropdownActive===this.item.id}},methods:{itemClick:function(){this.$superSearch.isDesign||(this.opened?this.$superSearch.dropdownActive=null:this.$superSearch.dropdownActive=this.item.id)}}},r=n,o=i(0),l=Object(o["a"])(r,s,a,!1,null,null,null);t["default"]=l.exports},1183:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-bt"},[i("div",{staticClass:"content",on:{click:e.itemClick}},[i("span",[e._v(e._s(e.item.fieldCaption))]),i("i",{class:["sort-bar",e.item.sortType]})])])},a=[],n={name:"DsfSuperSearchBtSort",inject:{$list:{default:null},$superSearch:{default:null}},data:function(){return{}},props:{item:{type:Object,required:!0}},methods:{itemClick:function(){var e;this.$superSearch.isDesign||(this.$superSearch.dropdownActive=null,e=""===this.item.sortType?"desc":"desc"===this.item.sortType?"asc":"",this.$set(this.item,"sortType",e),this.$superSearch.emitChange())}}},r=n,o=i(0),l=Object(o["a"])(r,s,a,!1,null,null,null);t["default"]=l.exports},1184:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("van-popup",{staticStyle:{height:"70vh"},attrs:{"get-container":"body",position:"bottom",round:""},model:{value:e.$superSearch.moreShow,callback:function(t){e.$set(e.$superSearch,"moreShow",t)},expression:"$superSearch.moreShow"}},[i("div",{staticClass:"van-calendar"},[i("div",{staticClass:"van-calendar__header",staticStyle:{"box-shadow":"none"}},[i("div",{staticClass:"van-calendar__header-title"},[e._v("全部筛选")]),i("van-icon",{staticStyle:{position:"absolute",top:"0.19rem",right:"0.32rem"},attrs:{name:"cross",size:"22",color:"#999"},on:{click:function(t){e.$superSearch.moreShow=!1}}})],1),i("div",{staticClass:"van-calendar__body"},[e._l(e.moreList,(function(t){return[i("div",{key:t.id,staticClass:"ds-super-search-more-popup-item"},[i("div",{staticClass:"title"},[e._v(e._s(t.label))]),i("div",{staticClass:"content"},[i("dsf-super-search-form-item",{ref:"formItem",refInFor:!0,attrs:{values:t.values,item:t,line:""},on:{"update:values":function(i){return e.$set(t,"values",i)}}})],1)])]}))],2),i("div",{staticClass:"van-calendar__footer"},[i("van-goods-action",{staticStyle:{position:"static"}},[i("van-goods-action-button",{attrs:{type:"info",text:"重 置"},on:{click:e.reset}}),i("van-goods-action-button",{attrs:{type:"primary",text:"确 定"},on:{click:e.sure}})],1)],1)])])},a=[],n=i(602),r={name:"DsfSuperSearchMorePopup",components:{DsfSuperSearchFormItem:n["a"]},inject:{$list:{default:null},$superSearch:{default:null}},props:{moreList:{type:Array,default:function(){return[]}}},data:function(){return{}},watch:{"$superSearch.moreShow":function(e){e&&this.open()}},methods:{open:function(){_.forEach(this.$refs.formItem,(function(e){return null===e||void 0===e?void 0:e.open()}))},reset:function(){_.forEach(this.$refs.formItem,(function(e){return null===e||void 0===e?void 0:e.reset()})),this.$superSearch.moreShow=!1,this.$superSearch.emitChange()},sure:function(){_.forEach(this.$refs.formItem,(function(e){return null===e||void 0===e?void 0:e.sure()})),this.$superSearch.moreShow=!1,this.$superSearch.emitChange()}}},o=r,l=i(0),u=Object(l["a"])(o,s,a,!1,null,null,null);t["default"]=u.exports},602:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-item mobile"},["enum"==e.item.type?["select"==e.item.showModel||"tile"==e.item.showModel?[i("dsf-super-search-form-item-checkbox",{ref:"item",attrs:{line:e.line,values:e.value,item:e.item},on:{"update:values":function(t){e.value=t}}})]:"treeselect"==e.item.showModel?[i("dsf-super-search-form-item-tree",{ref:"item",attrs:{line:e.line,values:e.value,item:e.item},on:{"update:values":function(t){e.value=t}}})]:"dataChoice"==e.item.showModel?[i("dsf-super-search-form-item-data-choice",{ref:"item",attrs:{line:e.line,values:e.value,item:e.item},on:{"update:values":function(t){e.value=t}}})]:e._e()]:"text"==e.item.type?[i("dsf-super-search-form-item-input",{ref:"item",attrs:{line:e.line,values:e.value,item:e.item},on:{"update:values":function(t){e.value=t}}})]:"number"==e.item.type?[i("dsf-super-search-form-item-number",{ref:"item",attrs:{line:e.line,values:e.value,item:e.item},on:{"update:values":function(t){e.value=t}}})]:"datetime"==e.item.type||"period"==e.item.type?[i("dsf-super-search-form-item-date",{ref:"item",attrs:{line:e.line,values:e.value,item:e.item},on:{"update:values":function(t){e.value=t}}})]:e._e()],2)},a=[],n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-form-checkbox ds-super-search-form-item",class:{line:e.line}},e._l(e.item.options||[],(function(t){return i("div",{key:t.value,staticClass:"ds-super-search-form-checkbox-item",class:{active:e.value.indexOf(t.value)>-1},on:{click:function(i){return e.itemClick(t)}}},[i("div",{staticClass:"ds-multi-ellipsis-1"},[e._v(e._s(t.text))]),i("i",{staticClass:"iconfont icon-duigou"})])})),0)},r=[],o={name:"DsfSuperSearchFormItemCheckbox",props:{values:{type:[String,Array,Object],default:function(){return[]}},item:{type:Object,default:function(){return{}}},line:{type:Boolean,default:!1}},data:function(){return{value:[]}},computed:{multiple:function(){return this.item.isAllowMultipe}},watch:{values:{handler:function(e){this.multiple?"array"==dsf.type(e)?this.value=e:this.value=e?[]:[e]:"array"==dsf.type(e)?this.value=e.length?[e[0]]:[]:this.value=e?[e]:[]},immediate:!0}},methods:{reset:function(){var e=this;this.value=[];var t=this.multiple?[]:"";this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))},itemClick:function(e){var t=this,i=this.value.indexOf(e.value),s="";this.multiple?(i>-1?this.value.splice(i,1):this.value.push(e.value),s=this.value):i>-1?this.value=[]:(this.value=[e.value],s=e.value),this.$emit("update:values",s),this.$nextTick((function(){t.$emit("change",s)}))}}},l=o,u=i(0),c=Object(u["a"])(l,n,r,!1,null,null,null),d=c.exports,h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-form-item center"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.value,expression:"value",modifiers:{trim:!0}}],staticClass:"ds-super-search-form-input",attrs:{type:"text",placeholder:"请输入关键词"},domProps:{value:e.value},on:{change:e.change,input:function(t){t.target.composing||(e.value=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])},p=[],f={name:"DsfSuperSearchFormItemInput",props:{values:{type:String,default:""},item:{type:Object,default:function(){return{}}}},data:function(){return{value:""}},watch:{values:{handler:function(e){this.value=e},immediate:!0}},methods:{reset:function(){var e=this,t=this.value="";this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))},change:function(){var e=this,t=this.value;this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))}}},m=f,v=Object(u["a"])(m,h,p,!1,null,null,null),y=v.exports,w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-form-item center",class:[e.item.operator]},["between"===e.item.operator?[i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.value[0],expression:"value[0]",modifiers:{number:!0}}],staticClass:"ds-super-search-form-input",attrs:{type:"number",placeholder:"请输入数字"},domProps:{value:e.value[0]},on:{change:e.change1,input:function(t){t.target.composing||e.$set(e.value,0,e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),i("i",{staticClass:"iconfont icon-758bianjiqi_fengexian"}),i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.value[1],expression:"value[1]",modifiers:{number:!0}}],staticClass:"ds-super-search-form-input",attrs:{type:"number",placeholder:"请输入数字"},domProps:{value:e.value[1]},on:{change:e.change2,input:function(t){t.target.composing||e.$set(e.value,1,e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]:[i("input",{directives:[{name:"model",rawName:"v-model.number",value:e.value,expression:"value",modifiers:{number:!0}}],staticClass:"ds-super-search-form-input",attrs:{type:"number",placeholder:"请输入数字"},domProps:{value:e.value},on:{change:e.change,input:function(t){t.target.composing||(e.value=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]],2)},b=[],g={name:"DsfSuperSearchFormItemNumber",props:{values:{type:[Number,Array],default:null},item:{type:Object,default:function(){return{}}}},data:function(){return{value:null}},watch:{values:{handler:function(e){if("between"===this.item.operator)if(this.value=[null,null],"array"==dsf.type(e)){if(e.length>1){var t=parseFloat(e[1]);this.value[1]=isNaN(t)?null:t}if(e.length>0){var i=parseFloat(e[0]);this.value[0]=isNaN(i)?null:i}}else{var s=parseFloat(e);this.value[0]=isNaN(s)?null:s}else"array"==dsf.type(e)?this.value=e.length?e[0]:null:this.value=e},immediate:!0}},methods:{reset:function(){var e=this;"between"===this.item.operator?this.value=[null,null]:this.value=null,this.$emit("update:values",this.value),this.$nextTick((function(){e.$emit("change",e.value)}))},change1:function(){null!==this.value[1]&&(this.value[0]>this.value[1]&&(this.value[1]=this.value[0]),this.change())},change2:function(){null!==this.value[0]&&(this.value[1]<this.value[0]&&(this.value[0]=this.value[1]),this.change())},change:function(){var e=this,t=this.value;this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))}}},S=g,$=Object(u["a"])(S,w,b,!1,null,null,null),x=$.exports,k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-form-item center",class:[e.item.operator]},["between"===e.item.operator?[i("div",{staticClass:"ds-super-search-form-input",class:{placeholder:!e.value[0]},on:{click:e.selectDate}},[e._v(" "+e._s(e.value[0]||"请选择开始日期")+" ")]),i("i",{staticClass:"iconfont icon-758bianjiqi_fengexian"}),i("div",{staticClass:"ds-super-search-form-input",class:{placeholder:!e.value[1]},on:{click:e.selectDate}},[e._v(" "+e._s(e.value[1]||"请选择结束日期")+" ")])]:[i("div",{staticClass:"ds-super-search-form-input",class:{placeholder:!e.value},on:{click:e.selectDate}},[e._v(" "+e._s(e.value||"请选择日期")+" ")])],i("van-popup",{attrs:{"get-container":"#app",position:"bottom",round:""},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[i("dsf-mobile-calendar",e._b({attrs:{show:e.showPicker},on:{cancel:function(t){e.showPicker=!1},confirm:e.onConfirm}},"dsf-mobile-calendar",e.calendarOptions,!1))],1)],2)},C=[],D=i(8),O=i.n(D),I={name:"DsfSuperSearchFormItemDate",props:{values:{type:[String,Array],default:function(){return[]}},item:{type:Object,default:function(){return{}}}},data:function(){return{showPicker:!1,value:null,calendarOptions:{}}},computed:{format:function(){return["ym","halfyear","quarter"].includes(this.item.model)?"yyyy-mm":"yyyy-mm-dd"}},watch:{values:{handler:function(e){"between"===this.item.operator?(this.value=[null,null],"array"==dsf.type(e)?(e.length>1&&(this.value[1]=e[1]),e.length>0&&(this.value[0]=e[0])):this.value[0]=e):"array"==dsf.type(e)?this.value=e.length?e[0]:null:this.value=e},immediate:!0},showPicker:{handler:function(e){if(e){var t,i="between"===this.item.operator;t=i?this.value[0]&&this.value[1]?[dsf.date.parse(this.value[0],this.format),dsf.date.parse(this.value[1],this.format)]:[]:this.value?dsf.date.parse(this.value,this.format):null;var s={ym:"month",ymds:"date",ymd:"date",y:"date",hy:"halfyear",ss:"quarter",md:"tendays"};this.calendarOptions={defaultValue:t,type:s[this.item.showModel]||"date",clearable:!0,range:i}}},immediate:!0}},methods:{reset:function(){var e=this;"between"===this.item.operator?this.value=[null,null]:this.value=null,this.$emit("update:values",this.value),this.$nextTick((function(){e.$emit("change",e.value)}))},selectDate:function(){this.showPicker=!0},onConfirm:function(e){var t=this;if(this.showPicker=!1,"between"===this.item.operator){var i=e||["",""],s=O()(i,2),a=s[0],n=s[1];this.value=[dsf.date.format(a,this.format),dsf.date.format(n,this.format)]}else{var r;if("array"===dsf.type(e))e=null===(r=e)||void 0===r?void 0:r[0];this.value=e?dsf.date.format(e,this.format):null}this.$emit("update:values",this.value),this.$nextTick((function(){t.$emit("change",t.value)}))}}},j=I,M=Object(u["a"])(j,k,C,!1,null,null,null),T=M.exports,P=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-form-checkbox ds-super-search-form-item line"},[e._l(e.value,(function(t,s){return i("div",{key:t._id,staticClass:"ds-super-search-form-checkbox-item active",on:{click:function(t){return e.remove(s)}}},[i("div",{staticClass:"ds-multi-ellipsis-1"},[e._v(e._s(t._name))]),i("i",{staticClass:"iconfont icon-guanbi3"})])})),i("div",{staticClass:"ds-super-search-form-checkbox-item border",on:{click:e.openPopup}},[i("div",{staticClass:"ds-multi-ellipsis-1"},[e._v("选择")]),i("i",{staticClass:"iconfont icon-hao"})]),i("van-popup",{staticStyle:{height:"100vh"},attrs:{"get-container":"body",position:"bottom"},model:{value:e.popupShow,callback:function(t){e.popupShow=t},expression:"popupShow"}},[i("div",{staticClass:"van-calendar"},[i("div",{staticClass:"van-calendar__body"},[i("dsf-mobile-tree-selector",{ref:"selector",attrs:{label:e.item.label,"max-tags":e.multiple?9999:1,data:e.item.options,"data-source":"6"}})],1),i("div",{staticClass:"van-calendar__footer"},[i("van-goods-action",{staticStyle:{position:"static"}},[i("van-goods-action-button",{attrs:{type:"info",text:"返 回"},on:{click:function(t){e.popupShow=!1}}}),i("van-goods-action-button",{attrs:{type:"primary",text:"确 定"},on:{click:e.surePopup}})],1)],1)])])],2)},B=[],A={name:"DsfSuperSearchFormItemTree",props:{values:{type:String,default:""},item:{type:Object,default:function(){return{}}}},data:function(){return{popupShow:!1,value:[]}},computed:{multiple:function(){return this.item.isAllowMultipe}},methods:{openPopup:function(){this.$refs.selector&&(this.$refs.selector.result=Object.assign([],this.value)),this.popupShow=!0},surePopup:function(){this.value=Object.assign([],this.$refs.selector.result),this.popupShow=!1,this.sure()},remove:function(e){this.value.splice(e,1);var t=_.map(this.value,"_id");this.$emit("update:values",t)},reset:function(){var e=this;this.value=[];var t=this.multiple?[]:null;this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))},sure:function(){var e=this,t=_.map(this.value,"_id");this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))}}},F=A,E=Object(u["a"])(F,P,B,!1,null,null,null),q=E.exports,N=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-form-checkbox ds-super-search-form-item line"},[e._l(e.values,(function(t,s){return i("div",{key:t.value,staticClass:"ds-super-search-form-checkbox-item active",on:{click:function(t){return e.remove(s)}}},[i("div",{staticClass:"ds-multi-ellipsis-1"},[e._v(e._s(t.text))]),i("i",{staticClass:"iconfont icon-guanbi3"})])})),i("div",{staticClass:"ds-super-search-form-checkbox-item border",on:{click:e.openPopup}},[i("div",{staticClass:"ds-multi-ellipsis-1"},[e._v("选择")]),i("i",{staticClass:"iconfont icon-hao"})]),i("van-popup",{staticStyle:{height:"100vh"},attrs:{"get-container":"body",position:"bottom"},on:{closed:function(t){e.viewShow=!1}},model:{value:e.popupShow,callback:function(t){e.popupShow=t},expression:"popupShow"}},[i("div",{staticClass:"van-calendar"},[i("div",{staticClass:"van-calendar__body"},[e.viewShow?i("dsf-mobile-view-part",{ref:"view",attrs:{"choice-params":e.choiceParams,path:e.path,"show-model":"full","is-open-dialog":""}}):e._e()],1),i("div",{staticClass:"van-calendar__footer"},[i("van-goods-action",{staticStyle:{position:"static"}},[i("van-goods-action-button",{attrs:{type:"info",text:"返 回"},on:{click:function(t){e.popupShow=!1}}}),i("van-goods-action-button",{attrs:{type:"primary",text:"确 定"},on:{click:e.surePopup}})],1)],1)])])],2)},L=[],V=i(4),K=i.n(V),U=i(1),Y=i.n(U),H={name:"DsfSuperSearchFormItemDataChoice",props:{values:{type:Array,default:function(){return[]}},item:{type:Object,default:function(){return{}}}},data:function(){return{popupShow:!1,viewShow:!1}},computed:{multiple:function(){return this.item.isAllowMultipe},path:function(){var e;return(null===(e=this.item.valueSource.value)||void 0===e?void 0:e.url)||""},choiceParams:function(){return{value:this.values,maxTags:0,openDefaultSelected:!0}}},methods:{openPopup:function(){this.popupShow=!0,this.viewShow=!0},surePopup:function(){var e=this;return K()(Y.a.mark((function t(){var i;return Y.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.view.$refs.view.yes();case 2:i=t.sent,i=e.mapData(i),!e.multiple&&i.length>1&&(i=[i.pop()]),e.popupShow=!1,e.sure(i);case 7:case"end":return t.stop()}}),t)})))()},remove:function(e){this.values.splice(e,1)},reset:function(){var e=this,t=[];this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))},sure:function(e){var t=this,i=_.clone(e);this.$emit("update:values",i),this.$nextTick((function(){t.$emit("change",i)}))},mapData:function(e){for(var t="array"==dsf.type(e)?e:[e],i=[],s=0;s<t.length;s++){var a=t[s],n=this.autoMapDataText(a);n&&i.push(n)}return i},autoMapDataText:function(e){var t,i,s=/(\w+)\.(\w+)/g,a=["text","_text","name","_name","label","_label"],n=["value","_value","id","_id","key","_key"],r=null;for(var o in e){var l=o;s.lastIndex=0;var u=s.exec(o);u&&u[2]&&(l=u[2]),!this.dialogTextKey||l!=this.dialogTextKey&&o!=this.dialogTextKey||(t=e[o]),!this.dialogValueKey||l!=this.dialogValueKey&&o!=this.dialogValueKey||(i=e[o]),dsf.isUnDef(t)&&a.indexOf(l)>=0&&(t=e[o]),dsf.isUnDef(i)&&n.indexOf(l)>=0&&(i=e[o])}return(dsf.isDef(t)||dsf.isDef(i))&&(r={text:t,value:i}),r}}},J=H,z=Object(u["a"])(J,N,L,!1,null,null,null),R=z.exports,X={name:"DsfSuperSearchFormItem",components:{DsfSuperSearchFormItemCheckbox:d,DsfSuperSearchFormItemInput:y,DsfSuperSearchFormItemNumber:x,DsfSuperSearchFormItemDate:T,DsfSuperSearchFormItemTree:q,DsfSuperSearchFormItemDataChoice:R},inject:{$superSearch:{default:null}},props:{item:{type:Object,default:function(){return{}}},line:{type:Boolean,default:!1}},data:function(){return{value:null}},methods:{open:function(){this.value=_.cloneDeep(this.item.values)},reset:function(){var e;null===(e=this.$refs.item)||void 0===e||e.reset(),this.sure()},sure:function(){var e=this;this.$emit("update:values",this.value),this.$nextTick((function(){e.$emit("change",e.value)}))}}},G=X,Q=Object(u["a"])(G,s,a,!1,null,null,null);t["a"]=Q.exports},965:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dropdown-box-main",class:e.rootClass,style:e.rootStyle,on:{click:function(e){e.stopPropagation()}}},[i("div",{staticClass:"dropdown-box-main-content"},["enum"!=e.item.type||"select"!=e.item.showModel||e.item.isAllowMultipe?"enum"==e.item.type&&"treeselect"==e.item.showModel?[i("dsf-super-search-down-item-tree",{ref:"formItem",attrs:{values:e.item.values,item:e.item},on:{"update:values":function(t){return e.$set(e.item,"values",t)},change:e.change}})]:[i("dsf-super-search-form-item",{ref:"formItem",attrs:{values:e.item.values,item:e.item,line:""},on:{"update:values":function(t){return e.$set(e.item,"values",t)}}})]:[i("dsf-super-search-down-item-select",{ref:"formItem",attrs:{values:e.item.values,item:e.item},on:{"update:values":function(t){return e.$set(e.item,"values",t)},change:e.change}})]],2),"select"!==e.item.showModel||e.item.isAllowMultipe?i("div",{staticClass:"dropdown-box-main-footer"},[i("van-goods-action",{staticStyle:{position:"static"}},[i("van-goods-action-button",{attrs:{type:"info",text:"重 置"},on:{click:e.reset}}),i("van-goods-action-button",{attrs:{type:"primary",text:e.sureBtText},on:{click:e.sure}})],1)],1):e._e()])},a=[],n=i(602),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-form-select"},e._l(e.item.options||[],(function(t){return i("div",{key:t.value,staticClass:"ds-super-search-form-select-item van-hairline--bottom",class:{active:e.value===t.value},on:{click:function(i){return e.itemClick(t)}}},[e._v(" "+e._s(t.text)+" "),i("i",{staticClass:"iconfont icon-duigou"})])})),0)},o=[],l={name:"DsfSuperSearchFormItemSelect",props:{isDesign:{type:Boolean,default:!1},values:{type:[String,Array,Object],default:function(){return[]}},item:{type:Object,default:function(){return{}}}},data:function(){return{value:null}},watch:{values:{handler:function(e){"array"==dsf.type(e)?this.value=e.length?e[0]:null:this.value=e},immediate:!0}},methods:{itemClick:function(e){var t=this;this.value===e.value?this.value=null:this.value=e.value,this.$emit("update:values",this.value),this.$nextTick((function(){t.$emit("change",t.value)}))}}},u=l,c=i(0),d=Object(c["a"])(u,r,o,!1,null,null,null),h=d.exports,p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dsf-mobile-tree-selector",{ref:"selector",attrs:{"max-tags":e.multiple?9999:1,data:e.item.options,"data-source":"6",label:""}})},f=[],m={name:"DsfSuperSearchDownItemTree",props:{values:{type:String,default:""},item:{type:Object,default:function(){return{}}}},computed:{multiple:function(){return this.item.isAllowMultipe}},methods:{reset:function(){var e=this;this.$refs.selector.result=[],this.value=[];var t=this.multiple?[]:null;this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))},sure:function(){var e=this,t=_.map(this.$refs.selector.result,"_id");this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change",t)}))}}},v=m,y=Object(c["a"])(v,p,f,!1,null,null,null),w=y.exports,b={name:"DsfSuperSearchDownItem",components:{DsfSuperSearchFormItem:n["a"],DsfSuperSearchDownItemSelect:h,DsfSuperSearchDownItemTree:w},inject:{$list:{default:null},$superSearch:{default:null}},props:{item:{type:Object,required:!0},show:{type:Boolean,default:!1}},data:function(){return{formItem:null,rootClass:[]}},computed:{sureBtText:function(){var e;if("select"==this.item.showModel&&!this.item.isAllowMultipe)return"";if("treeselect"==this.item.showModel)return"确 定";var t=null===this||void 0===this||null===(e=this.formItem)||void 0===e?void 0:e.value;return"array"===dsf.type(t)&&t.length?"确 定 (".concat(t.length,")"):"确 定"},rootStyle:function(){var e={};return"treeselect"==this.item.showModel&&(e["max-height"]="none",e["height"]="100%",e["border-radius"]="0"),e}},watch:{show:function(e){var t,i,s=this;e?(null===this||void 0===this||null===(t=(i=this.formItem).open)||void 0===t||t.call(i),setTimeout((function(){s.rootClass=["show"]}),50)):this.rootClass=[]}},mounted:function(){this.formItem=this.$refs.formItem},methods:{reset:function(){var e;null===(e=this.formItem)||void 0===e||e.reset();var t=this.item,i=t.type,s=t.showModel;"enum"==i&&"treeselect"==s||this.change()},sure:function(){var e;null===(e=this.formItem)||void 0===e||e.sure();var t=this.item,i=t.type,s=t.showModel;"enum"==i&&"treeselect"==s||this.change()},change:function(){this.$superSearch.dropdownActive=null,this.$superSearch.emitChange()}}},g=b,S=Object(c["a"])(g,s,a,!1,null,null,null);t["default"]=S.exports}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_mobile_supersearch.js.map