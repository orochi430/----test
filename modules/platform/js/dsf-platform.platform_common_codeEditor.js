/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[5],{395:function(module,__webpack_exports__,__webpack_require__){"use strict";var monacoLoader=__webpack_require__(66);__webpack_exports__["a"]={name:"MonacoEditor",props:{width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"100%"},readOnly:{type:Boolean,default:!1},code:{type:String,default:""},srcPath:{type:String,default:""},language:{type:String,default:"javascript"},theme:{type:String,default:"vs-dark"},options:{type:Object,default:function(){}},changeThrottle:{type:Number,default:0}},data:function(){return this.completionItemProvider=null,{defaults:{selectOnLineNumbers:!0,roundedSelection:!1,readOnly:!1,cursorStyle:"line",automaticLayout:!1,glyphMargin:!0}}},computed:{style:function(){var t=this.width,e=this.height,n=-1!==t.toString().indexOf("%")?t:"".concat(t,"px"),i=-1!==e.toString().indexOf("%")?e:"".concat(e,"px");return{width:n,height:i}},editorOptions:function(){return Object.assign({},this.defaults,this.options,{language:this.language,theme:this.theme,wrappingColumn:0,wrappingIndent:"indent",autoIndent:"keep",insertSpaces:!0,tabSize:2,readOnly:this.readOnly})}},mounted:function(){this.fetchEditor()},destroyed:function(){this.destroyMonaco()},methods:{getContent:function(){return this.editor.getValue()},setContent:function(t){this.editor&&this.editor.setValue(t)},editorHasLoaded:function(t,e){var n=this;this.editor=t,this.monaco=e,this.editor.onDidChangeModelContent((function(e){return n.codeChangeHandler(t,e)})),this.editor.onDidBlurEditorText((function(e){return n.codeBlurHandler(t,e)})),this.$emit("mounted",t)},codeChangeHandler:function(t){this.codeChangeEmitter||(this.codeChangeEmitter=_.debounce((function(t){this.$emit("codeChange",t)}),this.changeThrottle)),this.codeChangeEmitter(t)},codeBlurHandler:function(t){this.$emit("blur",t)},fetchEditor:function(){monacoLoader.load(this.srcPath,this.createMonaco)},createMonaco:function createMonaco(){var _this2=this,isDs=!1,isDSFContext=!1;this.editor=window.monaco.editor.create(this.$el,this.editorOptions),this.editor.setValue(this.code||""),this.editorHasLoaded(this.editor,window.monaco),["javascript"].map((function(item){_this2.completionItemProvider=window.monaco.languages.registerCompletionItemProvider(item,{provideCompletionItems:function provideCompletionItems(model,position){var line=position.lineNumber,content=model.getLineContent(line);if(isDs=content.match(/\bds$/g),isDs)return{suggestions:[{label:"dsf",kind:window.monaco.languages.CompletionItemKind["Function"],insertText:"dsf",detail:""}]};if(isDSFContext=content.match(/\bdsf(\.|\.([$a-zA-Z_][$a-zA-Z0-9_]*)\.)$/g),isDSFContext){var kinds=window.monaco.languages.CompletionItemKind,arr=[],obj=eval(isDSFContext[0].substr(0,isDSFContext[0].length-1));if(obj){for(var k in obj)arr.push({label:k,kind:"function"==dsf.type(obj[k])?kinds["Function"]:kinds["Module"],insertText:k,detail:""});return{suggestions:arr}}return{suggestions:arr}}},triggerCharacters:["."]})})),this.editor.onKeyDown((function(t){t.keyCode===window.monaco.KeyCode.KeyS&&(dsf.client.isMac()?t.metaKey:t.ctrlKey)&&(t.preventDefault(),_this2.$emit("saveCode"))}))},insertContent:function(t){if(this.editor){var e=this.editor.getSelection(),n=new monaco.Range(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),i={range:n,text:t,forceMoveMarkers:!0};this.editor.executeEdits("",[i]),this.editor.focus()}},destroyMonaco:function(){"undefined"!==typeof this.editor&&this.editor.dispose(),this.completionItemProvider&&this.completionItemProvider.dispose()},layout:function(){var t,e;null===this||void 0===this||null===(t=this.editor)||void 0===t||null===(e=t.layout)||void 0===e||e.call(t)}}}},612:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:t.style})},o=[],r=n(395),s=r["a"],a=n(0),d=Object(a["a"])(s,i,o,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_common_codeEditor.js.map