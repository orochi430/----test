/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[6],{111:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(e.dsf.global.$isMobile?"div":"DsfVirtualScroll",{tag:"component"},[r("div",{staticClass:"send-flow-show-result"},[e.msg?r("div",{staticClass:"flow-msg"},[r("img",{staticClass:"flow-ybj",attrs:{src:n(435)}}),r("p",[e._v(e._s(e.msg))])]):e._e(),e.listMap.length>0?r("div",{staticClass:"list-map",class:{"has-msg":e.msg}},e._l(e.listMap,(function(t){return r("div",{key:t.LineID,staticClass:"userbox"},[r("span",{staticClass:"node-name"},[r("i",{staticClass:"iconfont",class:{"icon-cygn-xmsb":!t.isCC,"icon-icon-output":t.isCC}}),e._v(" "+e._s(t.LineName)+" ")]),r("div",{staticClass:"user-list"},e._l(t.list,(function(t,n){return r("span",{key:n,staticClass:"ds-button--icon-text"},[e._v(e._s(t))])})),0)])})),0):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:e.time>0,expression:"time > 0"}],staticClass:"count-down"},[r("span",{staticClass:"ds-button--icon-text"},[e._v(e._s(e.time))]),r("span",[e._v("秒后自动关闭")])])])])},i=[],o={name:"SendFlowDialog",props:{listMap:{type:Array,default:function(){return[]}},msg:{type:String,default:function(){return""}},countDownTime:{type:[String,Number],default:function(){return""}}},data:function(){return{time:this.countDownTime||dsf.config.setting_flow_count_down_time||3,timer:null}},mounted:function(){var e=this;this.time>0&&(window.sendFlowTimer=this.timer=setTimeout((function(){e.countDown()}),1e3))},methods:{yes:function(){return!0},countDown:function(){var e,t=this;(this.time>0&&this.time--,this.time<=0)?null===(e=document.querySelector(".sendFlow"))||void 0===e||e.click():(window.sendFlowTimer=this.timer=setTimeout((function(){t.countDown()}),1e3),this.$once("hook:beforeDestroy",(function(){clearTimeout(t.timer)})))}}},s=o,a=n(0),l=Object(a["a"])(s,r,i,!1,null,null,null);t["default"]=l.exports},112:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"code-set-dialog"},[n("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{input:e.listenInput},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},slot:"suffix"})]),n("div",{staticClass:"selected-values"},[n("p",{staticClass:"current-selected"},[e._v("当前选中：")]),0===e.checkedNode.length?n("span",[e._v("暂未选择！")]):n("div",{staticClass:"values-box"},[n("div",{staticClass:"values"},[n("p",[e._v(e._s(e.checkNodesShowlabel))]),e.total>1?n("span",[e._v("(+"+e._s(e.total)+")")]):e._e()])])]),n("div",{staticClass:"code-set-container"},[n("DsfVirtualScroll",{attrs:{id:"code-set-virtual-scroll-box"},on:{scroll:e.scroll}},[n("el-tree",{directives:[{name:"show",rawName:"v-show",value:e.searchValue,expression:"searchValue"}],ref:"tree2",attrs:{"node-key":e.$opener.areaselect?"value":"id","empty-text":e.loadingTree?"数据加载中，请稍候...":"暂无数据","default-checked-keys":e.defaultKeys,"default-expanded-keys":e.defaultexpandedKeys,data:e.showSearchItems,props:e.treeDefaultProps,"default-expand-all":!1,"highlight-current":!0,"expand-on-click-node":!1,"show-checkbox":e.$opener.multiple,"check-on-click-node":!e.$opener.multiple,"check-strictly":e.strictly,accordion:e.$opener.accordion},on:{check:e.check,"node-click":e.nodeClick,"check-change":e.checkChange},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node;return n("span",{staticClass:"show-hide custom-tree-node"},[n("span",[e._v(e._s(r.label))])])}},{key:"empty",fn:function(){return[e.loadingTree?n("div",[n("i",{staticClass:"el-icon-loading"}),e._v(" 数据加载中，请稍候... ")]):n("dsf-empty-data")]},proxy:!0}])}),n("el-tree",{directives:[{name:"show",rawName:"v-show",value:!e.searchValue,expression:"!searchValue"}],ref:"tree",attrs:{"node-key":e.$opener.areaselect?"value":"id","empty-text":e.loadingTree?"数据加载中，请稍候...":"暂无数据","default-checked-keys":e.defaultKeys,"default-expanded-keys":e.defaultexpandedKeys,data:e.iszdyjk?e.initItems:e.realItems,props:e.treeDefaultProps,"default-expand-all":!1,"highlight-current":!0,"expand-on-click-node":!1,"show-checkbox":e.$opener.multiple,"check-on-click-node":!e.$opener.multiple,"check-strictly":e.strictly,lazy:e.isLazy,accordion:e.$opener.accordion,load:e.loadNode},on:{check:e.check,"node-click":e.nodeClick,"check-change":e.checkChange},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node;return n("span",{staticClass:"show-hide custom-tree-node"},[n("span",[e._v(e._s(r.label))])])}},{key:"empty",fn:function(){return[e.loadingTree?n("div",[n("i",{staticClass:"el-icon-loading"}),e._v(" 数据加载中，请稍候... ")]):n("dsf-empty-data")]},proxy:!0}])})],1)],1)],1)},i=[],o=n(3),s=n.n(o),a=n(4),l=n.n(a),c=n(1),u=n.n(c);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"CodeSetDialog",mixins:[$mixins.control],props:{$index:{type:Object,default:function(){return{}}},$fnode:{type:Object,default:function(){return{}}}},computed:{$opener:function(){return dsf.isEmptyObject(this.$fnode)?this.$index:this.$fnode},separator:function(){return this.$opener.separator},field:function(){var e="text",t="value",n="children";return _.forEach(this.$opener.keysMap,(function(r){if(r.from)switch(r.to){case"text":e=r.from;break;case"value":t=r.from;break;case"children":n=r.from;break}})),{textField:e,valueField:t,childrenField:n}},isLazy:function(){return!!this.$opener.areaselect||this.$opener.isLazy},iszdyjk:function(){return!this.$opener.areaselect&&this.$opener.iszdyjk},dataUrl:function(){return this.$opener.isLazy?this.$opener.lazyUrl:this.$opener.initDataSourceUrl},realItems:function(){var e=this;if(this.isDesign)return[];if(this.$opener.areaselect||this.iszdyjk)return[];var t=[],n=_.cloneDeep(this.$opener.realItems),r=_.cloneDeep(this.$opener.value);return dsf.deepForEach(n,(function(n,i,o,s){n.id=dsf.uuid(),n.fulltext=s?"".concat(s.fulltext).concat(e.separator).concat(n[e.field.textField]):n[e.field.textField],n.pid=s?s.id:null,n.pid||t.push(n),dsf.isArray(r)&&r.some((function(t){return t[e.field.textField]===n[e.field.textField]&&t[e.field.valueField]===n[e.field.valueField]}))&&e.$opener.multiple&&e.defaultKeys.push(n.id)}),{children:this.field.childrenField}),t},strictly:function(){return this.$opener.checkStrictly},treeDefaultProps:function(){return this.field.textField&&this.field.childrenField?{label:this.field.textField,children:this.field.childrenField,isLeaf:"isLeaf"}:{label:"text",children:"children",isLeaf:"isLeaf"}},checkNodesShowlabel:function(){var e,t,n,r,i,o="",s=_.cloneDeep(this.checkedNode);s.length>0&&(o=this.$opener.showAllLevels?(null===(e=s[0])||void 0===e?void 0:e.fulltext)||(null===(t=s[0])||void 0===t?void 0:t[this.field.textField])||(null===(n=s[0])||void 0===n?void 0:n.text)||"":(null===(r=s[0])||void 0===r?void 0:r[this.field.textField])||(null===(i=s[0])||void 0===i?void 0:i.text)||"");return o},total:function(){return this.$opener.multiple?this.checkedNode.length:1}},data:function(){return{searchValue:"",checkedNode:[],defaultKeys:[],defaultexpandedKeys:[],searchItems:[],showSearchItems:[],initItems:[],loadingTree:!1,virtualScrollBoxHeight:null,treeItemHeight:null,virtualScrollPageSize:40,checkChangeDebounce:null}},created:function(){this.init()},mounted:function(){var e=this;this.initScroll(),this.$opener.multiple&&(this.checkedNode=this.$refs.tree.getCheckedNodes()),this.checkChangeDebounce=_.debounce((function(){e.checkedNode=[],e.$nextTick((function(){var t=e.$refs.tree.getCheckedNodes();t.forEach((function(t){return e.checkedNode.push(t)}))}))}),500)},methods:{init:function(){var e=this;if(this.loadingTree=!0,this.searchTree=_.debounce((function(){e.searchTreeByinput()}),500),this.scrollLoad=_.throttle((function(t){e.scrollLoadTree(t)}),100),this.$opener.value&&0!=Object.keys(this.$opener.value).length)try{this.checkedNode=[];var t=_.cloneDeep(this.$opener.value);dsf.isArray(t)&&t.length>0?_.forEach(t,(function(t){return e.checkedNode.push(t)})):dsf.isObject(t)&&!dsf.isEmptyObject(t)&&this.checkedNode.push(t)}catch(n){this.checkedNode=[]}this.iszdyjk&&this.loadTreeFirstLevNode()},initScroll:function(){try{var e,t,n=Array.from(document.querySelectorAll("#code-set-virtual-scroll-box"))||[];if(null!==(e=n)&&void 0!==e&&e[0])n=n[0],this.virtualScrollBoxHeight=(null===(t=n)||void 0===t?void 0:t.clientHeight)||null,this.virtualScrollBoxHeight&&(this.virtualScrollPageSize=Math.floor(this.virtualScrollBoxHeight/30)+5)}catch(r){}},scroll:function(e){var t=e.target.scrollTop;this.scrollLoad(t)},scrollLoadTree:function(e){this.computedTreeShowData(!1,e)},loadTreeFirstLevNode:function(e){var t=this;return l()(u.a.mark((function n(){var r;return u.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.$replace(t.dataUrl||"/area/getArea?TREEINFO_GLOBALID=000000000000&END_LEVEL=2&START_LEVEL=2",t.$opener),n.next=3,t.$http.get(r,"").done((function(n){var r=n.success,i=n.data,o=n.message;if(r&&dsf.isArray(i)){var s=t.oldDataHandler(i);e?e(s):_.forEach(s,(function(e){t.initItems.push(e)}))}r||dsf.layer.message(o||"请求异常",!1)})).error((function(e){dsf.layer.message((null===e||void 0===e?void 0:e.message)||"请求异常",!1)})).always((function(){t.loadingTree=!1}));case 3:case"end":return n.stop()}}),n)})))()},computedTreeShowData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.showSearchItems=[];var r=0;t||(r=Math.floor(n/30)),_.forEach(this.searchItems,(function(t,n){n<e.virtualScrollPageSize+r&&e.showSearchItems.push(t)}))},loadTreeNodeChildren:function(e){var t=this;return l()(u.a.mark((function n(){var r,i,o;return u.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=[],i={},o=t.$replace(t.$opener.lazyChildrenUrl||"/area/getArea?TREEINFO_GLOBALID=@[treeinfo_globalid]&END_LEVEL=@[treeinfo_level + 1]&START_LEVEL=@[treeinfo_level + 1]",t.$expressParams(t.$opener,e)),o.indexOf("?pid")<0&&o.indexOf("&pid")<0&&(o+=o.indexOf("?")<0?"?":"&",o+="pid=@[_id]"),o=t.$replace(o,t.$expressParams(t.$opener,e)),n.next=5,t.$http.get(o,i).done((function(e){var t=e.success,n=e.data;e.message;t&&dsf.isArray(n)&&_.forEach(n,(function(e){r.push(e)}))}));case 5:return n.next=7,t.oldDataHandler(r);case 7:if(r=n.sent,!t.$opener.showAllLevels){n.next=12;break}return n.next=11,t.montageFulltext(r,e);case 11:r=n.sent;case 12:return n.abrupt("return",r);case 13:case"end":return n.stop()}}),n)})))()},oldDataHandler:function(e){var t=this.field.textField,n=this.field.valueField,r=this.field.childrenField,i=_.cloneDeep(e),o=_.filter(e,(function(e){return!e[t]||!e[n]}));return o.length>0&&_.forEach(i,(function(e,o){i[o]=f(f({},i[o]),{},s()(s()(s()(s()({},t,e.name),n,e.dsfa_area_id),r,(null===e||void 0===e?void 0:e.children)||[]),"isLeaf",6===(null===e||void 0===e?void 0:e.level)))})),i},montageFulltext:function(e,t){var n=this,r=this.field.textField,i=_.map(e,(function(e){return f(f({},e),{},{fulltext:"".concat((null===t||void 0===t?void 0:t.fulltext)||(null===t||void 0===t?void 0:t[r])||"").concat(n.separator).concat((null===e||void 0===e?void 0:e[r])||"")})}));return i},check:function(e){var t={data:e,selected:[]};this.$opener.multiple&&(t.selected=this.$refs.tree.getCheckedNodes()),this.$opener.checkChange(t)},checkChange:function(e){this.$opener.multiple&&this.checkChangeDebounce()},nodeClick:function(e){this.$opener.multiple||(0===this.checkedNode.length?this.checkedNode.push(e):this.$set(this.checkedNode,0,e))},listenInput:function(){var e=this;this.loadingTree=!0,this.searchItems=[],this.showSearchItems=[],this.searchValue&&this.$nextTick((function(){e.searchTree()}))},searchTreeByinput:function(){var e=this,t=this.$replace(this.$opener.lazySearchUrl||"/area/selectArea",this.$opener);this.$http.get(t,{keyword:this.searchValue}).done((function(t){var n=t.success,r=t.data,i=t.message;n&&dsf.isArray(r)&&(_.forEach(r,(function(t){var n={};n[e.field.textField]=t.name,n[e.field.valueField]=t.id,e.searchItems.push(n)})),e.computedTreeShowData(!0)),n||dsf.layer.message(i||"请求异常",!1)})).always((function(){e.loadingTree=!1}))},loadNode:function(e,t){var n=this;return l()(u.a.mark((function r(){var i,o,s,a,l;return u.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!n.$opener.areaselect){r.next=15;break}if(!n.searchValue){r.next=5;break}return r.abrupt("return",t((null===(i=e.data)||void 0===i?void 0:i.children)||[]));case 5:if(0!==e.level){r.next=9;break}n.loadTreeFirstLevNode((function(e){return t(e)})),r.next=13;break;case 9:return r.next=11,n.loadTreeNodeChildren(e.data);case 11:return o=r.sent,r.abrupt("return",t(o));case 13:r.next=30;break;case 15:if(!n.iszdyjk||n.searchValue){r.next=24;break}if(0!==e.level){r.next=18;break}return r.abrupt("return",t([]));case 18:return r.next=20,n.loadTreeNodeChildren(e.data);case 20:return s=r.sent,r.abrupt("return",t(s));case 24:if(n.iszdyjk){r.next=30;break}if(0!==e.level){r.next=27;break}return r.abrupt("return",t(e.data));case 27:return l=[],dsf.isArray(null===(a=e.data)||void 0===a?void 0:a.children)&&_.forEach(e.data.children,(function(e){var t=_.cloneDeep(e);dsf.isArray(null===e||void 0===e?void 0:e.children)||(t.isLeaf=!0),l.push(t)})),r.abrupt("return",t(l));case 30:case"end":return r.stop()}}),r)})))()},getCheckNode:function(){var e=this,t=[],n=_.cloneDeep(this.checkedNode),r=this.$opener.showAllLevels;return n.length>0&&(t=_.map(n,(function(t){return{text:r&&(null===t||void 0===t?void 0:t.fulltext)||t[e.field.textField],value:t[e.field.valueField]}}))),t}}},p=h,v=(n(779),n(0)),m=Object(v["a"])(p,r,i,!1,null,null,null);t["default"]=m.exports},113:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"importTemplateDownload",staticClass:"ds-control ds-import-template-download"},[n("div",{staticClass:"ds-import-template-download-content"},[n("DsfVirtualScroll",[e._l(e.showTips,(function(t,r){return[n("div",{key:"ds-import-template-download-p"+r},[e.dsf.isArray(t)?[n("p",[e._v(" ( "),e._l(t,(function(r,i){return n("span",{key:"ds-import-template-download-file"+i,staticClass:"ds-import-template-download-file-name",on:{click:function(t){return e.clickHandler(r,i)}}},[e._v(" "+e._s(r)+" "),i!=t.length-1?[e._v(" 、 ")]:e._e()],2)})),e._v(" ) ")],2)]:n("p",[e._v(e._s(t))])],2)]}))],2)],1),n("div",{staticClass:"ds-import-template-download-bottom"},[e.$button.isUpload?n("UploadButton",{attrs:{button:e.$button,owner:e.owner}}):n("DsfButton",{style:e.$button.style,attrs:{icon:e.owner.getIcon(e.$button),title:e.$button.title,disabled:e.$button.disabled,size:e.owner.size,type:e.$button.type,"btn-style":e.$button.btnStyle,"icon-position":e.$button.iconPosition,loading:e.$button.loading},on:{click:function(t){return e.defaultButtonClickHandler(e.$button,t)}}},[e._v(" "+e._s(e.button.text)+" ")])],1)])},i=[],o=n(3),s=n.n(o),a=n(43);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={name:"importTemplateDownload",components:{UploadButton:a["default"]},props:{ids:{type:String,default:""},names:{type:String,default:""},tips:{type:String,default:""},button:{type:Object,default:function(){return{}}},owner:{type:Object,default:function(){return{}}}},computed:{showTips:function(){try{var e=["",""],t=0;return _.forIn(this.tips,(function(n){"("!==n&&"（"!==n||(t=-1),t>-1&&(e[t]+=n),")"!==n&&"）"!==n||(t=1)})),[e[0],this.names.split(","),e[1].replace("\n","")]}catch(n){return[this.tips]}},$button:function(){return c(c({},this.button),{},{text:"导入",icon:"",isUploadImportTemplate:!1})}},data:function(){return{}},methods:{defaultButtonClickHandler:function(e,t){this.owner.clickHandler(e,t)},clickHandler:function(e,t){var n=this.ids.split(","),r=n[t],i=dsf.url.getWebPath("file/downloadFromBlob",this.owner.$baseUrl);$("<form action="+i+' method="get"><input type="text" name="files" value="'+r+"^"+e+'"/><input type="text" name="zipName" value="'+e+'"/></form>').appendTo("body").submit().remove()}}},d=u,f=(n(781),n(0)),h=Object(f["a"])(d,r,i,!1,null,null,null);t["default"]=h.exports},43:function(e,t,n){"use strict";function r(e,t){var n=t.props,r=n.owner,i=n.button;return e("DsfButton",{attrs:{icon:r.getIcon(i),title:i.title,disabled:i.disabled,size:r.size,type:i.type,"btn-style":n.btnStyle||i.btnStyle,"icon-position":i.iconPosition,loading:i.loading},on:{click:function(e){r.uploadClickBefore(i,e),e.stopPropagation()}}},[i.text])}n.r(t),t["default"]={name:"UploadButton",functional:!0,props:{btnStyle:{type:String,default:""},button:{type:Object,default:function(){return{}}},owner:{type:Object,default:function(){return{}}}},render:function(e,t){var n=t.props,i=n.owner,o=n.button;return e("el-upload",{class:"ds-button-update",style:t.data.style,props:{disabled:o.disabled,headers:i.getHeaders(),multiple:o.multiple,accept:i.getFileAccept(o),data:i.getUploadData(o),showFileList:!1,action:i.uploadUrl(o),onProgress:i.handleProgress,onChange:i.handleChange,onSuccess:i.handleAvatarSuccess(o),beforeUpload:i.beforeAvatarUpload(o)}},[r(e,t)])}}},435:function(e,t,n){e.exports=n.p+"modules/platform/img/flow-ybj.png"},570:function(e,t,n){var r=n(780);"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n(19).default;i("b7368f4a",r,!0,{sourceMap:!1,shadowMode:!1})},571:function(e,t,n){var r=n(782);"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n(19).default;i("69f21966",r,!0,{sourceMap:!1,shadowMode:!1})},779:function(e,t,n){"use strict";n(570)},780:function(e,t,n){"use strict";n.r(t)},781:function(e,t,n){"use strict";n(571)},782:function(e,t,n){"use strict";n.r(t)}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_common_output_common.js.map