/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[57],{414:function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return y})),n.d(t,"e",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"h",(function(){return w})),n.d(t,"j",(function(){return D})),n.d(t,"c",(function(){return S})),n.d(t,"i",(function(){return I})),n.d(t,"f",(function(){return B})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return k}));var i=n(4),a=n.n(i),r=n(3),s=n.n(r),o=n(1),l=n.n(o),u=n(97);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h="table-column";function f(e,t,n){var i={label:"",columnId:"",level:0,isLast:!1,hide:!1,headerAlign:"center",align:"center",resizable:!1,width:"auto",children:[]},a=dsf.mix({},i,e);return n?dsf.isUnDef(t)?(n.children.push(a),a.level=n.level+1):n.children.splice(t,0,a):dsf.isUnDef(t)?this.columns.push(a):this.columns.splice(t,0,a),a}function m(){if(this.isDesign&&0==this.columns.length)for(var e=4,t=0;t<e;t++){var n={id:dsf.uuid(8),label:"列".concat(t),level:0,columnId:h+"-"+dsf.math.numToEnglishLetter(t+1)};"dsf.treedatagrid"!==this.ctrlType||t||(n.headerAlign="left",n.align="left"),f.call(this,n)}}function p(e){var t=[];return g.call(this,(function(e){e.children&&e.children.length?(e.columnId="",e.isLast=!1):(e.isLast=!0,t.push(e))}),e),t}function g(e,t){var n=function t(n,i){var a=0;_.each(n,(function(n,r){e&&e(n,r,a,i),t(n.children,i+1),a++}))},i=t||this.columns;i="array"!==dsf.type(i)?[i]:i,n(i,0)}function y(e,t){_.forEach(e,(function(e){var n,i=_.find(t,(function(t){return t.id===e.id}));i&&(i.width=e.width,null!==(n=e.children)&&void 0!==n&&n.length&&y(e.children,i.children))}))}function b(e){return _.map(e,(function(e){var t=e.id,n=e.columnId,i=e.label,a=e.width,r=e.fixed,s=e.children,o={id:t,columnId:n,label:i,width:a,fixed:r};return null!==s&&void 0!==s&&s.length&&(o.children=b(s)),o}))}function v(){var e=this;if(this.isDesign){var t=[C.call(this,{id:"datagrid-hide"})];this.layoutInfo.forEach((function(n){"table"==n.type?t=t.concat(x.call(e)):t.push(C.call(e,n))})),this.$emit("update:slots",t),_.find(this.layoutInfo,(function(t){return t.id===e.currentShowLayout.id}))||(this.currentShowLayout=this.layoutInfo[0])}}function x(){var e=this,t=this.getLastColumns(),n=[];return _.each(t,(function(t,i){var a,r=t.columnId,s=_.find(e.slots,(function(e){return e.name==r}));if(s)s.name=r;else{var o=s={name:r,controls:[dsf.designer.createComponent(u["default"],{"slot-name":"default"})]};e.slots.push(o),s=o}t.columnId=r,null!==(a=s.controls)&&void 0!==a&&a.length&&"DsfDataGridCellContent"==s.controls[0].ctrlName&&(s.controls[0].columnId=r),s.controls[0],s.scope="scope",s.repeat=!0,s.dataKey="row",n.push(s)})),n=n.sort((function(e,n){var i=_.findIndex(t,(function(t){return t.columnId==e.name})),a=_.findIndex(t,(function(e){return e.columnId==n.name}));return i>a?1:-1})),n}function C(e){var t=e.id,n=(e.type,_.find(this.slots,(function(e){return e.name==t})));return n||(n={name:t,controls:[],scope:"scope",dataKey:"row",repeat:!0,textProxy:!0}),n}function w(e,t){dsf.designer.triggerDialogPropty("columns")}function S(e){var t,n,i=this,a=[],r="";dsf.deepForEach(this.columns||[],(function(e,t,n){e.id||(e.id=dsf.uuid(8))})),dsf.array.removeAll(this.childMetaDataCodes),dsf.designer.recursionLayoutTree(this,null,null,(function(t,n,s){if(t!=i){n==i&&(r=s);var o=t.$options.design||{},l=o.metadata||{},u=l.create&&l.create.call(t,e);if(u&&u.metadata){u.metadata.inColumn=r;var c=$(t.$el).closest(".ds-datagrid-column-hide");c.is(".ds-datagrid-column-hide")&&(u.metadata.hidden=!0),a.push(u);var d=!dsf.isDef(l.isDeep)||l.isDeep;if(!d)return!1}}}));for(var s={},o=[],l=[],u=0;u<this.searchInfo.length;u++){var c=this.searchInfo[u],h=null,f="";"datetime"==c.dataType&&(f="yyyy-MM-dd HH:mm:ss","ymd"==c.format?f="yyyy-MM-dd":"ym"==c.format?f="yyyy-MM":"y"==c.format&&(f="yyyy")),"0"==c.type?(h={code:c.code,operator:c.operation,valueKey:"searchValue",from:"searchInput",dataType:c.dataType||"string",format:f},o.push(h)):(h={code:c.code,operator:c.operation,valueKey:c.code,from:"default",dataType:c.dataType||"string",format:f},l.push(h),c.metadata_fullcode=h.code)}var m={logic:"or",items:[]};(t=m.items).push.apply(t,o);var p={logic:"and",items:[]};(n=p.items).push.apply(n,l);var g={logic:"and",items:[]};g.items.push(m),g.items.push(p);var y={logic:"and",items:[]},b=[];_.each(this.superSearchInfo,(function(e){var t=null,n="",i=null;if("enum"==e.searchType){var a,r=[];if((null===e||void 0===e||null===(a=e.children)||void 0===a?void 0:a.length)>0?(r=_.map(e.children,(function(e){return 1==e.join})),r=r.slice(0,1)):r=[e],1==r.length){t=r[0].field,n=r[0].operator,i=r[0].field,"in"!=n&&"eq"!=n||(n="in");var s={code:t,operator:"in"==n||"eq"==n?"in":n,valueKey:t,dataType:"like"==n?"enum":"string",format:"",from:"superSearch"};b.push(s)}}else if("text"==e.searchType)t=e.field,n=e.operator,i=e.field,b.push({code:t,operator:n,valueKey:i,dataType:"string",format:"",from:"superSearch"});else if("number"==e.searchType)t=e.field,n=e.operator,i=e.field,b.push({code:t,operator:n,valueKey:i,dataType:"number",format:"",from:"superSearch"});else if("datetime"==e.searchType){var o,l=[];if((null===e||void 0===e||null===(o=e.children)||void 0===o?void 0:o.length)>0?(l=_.map(e.children,(function(e){return 1==e.join})),l=l.slice(0,1)):l=[e],1==l.length){var u="yyyy-MM-dd HH:mm:ss";"ymd"==e.model?u="yyyy-MM-dd":"ym"==e.model?u="yyyy-MM":"y"==e.model&&(u="yyyy"),b.push({code:l[0].field,operator:l[0].operator,valueKey:l[0].field,dataType:"datetime",format:u})}}else"period"==e.searchType&&b.push({code:e.field,operator:e.operator,valueKey:e.field,dataType:"datetime",format:"yyyy-MM-dd HH:mm:ss",from:"superSearch"})})),y.items=b,g.items.push(y),s=g;var v={};if(this.exportOptions["rule-1"]&&0==this.exportOptions["rule-1"].length)for(var x=[],C=function(){var e=a[w].metadata;if(e.hidden)return 1;_.each(e.valueAttributes,(function(t){var n=e.at.replace(/\./g,"_"),i={caption:e.name+(e.valueAttributes.length>1?"("+t.name+")":""),code:e.code,currentValueAttribute:t.code,format:"",id:n+"."+(1==e.valueAttributes.length?e.code:e.code+"_"+t.code),table:n,valueAttributes:_.map(e.valueAttributes,"code"),style:{align:"center",headerAlign:"center"}};x.push(i)})),i.exportOptions["rule-1"]=x},w=0;w<a.length;w++)C();_.each(this.exportOptions,(function(e,t){e&&e.length>0&&(v[i.caption+"."+t]=e)}));var S={query:s,export:d({},v),browseScope:this.browseScope,self:this};return dsf.array.removeAll(this.childMetaDataCodes),a.length&&(_.each(a,(function(e){dsf.array.ensure(i.childMetaDataCodes,e.metadata_fullcode)})),this.$emit("update:dataPrefix",a[0].metadata.at.replace(/\./g,"_"))),[S].concat(a)}function k(e){var t=this;this.$vm&&this.designId&&_.each(e,(function(e){for(var n=0;n<t.slots.length;n++){var i;if(null!==t&&void 0!==t&&null!==(i=t.slots)&&void 0!==i&&null!==(i=i[n])&&void 0!==i&&i.repeat){var a,r=t.slots[n],s=null===r||void 0===r||null===(a=r.controls)||void 0===a?void 0:a[0];if(s&&s.designId){var o,l=(null===s||void 0===s||null===(o=s.slots[0])||void 0===o?void 0:o.controls)||[];_.each(l,(function(n){if(n&&n.designId){var i=n.designId+"-"+e.$hash;delete t.$vm.$controls[i]}}))}}}}))}function T(e){var t=this;this.$vm&&this.designId&&_.each(e,(function(e){for(var n=0;n<t.slots.length;n++){var i;if(null!==t&&void 0!==t&&null!==(i=t.slots)&&void 0!==i&&null!==(i=i[n])&&void 0!==i&&i.repeat){var a,r=t.slots[n],s=null===r||void 0===r||null===(a=r.controls)||void 0===a?void 0:a[0];if(s&&s.designId){var o,l=(null===s||void 0===s||null===(o=s.slots[0])||void 0===o?void 0:o.controls)||[];_.each(l,(function(n){if(n&&n.designId&&!n.textProxy){var i=n.designId+"-"+e.$hash;if(dsf.isUnDef(t.$vm.$controls[i])){var a=dsf.mix(!0,{},n);t.$vm.$set(t.$vm.$controls,i,a)}}}))}}}}))}function D(e){return L.apply(this,arguments)}function L(){return L=a()(l.a.mark((function e(t){var n,i,r,s,o,u,c,d=this;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.row,i=t.event,t.$index,r={},["$vm","$page","$form","$dialog"].forEach((function(e){r[e]={default:d[e]}})),r["$list"]={default:this},s=window.$components["platform"]["DsfButtonBar"],!dsf.isFunction(s)){e.next=13;break}if(!s.resolved){e.next=10;break}s=s.resolved,e.next=13;break;case 10:return e.next=12,s();case 12:s=e.sent;case 13:o=Vue.extend({mixins:[s],inject:r}),u=new o({propsData:{isDesign:!1,owner:this,local:n,renderButton:this.renderRowButton,disabledButton:this.disabledRowButton,buttons:this.contextmenuList,emitPrefix:"row-button"}}),c=[],_.forEach(u.validButtons,(function(e){return c.push({icon:e.icon,name:e.text||e.title,disabled:e.disabled,handler:e.isUpload?a()(l.a.mark((function t(){var n,a,r,s,o,c;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=u.getButtonParams(e),r=dsf.url.getWebPath(a[0]),s=dsf.url.queryStringParse(a[1]),o=_.map(null===(n=a[2])||void 0===n?void 0:n.split("|"),(function(e){return e=e.toLowerCase(),dsf.mime[e]||e})).join(","),t.next=6,dsf.file.load(o);case 6:if(s.file=t.sent,s.file){t.next=9;break}return t.abrupt("return");case 9:c=dsf.layer.loading(),dsf.http.upload(r,s).done((function(t){u.clickHandler(e,i,t)})).error((function(e){dsf.layer.message((null===e||void 0===e?void 0:e.message)||"上传文件失败",!1)})).finally((function(){dsf.layer.closeLoading(c)}));case 11:case"end":return t.stop()}}),t)}))):function(){u.clickHandler(e,i)}})})),c.length&&(i.preventDefault(),i.stopPropagation(),Vue.directive("contextMenu").contextMenuClick({x:i.clientX,y:i.clientY},n,c,i.target,i));case 18:case"end":return e.stop()}}),e,this)}))),L.apply(this,arguments)}var I=_.debounce((function(){dsf.layer.message("数据中_id的值存在重复，会导致页面出现未知的bug,请及时处理",!1)}),100);function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.length>0){var n={};dsf.deepForEach(t,(function(e){n[e.id]=e}));var i=dsf.cloneDeepWith(e,(function(e){return n[e.id]?e:null}));return dsf.cloneDeepWith(i,(function(e){var t=!0;return dsf.deepForEach(e,(function(e){var i,a=n[e.id];if(a&&(null===(i=a.children)||void 0===i||!i.length))return t=!1,-1}),{isLast:!0}),t?null:e}))}return dsf.cloneDeepWith(t,(function(e){var t=e.id,n=e.columnId,i=e.label,a=e.width,r=e.fixed,s=e.addFilterColumns;return!0===s||void 0===s?{id:t,columnId:n,label:i,width:a,fixed:r}:null}))}},464:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.search.apply(null,arguments)}}},[n("div",{staticClass:"search-input el-input"},[n("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e.searchInputValue,expression:"searchInputValue",modifiers:{lazy:!0}}],staticClass:"el-input__inner",attrs:{placeholder:e.placeholder,type:"text",autocomplete:"off"},domProps:{value:e.searchInputValue},on:{change:[function(t){e.searchInputValue=t.target.value},e.changeHandler]}})]),e._m(0)])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"search-button"},[n("i",{staticClass:"iconfont icon-fangdajing"})])}],r={name:"DsfDataGridSearchInput",props:{placeholder:{type:String,default:""},defaultSearchValue:{type:String,default:""}},data:function(){return{searchInputValue:""}},computed:{},watch:{defaultSearchValue:{handler:function(e){this.searchInputValue=e},immediate:!0}},created:function(){},mounted:function(){},methods:{search:function(){this.$emit("change",this.searchInputValue),this.$emit("search",this.searchInputValue)},changeHandler:function(){this.$emit("change",this.searchInputValue)}}},s=r,o=n(0),l=Object(o["a"])(s,i,a,!1,null,null,null);t["a"]=l.exports},956:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ds-control ds-datagrid",class:e.getCss},[n("DsfPanel",{staticClass:"ds-datagrid-panel",class:e.getPanelClass,style:e.getListStyle,attrs:{"has-title":e.showTitle,"has-header":e.showHead,"background-config":e.backgroundConfig,"title-border":""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(e.label)+" ")]},proxy:!0},{key:"header-left",fn:function(){return[e._t("header-left",(function(){return[n("div",{staticClass:"ds-datagrid-header-left"},[n("span",{staticClass:"ds-datagrid-header-left-showType"},e._l(e.layoutInfoCopy,(function(t){return n("i",{key:t.id,class:["show-type-icon","iconfont",t.icon,{active:e.currentShowLayout.id==t.id}],on:{click:function(n){e.currentShowLayout=t}}})})),0)])]}))]},proxy:!0},{key:"header",fn:function(){return[e._t("header",(function(){return[n("div",{staticClass:"ds-datagrid-header"},[e.checkboxColumn.show?n("div",{staticClass:"head-right-item",staticStyle:{"margin-left":"10px"}},[e.isSingleChecked?e._e():n("span",{staticClass:"ds-datagrid-checkednumber ds_font5"},[n("i",{staticClass:"icon-093info iconfont icon-color ds_icon_4",staticStyle:{"margin-right":"5px"}}),e._v("已选："),n("font",{staticStyle:{margin:"0 5px"}},[e._v(e._s(e.multipleSelection.length))]),e._v("条 ")],1)]):e._e(),e.showSearch?n("div",{staticClass:"head-right-item",staticStyle:{"margin-left":"10px"}},[n("search-input",{attrs:{placeholder:e.searchPlaceholder}})],1):e._e(),e.buttons.length?n("div",{staticClass:"head-right-item",staticStyle:{"margin-left":"10px"}},[n("DsfButtonBar",{ref:"buttonbar",class:{"ds-no-padding":!0},attrs:{"is-design":e.isDesign,"more-button-style":e.buttonsMoreStyle,"more-button-text":e.buttonsMoreText,"max-number":e.buttonsMaxNumber,buttons:e.buttons,"render-button":e.renderButton,local:e.local}})],1):e._e(),n("div",{staticClass:"head-right-item",attrs:{"slot-name":"header-attach"}},[e._t("header-attach")],2)])]}))]},proxy:!0},{key:"default",fn:function(){return[n("div",{staticClass:"ds-datagrid-box"},[n("div",{staticClass:"ds-datagrid-search-wrap",class:{extend:e.superSearchExtend}},[e._t("search-bar",(function(){return[!e.hideSuperSearch&&e.superSearchInfo.length>0?[n("DsfSuperSearch",{ref:"superSearchBar",attrs:{"super-search-row-border":e.superSearchRowBorder,"show-fitler":e.showSuperSearchFilter,"search-item-setting":e.superSearchInfo,owner:e._self,"default-rows-number":e.superSearchDefaultRowsNumber,"value-change-trigger":!e.superSearchButtonTrigger},on:{"change-height":e.superSearchChangeHeight,extend:e.superSearchExtendHandler,loaded:e.superSearchLoadedHandler}})]:e._e()]}))],2),e._t("custom-order",(function(){return[e.customerOrder.length&&"cardList"==e.currentShowLayout.type?n("dsf-custom-order",{attrs:{"custom-order":e.customerOrder}},[e._t("custom-order-right",null,{data:e.staticValue,count:e.pageCount})],2):e._e()]}),{customOrder:e.customerOrder}),e.isDesign?[e._l(e.layoutInfoCopy,(function(t){return[e.refreshTable||"table"!=t.type?"cardList"==t.type?n("div",{directives:[{name:"show",rawName:"v-show",value:e.currentShowLayout.id==t.id,expression:"currentShowLayout.id == item.id"}],key:t.id,staticClass:"ds-datagrid-content-wrap card-mode",style:e.getContentWrapStyle(t)},[n("dsf-static-list-by-card",{attrs:{data:e.staticValue,"column-number":e.cardListColumnNumber,"column-width":e.cardListColumnWidth,"margin-top":e.cardListMarginTop,checkbox:e.checkboxColumn.show,"max-check-num":e.isSingleChecked?1:0,"checkbox-style":e.cardListCheckboxStyle,"checkbox-size":e.cardListCheckboxSize,"checkbox-position":e.cardListCheckboxPosition,"is-design":""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"ds-datagrid-slot",attrs:{"slot-name":"default"}},[e._t("default",null,null,t)],2)]}}],null,!0)})],1):e._e():n("dsf-static-list-by-table",{directives:[{name:"show",rawName:"v-show",value:e.currentShowLayout.id==t.id,expression:"currentShowLayout.id == item.id"}],key:t.id,ref:"table",refInFor:!0,style:e.getContentWrapStyle(t),attrs:{"is-design":e.isDesign,"is-editable":e.isEditable,columns:e.columns,"checkbox-column":e.checkboxColumn,"index-column":e.indexColumn,"operate-column":e.operateColumn,"row-buttons":e.rowButtons,"render-row-Button":e.renderRowButton,"is-single-checked":e.isSingleChecked,border:!0,fit:!0,"header-cell-class-name":e.getHeaderClass,data:e.staticValue,height:e.tableHeight,"customer-order":e.customerOrder,"is-re-draw-hander":e.isReDrawHander,"row-buttons-max-number":e.rowButtonsMaxNumber,"row-buttons-more-style":e.rowButtonsMoreStyle,"row-buttons-more-text":e.rowButtonsMoreText},scopedSlots:e._u([e._l(e.getLastColumns(),(function(t){return{key:t.columnId,fn:function(n){return[e._t(t.columnId,null,null,n)]}}}))],null,!0)})]}))]:[e._l(e.layoutInfoCopy,(function(t){return["table"==t.type?n("wrap-content",{key:t.id},[n("dsf-static-list-by-table",{directives:[{name:"show",rawName:"v-show",value:e.currentShowLayout.id==t.id,expression:"currentShowLayout.id == item.id"}],ref:"table",refInFor:!0,attrs:{columns:e.columns,data:e.currentPageData,height:e.tableHeight,"checkbox-column":e.checkboxColumn,"index-column":e.indexColumn,"operate-column":e.operateColumn,"row-buttons":e.rowButtons,"is-single-checked":e.isSingleChecked,"header-cell-class-name":e.getHeaderClass,"customer-order":e.customerOrder,"is-re-draw-hander":e.isReDrawHander,"row-buttons-max-number":e.rowButtonsMaxNumber,"row-buttons-more-style":e.rowButtonsMoreStyle,"row-buttons-more-text":e.rowButtonsMoreText,"is-design":!1,border:"",stripe:"",fit:""},on:{"update:columns":function(t){e.columns=t},"table-column-resize":e.tableColumnResize},scopedSlots:e._u([e._l(e.getLastColumns(),(function(t){return{key:t.columnId,fn:function(n){return[e._t(t.columnId,null,null,n)]}}}))],null,!0)},[e._t("default")],2)],1):"cardList"==t.type?n("wrap-content",{key:t.id},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.currentShowLayout.id==t.id,expression:"currentShowLayout.id == item.id"}],staticClass:"ds-datagrid-content-wrap card-mode"},[n("dsf-static-list-by-card",{ref:"cardBox",refInFor:!0,attrs:{data:e.currentPageData,"column-number":e.cardListColumnNumber,"column-width":e.cardListColumnWidth,"margin-top":e.cardListMarginTop,checkbox:e.checkboxColumn.show,"max-check-num":e.isSingleChecked?1:0,"checkbox-style":e.cardListCheckboxStyle,"checkbox-size":e.cardListCheckboxSize,"checkbox-position":e.cardListCheckboxPosition},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("default",null,null,t)]}}],null,!0)})],1)]):e._e()]}))],e.isDesign?[n("div",{staticClass:"ds-datagrid-pager",style:{"text-align":e.paginationPosition}},["table"==e.currentShowLayout.type?n("div",{staticClass:"dsf-static-list-by-table-button-group"},[n("DsfButton",{attrs:{text:e.isEditable?"完成编辑":"编辑模式",size:"small"},on:{click:function(t){e.isEditable=!e.isEditable}}}),e.isEditable?[n("DsfButton",{attrs:{size:"small",text:"新增行"},on:{click:e.addRowByTable}}),n("DsfButton",{attrs:{size:"small",text:"批量删除"},on:{click:e.removeRowsByTable}})]:e._e()],2):e._e(),e.showPagination?n("el-pagination",{ref:"pagination",class:[e.paginationStyle],attrs:{"hide-on-single-page":!1,total:e.pageCount,"page-size":e.pageSize,"page-sizes":e.limits,"current-page":e.currentPage,layout:"slot,"+e.pagerLayout},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.pageSizeChange}},["table"==e.currentShowLayout.type?n("span",{staticStyle:{"margin-right":"10px"}},[n("a",{staticClass:"ds-datagrid-pager-button",attrs:{title:"还原列表"},on:{click:function(t){return e.headerReset()}}},[n("DsfIcon",{attrs:{name:"chehuisekuai"}})],1),n("a",{staticClass:"ds-datagrid-pager-button",attrs:{title:"刷新"}},[n("DsfIcon",{attrs:{name:"shuaxin"}})],1)]):e._e()]):e._e()],1)]:e.showPagination?n("div",{staticClass:"ds-datagrid-pager",style:{"text-align":e.paginationPosition}},[n("el-pagination",{ref:"pagination",class:[e.paginationStyle],attrs:{"hide-on-single-page":!1,total:e.pageCount,"page-size":e.pageSize,"page-sizes":e.limits,"current-page":e.currentPage,layout:"slot,"+e.pagerLayout},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.pageSizeChange}},["table"==e.currentShowLayout.type?n("span",{staticStyle:{"margin-right":"10px"}},[n("a",{staticClass:"ds-datagrid-pager-button",attrs:{title:"还原列表"},on:{click:function(t){return e.headerReset()}}},[n("DsfIcon",{attrs:{name:"chehuisekuai"}})],1),n("a",{staticClass:"ds-datagrid-pager-button",attrs:{title:"刷新"}},[n("DsfIcon",{attrs:{name:"shuaxin"}})],1)]):e._e()])],1):e._e()],2)]},proxy:!0}],null,!0)})],1)},a=[],r=n(2),s=n.n(r),o=n(4),l=n.n(o),u=n(1),c=n.n(u),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ds-datagrid-content-wrap table-mode"},[e.isDesign?n("el-table",{ref:"table",staticClass:"dsf-static-list-by-table",class:{disabledCheckHead:e.isSingleChecked},attrs:{border:!0,fit:!0,data:e.data,"row-key":"_id","tree-props":e.$list.treeProps,height:e.height,"header-cell-class-name":e.headerCellClassName,stripe:""}},[e.isReDrawHander?e._e():[e.checkboxColumn.show||e.isEditable?n("el-table-column",{attrs:{width:e.checkboxColumn.width,type:"selection","header-align":"center",align:"center",fixed:"left"}}):e._e(),e.indexColumn.show?n("el-table-column",{attrs:{index:e.$list.indexMethod,resizable:!1,width:e.indexColumnWidth,type:"index",label:"序号","header-align":"center",align:"center",fixed:"left"}}):e._e(),e._l(e.getColumns(),(function(t){return[n("dsf-static-list-by-table-column",{key:t.columnId,attrs:{"is-design":e.isDesign,columns:t,"get-column-sort":e.getColumnSort},scopedSlots:e._u([{key:"header",fn:function(t){return[n("div",{staticClass:"editor-td-box"},[n("dsf-div-editor",{class:[t.col.align],staticStyle:{width:"100%",height:"100%"},attrs:{tag:"div","filter-style":"text",value:t.col.label},on:{html:function(n){return e.editHeader(n,t.col,t)},blur:function(n){return e.editHeaderBlur(n,t.col)}}})],1)]}},{key:"default",fn:function(t){var i=t.row,a=t.col;return[n("div",{staticClass:"editor-td-box"},[n("dsf-div-editor",{class:[a.align],staticStyle:{width:"100%",height:"100%"},attrs:{tag:"div","filter-style":"style"},model:{value:i[a.columnId],callback:function(t){e.$set(i,a.columnId,t)},expression:"row[col.columnId]"}})],1)]}}],null,!0)})]})),e.isEditable?n("el-table-column",{attrs:{label:"操作","header-align":"center",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"dsf-static-list-by-table-button-row"},[n("a",{on:{click:function(n){return e.insertRow(t.$index)}}},[e._v("插入")]),e.$list.isTreeTable?n("a",{on:{click:function(n){return e.insertChildRow(t.row)}}},[e._v(" 插入子项 ")]):e._e(),n("a",{on:{click:function(n){return e.removeRow(t.row)}}},[e._v("删除")])])]}}],null,!1,1705412763)}):e.operateColumn.show?n("el-table-column",{attrs:{label:"操作",width:e.operateColumn.width,"header-align":"center",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("DsfButtonBar",{staticClass:"ds-no-padding ds-no-drop",attrs:{size:"small","max-number":e.rowButtonsMaxNumber,"more-button-text":e.rowButtonsMoreText,"more-button-style":e.rowButtonsMoreStyle,"is-design":e.isDesign,buttons:t._self.rowButtons,align:"center"}})]}}],null,!1,445715671)}):e._e()]],2):n("el-table",{ref:"table",staticClass:"dsf-static-list-by-table",class:{disabledCheckHead:e.isSingleChecked},attrs:{"row-key":"_id",border:!0,fit:!0,data:e.data,"tree-props":e.$list.treeProps,height:e.height,"default-expand-all":e.$list.extendDefaultAll,"header-cell-class-name":e.headerCellClassName,stripe:""}},[e.checkboxColumn.show?n("el-table-column",{attrs:{width:e.checkboxColumn.width,type:"selection","header-align":"center",align:"center",fixed:"left"}}):e._e(),e.indexColumn.show?n("el-table-column",{attrs:{index:e.$list.indexMethod,resizable:!1,width:e.indexColumnWidth,type:"index",label:"序号","header-align":"center",align:"center",fixed:"left"}}):e._e(),e._l(e.getColumns(),(function(t,i){return n("dsf-static-list-by-table-column",{key:i,attrs:{columns:t,label:t.label,"get-column-sort":e.getColumnSort},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,a=t.col;return[n("span",{domProps:{innerHTML:e._s(i[a.columnId])}})]}}],null,!0)})})),e.operateColumn.show?n("el-table-column",{attrs:{label:"操作",width:e.operateColumn.width,"header-align":"center",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("DsfButtonBar",{staticClass:"ds-no-padding ds-no-drop",attrs:{size:"small","max-number":e.rowButtonsMaxNumber,"more-button-text":e.rowButtonsMoreText,"more-button-style":e.rowButtonsMoreStyle,"is-design":e.isDesign,buttons:t._self.rowButtons,align:"center"}})]}}],null,!1,445715671)}):e._e()],2)],1)},h=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.columns.children&&e.columns.children.length?n("el-table-column",{attrs:{label:e.columns.label,resizable:!e.isDesign,width:e.columns.width,"min-width":e.columns.minWidth,"header-align":e.columns.headerAlign,align:e.columns.align,"class-name":"editor-td"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._t("header",(function(){return[e._v(" "+e._s(e.columns.label)+" ")]}),{col:e.columns},t)]}}],null,!0)},e._l(e.columns.children,(function(t){return n("dsf-static-list-by-table-column",{key:t.columnId,attrs:{"is-design":e.isDesign,columns:t,"get-column-sort":e.getColumnSort},scopedSlots:e._u([{key:"header",fn:function(n){return[e._t("header",(function(){return[e._v(" "+e._s(t.label)+" ")]}),{col:t},n)]}},{key:"default",fn:function(n){return[e._t("default",null,{col:t},n)]}}],null,!0)})})),1):"extend"==e.columns.columnType?n("el-table-column",{attrs:{label:e.columns.label,prop:e.columns.columnId,resizable:!e.isDesign,width:e.columns.width,"min-width":e.columns.minWidth,"header-align":e.columns.headerAlign,align:"left",sortable:e.getColumnSort(e.columns),"class-name":"editor-td"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._t("header",(function(){return[e._v(" "+e._s(e.columns.label)+" ")]}),{col:e.columns},t)]}},{key:"default",fn:function(t){return[e._t("default",null,{col:e.columns},t)]}}],null,!0)}):n("el-table-column",{attrs:{label:e.columns.label,prop:e.columns.columnId,resizable:!e.isDesign,width:e.columns.width,"min-width":e.columns.minWidth,"header-align":e.columns.headerAlign,align:e.columns.align,sortable:e.getColumnSort(e.columns),"class-name":"editor-td"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._t("header",(function(){return[e._v(" "+e._s(e.columns.label)+" ")]}),{col:e.columns},t)]}},{key:"default",fn:function(t){return[e._t("default",null,{col:e.columns},t)]}}],null,!0)})},m=[],p={name:"DsfStaticListByTableColumn",props:{isDesign:{type:Boolean,default:!1},columns:{type:Object,default:function(){return{}}},getColumnSort:{type:Function,required:!0}},data:function(){return{columnType:""}},mounted:function(){}},g=p,y=n(0),b=Object(y["a"])(g,f,m,!1,null,null,null),v=b.exports;function x(e,t){var n=this,i=[];return _.forEach(e,(function(e){var a=_.find(t,(function(t){return t.id===e.id}));if(a){var r=e.width;if(e.children){var s=x.call(n,e.children,a.children);i.push(Object.assign({},a,{width:r,children:s}))}else i.push(Object.assign({},a,{width:r}))}})),Vue.observable(i)}function C(e,t){var n=this,i=[];return _.forEach(e,(function(e){if(!1!==t(e,!0))if(e.isLast){var a=_.cloneDeep(e);delete a.children,i.push(a)}else if(e.children.length){var r=C.call(n,e.children,t,e.children);if(r.length){var s={children:r};for(var o in e)"children"!==o&&(s[o]=e[o]);if(s.fixed){var l=0;dsf.deepForEach(s,(function(e){l+=parseInt(e.width)}),{isLast:!0}),s.width=l}i.push(s)}}})),Vue.observable(i)}var w={name:"DsfStaticListByTable",components:{DsfStaticListByTableColumn:v},mixins:[$mixins.layout],inject:{$list:{default:null}},props:{isEditable:{type:Boolean,default:!1},columns:{type:Array,default:function(){return[]}},data:{type:Array,default:function(){return[]}},isReDrawHander:{type:Boolean,default:!1},rowButtons:{type:Array,default:function(){return[]}},renderRowButton:{type:Function,default:null},rowButtonsMaxNumber:{type:[Number,String],default:4},rowButtonsMoreStyle:{type:String,default:"icon-text"},rowButtonsMoreText:{type:String,default:"更多"},height:{type:String,default:function(){return"100%"}},stripe:{type:Boolean,default:!0},slots:{type:Array,default:function(){return[{name:"default",controls:[]}]}},checkboxColumn:{type:Object,default:function(){return{}}},indexColumn:{type:Object,default:function(){return{}}},operateColumn:{type:Object,default:function(){return{}}},border:{type:Boolean,default:!0},fit:{type:Boolean,default:!0},isSingleChecked:{type:Boolean,default:!1},rowKey:{type:[String,Function],default:""},headerCellClassName:{type:[String,Function],default:""},spanMethod:{type:Function,required:!1},customerOrder:{type:Array,default:function(){return[]}},filterResult:{type:Array,default:function(){return[]}}},data:function(){return{columnsBak:null,updateHeader:!1,tableWidth:0,tableClientWidth:0,elTable:null,multipleSelectionCopy:null,operateColumnWidth:this.operateColumn.width,operateColumnFixed:!1,indexWidthCoefficient:1}},computed:{lastColumns:function(){return this.getLastColumns()},realColumns:function(){var e=this.columns;return C.call(this,e,this.getColumnRenderResult)},filterColumns:function(){var e=this.columns,t=this.filterResult;return this.filterResult.length<=0?e:x.call(this,t,e)},realFilterColumns:function(){return C.call(this,this.filterColumns,this.getColumnRenderResult)},columnsTree:function(){return C.call(this,this.columns,this.getColumnRenderResult)},multipleSelection:{get:function(){return this.$list?this.$list.multipleSelection:this.multipleSelectionCopy},set:function(e){this.$list?this.$list.multipleSelection=e:this.multipleSelectionCopy=e}},isTreeColumns:function(){for(var e=!1,t=this.realFilterColumns,n=0;n<t.length;n++)if(!t[n].isLast){e=!0;break}return e},indexColumnWidth:function(){return this.indexColumn.width*this.indexWidthCoefficient}},created:function(){_.each(this.lastColumns,(function(e){e.designWidth=e.width}))},mounted:function(){this.elTable=this.$refs.table,this.$list.isDesign||(this.columnsBak=dsf.mix(!0,[],this.columns))},updated:function(){this.doLayout()},methods:{insertRow:function(e){this.data.splice(e+1,0,{_id:dsf.uuid(8)})},insertChildRow:function(e){e&&(e.children||this.$set(e,"children",[]),e.children.push({_id:dsf.uuid(8)}))},removeRow:function(e){var t=this;dsf.deepForEach(this.data,(function(n,i,a,r){n===e&&(r?dsf.array.remove(r.children,n):dsf.array.remove(t.data,n))}))},getColumnRenderResult:function(e){var t=!0;return t=!e.hide&&!1!==this.renderHeader(e),t},getLastColumns:function(e){var t=[];return this.deep((function(e){e.children&&e.children.length?(e.columnId="",e.isLast=!1):(e.isLast=!0,t.push(e))}),e),t},deep:function(e,t){var n=function t(n,i){var a=0;_.each(n,(function(n,r){e&&e(n,r,a,i),t(n.children,i+1),a++}))},i=t||this.columns;i="array"!==dsf.type(i)?[i]:i,n(i,0)},doLayout:function(){var e;this.elTable=this.$refs.table,null===(e=this.elTable)||void 0===e||e.doLayout()},resize:function(){var e=this;this.doLayout(),this.$list.isDesign||this.$nextTick((function(){if(e.elTable){e.resetTableWidth();var t=0,n=_.map(e.lastColumns,"columnId"),i=e.elTable.$el.querySelector(".el-table__header-wrapper>table"),a=i.querySelector("thead");_.each(e.elTable.columns,(function(e,i){if(n.indexOf(e.columnKey)>=0){var r=e.realWidth||e.width;if(dsf.isNumber(r))t+=r;else{var s=a.querySelector("."+e.id);s&&(t+=s.offsetWidth)}}})),t>0&&(t+=e.getIndexWidth(),t+=e.getCheckColumnWidth(),e.operateColumn.show&&(t+=parseFloat(e.operateColumn.width||100)),e.tableClientWidth>t?e.operateColumnFixed=!1:e.operateColumnFixed="right"),e.elTable.fixedColumns&&e.elTable.fixedColumns.length>0&&_.each(e.elTable.fixedColumns,(function(t,n){if(t.children&&t.children.length>0){var i=_.filter(e.elTable.columns,(function(e){return 0==e.id.indexOf(t.id+"_")})),a=0;_.each(i,(function(e){dsf.isNumber(e.realWidth||e.width)&&(a+=e.realWidth||e.width)})),t.realWidth=a}})),e.$nextTick((function(){e.doLayout()}))}}))},handleSelection:function(e,t){if(this.isSingleChecked){var n=!!_.find(e,(function(e){return e._id===t._id})),i=n?[t]:[];this.multipleSelection=i,this.$emit("select",i,t)}else this.$emit("select",e,t)},handleSelectionAll:function(e){this.isSingleChecked&&(!this.multipleSelection&&this.data.length?(e=[this.data[0]],this.toggleRowSelection(this.data[0],!0)):e=this.multipleSelection?[this.multipleSelection]:[]),this.$emit("select-all",e)},headerDragend:function(e,t,n,i){var a=this,r=_.find(this.lastColumns,(function(e){return e.columnId==n.columnKey})),s=_.keyBy(this.realFilterColumns,"columnId");r.designWidth.endsWith("%")?s[n.columnKey].width=this.pxTopercentage(e,this.tableClientWidth):s[n.columnKey]&&(s[n.columnKey].width=e),this.$nextTick((function(){a.$emit("table-column-resize",a.realFilterColumns),a.resize()}))},rowDblClickHandler:function(e,t,n){var i=n.currentTarget,a=$(i).find("td:last div[ctrl_type='dsf.buttonbar']");if(a.length>0){var r=a.get(0).__vue__,s=_.filter(r.buttons,(function(e){return e.isDblClick}));s.length>0&&r.triggerButtonClick(s[0])}},tableSort:function(e){this.$emit("sort-change",e)},getRowButtons:function(e){return dsf.mix(!0,[],e||[])},clearSelection:function(){var e;null===(e=this.elTable)||void 0===e||e.clearSelection()},toggleRowSelection:function(e,t){var n,i=this;null===(n=this.elTable)||void 0===n||n.toggleRowSelection(e,t),this.$nextTick((function(){var t;i.handleSelection(null===(t=i.elTable)||void 0===t?void 0:t.selection,e)}))},toggleAllSelection:function(){var e;null===(e=this.elTable)||void 0===e||e.toggleAllSelection()},getColumnSort:function(e){if(this.customerOrder){var t=_.filter(this.customerOrder,(function(t){if(e.columnId==t.column)return!0}));if(t.length>0)return!0}return!1},handleSelectionChange:function(e){this.isSingleChecked?(e.length>1&&this.clearSelection(),this.multipleSelection&&this.toggleRowSelection(this.multipleSelection,!0)):this.multipleSelection=e},getIndexWidth:function(){if(this.indexColumn.show){if(this.elTable){var e=null,t=1;return this.checkboxColumn.show||(t=0),e=this.elTable.columns[t],e.width}return this.indexColumnWidth}return 0},getCheckColumnWidth:function(){if(this.checkboxColumn.show){if(this.elTable){var e=this.elTable.columns[0];return e.width}return this.checkboxColumn.width}return 0},headerReset:function(){this.$list.$emit("update:columns",this.columnsBak),this.headerReload()},headerReload:function(){var e=this;this.updateHeader=!this.updateHeader,this.$nextTick((function(){e.updateHeader=!e.updateHeader,e.resize()}))},getContentWidth:function(e){var t=this.getIndexWidth(),n=this.getCheckColumnWidth(),i=this.operateColumn.show?this.operateColumn.width:0,a=e-t-n-i;return a},percentageToPx:function(e,t,n){var i=e;if("string"==dsf.type(i)&&i&&i.endsWith("%")){var a=parseFloat(i.replace("%",""))/100,r=n?this.getContentWidth(t):t;i=parseFloat(r)*a}return i},pxTopercentage:function(e,t){return e/t*100+"%"},isPercentage:function(e){var t=_.find(this.lastColumns,(function(t){return t.columnId==e.columnKey}));return!(!t||!t.designWidth.endsWith("%"))},resetTableWidth:function(){var e=this.elTable.$el.querySelector(".el-table__body-wrapper");this.tableWidth=e.offsetWidth,this.tableClientWidth=e.clientWidth},getColumns:function(){var e=[];return this.$list.isTreeTable&&(dsf.deepForEach(this.columns,(function(t){t.isLast&&e.push(t)})),e.length>0&&(e[0].columnType="extend")),this.columns},editHeader:function(e,t,n){var i=n._self,a=n.column;$(i.$el).find(".el-table__fixed th.".concat(a.id," .dsf-div-editor,.el-table__fixed-right th.").concat(a.id," .dsf-div-editor")).html(e),this.$refs.table.doLayout()},editHeaderBlur:function(e,t){var n=e.value;this.$set(t,"label",n)}},watch:{"$system.setting.fontSize":{handler:function(e,t){var n=["bigFont_1","bigFont_2","bigFont_3"];n.indexOf(e)>=0?this.indexWidthCoefficient=1.33333:this.indexWidthCoefficient=1},immediate:!0},"elTable.bodyWidth":{handler:function(e,t){this.elTable&&this.resetTableWidth()},immediate:!0},filterColumns:{handler:function(){this.resize()},deep:!0}}},S=w,k=Object(y["a"])(S,d,h,!1,null,null,null),T=k.exports,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ds-control dsf-static-list-by-card"},[e.checkbox&&e.showCheckAll&&1!==e.maxCheckNum?n("el-checkbox",{staticClass:"ds-platform-card-box-checkAll",class:[e.checkboxSize],attrs:{value:e.checkAll,indeterminate:e.isIndeterminate},on:{change:function(t){return e.handleCheckAllChange(t)}},nativeOn:{click:function(e){e.stopPropagation()}}},[e._v(" 全选 ")]):e._e(),e.isDesign?n("div",{staticClass:"ds-platform-card-list",class:[e.checkboxPosition]},[e._l(e.realData,(function(t,i){return[n("div",{directives:[{name:"context-menu",rawName:"v-context-menu",value:{params:{row:t,index:i},data:e.treeMenu},expression:"{params: {row, index: $index}, data: treeMenu }"}],key:t[e.rowKey],staticClass:"ds-platform-card-item",class:e.getItemClass(i),style:e.itemStyle},[n("div",{staticClass:"ds-platform-card-item-content"},[e._t("default",null,null,{row:t,$index:i})],2),e.checkbox&&e.checkboxStyle?n("dsf-custom-checkbox",{staticClass:"ds-platform-card-item-checkbox",attrs:{value:e.checkIdList.indexOf(t[e.rowKey])>-1,"style-type":e.checkboxStyle,size:e.checkboxSize},on:{input:function(n){return e.checkChange(t,n)}}}):e._e()],1)]})),n("div",{staticClass:"ds-platform-card-item dsf-static-list-by-card-add",class:e.getItemClass(e.realData.length),style:e.itemStyle,attrs:{title:"新增"},on:{click:e.addRow}},[n("i",{staticClass:"iconfont icon-add"})])],2):n("div",{staticClass:"ds-platform-card-list",class:[e.checkboxPosition]},[e._l(e.realData,(function(t,i){return[n("div",{key:t[e.rowKey],staticClass:"ds-platform-card-item",class:e.getItemClass(i),style:e.itemStyle},[n("div",{staticClass:"ds-platform-card-item-content"},[e._t("default",null,null,{row:t,$index:i})],2),e.checkbox&&e.checkboxStyle?n("dsf-custom-checkbox",{staticClass:"ds-platform-card-item-checkbox",attrs:{value:e.checkIdList.indexOf(t[e.rowKey])>-1,"style-type":e.checkboxStyle,size:e.checkboxSize},on:{input:function(n){return e.checkChange(t,n)}}}):e._e()],1)]}))],2)],1)},L=[],I=n(3),B=n.n(I),M={name:"DsfStaticListByCard",mixins:[$mixins.layout],props:{isDesign:{type:Boolean,default:!1},checkboxSize:{type:String,default:"medium"},checkboxPosition:{type:String,default:"top right"},rowKey:{type:[String,Function],default:"_id"},data:{type:Array,default:function(){return[]}},horizontal:{type:Boolean,default:!1},columnNumber:{type:Number,default:3},columnWidth:{type:String,default:"30%"},lineHeight:{type:String,default:"120px"},marginTop:{type:String,default:"15px"},marginLeft:{type:String,default:"15px"},checkbox:{type:Boolean,default:!1},checkboxStyle:{type:String,default:"style1"},maxCheckNum:{type:Number,default:0},showCheckAll:{type:Boolean,default:!0},selectable:{type:[Array,Function],required:!1}},data:function(){return{dataCopy:[],checkIdList:[],checkDataList:[],treeMenu:[{icon:"icon-kuaisubianpai",name:"插入",handler:this.insertRow},{icon:"icon-shanchu",name:"删除",handler:this.removeRow}]}},computed:{cWidth:function(){return this.$isMobile?this.pxToRem(this.columnWidth):this.columnWidth},lHeight:function(){return this.$isMobile?this.pxToRem(this.lineHeight):this.lineHeight},mTop:function(){return this.$isMobile?this.pxToRem(this.marginTop):this.marginTop},listStyle:function(){var e=this;if(!this.horizontal)return{};var t=_.map(this.padding,(function(t){return e.pxToRem(t)})),n="".concat(this.columnNumber," * ").concat(this.lHeight," + ").concat(this.columnNumber-1," * ").concat(this.mTop);return{height:"calc(".concat(n,")"),"padding-left":t[3],"padding-right":t[1]}},itemStyle:function(){var e=this.marginLeft;this.$isMobile&&(e=this.pxToRem(e)),this.horizontal||(e="calc((100% - ".concat(this.cWidth," * ").concat(this.columnNumber,") / ").concat(this.columnNumber-1,")"));var t={width:this.cWidth,"margin-Left":e,"margin-top":this.mTop};return this.horizontal&&(t["height"]=this.lHeight),t},realData:function(){return _.map(this.data,(function(e,t){return Object.assign({$hash:dsf.uuid(),$order:t,$index:t},e)}))},realMaxCheckNum:function(){return this.maxCheckNum?Math.min(this.maxCheckNum,this.realData.length):this.realData.length},checkAll:function(){var e=this.getCurrentCheckNum();return e&&e>=this.realMaxCheckNum},isIndeterminate:function(){var e=this.getCurrentCheckNum();return e>0&&e<this.realMaxCheckNum}},methods:{getItemClass:function(e){var t=this.columnNumber;return this.horizontal?{"no-margin-top":!(e%t),"no-margin-left":e<t}:{"no-margin-left":!(e%t),"no-margin-top":e<t}},getCurrentCheckNum:function(){var e=this,t=0;return _.forEach(this.realData,(function(n){var i=n[e.rowKey];e.checkIdList.indexOf(i)>-1&&t++})),t},selectableHandler:function(e,t){var n=e[this.rowKey];return dsf.isArray(this.selectable)?-1===this.selectable.indexOf(n):!dsf.isFunction(this.selectable)||this.selectable(e,t)},checkChange:function(e,t){var n=e[this.rowKey],i=this.checkIdList.indexOf(n),a=!this.selectableHandler(e,e.$index);a||(!t&&i>-1?(this.checkIdList.splice(i,1),this.checkDataList.splice(i,1),this.$emit("select",this.checkDataList,e)):t&&-1===i&&(1==this.maxCheckNum?(this.checkIdList=[n],this.checkDataList=[e],this.$emit("select",this.checkDataList,e)):this.maxCheckNum>1&&this.getCurrentCheckNum()>=this.maxCheckNum?dsf.layer.message("最多只能选择".concat(this.maxCheckNum,"条数据"),!1):(this.checkIdList.push(n),this.checkDataList.push(e),this.$emit("select",this.checkDataList,e))))},handleCheckAllChange:function(e,t){var n=this;if(e){for(var i,a,r=[],s=[],o=this.realMaxCheckNum-this.getCurrentCheckNum(),l=function(){var e=n.realData[u],t=e[n.rowKey],i=_.findIndex(n.realData,(function(e){return e[n.rowKey]===t}));if(-1===n.checkIdList.indexOf(t)&&n.selectableHandler(e,i)&&(r.push(t),s.push(e),o--,!o))return 1},u=0,c=this.realData.length;u<c;u++)if(l())break;(i=this.checkIdList).push.apply(i,r),(a=this.checkDataList).push.apply(a,s)}else _.forEach(this.realData,(function(e,t){var i=e[n.rowKey],a=n.checkIdList.indexOf(i);a>-1&&n.selectableHandler(e,t)&&(n.checkIdList.splice(a,1),n.checkDataList.splice(a,1))}));t||this.$emit("select-all",this.checkDataList)},clearSelection:function(){this.checkIdList=[],this.checkDataList=[]},toggleRowSelection:function(e,t){this.checkChange(e,t)},toggleAllSelection:function(){this.handleCheckAllChange(!this.checkAll,!0)},addRow:function(){this.data.push(B()({},this.rowKey,dsf.uuid(8)))},insertRow:function(e){var t=e.params.index;this.data.splice(t+1,0,{_id:dsf.uuid(8)})},removeRow:function(e){var t=e.params.index;this.data.splice(t,1)},onPaste:function(e){}}},P=M,R=Object(y["a"])(P,D,L,!1,null,null,null),z=R.exports,H=n(464),W=n(414),O={render:function(e){var t;return null===(t=this.$scopedSlots)||void 0===t?void 0:t["default"]()}},N=dsf.component({name:"DsfStaticList",ctrlCaption:"静态列表",mixins:[$mixins.control,$mixins.list,$mixins.dataResult],components:{DsfStaticListByTable:T,DsfStaticListByCard:z,searchInput:H["a"],wrapContent:O},props:{staticValue:{type:Array,default:function(){return[{_id:dsf.uuid(8)}]}},label:{type:String,default:"静态列表"},searchPlaceholder:{type:String,default:"请输入检索关键字"},fit:{type:Boolean,default:!0},renderButton:{type:Function,default:null},buttons:{type:Array,default:function(){return[]}},buttonsMaxNumber:{type:Number,default:4},buttonsMoreStyle:{type:String,default:""},buttonsMoreText:{type:String,default:"更多"},buttonBarPosition:{type:String,default:"head"},buttonBarPositionMode:{type:String,default:"normal"},showHead:{type:Boolean,default:!0},showTitle:{type:Boolean,default:!0},showSearch:{type:Boolean,default:!0},checkboxColumn:{type:Object,default:function(){return{show:!0,width:dsf.config.component.DsfDataGrid.width}}},isSingleChecked:{type:Boolean,default:!1},superSearchInfo:{type:Array,default:function(){return[]}},superSearchRowBorder:{type:Boolean,default:!0},superSearchDefaultRowsNumber:{type:Number,default:2},customerOrder:{type:Array,default:function(){return[]}},showPagination:{type:Boolean,default:!0},paginationPosition:{type:String,default:"right"},paginationStyle:{type:String,default:"style1"},limits:{type:Array,default:function(){return[15,20,30,40,50,100]}},pagerLayout:{type:String,default:"total,prev,pager,next,jumper,sizes"},scrollPageSize:{type:Number,default:15},layoutInfo:{type:Array,default:function(){return[{id:"default",name:"表格",icon:"icon-biaodanzujian-biaoge",type:"table",typeName:"表格",backgroundColor:"#fff"}]}},rowButtons:{type:Array,default:function(){return[]}},renderRowButton:{type:Function,default:null},rowButtonsMaxNumber:{type:Number,default:4},rowButtonsMoreStyle:{type:String,default:"icon-text"},rowButtonsMoreText:{type:String,default:"更多"},indexColumn:{type:Object,default:function(){return{show:!0,width:60}}},operateColumn:{type:Object,default:function(){return{show:!0,width:100}}},columns:{type:Array,default:function(){return[]}},cardListColumnNumber:{type:Number,default:3},cardListColumnWidth:{type:String,default:"30%"},cardListMarginTop:{type:String,default:"15px"},cardListCheckboxStyle:{type:String,default:"style1"},cardListCheckboxSize:{type:String,default:"medium"},cardListCheckboxPosition:{type:String,default:"top right"},showSuperSearchFilter:{type:Boolean,default:!1},pagerCount:{type:Number,default:5},pageSize:{type:Number,default:15},slots:{type:Array,default:function(){return[{name:"default",controls:[]}]}},contentWrapMargin:{type:String,default:"0px"},isTreeTable:{type:Boolean,default:!1},extendDefaultAll:{type:Boolean,default:!1},hideSuperSearch:{type:Boolean,default:!1}},data:function(){return{refreshTable:!1,currentPage:1,isReDrawHander:!1,searchStr:"",removeTable:!1,multipleSelectionCopy:[],superSearchHeight:0,superSearchExtend:!1,superValue:{},currentShowLayout:{},elTable:null,isEditable:!1}},computed:{treeProps:function(){return this.isTreeTable?{children:"children"}:{children:""}},pageCount:function(){return this.isDesign?1:this.staticValue.length},currentPageData:function(){var e=this.staticValue,t=this.pageSize,n=this.currentPage-1;n=n<0?0:n;var i=n*t;return e.slice(i,i+t)},$errors:function(){return this.$data._errors},dataIds:function(){return this.staticValue.map((function(e){var t=e._id;return t}))},multipleSelection:{get:function(){var e=this.multipleSelectionCopy;return this.isSingleChecked?e&&e.length&&e[0]||null:e||[]},set:function(e){this.isSingleChecked?"array"==dsf.type(e)?this.multipleSelectionCopy=e.length?[e[0]]:[]:this.multipleSelectionCopy=e?[e]:[]:this.multipleSelectionCopy=e||[]}},infiniteScrollDisabled:function(){return!this.hasInfiniteScroll||this.staticValue.length>=this.pageCount},layoutInfoCopy:function(){var e=this;return this.isDesign||this.layoutInfo.length<2?this.layoutInfo:this.layoutInfo.filter((function(t){return"table"!=t.type||!e.hasInfiniteScroll&&!t.hide}))},contentWrapHeight:function(){if(this.fit){var e=this.showPagination||this.isDesign?57:0,t=0;return"cardList"==this.currentShowLayout.type&&(this.customerOrder.length&&(t=41),e&&(e+=15)),"calc(100% - ".concat(this.tableMarginTop,"px - ").concat(e+t,"px - ").concat(this.contentWrapMargin,")")}return"auto"},tableMarginTop:function(){return this.superSearchHeight>0?this.superSearchHeight:0},tableHeight:function(){if(this.isDesign)return"100%";var e=this.fit;return e?"100%":null},panelHeight:function(){var e=this.fit;return this.isDesign||e?"100%":"auto"},getCss:function(){return[this.$getClass(),{fit:this.fit,"has-pagination":this.showPagination,"has-checkbox":this.checkboxColumn.show,"card-model":"cardList"==this.currentShowLayout.type}]},getListStyle:function(){return{height:this.panelHeight}},getPanelClass:function(){return{fit:this.fit}},checkedNumber:function(){return this.checkboxColumn.show?this.isSingleChecked?this.multipleSelection?1:0:this.multipleSelection.length:0},superSearchBar:function(){return this.$refs.superSearchBar},metadataDict:function(){var e,t=this,n=null===this||void 0===this||null===(e=this.$vm)||void 0===e?void 0:e.metadataDict;if(n){var i={};return _.each(n,(function(e,n){var a=t.childMetaDataCodes,r=_.findIndex(a,(function(t){return t==e.id}));r>=0&&(i[n]=e)})),i}return{}},searchWarpStyle:function(){var e={height:this.superSearchHeight+"px"};return"cardList"==this.currentShowLayout.type&&this.customerOrder.length&&(e["height"]=this.superSearchHeight+41+"px"),e}},created:function(){var e=this;this.checkboxColumn&&dsf.isUnDef(this.checkboxColumn.width)&&(this.checkboxColumn.width=dsf.config.component.DsfDataGrid.checkColumn.width),W["d"].call(this);var t=_.find(this.limits,(function(t){return t==e.pageSize}));t||this.$emit("update:pageSize",this.limits[0]),this.watchCurrentPageAndPageSize(),this.currentShowLayout=this.layoutInfo[0]},beforeMount:function(){},mounted:function(){this.elTable=this.getElTable()},updated:function(){this.doLayout()},beforeDestroy:function(){this.unwatch&&this.unwatch(),this.$refs.pagination&&this.$refs.pagination.$destroy(),this.staticValue.splice(0,this.staticValue.length)},destroyed:function(){},methods:{getElTable:function(){var e;return null===(e=this.$refs.table)||void 0===e?void 0:e[0]},watchCurrentPageAndPageSize:function(){var e=this;function t(){return this.currentPage+","+this.pageSize}this.hasInfiniteScroll||(this.unwatch=this.$watch(t,(function(t,n){var i=Math.ceil(e.pageCount/e.pageSize);e.currentPage>i&&(e.currentPage=i<=0?1:i)})))},getLastColumns:function(e){return W["g"].call(this,e)},reset:function(){this.clearSelect(),this.currentPage=1},indexMethod:function(e){return(this.currentPage-1)*this.pageSize+e+1},resize:function(){var e=this;return l()(c.a.mark((function t(){var n,i;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.superSearchBar&&e.superSearchBar.resize(),"default"!=e.currentShowLayout.id){t.next=4;break}return t.next=4,null===e||void 0===e||null===(n=e.elTable)||void 0===n||null===(i=n.resize)||void 0===i?void 0:i.call(n);case 4:case"end":return t.stop()}}),t)})))()},pageSizeChange:function(e){this.isSingleChecked&&(this.multipleSelection=null),this.$emit("update:pageSize",e)},doLayout:function(){var e=this.getElTable();e&&e.doLayout&&e.doLayout()},updateSubControls:function(e,t,n){return e},getSelectedRows:function(){return this.multipleSelection},getHeaderClass:function(e){e.row;var t=e.column,n=(e.rowIndex,e.columnIndex,[]);if(t.columnKey){var i=_.filter(this.customerOrder,(function(e){return e.column==t.columnKey}));if(i.length>0){var a=i[0];if(a.sortType){var r=a.sortType+"ending";t.order=r,n.push(r)}else t.order=null}}return n.join(" ")},getReturnValue:function(){return this.getSelectedRows()},headerReset:function(){this.$emit("update:tableFilterResult",[]),this.$clearCustom(this.caption),this.elTable.headerReset()},tableColumnResize:function(e){var t,n=this.tableFilterResult;if(null===(t=n)||void 0===t||!t.length){var i=this.$refs.table[0].columnsTree;n=Object(W["e"])(i)}Object(W["l"])(e,n),this.$addCustom(this.caption,{tableFilterResult:n})},getContentWrapStyle:function(e){var t={height:this.contentWrapHeight,"background-color":e.backgroundColor};return"cardList"==this.currentShowLayout.type&&(t["padding"]=this.fit?"20px 20px 0":"20px 0 0"),t},superSearchLoadedHandler:function(e){var t=this;this.isDesign||(this.superValue=e,this.currentPage=1,this.$nextTick((function(){t.superSearchBar&&t.superSearchBar.emitHeight()})))},superSearchChangeHeight:function(e){this.superSearchExtend||(this.superSearchHeight=e)},superSearchExtendHandler:function(e){this.superSearchExtend=e},$getChildMetadataList:function(){if(this.isDesign)return A},addRowByTable:function(){this.staticValue.push({_id:dsf.uuid(8)})},removeRowsByTable:function(){var e=this.getElTable(),t=e.$refs.table,n=t.selection;n.length?(_.forEach(n,(function(t){return e.removeRow(t)})),t.selection=[]):dsf.layer.message("请至少选择一条数据",!1)}},watch:{isTreeTable:{handler:function(e){var t=this;this.refreshTable=!0,this.$nextTick((function(){t.refreshTable=!1}))}},columns:{handler:function(e,t){var n=this;this.isDesign&&(this.isReDrawHander=!0,this.$nextTick((function(){n.isReDrawHander=!1})))},deep:!0},staticValue:{handler:function(e){var t=this;if(e&&0!=e.length){for(var n=0;n<e.length;n++)!("$editing"in e[n])&&this.$set(e[n],"$editing",!1),!("$hash"in e[n])&&this.$set(e[n],"$hash",dsf.uuid()),"$order"in e[n]?this.$set(e[n],"$order",n):e[n]["$order"]=n,e[n].$index=n;this.$nextTick((function(){t.resize()}))}else this.$emit("update:staticValue",[{_id:dsf.uuid(8)}])},deep:!1},tableMarginTop:function(){var e=this;this.$nextTick((function(){e.doLayout()}))},superSearchInfo:function(e){0==e.length&&(this.superSearchHeight=0)},"currentShowLayout.id":function(e,t){var n=this;e&&t&&this.$nextTick((function(){n.resize()}))}},design:{isMask:!1,fit:!0,settingMenus:function(){return[].concat(s()($mixins.list.design.settingMenus()||[]),[{text:"表头设置",command:"header-setting",handler:W["h"]}])}}}),A=[{key:"dsfa_rm.name",metadata:{name:"名称",at:"dsfa.rm",code:"name",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.ID",metadata:{name:"标识",at:"dsfa.rm",code:"ID",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.type",metadata:{name:"类型",at:"dsfa.rm",code:"type",valueAttributes:[{name:"文本",code:"text"},{name:"值",code:"value"}]}},{key:"dsfa_rm.code",metadata:{name:"标识",at:"dsfa.rm",code:"code",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.path",metadata:{name:"标识",at:"dsfa.rm",code:"path",valueAttributes:[{name:"文本",code:"text"}]}},{key:"dsfa_rm.treeinfo",metadata:{name:"树信息",at:"dsfa.rm",code:"treeinfo",valueAttributes:[{name:"tree节点类型",code:"type"},{name:"tree节点父标识",code:"pid"},{name:"tree节点图标",code:"icon"},{name:"tree全局标识",code:"globalid"},{name:"tree节点等级",code:"level"}]}},{key:"dsfa_rm.ds_update_user_name",metadata:{name:"修改人",at:"dsfa.rm",code:"ds_update_user_name",valueAttributes:[{name:"修改人姓名",code:"ds_update_user_name"}]}},{key:"dsfa_rm.ds_update_time",metadata:{name:"修改时间",at:"dsfa.rm",code:"ds_update_time",valueAttributes:[{name:"修改时间",code:"ds_update_time"}]}},{key:"dsfa_rm.ds_order",metadata:{name:"排序码",at:"dsfa.rm",code:"ds_order",valueAttributes:[{name:"排序码",code:"ds_order"}]}}],E=N,F=Object(y["a"])(E,i,a,!1,null,null,null);t["default"]=F.exports}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_pc_prototype.js.map