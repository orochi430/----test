/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[0],{985:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("iframe",{ref:"iframe",style:{width:"100%",height:"100%","border-style":"none",display:"block"},attrs:{src:t.iframeSrc},on:{load:t.loaded}})},n=[],s={name:"IframeLoader",props:{src:{type:String,default:""}},data:function(){return this.mutationObserver=null,{isMobile:dsf.global.$isMobile,iframeSrc:""}},computed:{$src:function(){return this.src}},methods:{getSrc:function(){var t=this.src,e=dsf.url.parse(t),i=_.find(dsf.config.setting_public_whitelist||[],(function(t){if(v.startsWith("http")||v.startsWith("https"))return e.hostname==t}));if(!i)return this.$message("加载非法资源",!1),"";if(this.$refs.iframe){var r=this.$refs.iframe;"replace"==this.$router.params.state?r.contentWindow.replace(v):r.contentWindow.location.href=v}},loaded:function(){if(this.isAyncToMainTitle()){var t=this.$refs.iframe;try{var e=t.contentWindow;this.mutationObserver=new e.MutationObserver(this.changeTitle);var i=e.document,r=i.querySelector("head>title");r.innerText&&(window.document.title=r.innerText),this.mutationObserver.observe(r,{childList:!0,subtree:!0})}catch(n){}}},changeTitle:function(t,e){if(this.isAyncToMainTitle()&&null!==t&&void 0!==t&&t[0]){var i=t[0].target;i.innerText&&(window.document.title=i.innerText)}},isAyncToMainTitle:function(){var t=dsf.config.documentTitle.PC.iframeLoaderAsync;if(t){var e=dsf.config.documentTitle.PC.mode,i=dsf.config.setting_public_default_page_title;if("system"==e&&!i)return!0;if("router"==e)return!0}return!1}},beforeDestroy:function(){try{this.mutationObserver.disconnect()}catch(t){}},watch:{$src:{handler:function(t,e){var i=(this.src||"").trim();if(i=dsf.safe.url(i),i){if(this.iframeSrc=this.src,this.$refs.iframe){var r,n=this.$refs.iframe;"replace"==(null===this||void 0===this||null===(r=this.$router)||void 0===r||null===(r=r.params)||void 0===r?void 0:r.state)?n.contentWindow.replace(this.iframeSrc):n.contentWindow.location.href=this.iframeSrc}}else dsf.error("非安全路径拒绝加载")},immediate:!0}}},a=s,o=i(0),f=Object(o["a"])(a,r,n,!1,null,null,null);e["default"]=f.exports}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_pc_router_iframe.js.map