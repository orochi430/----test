/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[67],{1255:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.loaded,expression:"loaded"}],staticClass:"ds-super-search",class:{"is-click":e.isClickExtend,"row-split-boder":e.superSearchRowBorder,"ds-super-search__extend":e.isExtend,float:e.float&&!e.isDesign}},[e.float&&!e.isDesign?i("div",{staticClass:"ds-super-search-static",style:{height:e.unitSize(e.staticHeight)}}):e._e(),i("div",{staticClass:"ds-super-search-real-box"},[e.showFitler?i("div",{staticClass:"el-row ds-super-search-fitler"},[i("div",{staticClass:"ds-super-search-item el-col-24 filter-bar"},[i("label",{staticClass:"ds-super-search-item-text",style:{width:e.unitSize(e.titleMaxWidth)}},[e._v("筛选:")]),0===e.getFilterBar().length?i("p",{staticClass:"ds-super-search-tips"},[e._v(" "+e._s(e.searchTips)+" ")]):e._e(),i("div",{staticClass:"ds-super-search-item-block"},e._l(e.getFilterBar(),(function(t){return i("DsfSuperSearchFilter",{key:t.id,staticClass:"ds-super-search-filter-item",attrs:{item:t},on:{change:function(i){return e.valueChange(i,t)},remove:function(t){return e.removeFilter(t)}}})})),1)])]):e._e(),i("div",{staticClass:"ds-super-search-main"},[i("div",{staticClass:"ds-super-search-main-left",style:e.searchAreaHeight},[i("dsf-virtual-scroll",[[i("div",{staticClass:"el-row where-row"},[e._l(e.layout,(function(t){return["buttons"!=t.type?i("DsfSuperSearchItem",{directives:[{name:"show",rawName:"v-show",value:e.isExtend||t.rowIndex<=e.initRowsNumber-1,expression:"isExtend || cell.rowIndex <= initRowsNumber - 1"}],key:t.id,class:["seach-item","el-col-"+t.layout,"tile"==t.showModel||"treeTile"==t.showModel?"tile":""],attrs:{"item-key":t.id,item:t,span:t.layout,"row-index":t.rowIndex,titleMaxWidth:e.titleMaxWidth},on:{focus:e.filterAllClose,change:function(i){return e.valueChange(i,t)}}}):e._e()]})),e.valueChangeTrigger?e._e():[e.isExtend?[i("div",{key:"button",class:["el-col-"+e.extendButtonLayout,"search-button-bar",24==e.extendButtonLayout?"align-center":"align-right"],attrs:{span:e.extendButtonLayout}},[i("DsfButton",{attrs:{size:"small"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.triggerSearch.apply(null,arguments)}}},[e._v("查询")]),i("DsfButton",{attrs:{size:"small",type:"plain"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.reset.apply(null,arguments)}}},[e._v("重置")]),e.hasExtend?i("a",{staticClass:"link-extend",staticStyle:{"margin-left":"10px"},attrs:{href:"javascript:void(0)"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.extendHandler.apply(null,arguments)}}},[e._v(" 收起 "),i("DsfIcon",{attrs:{name:"arrow-up"}})],1):e._e()],1)]:["buttons"==e.buttonCell.type?i("div",{key:"button",class:["el-col-"+e.buttonCell.layout,"seach-item","search-button-bar","align-right"],attrs:{span:e.buttonCell.layout}},[i("DsfButton",{attrs:{size:"small"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.triggerSearch.apply(null,arguments)}}},[e._v("查询")]),i("DsfButton",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"plain"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.reset.apply(null,arguments)}}},[e._v("重置")]),e.hasExtend?i("a",{staticClass:"link-extend",staticStyle:{"margin-left":"10px"},attrs:{href:"javascript:void(0)"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.extendHandler.apply(null,arguments)}}},[e._v(" 展开 "),i("DsfIcon",{attrs:{name:"arrow-up"}})],1):e._e()],1):e._e()]]],2)]],2)],1),e.showExtendButton&&!e.extendInBottom?i("div",{staticClass:"ds-super-search-main-right"},[i("a",{staticClass:"link-extend",attrs:{href:"javascript:void(0)"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.extendHandler.apply(null,arguments)}}},[e._v(" "+e._s(e.isExtend?"收起":"展开")+" "),i("DsfIcon",{attrs:{name:"arrow-up"}})],1)]):e._e()]),e.showExtendButton&&e.extendInBottom?i("div",{ref:"spanExtend",staticClass:"ds-super-search-extend"},[i("a",{staticClass:"link-extend",attrs:{href:"javascript:void(0)"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.extendHandler.apply(null,arguments)}}},[e._v(" "+e._s(e.isExtend?"收起筛选条件":"展开筛选条件")+" "),i("DsfIcon",{attrs:{name:"arrow-up"}})],1)]):e._e()])])},n=[],a=i(3),r=i.n(a),l=i(4),o=i.n(l),u=i(1),c=i.n(u);function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){r()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var f={name:"DsfSuperSearch",inheritAttrs:!1,components:{},inject:{$vm:{default:null}},provide:function(){return{$superSearch:this}},props:{isDesign:{type:Boolean,default:!1},valueChangeTrigger:{type:Boolean,default:!0},buttonBarPositionMode:{type:String,default:function(){return"normal"}},owner:{type:Object,default:function(){return null}},firstHasButton:{type:Boolean,default:!1},searchItemSetting:{type:Array,default:function(){return[]}},searchHeight:{type:Number,default:0},defaultRowsNumber:{type:Number,default:2},showFitler:{type:Boolean,default:!1},superSearchRowBorder:{type:Boolean,default:!0},queryValue:{type:Object,default:function(){return{}}},float:{type:Boolean,default:!1},maxHeight:{type:String,default:"600"},titleMaxWidth:{type:String,default:""},extendButtonPosition:{type:String,default:"bottom"},searchBeforeHandler:{type:[Object,Function],required:!1},needGetSearchTemplate:{type:Boolean,default:!1}},data:function(){return{isExtend:!1,searchItems:[],optionsMap:{},totalRowsNumber:0,layout:[],loaded:!1,isFirstLoad:!1,rowHeight:45,defaultHeight:0,value:this.queryValue||{},config:dsf.mix(!0,{},dsf.config.component.superSearch),initRowsNumber:this.defaultRowsNumber,onChangeEvent:!1,staticHeight:0,realHeight:0,mainHeight:0,extendButtonLayout:24,buttonCell:{type:"buttons",layout:0},isClickExtend:!1,searchTips:""}},computed:{searchAreaHeight:function(){var e={height:this.unitSize(this.mainHeight),overflow:this.isExtend?"visible":"hidden"};return this.maxHeight&&(e.maxHeight=this.unitSize(this.maxHeight)),e},hasExtend:function(){return this.totalRowsNumber>this.initRowsNumber},showExtendButton:function(){return this.hasExtend&&this.valueChangeTrigger},extendInBottom:function(){return"bottom"==this.extendButtonPosition}},watch:{searchItemSetting:{handler:function(e){var t=this;return o()(c.a.mark((function e(){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.updateSearchItemSetting();case 2:t.resize();case 3:case"end":return e.stop()}}),e)})))()},immediate:!0},showFitler:{handler:function(e){var t=this;this.$nextTick((function(){t.resize()}))}},searchItems:{handler:function(e){var t=this;this.isDesign&&(this.setLayout(),this.$nextTick((function(){t.resize()})))}}},created:function(){this.searchTips=dsf.storage.local.get("searchTips")||"",document.addEventListener("click",this.documentClick),this.unlayoutWatch=this.$watch((function(){return this.defaultRowsNumber+"-"+this.valueChangeTrigger}),{handler:function(e){var t=this;this.initRowsNumber=this.defaultRowsNumber,this.setLayout(),this.$nextTick((function(){t.resize()}))}})},mounted:function(){},beforeDestroy:function(){document.removeEventListener("click",this.documentClick),this.unlayoutWatch&&this.unlayoutWatch()},methods:{documentClick:function(){this.filterAllClose()},getFilterBar:function(){var e=[];return _.each(this.searchItems,(function(t){var i=t.values?t.values:null;if(!dsf.isUnDef(i)){var s="array"==dsf.type(i)?i:[i];s=_.filter(s,(function(e){return e})),s.length>0&&e.push(t)}})),e},removeFilter:function(e){var t=e.type,i=e.operator;"enum"==t?(e.values=[],e.customerBetween=[],e.treeNodeSelected=[]):"datetime"==t||"number"==t?e.values="between"==i?[]:"":("text"==t||"period"==t)&&(e.values=""),this.postSearch(!0)},filterAllClose:function(e){_.each(this.searchItems,(function(t){t!==e&&(t.isFilterExtend=!1)}))},filterClose:function(e){e.isFilterExtend=!1,e.multiple=!1},triggerSearch:function(){var e=this;this.postSearch(!0),this.$nextTick((function(){e.closeOrOpen(!1)}))},reset:function(e){try{_.each(this.layout,(function(e){e.values=e._defaultValue||null}))}catch(t){dsf.error(t)}this.postSearch(!0)},getDefaultTemplate:function(){var e=this;return o()(c.a.mark((function t(){return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){e.needGetSearchTemplate?e.$http.get("list/condition/template/getDefaultTemplate",{namespace:e.$vm.nameSpace,pageName:e.$vm.pageName}).done((function(e){var s,n=e.success,a=e.data;n?a&&a.content?t(JSON.parse((null===(s=JSON.parse(a.content))||void 0===s?void 0:s.query)||{})):t({}):i()})).error((function(){i()})):t({})})));case 1:case"end":return t.stop()}}),t)})))()},updateSearchItemSetting:function(){var e=this;return o()(c.a.mark((function t(){var i,s;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.searchItems=_.map(e.searchItemSetting,(function(e){var t=!1,i=!1,s=!1;return"tile"!=e.model&&"treeTile"!=e.model||(!1===e.isTileCollapse&&(t=!0),e.isTileForceMulti&&(s=!0)),{id:e.id,field:e.field,label:e.fieldCaption,valueSource:e.setting,operator:e.operator,type:e.searchType,optionKey:e.id||"",options:[],treeNodeSelected:[],defaultValue:e.defaultValue,values:null,showModel:e.model,isExtend:t,isMore:i,multiple:s,isAllowMultipe:"enum"!==e.searchType||-1===["between","eq"].indexOf(e.operator),layout:e.layout||24,customerBetween:[],isFilterExtend:!1,fields:_.filter(e.children,(function(e){return 1==e.join})),isLineBreak:e.isLineBreak||!1,childField:e.childField||null,autoHide:e.autoHide||!1,placeholder:e.placeholder||"",showTileAll:!dsf.isDef(e.showTileAll)||e.showTileAll,isTileCollapse:!dsf.isDef(e.isTileCollapse)||e.isTileCollapse,isTileForceMulti:!!dsf.isDef(e.isTileForceMulti)&&e.isTileForceMulti,isClearable:!1!==e.isClearable}})),i=null,t.prev=2,t.next=5,e.getDefaultTemplate();case 5:i=t.sent,t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](2);case 10:return dsf.isUnDef(i)?i={}:i&&(s=i.searchValue,s&&e.owner.uploadSearchInputVal(s)),t.next=13,e.updateData();case 13:e.optionsMap=t.sent,_.each(e.searchItems,(function(t,s){e.optionsMap[t.id]&&(t.options=e.optionsMap[t.id]);var n=null;if(dsf.isDef(t.defaultValue)&&""!=t.defaultValue&&!e.isDesign){var a=e.$expressParams(null,{item:t});try{n=e.owner.$eval(t.defaultValue,a)}catch(r){dsf.error(r),dsf.layer.message("默认值表达式【"+t.defaultValue+"】计算错误，请使用正确的js语法",!1)}}dsf.isFunction(n)&&(n=n.call(e.$vm,t)),"enum"==t.type?(n=dsf.isDef(n)?"array"!=dsf.type(n)?[n]:n:[],"dataChoice"!=t.model&&(n=_.map(n,(function(e){return e+""})))):"datetime"==t.type?"between"==t.operator&&(dsf.isDef(n)?dsf.isString(n)?n=[n,n]:dsf.isArray(n)||(n=[]):n=[]):n=dsf.isDef(n)?n+"":"",t._defaultValue=n,dsf.isUnDef(t.values)&&(t.values=n),t.field in i&&(t.values=i[t.field])})),e.setLayout(),e.loaded=!0,e.$nextTick((function(){e.isFirstLoad||(e.isFirstLoad=!0,e.resize(),e.$nextTick((function(){e.searchBefore("loaded")})))}));case 18:case"end":return t.stop()}}),t,null,[[2,8]])})))()},updateData:function(){var e=this;return o()(c.a.mark((function t(){var i,s,n,a,r,l,o,u,h,f,p,m;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.owner.isDesign){t.next=2;break}return t.abrupt("return",{});case 2:i={},s=[],n=[],a=0;case 6:if(!(a<e.searchItems.length)){t.next=16;break}if(l=e.searchItems[a],o=(null===(r=e.owner)||void 0===r?void 0:r.queryString)||{},"enum"===l.type){t.next=11;break}return t.abrupt("continue",13);case 11:u=l.valueSource||{},h=u.type,f=u.value,"dict"==h?(p={key:l.id,type:"dict",dictId:f.key},n.push(p)):"dbsource"==h?s.push({id:l.id,type:"dbsource",params:d({},o),path:f.key.replace(/\./g,"/")}):"interface"==h?s.push({id:l.id,type:"interface",params:d({},o),path:e.$replace(f)}):i[l.id]=f||[];case 13:a++,t.next=6;break;case 16:return n.length>0&&s.unshift({id:"dicts",path:"",type:"dicts",params:{dicts:n}}),t.prev=17,t.next=20,e.loopOptionsHttps(s);case 20:return m=t.sent,t.abrupt("return",dsf.mix(i,m,{}));case 24:t.prev=24,t.t0=t["catch"](17),dsf.layer.pc.message("查询检索选项出现错误,页面无法创建",!1);case 27:case"end":return t.stop()}}),t,null,[[17,24]])})))()},loopOptionsHttps:function(e){var t={},i=[],s=this;_.each(e,(function(e){"dict"!=e.type?dsf.array.ensure(i,e,(function(t){if(t.type==e.type&&t.path==e.path&&dsf.isEqualObject(t.params,e.params))return t.id&&!dsf.isArray(t.id)&&(t.id=[t.id]),t.id.push(e.id),!0})):i.push(e)}));var n=new Promise((function(e,n){var a=[];_.forEach(i,(function(e){var t=e,i=null;"dicts"==t.type?i=s.$webAPI.getBatchDict(t.params,!0):"dbsource"==t.type?i=s.$webAPI.dbSourceInterface(t.params,t.path,!0):"interface"==t.type&&(i=s.$http.get(t.path,t.params,!0)),a.push(i)})),Promise.all(a).then((function(s){_.forEach(s,(function(e,s){var n=e.data,a=i[s];if("dicts"==a.type)for(var r in n.data)t[r]=n.data[r];else{var l=dsf.isArray(a.id)?a.id:[a.id];_.each(l,(function(e){t[e]=dsf.mix(!0,[],n.data)}))}})),e(t)})).catch((function(){n()}))}));return n},getTotalRowsNumber:function(){var e=this,t=0,i=0;_.each(this.searchItemSetting,(function(s,n){t+=~~s.layout,s.isLineBreak&&n<e.searchItemSetting.length-2&&i++}));var s=Math.ceil(t/24);return s+i},collapseItems:function(e){_.each(this.searchItems,(function(t){e!==t&&(t.multiple=!1)}))},setLayout:function(){var e=this,t=0,i=parseInt(this.defaultRowsNumber);this.totalRowsNumber=0,this.initRowsNumber=i;var s=i,n=24,a=0,r=[],l=[];_.each(this.searchItems,(function(e){e.layout=~~e.layout,a+=e.layout}));var o=Math.ceil(a/n);o<=i&&(s=o),a=0;for(var u=0;u<this.searchItems.length;u++){var c=this.searchItems[u];a+c.layout>n?(a=c.layout,t++):a+=c.layout,l[t]||(l[t]=[]),l[t].push(c)}a=0;var h=l[l.length-1];a=_.sum(_.map(h,"layout")),this.extendButtonLayout=a>=n?24:n-a;for(var d=[],f=0;f<s;f++){var p=l[f],m=_.map(p,"layout"),v=_.sum(m);d[f]=v>=n?0:1}var y=!1,g=_.findIndex(d,(function(e){return 1==e}))>=0;if((this.initRowsNumber<=s||g)&&(y=!0),y){for(var w,b=function(){var t=l[x],i=0;return _.each(t,(function(e){i+=e.layout})),i<n?(e.buttonCell.layout=n-i,t.push(e.buttonCell),0):i==n&&x>=s-1?(t.length>1?(e.buttonCell.layout=t[t.length-1].layout,t.splice(t.length-1,0,e.buttonCell)):(e.buttonCell.layout=n,l.splice(x+1,0,[e.buttonCell])),0):void 0},x=0;x<s;x++)if(w=b(),0===w)break}else this.buttonCell.layout=24,l.push([this.buttonCell]);r=_.flatMap(l),a=0,t=0;for(var C=[],S=0;S<r.length;S++){var $=r[S];this.valueChangeTrigger&&"buttons"==$.type||(a+$.layout>n?(t++,a=$.layout):a+=$.layout,$.rowIndex=t,C.push($))}this.totalRowsNumber=t+1,this.totalRowsNumber<this.defaultRowsNumber?this.initRowsNumber=this.totalRowsNumber:this.initRowsNumber=this.defaultRowsNumber,this.layout=C},valueChange:function(e,t){var i=this.searchBeforeHandler,s=this.layout,n=this.postSearch,a=null===i||void 0===i?void 0:i[t.id];if(dsf.isFunction(a)){var r=_.keyBy(s,"id"),l=!1;a(t,r,(function(e){l||!1===e||(l=!0,n())}))}else n()},emitValue:function(){var e={};for(var t in _.each(this.searchItems,(function(t){if("datetime"==t.type){var i="ymds"===t.showModel?"yyyy-mm-dd hh:ii:ss":"yyyy-mm-dd",s="yyyy";if("between"==t.operator){var n="array"==dsf.type(t.values)?t.values:[t.values];n=_.filter(n,(function(e){return e})),e[t.field]=_.map(n,(function(e,s){if("ym"==t.showModel){if(1==s){var n=e.getMonth()+1,a=e.getFullYear(),r=new Date(a,n,0);return dsf.date.format(r,i)}}else if("y"==t.showModel&&1==s){var l=e.getFullYear(),o=new Date(l,12,0);return dsf.date.format(o,i)}return dsf.date.format(e,i)}))}else if("gt"==t.operator||"lteq"==t.operator){var a="array"==dsf.type(t.values)?t.values[0]:t.values;if("ym"==t.showModel)if(a){var r=a.getMonth()+1,l=a.getFullYear(),o=new Date(l,r,0);e[t.field]=a?dsf.date.format(o,i):""}else e[t.field]="";else if("y"==t.showModel)if(a){var u=a.getFullYear(),c=new Date(u,12,0);e[t.field]=dsf.date.format(c,i)}else e[t.field]="";else e[t.field]=a?dsf.date.format(a,i):""}else if("gteq"==t.operator||"lt"==t.operator)if("ym"==t.showModel)if(t.values){var h=t.values.getMonth(),d=t.values.getFullYear(),f=new Date(d,h,1);e[t.field]=t.values?dsf.date.format(f,i):""}else e[t.field]="";else if("y"==t.showModel)if(t.values){var p=t.values.getFullYear(),m=new Date(p,0,1);e[t.field]=dsf.date.format(m,i)}else e[t.field]="";else e[t.field]=t.values?dsf.date.format(t.values,i):"";else if("eq"==t.operator){var v="array"==dsf.type(t.values)?t.values[0]:t.values;if("ym"==t.showModel)if(v){var y=v.getMonth()+1,g=v.getFullYear(),w=new Date(g,y,0);e[t.field]=v?dsf.date.format(w,i):""}else e[t.field]="";else"y"==t.showModel?e[t.field]=v?dsf.date.format(v,s):"":e[t.field]=v?dsf.date.format(v,i):""}}else if("number"==t.type)"between"==t.operator&&t.values&&t.values[0]==dsf.enums.numberBoundary.MIN&&t.values[1]==dsf.enums.numberBoundary.MAX?e[t.field]=null:e[t.field]=t.values;else if("enum"==t.type){var b=t.values;if("dataChoice"==t.showModel&&(b=_.map(b,"value")||[]),"between"==t.operator)if(t.customerBetween.length>0&&t.customerBetween[0]&&t.customerBetween[1])e[t.field]=t.customerBetween;else{var x=b[0]?b[0].split(";"):"";2==x.length?e[t.field]=x:1==x.length?e[t.field]=[x[0],x[0]]:e[t.field]=[]}else if("like"==t.operator||"slike"==t.operator||"elike"==t.operator){var C="array"==dsf.type(b)?b:[b];e[t.field]=C.join(" ")}else{var S="array"==dsf.type(b)?b:[b],$=_.filter(S,(function(e){return dsf.isDef(e)&&""!==e}));e[t.field]=$}}else if("text"==t.type){var k="";k="between"==t.operator?(t.values||[]).join(""):t.values,e[t.field]=k?t.values:""}else e[t.field]=t.values})),e)dsf.isEmptyObject(e[t])&&delete e[t];return e},postSearch:function(e){var t=this,i=function(){t.$nextTick((function(){t.searchBefore("change")}))};(e||this.valueChangeTrigger)&&i()},getValue:function(){return this.emitValue()},emitHeight:function(){var e=this,t=$(this.$el);if(t.length){var i=t.find(".ds-super-search-fitler"),s=t.find(".ds-super-search-extend"),n=t.find(".ds-super-search-main"),a=n.find(".where-row"),r=0,l=0;if(this.staticHeight=0,this.realHeight=0,this.mainHeight=0,i&&(r+=i.outerHeight()||0),s&&(r+=s.outerHeight()||0),!this.isExtend&&24==this.buttonCell.layout&&24==this.buttonCell.layout){var o=n.find(".search-button-bar");l=o.length?o.outerHeight():0,r+=l}if(a.length){var u=[],c=a.find(".seach-item:visible");u=_.map(c,(function(e,t){return c[t]}));for(var h=[],d=24,f=0,p=0,m=0;m<u.length;m++){var v=$(u[m]),y=parseInt(v.attr("span"));f+y>d&&(p++,f=0),f+=y;var g=v.outerHeight(),w=p;dsf.isUnDef(h[w])&&(h[w]=0),g>h[w]&&(h[w]=g)}_.each(h,(function(t,i){i<=e.initRowsNumber-1&&(e.staticHeight+=t||0)})),this.isExtend?this.mainHeight=a.outerHeight():(this.mainHeight=this.staticHeight,l>0&&(this.mainHeight+=l))}this.staticHeight+=r}},resize:function(){var e=this;this.loaded&&(_.each(this.searchItems,(function(t){var i=e.$el.querySelector("[item-key='"+t.id+"']");if(i){var s=i.querySelector(".ds-super-search-item-block"),n=i.querySelector(".ds-super-search-item-option-box");if(s&&n){var a=s.offsetHeight,r=n.offsetHeight;t.isMore=t.isExtend?r>e.rowHeight+10:r>a+10}}})),this.$nextTick((function(){e.emitHeight()})))},extendHandler:function(){this.isClickExtend=!0,this.closeOrOpen(!this.isExtend)},closeOrOpen:function(e){var t=this;this.owner.isDesign||(this.isExtend=e,this.setLayout(),this.$emit("extend",this.isExtend),this.$nextTick((function(){t.resize()})))},getRowLayoutSum:function(e){var t=e.map((function(e){return e.laout}));return dsf.math.sum(t)},searchBefore:function(e){var t=this,i=this.searchBeforeHandler,s=this.layout;if(dsf.isFunction(i)){var n=_.keyBy(s,"id"),a=!1;i(n,(function(i){if(!a&&!1!==i){a=!0;var s=t.emitValue();t.$emit(e,s)}}))}else{var r=this.emitValue();this.$emit(e,r)}},getMaskHeight:function(){var e,t,i=null===this||void 0===this||null===(e=this.owner.$el)||void 0===e||null===(t=e.querySelector)||void 0===t?void 0:t.call(e,".ds-datagrid-box");return i?(i=$(i),i.height()):0}}},p=f,m=i(0),v=Object(m["a"])(p,s,n,!1,null,null,null);t["default"]=v.exports},1256:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ds-super-search-filter-item"},[i("div",{staticClass:"ds-super-search-filter-item-tag",class:{"tag-open":e.item.isFilterExtend}},["enum"==e.item.type&&"select"==e.item.showModel||"tile"==e.item.showModel?[i("span",{staticClass:"ds-super-search-filter-item-tag-text"},[e._v(e._s(e.item.label)+":")]),"between"!=e.item.operator?[i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.itemValue=e.formatChecked(e.item)}},[e._v(e._s(e.itemValue.join(",")))]),i("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.itemValue.length>1,expression:"itemValue.length > 1"}],staticClass:"ds-super-search-filter-item-num",attrs:{type:"info",size:"mini","disable-transitions":""}},[e._v(e._s(e.itemValue.length))])]:[i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.itemValue=e.formatBetween(e.item)}},[e._v(e._s(e.itemValue))])]]:e._e(),"enum"==e.item.type&&"treeselect"==e.item.showModel?[i("span",{staticClass:"ds-super-search-filter-item-tag-text"},[e._v(e._s(e.item.label)+":")]),(e.item.operator,[i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.itemValue=e.formatTreeSelected(e.item)}},[e._v(e._s(e.itemValue.join(",")))]),i("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.itemValue.length>1,expression:"itemValue.length > 1"}],staticClass:"ds-super-search-filter-item-num",attrs:{type:"info",size:"mini","disable-transitions":""}},[e._v(e._s(e.itemValue.length))])])]:e._e(),"treeTile"==e.item.showModel?[i("span",{staticClass:"ds-super-search-filter-item-tag-text"},[e._v(e._s(e.item.label)+":")]),(e.item.operator,[i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.itemValue=e.formatTreeTile(e.item)}},[e._v(e._s(e.itemValue.join(",")))]),i("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.itemValue.length>1,expression:"itemValue.length > 1"}],staticClass:"ds-super-search-filter-item-num",attrs:{type:"info",size:"mini","disable-transitions":""}},[e._v(e._s(e.itemValue.length))])])]:e._e(),"text"==e.item.type?[i("span",{staticClass:"ds-super-search-filter-item-tag-text"},[e._v(e._s(e.item.label)+":")]),i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.item.values}},[e._v(e._s(e.item.values))])]:e._e(),"number"==e.item.type?[i("span",{staticClass:"ds-super-search-filter-item-tag-text"},[e._v(e._s(e.item.label)+":")]),"between"==e.item.operator?[i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.itemValue=e.formatNumbers(e.item)}},[e._v(e._s(e.itemValue))])]:[i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.item.values}},[e._v(e._s(e.item.values))])]]:e._e(),"datetime"==e.item.type?[i("span",{staticClass:"ds-super-search-filter-item-tag-text"},[e._v(e._s(e.item.label)+":")]),i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.itemValue=e.formatDate(e.item)}},[e._v(" "+e._s(e.itemValue)+" ")])]:e._e(),"period"==e.item.type?[i("span",{staticClass:"ds-super-search-filter-item-tag-text"},[e._v(e._s(e.item.label)+":")]),i("span",{staticClass:"ds-super-search-filter-item-value",attrs:{title:e.itemValue=e.formatPeriod(e.item)}},[e._v(" "+e._s(e.itemValue)+" ")])]:e._e()],2),i("span",{staticClass:"item-close",on:{click:function(t){return e.removeFilter(e.item)}}},[i("i",{staticClass:"iconfont icon-shanchu1"})])])},n=[],a=i(609),r={name:"DsfSuperSearchFilter",components:{DropdownTree:a["a"]},inject:{$superSearch:{default:null}},props:{item:{type:Object,default:function(){return{}}},searchItems:{type:Array,default:function(){return[]}}},data:function(){return{types:{ymds:"datetime",ymd:"date",ym:"month",y:"year"},betweenTypes:{ymds:"datetimerange",ymd:"daterange",ym:"monthrange",y:"yearrange"},formats:{ymds:"yyyy-mm-dd hh:ii:ss",ymd:"yyyy-mm-dd",ym:"yyyy-mm",y:"yyyy"}}},mounted:function(){},methods:{filterOpen:function(e){var t=this;"enum"==e.type?(e.isExtend=!1,e.isFilterExtend=!e.isFilterExtend,e.isAllowMultipe&&(e.values_bak="array"==dsf.type(e.values)?e.values.slice(0):e.values,e.multiple=!0)):"text"==e.type&&(e.isFilterExtend=!e.isFilterExtend),this.$nextTick((function(){t.$superSearch.emitHeight()}))},formatBetween:function(e){var t=_.filter(e.customerBetween,(function(e){return dsf.isDef(e)}));if(t.length>=2)return t[0]+"-"+t[1];var i=e.options;if(i){var s=_.filter(i,(function(t){return e.values.indexOf(t.value)>=0}));return _.map(s,"text").join(",")}return""},formatDate:function(e){var t=this.formats[e.showModel];return"between"==e.operator?dsf.date.format(e.values[0],t)+"~"+dsf.date.format(e.values[1],t):dsf.date.format(e.values,t)},formatPeriod:function(e){return Vue.filter("periodTime")(e.values)},formatChecked:function(e){var t=e.options;if(t){var i=_.filter(t,(function(t){return e.values.indexOf(t.value)>=0}));return _.map(i,"text")}return[]},formatTreeSelected:function(e){var t=e.treeNodeSelected,i="array"==dsf.type(t)?t:[t];return _.map(i,"_name")},formatTreeTile:function(e){var t=e.options;if(t){var i=_.filter(t,(function(t){return e.values.indexOf(t._id)>=0}));return _.map(i,"_name")}return[]},formatNumbers:function(e){var t=e.values[0],i=e.values[1];return t==dsf.enums.numberBoundary.MIN&&(t=null),i==dsf.enums.numberBoundary.MAX&&(i=null),dsf.isUnDef(t)&&dsf.isDef(i)?"小于等于"+e.values[1]:dsf.isDef(t)&&dsf.isUnDef(i)?"大于等于"+e.values[0]:e.values[0]+"~"+e.values[1]},multipleSure:function(e){var t=this;e.isExtend=!1,e.multiple=!1,e.isFilterExtend=!1,this.$nextTick((function(){t.$superSearch.emitHeight(),t.change()}))},multipleCancel:function(e){var t=this;e.values_bak&&(e.values=e.values_bak),e.isExtend=!1,e.multiple=!1,e.isFilterExtend=!1,this.$superSearch.collapseItems(),this.$nextTick((function(){t.$superSearch.emitHeight()}))},checkboxChange:function(e,t,i,s){var n=this;t.multiple||(t.values=e?[i.value]:[],"between"==t.operator&&(t.customerBetween=[]),this.$nextTick((function(){n.change()})))},treeSelectedToValues:function(){var e=this,t=null;t=this.multipe||this.item.treeNodeSelected[0]?_.map(this.item.treeNodeSelected,"_id"):[""],this.item.values=t,this.$nextTick((function(){e.change()}))},treeNodeChange:function(){this.item.multiple||(this.item.isExtend=!1,this.item.multiple=!1,this.item.isClickMultiple=!1,this.item.isFilterExtend=!1);var e=this.$refs.tree.getSelectedData();this.item.treeNodeSelected="array"==dsf.type(e)?e:[e],this.treeSelectedToValues()},removeFilter:function(e){this.$emit("remove",e)},change:function(){this.$emit("change")}},watch:{"item.isFilterExtend":function(e){if(e&&this.$superSearch.filterAllClose(this.item),"treeselect"==this.item.showModel)if(e){var t=this.item.values;this.$refs.tree.setSelectedKeys(t)}else{var i=this.$refs.tree.getSelectedData();this.item.treeNodeSelected="array"==dsf.type(i)?i:[i];var s=_.map(this.item.treeNodeSelected,"_id").join(","),n=this.item.values.join(",");s!=n&&this.treeSelectedToValues()}}}},l=r,o=i(0),u=Object(o["a"])(l,s,n,!1,null,null,null);t["default"]=u.exports},1257:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.showItem?i("div",{staticClass:"ds-super-search-item"},[i("label",{staticClass:"ds-super-search-item-text",style:{width:e.unitSize(e.titleMaxWidth)},attrs:{title:e.item.label}},[e._v(e._s(e.item.label)+":")]),i("div",{staticClass:"ds-super-search-item-block",class:{open:e.item.isExtend}},[e.isTile?[i("div",{staticClass:"ds-super-search-item-option"},[i("div",{staticClass:"ds-super-search-item-option-box",on:{click:function(e){e.stopPropagation()}}},[i("el-checkbox-group",{model:{value:e.tileValues,callback:function(t){e.tileValues=t},expression:"tileValues"}},[e.item.showTileAll?[!e.item.multiple&&e.item.options&&e.item.options.length>0?i("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.item.showTileAll,expression:"item.showTileAll"}],key:"$$all$$",attrs:{label:"","true-label":"''"},on:{change:function(t){return e.checkboxChange("",e.item,null,!1)}}},[e._v(" 全部 ")]):e._e()]:e._e(),"tile"==e.item.showModel?e._l(e.item.options||[],(function(t){return i("el-checkbox",{key:t.value,attrs:{label:t.value},on:{change:function(i){return e.checkboxChange(t.value,e.item,t,!1)}}},[e._v(" "+e._s(t.text)+" ")])})):"treeTile"==e.item.showModel?e._l(e.item.options||[],(function(t){return i("el-checkbox",{key:t._id,attrs:{label:t._id},on:{change:function(i){return e.checkboxTreeChange(t._id,e.item,t,!1)}}},[e._v(" "+e._s(t._name)+" ")])})):e._e(),"between"===e.item.operator?i("el-form",{staticClass:"ds-super-search-customer-between-form",nativeOn:{submit:function(e){e.preventDefault()}}},[i("label",{staticClass:"el-checkbox"},[i("el-input",{staticClass:"small",model:{value:e.item.customerBetween[0],callback:function(t){e.$set(e.item.customerBetween,0,t)},expression:"item.customerBetween[0]"}}),i("span",{staticStyle:{"margin-left":"5px","margin-right":"5px"}},[e._v("~")]),i("el-input",{staticClass:"small",model:{value:e.item.customerBetween[1],callback:function(t){e.$set(e.item.customerBetween,1,t)},expression:"item.customerBetween[1]"}}),i("dsf-button",{staticStyle:{"margin-top":"-2px","min-width":"auto","margin-left":"5px"},attrs:{"tag-name":"button",size:"small"},on:{click:function(t){return e.customerSure(e.item)}}},[e._v("确定")])],1)]):e._e()],2)],1),e.showMultipleButtons?i("div",{staticClass:"multiple-buttons",staticStyle:{"text-align":"center"}},[i("dsf-button",{staticStyle:{"min-width":"auto"},attrs:{size:"small"},on:{click:function(t){return e.multipleSure(e.item)}}},[e._v("确定")]),i("dsf-button",{staticStyle:{"min-width":"auto"},attrs:{size:"small",type:"plain"},on:{click:function(t){return e.multipleCancel(e.item)}}},[e._v("取消")])],1):e._e()])]:e._e(),e.isSelect?["select"==e.item.showModel?i("DsfSuperSearchSelect",{attrs:{item:e.item,values:e.item.values,options:e.item.options||[],multipe:e.item.isAllowMultipe},on:{"update:values":function(t){return e.$set(e.item,"values",t)},focus:e.focus,change:function(t){return e.change(e.item)}},nativeOn:{click:function(e){e.stopPropagation()}}}):"treeselect"==e.item.showModel?i("DsfSuperSearchTreeSelect",{attrs:{item:e.item,values:e.item.values,options:e.item.options||[],multipe:e.item.isAllowMultipe},on:{"update:values":function(t){return e.$set(e.item,"values",t)},focus:e.focus,change:function(t){return e.change(e.item)}},nativeOn:{click:function(e){e.stopPropagation()}}}):"dataChoice"==e.item.showModel?i("DsfSuperSearchDataChoice",{attrs:{item:e.item,values:e.item.values,"is-design":e.$superSearch.isDesign,multiple:e.item.isAllowMultipe},on:{"update:values":function(t){return e.$set(e.item,"values",t)},focus:e.focus,change:function(t){return e.change(e.item)}},nativeOn:{click:function(e){e.stopPropagation()}}}):e._e()]:e._e(),e.isText?[i("DsfSuperSearchInput",{attrs:{item:e.item,values:e.item.values},on:{"update:values":function(t){return e.$set(e.item,"values",t)},change:function(t){return e.change(e.item)}}})]:e._e(),e.isNumber?[i("DsfSuperSearchNumber",{attrs:{item:e.item,values:e.item.values},on:{"update:values":function(t){return e.$set(e.item,"values",t)},change:function(t){return e.change(e.item)}}})]:e._e(),e.isDateTime?["between"===e.item.operator?i("DsfSuperSearchDataPicker",{attrs:{item:e.item,values:e.item.values,format:e.item.showModel,"is-range":!0},on:{"update:values":function(t){return e.$set(e.item,"values",t)},focus:e.focus,change:function(t){return e.change(e.item)}}}):i("DsfSuperSearchDataPicker",{attrs:{item:e.item,values:e.item.values,format:e.item.showModel,"is-range":!1},on:{"update:values":function(t){return e.$set(e.item,"values",t)},focus:e.focus,change:function(t){return e.change(e.item)}}})]:e._e(),e.isPeriod?[i("DsfSuperSearchPeriod",{attrs:{item:e.item,values:e.item.values,chooseType:e.item.showModel.toUpperCase(),"is-range":"between"===e.item.operator},on:{"update:values":function(t){return e.$set(e.item,"values",t)},focus:e.focus,change:function(t){return e.change(e.item)}}})]:e._e()],2),e.isTile?i("div",{staticClass:"ds-super-search-item-buttons"},[e.item.isMore?[e.item.isExtend?i("dsf-button",{staticClass:"pack-up",staticStyle:{"min-width":"auto"},attrs:{type:"plain",size:"small",icon:"shuangjiantoushang"},on:{click:function(t){return t.stopPropagation(),e.extend(e.item,!1)}}},[e._v(" 收起 ")]):i("dsf-button",{staticClass:"more",staticStyle:{"min-width":"auto"},attrs:{type:"plain",size:"small",icon:"shuangjiantouxia"},on:{click:function(t){return t.stopPropagation(),e.extend(e.item,!0)}}},[e._v(" 更多 ")])]:e._e(),e.item.isTileForceMulti?e._e():[e.item.isAllowMultipe&&!e.item.multiple?i("dsf-button",{staticClass:"multiple",staticStyle:{"min-width":"auto"},attrs:{icon:"hao",type:"plain",size:"small"},on:{click:function(t){return t.stopPropagation(),e.multipleExtend(e.item)}}},[e._v(" 多选 ")]):e._e()]],2):e._e()]):e._e()},n=[],a=i(2),r=i.n(a),l={name:"DsfSuperSearchItem",components:{},inject:{$superSearch:{default:null}},props:{item:{type:Object,default:function(){return{}}},titleMaxWidth:{type:String,default:""}},data:function(){return{parentVm:null,childVm:null}},computed:{tileValues:{get:function(){var e=this.item.values||[];return e.length?this.item.values:[""]},set:function(e){0==e.length?this.item.values=[]:(e=_.filter(e,(function(e){return e})),this.item.values=e)}},showItem:function(){if(this.$superSearch.isDesign||!this.item.autoHide)return!0;var e=this.item,t=e.type,i=e.showModel;return"enum"!==t||"treeTile"!==i||(this.item.options||[]).length},showMultipleButtons:function(){return!this.item.isTileForceMulti&&!(!this.item.isExtend||!this.item.multiple)},isTile:function(){return"isTile"==u(this.item)},isSelect:function(){return"isSelect"==u(this.item)},isDateTime:function(){return"isDateTime"==u(this.item)},isPeriod:function(){return"isPeriod"==u(this.item)},isNumber:function(){return"isNumber"==u(this.item)},isText:function(){return"isText"==u(this.item)},isItemMulitExtend:function(){return this.item.multiple&&this.item.isExtend}},created:function(){this.$set(this.item,"$vm",this)},mounted:function(){var e=this.item,t=e.type,i=e.showModel,s=e.childField;if("enum"===t&&"treeTile"===i&&s){var n=_.find(this.$superSearch.searchItems,(function(e){return"enum"===e.type&&"treeTile"===e.showModel&&e.field===s}));null!==n&&void 0!==n&&n.$vm&&(n.$vm.parentVm=this,this.childVm=n.$vm)}},methods:{focus:function(){this.$emit("focus")},change:function(){this.$emit("change")},extend:function(e,t){e.isExtend=t,this.$superSearch.filterAllClose()},multipleExtend:function(e){var t=this;this.$superSearch.filterAllClose(),this.$superSearch.collapseItems(),e.isExtend=!0,e.values_bak=e.values.slice(0),e.multiple=!0,this.$nextTick((function(){t.$superSearch.emitHeight()}))},multipleSure:function(e){var t=this;if(e.multiple=!1,e.isExtend=!1,"treeTile"==e.showModel&&e.childField){var i=[];_.forEach(e.values,(function(t){var s=_.find(e.options,(function(e){var i=e._id;return i===t}));s.children&&i.push.apply(i,r()(s.children))})),this.setTreeTileChildOptions(e.childField,i)}this.$superSearch.filterAllClose(),this.$nextTick((function(){t.$superSearch.emitHeight(),t.change()}))},multipleCancel:function(e){var t=this;e.values_bak&&(e.values=e.values_bak),e.isExtend=!1,this.$superSearch.collapseItems(),this.$superSearch.filterAllClose(),this.$nextTick((function(){t.$superSearch.emitHeight()}))},checkboxChange:function(e,t,i,s){this.$tileCheckboxChange("value",e,t,i,s)},checkboxTreeChange:function(e,t,i,s){this.$tileCheckboxChange("_id",e,t,i,s)},$tileCheckboxChange:function(e,t,i,s,n){var a=this;if(i.isTileForceMulti){if("treeTile"==i.showModel&&i.childField){var l=[];_.forEach(i.values,(function(e){var t=_.find(i.options,(function(t){var i=t._id;return i===e}));t.children&&l.push.apply(l,r()(t.children))})),this.setTreeTileChildOptions(i.childField,l)}"between"==i.operator&&(i.customerBetween=[]),this.$nextTick((function(){a.change()}))}else if(!i.multiple){if(i.values=t&&s?[s[e]]:[],"between"==i.operator&&(i.customerBetween=[]),i.childField){var o=(null===s||void 0===s?void 0:s.children)||[];this.setTreeTileChildOptions(i.childField,o)}this.$nextTick((function(){a.change()}))}},setTreeTileChildOptions:function(e,t){var i=this.childVm;if(i)if(e!==this.item.field)if(t.length)i.$set(i.item,"options",t),i.$set(i.item,"values",[]);else while(i)i.$set(i.item,"options",[]),i.$set(i.item,"values",[]),i=i.childVm;else dsf.error('高级检索：树平铺字段"'.concat(this.item.label,'"配置的级联子字段名').concat(e,"不能与其本身字段名相同"))},customerSure:function(e){var t=_.filter(e.customerBetween,(function(e){return e+""}));2==t.length?(e.values=t,this.change()):dsf.layer.message("请填写"+e.label+"的区间值",!1)}},watch:{"item.isExtend":{handler:function(e,t){var i=this;e!=t&&this.$nextTick((function(){i.$superSearch.emitHeight()}))}}}},o={enum:{tile:"isTile",treeTile:"isTile",select:"isSelect",treeselect:"isSelect",dataChoice:"isSelect"},text:{textbox:"isText"},number:{textbox:"isNumber"},datetime:{ymds:"isDateTime",ymd:"isDateTime",ym:"isDateTime",y:"isDateTime"},period:{hy:"isPeriod",ss:"isPeriod",md:"isPeriod"}};function u(e){var t=e.showModel,i=e.type;return o[i][t]}var c=l,h=i(0),d=Object(h["a"])(c,s,n,!1,null,null,null);t["default"]=d.exports},1258:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"100%"}},[e.isBetween?[i("div",{staticClass:"ds-supersearch-input"},[i("div",{class:{"ds-supersearch-input-range":e.isBetween,"ds-supersearch-input-focus":e.isFocus}},[i("el-input",{ref:"sinput",attrs:{placeholder:e.$placeholder[0]||"请输入",clearable:!1!==e.item.isClearable},on:{focus:e.inputFocus,blur:e.inputBlur,change:function(t){return e.change(e.item)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterHander(0,e.item,t)},mousedown:function(t){return e.clickHandler.apply(null,arguments)}},model:{value:e.value[0],callback:function(t){e.$set(e.value,0,t)},expression:"value[0]"}}),i("span",{on:{click:function(e){e.stopPropagation(),e.preventDefault()},mousedown:function(e){e.stopPropagation(),e.preventDefault()}}},[e._v("至")]),i("el-input",{ref:"einput",attrs:{placeholder:e.$placeholder[1]||"请输入",clearable:!1!==e.item.isClearable},on:{focus:e.inputFocus,blur:e.inputBlur,change:function(t){return e.change(e.item)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterHander(1,e.item,t)},mousedown:function(t){return e.clickHandler.apply(null,arguments)}},model:{value:e.value[1],callback:function(t){e.$set(e.value,1,t)},expression:"value[1]"}})],1)])]:[i("div",{staticClass:"ds-supersearch-input"},[i("el-input",{ref:"input",attrs:{clearable:!1!==e.item.isClearable,placeholder:e.$placeholder||"请输入"},on:{change:function(t){return e.change(e.item)}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)]],2)},n=[],a={name:"DsfSuperSearchInput",props:{values:{type:[Array,String],default:function(){return[]}},item:{type:Object,default:function(){return{}}},placeholder:{type:[String,Array],default:function(){return["请输入"]}}},data:function(){return{value:null,isFocus:!1,isActive:!1,isChange:!1}},computed:{$values:function(){var e=this.values;return this.isBetween?"array"==dsf.type(e)?e:[e]:"array"==dsf.type(e)?e.join(""):e},$placeholder:function(){var e=this.item.placeholder||"请输入";return this.isBetween?(e="array"==dsf.type(e)?e:e.split(";"),e[1]||(e[1]=e[0])):e="array"==dsf.type(e)?e[0]:e,e},isBetween:function(){return"between"==this.item.operator}},beforeCreate:function(){},created:function(){this.value=this.$values},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{clickHandler:function(){this.isActive=!0},inputFocus:function(){this.isFocus=!0,this.isActive=!0},inputBlur:function(){this.isFocus=!1,this.isActive=!1},enterHander:function(e,t){var i=this;this.isEnter=!0,0==e?this.$refs.einput.focus():this.isChange&&this.$nextTick((function(){i.$emit("change"),i.isChange=!1}))},change:function(){var e=this;this.$emit("update:values",this.value),window.setTimeout((function(){e.isBetween&&e.isActive||e.$nextTick((function(){e.$emit("change"),e.isChange=!1}))}),100)}},watch:{values:function(e,t){this.value=this.$values}}},r=a,l=i(0),o=Object(l["a"])(r,s,n,!1,null,null,null);t["default"]=o.exports},1259:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"100%"}},[e.isBetween?[i("div",{staticClass:"ds-supersearch-input"},[i("div",{class:{"ds-supersearch-input-range":e.isBetween,"ds-supersearch-input-focus":e.isFocus}},[i("el-input",{ref:"sinput",staticClass:"number-input",attrs:{clearable:!1!==e.item.isClearable,controls:!1,placeholder:e.$placeholder[0]||"请输入"},on:{input:function(t){return e.inputHandle(0)},focus:function(t){return e.inputFocus(0)},blur:e.inputBlur,change:function(t){return e.change(e.item,t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterHander(0,e.item,t)},mousedown:function(t){return e.clickHandler.apply(null,arguments)}},model:{value:e.value[0],callback:function(t){e.$set(e.value,0,"string"===typeof t?t.trim():t)},expression:"value[0]"}}),i("span",{on:{click:function(e){e.stopPropagation(),e.preventDefault()},mousedown:function(e){e.stopPropagation(),e.preventDefault()}}},[e._v("至")]),i("el-input",{ref:"einput",staticClass:"number-input",attrs:{autocomplete:"off",clearable:!1!==e.item.isClearable,controls:!1,placeholder:e.$placeholder[1]||"请输入"},on:{input:function(t){return e.inputHandle(1)},focus:function(t){return e.inputFocus(1)},blur:e.inputBlur,change:function(t){return e.change(e.item,t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterHander(1,e.item,t)},mousedown:function(t){return e.clickHandler.apply(null,arguments)}},model:{value:e.value[1],callback:function(t){e.$set(e.value,1,"string"===typeof t?t.trim():t)},expression:"value[1]"}})],1)])]:[i("div",{staticClass:"ds-supersearch-input"},[i("el-input",{ref:"input",attrs:{controls:!1,clearable:!1!==e.item.isClearable,placeholder:e.$placeholder||"请输入"},on:{change:function(t){return e.change(e.item)}},nativeOn:{input:function(t){return e.inputHandle()}},model:{value:e.value,callback:function(t){e.value="string"===typeof t?t.trim():t},expression:"value"}})],1)]],2)},n=[],a={name:"DsfSuperSearchNumber",props:{values:{type:[Array,String,Number],default:function(){return[]}},item:{type:Object,default:function(){return{}}}},data:function(){return{value:null,isFocus:!1,isActive:!1,isChange:!1}},computed:{$values:function(){var e=this.values;return this.isBetween?"array"==dsf.type(e)?e:[e]:"array"==dsf.type(e)?e.join(""):e},$placeholder:function(){var e=this.item.placeholder||"请输入";return this.isBetween?(e="array"==dsf.type(e)?e:e.split(";"),e[1]||(e[1]=e[0])):e="array"==dsf.type(e)?e[0]:e,e},isBetween:function(){return"between"==this.item.operator}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{clickHandler:function(){this.isActive=!0},inputHandle:function(e){dsf.isDef(e)?this.$set(this.value,e,this.clearNoNumber(this.value[e])):this.value=this.clearNoNumber(this.value)},inputFocus:function(){this.isFocus=!0,this.isActive=!0},inputBlur:function(){this.isFocus=!1,this.isActive=!1},enterHander:function(e,t){var i=this;0==e?this.$refs.einput.focus():this.isChange&&this.$nextTick((function(){i.$emit("change"),i.isChange=!1}))},change:function(e,t){var i=this;this.isChange=!0;var s=this.value;if(this.isBetween&&(_.each(s,(function(e,t){s[t]=dsf.isDef(s[t])&&dsf.isNumber(s[t])?parseFloat(s[t]):"",(dsf.isUnDef(s[t])||""===s[t])&&(s[t]=0==t?dsf.enums.numberBoundary.MIN:dsf.enums.numberBoundary.MAX)})),s[0]>s[1])){var n=s[1];this.$set(this.value,1,s[0]),this.$set(this.value,0,n)}this.$emit("update:values",s),window.setTimeout((function(){i.isBetween&&i.isActive||i.$nextTick((function(){i.$emit("change"),i.isChange=!1}))}),100)},clearNoNumber:function(e){return e=e.replace(/^\.+|[^\d.]/g,(function(e){return"-"==e?e:""})),e}},watch:{values:{handler:function(e,t){var i=this;this.isBetween?(this.value=[void 0,void 0],_.each(this.$values,(function(e,t){parseFloat(e)==dsf.enums.numberBoundary.MAX||parseFloat(e)==dsf.enums.numberBoundary.MIN?i.$set(i.value,t,void 0):dsf.isDef(e)?i.$set(i.value,t,e):i.$set(i.value,t,void 0)}))):this.value=this.$values},immediate:!0}}},r=a,l=i(0),o=Object(l["a"])(r,s,n,!1,null,null,null);t["default"]=o.exports},1260:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"100%"}},[e.multipe?[i("el-select",{ref:"select",staticClass:"indiction-select tag-no-wrap",class:{"tag-focus":e.selectHoverFocus},staticStyle:{width:"100%","line-height":"40px"},attrs:{"collapse-tags":"",filterable:"",clearable:!1!==e.item.isClearable,multiple:"",placeholder:e.$placeholder,"reserve-keyword":""},on:{focus:e.focus,"visible-change":e.visibleChange,change:e.change},model:{value:e.valueArr,callback:function(t){e.valueArr=t},expression:"valueArr"}},e._l(e.initOptions||e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})),1),e.isDesign?e._e():i("div",{ref:"selectHover",staticClass:"indiction-select-hover",style:e.selectHoverStyle,attrs:{tabindex:"0",hidefocus:"true"},on:{focus:function(t){e.selectHoverFocus=!0},blur:function(t){e.selectHoverFocus=!1}}},e._l(e.selected,(function(t){return i("el-tag",{key:t.currentValue,attrs:{title:t.currentLabel,type:"info",size:"small",closable:"","disable-transitions":""},on:{close:function(i){return e.deleteTag(i,t)}},nativeOn:{click:function(t){return t.stopPropagation(),e.$selectHover.focus()}}},[i("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t.currentLabel))])])})),1)]:i("el-select",{staticClass:"indiction-select tag-no-wrap",staticStyle:{width:"100%","line-height":"40px"},attrs:{"collapse-tags":"",filterable:"",clearable:!1!==e.item.isClearable,placeholder:e.$placeholder},on:{"visible-change":e.visibleChange,focus:e.focus,change:e.change},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[e.item.showTileAll?i("el-option",{key:"",attrs:{label:e.emptyItemText,value:""}}):e._e(),e._l(e.initOptions||e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})}))],2)],2)},n=[],a=i(402),r=i.n(a),l={name:"DsfSuperSearchEnum",props:{isDesign:{type:Boolean,default:!1},multipe:{type:Boolean,default:!1},values:{type:[String,Array,Object],default:function(){return[]}},options:{type:Array,default:function(){return[]}},item:{type:Object,default:function(){return{}}},emptyItemText:{type:String,default:"全部"}},data:function(){return{value:"",valueArr:[],selected:[],selectHoverStyle:{},selectHoverFocus:!1,selectFocus:!1,initOptions:[]}},computed:{$placeholder:function(){var e=this.item.placeholder;return e="array"==dsf.type(e)?e[0]:e,e||"请选择"}},watch:{values:{handler:function(e){var t=this;this.initOptions&&null!==e&&void 0!==e&&e.length&&(this.initOptions=_.filter(this.options,(function(t){return _.find(e,(function(e){return e==t.value}))}))),this.multipe?(this.valueArr=this.values||[],this.$nextTick((function(){var e,i=(null===(e=t.$select)||void 0===e?void 0:e.selected)||[],s=r()(i),n=(s[0],s.slice(1));t.selected=n}))):this.value="array"==dsf.type(this.values)?this.values[0]||"":this.values||""},immediate:!0},"selected.length":function(e){var t=this;e>0&&!this.$more?(this.$more=this.$select.$el.querySelector("span.el-tag:last-child"),this.$more.onmouseenter=function(){t.tagHover=!0,t.selected.length&&!t.selectFocus&&t.$selectHover.focus()}):this.$more=null,0==e&&this.$selectHover.blur()}},mounted:function(){this.multipe&&(this.$select=this.$refs.select,this.$selectHover=this.$refs.selectHover,this.updateStyle(),this.$scrollRoot=o(this.$el),this.$scrollRoot.addEventListener("scroll",this.updateStyle),window.addEventListener("resize",this.updateStyle),document.body.appendChild(this.$selectHover))},beforeDestroy:function(){this.multipe&&(window.removeEventListener("resize",this.updateStyle),this.$scrollRoot.removeEventListener("scroll",this.updateStyle),$(this.$selectHover).remove())},methods:{focus:function(){this.$emit("focus")},visibleChange:function(e){this.initOptions=null,this.multipe&&(this.selectFocus=e,e&&this.updateStyle())},change:function(){var e=this;this.$emit("update:values",this.multipe?this.valueArr:[this.value]),this.$nextTick((function(){e.$emit("change")}))},deleteTag:function(e,t){this.$selectHover.focus(),this.$select.deleteTag(e,t)},updateStyle:function(){var e=this.$select.$el.getClientRects()[0];e&&(this.selectHoverStyle={width:e.width+"px",top:e.top+e.height+11+"px",left:e.left+"px"})}}};function o(e){var t=e.parentNode;return t?t===window.document?window.document.body.scrollTop||window.document.body.scrollLeft?window.document.body:window.document.documentElement:-1!==["scroll","auto"].indexOf(u(t,"overflow"))||-1!==["scroll","auto"].indexOf(u(t,"overflow-x"))||-1!==["scroll","auto"].indexOf(u(t,"overflow-y"))?t:o(e.parentNode):e}function u(e,t){var i=window.getComputedStyle(e,null);return i[t]}var c=l,h=i(0),d=Object(h["a"])(c,s,n,!1,null,null,null);t["default"]=d.exports},1261:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dsf-dropdown-wrapper",{ref:"dropdownWrapper",staticClass:"el-select super-search-tree-select",staticStyle:{width:"100%"},attrs:{width:e.width},on:{"visible-change":e.visibleChange},scopedSlots:e._u([{key:"default",fn:function(){return[e.multipe?e._e():i("el-input",{staticStyle:{width:"100%"},attrs:{readonly:"",value:e.selectName,placeholder:e.$placeholder},nativeOn:{mouseenter:function(t){e.inputHovering=!0},mouseleave:function(t){e.inputHovering=!1}}},[i("template",{slot:"suffix"},[i("i",{directives:[{name:"show",rawName:"v-show",value:!e.showCloseCopy,expression:"!showCloseCopy"}],class:["el-select__caret","el-input__icon","el-icon-"+e.iconClass]}),e.showCloseCopy?i("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:function(t){return t.stopPropagation(),e.handleClearClick.apply(null,arguments)}}}):e._e()])],2),e.multipe?[i("div",{on:{mouseenter:function(t){e.inputHovering=!0},mouseleave:function(t){e.inputHovering=!1}}},[i("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:e.$placeholder,readonly:""}},[i("template",{slot:"suffix"},[i("i",{directives:[{name:"show",rawName:"v-show",value:!e.showCloseCopy,expression:"!showCloseCopy"}],class:["el-select__caret","el-input__icon","el-icon-"+e.iconClass]}),i("i",{directives:[{name:"show",rawName:"v-show",value:e.showCloseCopy,expression:"showCloseCopy"}],staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:function(t){return t.stopPropagation(),e.handleClearClick.apply(null,arguments)}}})])],2),i("div",{ref:"tags",staticClass:"el-select__tags",style:{width:"100%"}},[e.collapseTags?i("span",[e.item.treeNodeSelected.length>0?i("el-tag",{attrs:{title:e.item.treeNodeSelected[0]._name,closable:!0,size:"small",hit:!1,type:"info","disable-transitions":""},on:{close:function(t){return e.deleteTag(t,e.item.treeNodeSelected[0])}}},[i("span",{staticClass:"el-select__tags-text"},[e._v(e._s(e.item.treeNodeSelected[0]._name))])]):e._e(),e.item.treeNodeSelected.length>1?i("el-tag",{attrs:{closable:!1,size:"small",type:"info","disable-transitions":""}},[i("span",{staticClass:"el-select__tags-text"},[e._v("+ "+e._s(e.item.treeNodeSelected.length-1))])]):e._e()],1):i("span",e._l(e.item.treeNodeSelected,(function(t){return i("el-tag",{key:t._id,attrs:{title:t._name,closable:!0,size:"small",type:"info","disable-transitions":""},on:{close:function(i){return e.deleteTag(i,t)}}},[i("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t._name))])])})),1)])],1)]:e._e()]},proxy:!0},{key:"dropdown",fn:function(){return[i("dropdown-tree",{ref:"tree",attrs:{values:e.values,item:e.item,options:e.options,multipe:e.multipe},on:{change:e.treeNodeChange}})]},proxy:!0}])})},n=[],a=i(609),r={components:{DropdownTree:a["a"]},name:"DsfSuperSearchTreeSelect",data:function(){return{value:"",width:"auto",inputHovering:!1,treeMap:{}}},props:{multipe:{type:Boolean,default:!1},values:{type:[String,Array,Object],default:function(){return[]}},options:{type:Array,default:function(){return[]}},collapseTags:{type:Boolean,default:!0},item:{type:Object,default:function(){return{}}}},computed:{iconClass:function(){return this.item.isExtend?"arrow-up is-reverse":"arrow-up"},selectName:function(){return this.item.treeNodeSelected.length>0?this.item.treeNodeSelected[0]._name:""},currentNode:function(){return!this.multipe&&this.item.treeNodeSelected.length>0?this.item.treeNodeSelected[0]._id:""},showCloseCopy:function(){var e;return!1!==this.item.isClearable&&(!!this.inputHovering&&(null===(e=this.values)||void 0===e?void 0:e.length)>0)},$placeholder:function(){var e=this.item.placeholder;return e="array"==dsf.type(e)?e[0]:e,e||"请选择"}},mounted:function(){this.width=this.getWidth()},methods:{visibleChange:function(e){e?(this.width=this.getWidth(),this.$refs.tree.setSelectedKeys(this.values)):this.__hasChange&&(this.__hasChange=!1,this.hideHandler()),this.item.isExtend=e},getWidth:function(){var e,t=null===(e=this.$el)||void 0===e?void 0:e.offsetWidth;return t+"px"||!1},focus:function(){this.$emit("focus")},change:function(){var e=this,t=null;t=this.multipe?_.map(this.item.treeNodeSelected,"_id"):this.item.treeNodeSelected[0]?[this.item.treeNodeSelected[0]._id]:[""],this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change")}))},treeNodeChange:function(e,t){this.__hasChange=!0,this.multipe||(this.item.treeNodeSelected=[],this.item.treeNodeSelected.push(this.$refs.tree.getSelectedData()),this.$refs.dropdownWrapper.toggleDropDownVisible(!1))},hideHandler:function(){if(this.multipe){var e=this.$refs.tree.getSelectedData();this.item.treeNodeSelected=e}this.change()},deleteTag:function(e,t){dsf.array.remove(this.item.values,t._id),dsf.array.removeWith(this.item.treeNodeSelected,(function(e){return e._id==t._id})),this.change()},handleClearClick:function(){var e=this,t=null;this.multipe&&(t=[]),this.$refs.tree.setSelectedKeys(this.multipe?_.map(this.values,"_id"):null),this.$emit("update:values",t),this.$nextTick((function(){e.$emit("change")}))}},watch:{"item.isExtend":function(e){this.$refs.dropdownWrapper.toggleDropDownVisible(e)}}},l=r,o=i(0),u=Object(o["a"])(l,s,n,!1,null,null,null);t["default"]=u.exports},1262:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:e.pickerType,"range-separator":"至",placeholder:e.startPlaceholder,"start-placeholder":e.startPlaceholder,"end-placeholder":e.endPlaceholder,clearable:!1!==e.item.isClearable},on:{change:function(t){return e.change()}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},n=[],a={name:"DsfSuperSearchDataPicker",props:{item:{type:Object,default:function(){return{}}},isRange:{type:Boolean,default:!1},format:{type:String,default:function(){return"ymd"}},values:{type:[Date,Array,String],default:function(){return null}}},data:function(){return{value:null}},computed:{$placeholder:function(){var e=this.item.placeholder;return e="array"==dsf.type(e)?e:e.split(";"),e[1]||(e[1]=e[0]),e},startPlaceholder:function(){var e=this.$placeholder,t=this.isRange,i=this.format;return e[0]?e[0]:t?"ymd"==i?"开始日期":"y"==i?"开始年":"ymds"==i?"开始日期时间":"开始年月":"请选择日期"},endPlaceholder:function(){var e=this.$placeholder,t=this.isRange,i=this.format;return e[1]?e[1]:t?"ymd"==i?"结束日期":"y"==i?"结束年":"ymds"==i?"结束日期时间":"结束年月":"请选择日期"},pickerType:function(){var e=this.isRange,t=this.format;return e?"ymd"==t?"daterange":"y"==t?"yearrange":"ymds"==t?"datetimerange":"monthrange":"ymd"==t?"date":"y"==t?"year":"ymds"==t?"datetime":"month"}},methods:{focus:function(){this.$emit("focus")},change:function(){var e=this;this.$emit("update:values",this.value),this.$nextTick((function(){e.$emit("change")}))}},watch:{values:{handler:function(e,t){this.isRange?this.value=this.values||[]:this.value="array"==dsf.type(this.values)?this.values[0]:this.values},immediate:!0}}},r=a,l=i(0),o=Object(l["a"])(r,s,n,!1,null,null,null);t["default"]=o.exports},1263:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"100%"}},[i("ds-date-picker",{staticStyle:{width:"100%"},attrs:{type:e.pickerType,"period-type":e.chooseType,format:e.format,"value-format":e.valueFormat,clearable:!1!==e.item.isClearable,placeholder:e.startPlaceholder,"start-placeholder":e.startPlaceholder,"end-placeholder":e.endPlaceholder,popperClass:["ds-date-picker-panel"].concat(e.popperClass).join(" ")},on:{change:e.change},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)},n=[],a=i(8),r=i.n(a),l=i(413),o=ELEMENT.DatePicker,u=Object(l["a"])(o),c={name:"DsfSuperSearchPeriod",components:{DsDatePicker:u},props:{popperClass:{type:Array,default:function(){return[]}},isRange:{type:Boolean,default:!1},chooseType:{type:String,default:function(){return"MD"}},values:{type:[Date,Array,String],default:function(){return null}},item:{type:Object,default:function(){return{}}}},data:function(){return{formats:{HY:"yyyy-MM",SS:"yyyy-MM",MD:"yyyy-MM-dd"},valueFormats:{HY:"yyyy-MM-dd",SS:"yyyy-MM-dd",MD:"yyyy-MM-dd"},value:null}},computed:{format:function(){return this.formats[this.chooseType]},valueFormat:function(){return this.valueFormats[this.chooseType]},pickerType:function(){return"MD"==this.chooseType?this.isRange?"daterange":"date":this.isRange?"monthrange":"month"},$placeholder:function(){var e=this.item.placeholder;return e="array"==dsf.type(e)?e:e.split(";"),e[1]||(e[1]=e[0]),e},startPlaceholder:function(){var e=this.$placeholder,t=this.isRange,i=this.chooseType;return e[0]?e[0]:"HY"==i?t?"开始时间":"请选择年":"SS"==i?t?"开始季度":"请选择季度":t?"开始时间":"请选择旬"},endPlaceholder:function(){var e=this.$placeholder,t=this.isRange,i=this.chooseType;return e[1]?e[1]:"HY"==i?t?"结束时间":"请选择年":"SS"==i?t?"结束季度":"请选择季度":t?"结束时间":"请选择旬"}},methods:{focus:function(){this.$emit("focus")},change:function(){var e,t=this,i=null===(e=this.value)||void 0===e?void 0:e[1];this.isRange&&i?this.$emit("update:values",[this.value[0],this.handleEndDate(!0,i)]):this.$emit("update:values",this.value),this.$nextTick((function(){t.$emit("change")}))},handleEndDate:function(e,t){var i={MD:{1:10,11:20,21:0},SS:{1:3,4:6,7:9,10:12},HY:{1:6,7:12}},s=new Date(t),n=s.getFullYear(),a=s.getMonth()+1,l=s.getDate(),o="";if(e){var u=i[this.chooseType];if("MD"===this.chooseType){var c=u[l];o=new Date(n,0===c?a:a-1,c,23,59,59)}else o=new Date(n,u[a],0,23,59,59)}else{var h=Object.entries(i[this.chooseType]).reduce((function(e,t){var i=r()(t,2),s=i[0],n=i[1];return e[n]=s,e}),{});if("MD"===this.chooseType){var d=_.inRange(l,1,11)?1:_.inRange(l,11,21)?11:21;o=new Date(n,a-1,d)}else o=new Date(n,h[a]-1,1)}return dsf.date.format(o,"yyyy-mm-dd")}},watch:{values:{handler:function(e,t){var i=null===e||void 0===e?void 0:e[1];this.isRange&&i?this.value=[e[0],this.handleEndDate(!1,i)]:this.value=e},immediate:!0}}},h=c,d=i(0),f=Object(d["a"])(h,s,n,!1,null,null,null);t["default"]=f.exports},1264:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"el-select indiction-select tag-no-wrap",class:{"tag-focus":e.selectHoverFocus},staticStyle:{width:"100%"},on:{click:e.openDialog,mouseenter:function(t){e.inputHovering=!0},mouseleave:function(t){e.inputHovering=!1}}},[e.multiple?i("div",{ref:"tags",staticClass:"el-select__tags",staticStyle:{width:"calc(100% - 35px)"}},[e.collapseTags&&e.selectedValue.length>1?i("span",[i("el-tag",{attrs:{size:e.collapseTagSize,title:e.selectedValue[0].text,type:"info",closable:"","disable-transitions":""},on:{close:function(t){return e.deleteTag(t,e.selectedValue[0],0)}}},[i("span",{staticClass:"el-select__tags-text"},[e._v(e._s(e.selectedValue[0].text))])]),i("el-tag",{attrs:{slot:"reference",closable:!1,size:e.collapseTagSize,type:"info","disable-transitions":""},nativeOn:{mouseenter:function(t){return e.collapseTagMouseenter.apply(null,arguments)}},slot:"reference"},[i("span",{staticClass:"el-select__tags-text"},[e._v("+ "+e._s(e.selectedValue.length-1))])])],1):i("transition-group",{on:{"after-leave":e.resetInputHeight}},e._l(e.selectedValue,(function(t,s){return i("el-tag",{key:t.value,attrs:{size:e.collapseTagSize,title:t.text,type:"info",closable:"","disable-transitions":""},on:{close:function(i){return e.deleteTag(i,t,s)}}},[i("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t.text))])])})),1)],1):e._e(),i("el-input",{ref:"reference",class:{"is-focus":e.visible},attrs:{value:e.selectedValue.text,"validate-event":!1,tabindex:e.multiple?"-1":null,placeholder:e.values.length>0?"":e.$placeholder,type:"text",readonly:""}},[e.$slots.prefix?i("template",{slot:"prefix"},[e._t("prefix")],2):e._e(),i("template",{slot:"suffix"},[e.showCloseCopy?i("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close is-reverse",on:{click:function(t){return t.stopPropagation(),e.handleClearClick.apply(null,arguments)}}}):i("i",{staticClass:"el-select__caret el-input__icon el-icon-search is-reverse"})])],2),!e.isDesign&&e.multiple?i("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedValue.length>1,expression:"selectedValue.length > 1"}],ref:"selectHover",staticClass:"indiction-select-hover",style:e.selectHoverStyle,attrs:{tabindex:"0",hidefocus:"true"},on:{focus:function(t){e.selectHoverFocus=!0},blur:function(t){e.selectHoverFocus=!1}}},e._l(e.selectedValue,(function(t,s){return i("el-tag",{directives:[{name:"show",rawName:"v-show",value:s,expression:"i"}],key:t.value,attrs:{title:t.text,type:"info",size:"small",closable:"","disable-transitions":""},on:{close:function(i){return e.deleteTag(i,t,s)}},nativeOn:{click:function(t){return t.stopPropagation(),e.$selectHover.focus()}}},[i("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t.text))])])})),1):e._e()],1)},n=[],a={name:"DsfSuperSearchDataChoice",inject:{$vm:{default:null}},props:{collapseTags:{type:Boolean,default:!0},size:String,isDesign:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},values:{type:[String,Array,Object],default:function(){return[]}},item:{type:Object,default:function(){return{}}}},data:function(){return{visible:!1,inputHovering:!1,selectHoverStyle:{},selectHoverFocus:!1}},computed:{selectedValue:function(){var e=this.values;return this.multiple?dsf.isObject(e)?[e]:dsf.isArray(e)?e:[]:dsf.isObject(e)?e:dsf.isArray(e)&&e.length?e[0]:{text:"",value:""}},showCloseCopy:function(){var e;return!1!==this.item.isClearable&&(!!this.inputHovering&&(this.multiple?this.selectedValue.length>0:!(null===(e=this.selectedValue)||void 0===e||!e.value)))},collapseTagSize:function(){return["small","mini"].indexOf(this.size)>-1?"mini":"small"},$placeholder:function(){var e=this.item.placeholder;return e="array"==dsf.type(e)?e[0]:e,e||"请选择"}},mounted:function(){!this.isDesign&&this.multiple&&(this.$selectHover=this.$refs.selectHover,document.body.appendChild(this.$selectHover),this.updateStyle(),this.$scrollRoot=dsf.findScrollEl(this.$el),this.$scrollRoot.addEventListener("scroll",this.updateStyle),window.addEventListener("resize",this.updateStyle))},beforeDestroy:function(){!this.isDesign&&this.multipe&&(window.removeEventListener("resize",this.updateStyle),this.$scrollRoot.removeEventListener("scroll",this.updateStyle),$(this.$selectHover).remove())},methods:{resetInputHeight:function(){},openDialog:function(){var e=this,t=this.item.valueSource.value,i=void 0===t?{}:t,s=i.title,n=i.width,a=i.height,r=i.url;this.$openDialog({title:s||"请选择",width:n||"800px",height:a||"500px",top:"10vh",params:{fromDataChioce:!0,path:this.$replace(r,this.$vm),choiceParams:{value:this.values,maxTags:this.multiple?0:1},selectValue:this.values},btns:[{text:"确定",handler:function(t){if(t.content){var i=t.content;if(i&&i.yes&&dsf.isFunction(i.yes)){var s=i.yes();if(!s)return!1;s=JSON.parse(JSON.stringify(s));var n=e.mapData(s);!e.multiple&&n.length>1&&(n=[n.pop()]),e.$emit("update:values",n),e.$nextTick((function(){e.$emit("change")}))}}}},{text:"取消"}]})},mapData:function(e){for(var t="array"==dsf.type(e)?e:[e],i=[],s=0;s<t.length;s++){var n=t[s],a=this.autoMapDataText(n);a&&i.push(a)}return i},autoMapDataText:function(e){var t,i,s=/(\w+)\.(\w+)/g,n=["text","_text","name","_name","label","_label"],a=["value","_value","id","_id","key","_key"],r=null;for(var l in e){var o=l;s.lastIndex=0;var u=s.exec(l);u&&u[2]&&(o=u[2]),!this.dialogTextKey||o!=this.dialogTextKey&&l!=this.dialogTextKey||(t=e[l]),!this.dialogValueKey||o!=this.dialogValueKey&&l!=this.dialogValueKey||(i=e[l]),dsf.isUnDef(t)&&n.indexOf(o)>=0&&(t=e[l]),dsf.isUnDef(i)&&a.indexOf(o)>=0&&(i=e[l])}return(dsf.isDef(t)||dsf.isDef(i))&&(r={text:t,value:i}),r},handleClearClick:function(){var e=this;this.$emit("update:values",[]),this.$nextTick((function(){e.$emit("change")}))},deleteTag:function(e,t,i){var s=this;this.values.splice(i,1),this.$nextTick((function(){s.$emit("change")}))},updateStyle:function(){var e=this.$el.getClientRects()[0];e&&(this.selectHoverStyle={width:e.width+"px",top:e.top+e.height+11+"px",left:e.left+"px"})},collapseTagMouseenter:function(){this.values.length>1&&this.$selectHover.focus()}}},r=a,l=i(0),o=Object(l["a"])(r,s,n,!1,null,null,null);t["default"]=o.exports},402:function(e,t,i){var s=i(21),n=i(20),a=i(14),r=i(22);function l(e){return s(e)||n(e)||a(e)||r()}e.exports=l,e.exports.__esModule=!0,e.exports["default"]=e.exports},413:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var s=i(42),n=i(17),a=["early","middle","late"],r={quarter:{"01":"一","04":"二","07":"三",10:"四"},halfYear:{"01":"上","07":"下"},meadow:{"01":"上",11:"中",21:"下"}},l=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()},o=function(e,t){var i=e.target;if("A"===i.tagName&&(i=i.parentNode.parentNode),"DIV"===i.tagName&&(i=i.parentNode),"TD"===i.tagName&&!Object(s["a"])(i,"disabled")){var n=i.cellIndex,a=n*t,r=this.getMonthOfCell(n);"range"===this.selectionMode?this.rangeState.selecting?(r>=this.minDate?this.$emit("pick",{minDate:this.minDate,maxDate:r}):this.$emit("pick",{minDate:r,maxDate:this.minDate}),this.rangeState.selecting=!1):(this.$emit("pick",{minDate:r,maxDate:null}),this.rangeState.selecting=!0):this.$emit("pick",a)}},u=function(e,t){var i=this.date.getFullYear();return new Date(i,e*t,1)},c=function(e,t,i){e=l(new Date(e)),t=t?l(new Date(t)):e;var s=[Math.min(e,t),Math.max(e,t)];e=s[0],t=s[1];for(var n=this.rows,a=0,r=n.length;a<r;a++)for(var o=n[a],u=0,c=o.length;u<c;u++)if(!this.showWeekNumber||0!==u){var h=o[u],d=this.date.getFullYear(),f=10===i?this.date.getMonth():u*i,p=10===i?u*i+1:1,m=l(new Date(d,f,p));h.inRange=e&&m>=e&&m<=t,h.start=e&&m===e,h.end=t&&m===t}this.$forceUpdate()},h=function(e,t){for(var i=this,s=[[]],a=this.disabledDate,r=[],o=l(new Date),u=s[0],c=function(){var t=u[h];t||(t={row:0,column:h,type:"normal",inRange:!1,start:!1,end:!1}),t.type="normal";var s=h*e,c=new Date(i.date.getFullYear(),s,1).getTime();t.inRange=c>=l(new Date(i.minDate))&&c<=l(new Date(i.maxDate)),t.start=i.minDate&&c===l(new Date(i.minDate)),t.end=i.maxDate&&c===l(new Date(i.maxDate));var d=c===o;d&&(t.type="today"),t.text=h;var f=new Date(c);t.disabled="function"===typeof a&&a(f),t.selected=Object(n["a"])(r,(function(e){return e.getTime()===f.getTime()})),i.$set(u,h,t)},h=0;h<t;h++)c();return s},d=new Date,f=d.getFullYear(),p=Math.ceil((d.getMonth()+1)/3),m=Math.ceil((d.getMonth()+1)/6),v=d.getMonth(),y=d.getDate();function g(e){var t=e.mixins[0].computed.displayValue;return{name:e.name,props:{periodType:String},extends:e,created:function(){this.getPanel()},computed:{displayValue:function(){var e=this,i=t.call(this),s=!1;/range/.test(this.type)&&(s=!0),Array.isArray(i)||(i=[i]);var n=i;return n=i.map((function(t){if(!t)return"";var i=[],s=t.split("-");return i="zh_CN"===e.$i18n.locale?"MD"===e.periodType?[s[0],s[1],r.meadow[s[2]]]:"SS"===e.periodType?[s[0],r.quarter[s[1]]]:[s[0],r.halfYear[s[1]]]:s,e.$t("platform.datePicker.".concat(e.periodType,"Text"),i)})),s?n:n[0]}},watch:{periodType:"updatePanel"},methods:{updatePanel:function(){var t=!1;this.picker&&(this.unmountPicker(),this.picker=null,t=!0),e.watch.type.call(this,this.type),this.getPanel(),t&&this.mountPicker()},getPanel:function(){"MD"==this.periodType?w.call(this):"SS"==this.periodType?b.call(this):"HY"==this.periodType&&x.call(this)}}}}function w(){var e=this.panel.components.DateTable;if(null!==e&&void 0!==e&&e.computed){var t=e.render,i={extends:e,computed:{rows:function(){for(var e=[],t=l(new Date(this.maxDate)),i=l(new Date(this.minDate)),s=0;s<3;s++){var n=new Date(this.year,this.month,10*s+1).getTime(),r=new Date(n),o={disabled:"function"===typeof this.disabledDate&&this.disabledDate(r),customClass:"function"===typeof this.cellClassName&&this.cellClassName(r),text:this.translate(a[s]),type:this.isToday(s),inRange:this.inRange(n,t,i),start:i&&n===i,end:t&&n===t,selected:n===i||n===t};e.push(o)}return[e]}},methods:{isToday:function(e){var t=new Date(this.startDate),i=[t.getFullYear(),t.getMonth()+1];if(i[0]===f&&i[1]===v){var s=-1;return s=_.inRange(y,0,11)?0:_.inRange(y,11,21)?1:2,e===s?"today":"normal"}return"normal"},inRange:function(e,t,i){return i&&e>=i&&e<=t},getDateOfCell:function(e,t){return new Date(this.year,this.month,10*t+1)},handleClick:function(e){var t,i=e.target,s=i.nodeName.toLowerCase(),n="td"===s?i.cellIndex:null===(t=$(i).parents("td")[0])||void 0===t?void 0:t.cellIndex;if(dsf.isNumber(n)){var a;a=0==n?1:1==n?11:21;var r=new Date(this.year,this.month,a);"range"===this.selectionMode?this.rangeState.selecting?(r>=this.minDate?this.$emit("pick",{minDate:this.minDate,maxDate:r}):this.$emit("pick",{minDate:r,maxDate:this.minDate}),this.rangeState.selecting=!1):(this.$emit("pick",{minDate:r,maxDate:null}),this.rangeState.selecting=!0):this.$emit("pick",r)}},markRange:function(e,t){c.call(this,e,t,10)},cellMatchesDate:function(e,t){var i=a.indexOf(e.text),s=new Date(t);return this.year===s.getFullYear()&&this.month===s.getMonth()&&Number(10*i+1)===s.getDate()},translate:function(e){return this.$t("platform.datePicker.".concat(e))}},render:function(e){var i=t.call(this,e);return i.children[0].children[0].children=[],i.children[0].children[1].children.splice(3,8),i}};this.panel={extends:this.panel,components:{DateTable:i}}}}function b(){var e=this.panel.components.MonthTable;if(null!==e&&void 0!==e&&e.computed){var t=e.methods.getCellStyle,i={extends:e,data:function(){return{months:["firstQuarter","secondQuarter","thirdQuarter","fourthQuarter"]}},computed:{rows:function(){var e=h.call(this,3,4);return e}},methods:{getCellStyle:function(e){var i=t.call(this,e),s=new Date(this.value),n=[s.getFullYear(),s.getMonth()],a=n[0],r=n[1],l=new Date(this.date).getFullYear();return i.today=this.date.getFullYear()==f&&p==e.text+1,i.current=a===l&&r===3*e.text,i},markRange:function(e,t){c.call(this,e,t,3)},getMonthOfCell:function(e){return u.call(this,e,3)},handleMonthTableClick:function(e){o.call(this,e,3)},t:function(e){return this.$t("platform.datePicker.".concat(e.split(".")[3]))}}};this.panel={extends:this.panel,components:{MonthTable:i}}}}function x(){var e=this.panel.components.MonthTable;if(null!==e&&void 0!==e&&e.computed){var t=e.methods.getCellStyle,i=e.render,s={extends:e,computed:{rows:function(){return h.call(this,6,2)}},data:function(){return{months:["firstHalf","secondHalf"]}},methods:{getCellStyle:function(e){var i=t.call(this,e),s=new Date(this.value),n=[s.getFullYear(),s.getMonth()],a=n[0],r=n[1],l=new Date(this.date).getFullYear();return i.today=this.date.getFullYear()==f&&m==e.text+1,i.current=a===l&&r===6*e.text,i},markRange:function(e,t){c.call(this,e,t,6)},getMonthOfCell:function(e){return u.call(this,e,6)},handleMonthTableClick:function(e){o.call(this,e,6)},t:function(e){return this.$t("platform.datePicker.".concat(e.split(".")[3]))}},render:function(e){var t=i.call(this,e);return t.children[0].children[0].children.splice(2,4),t}};this.panel={extends:this.panel,components:{MonthTable:s}}}}},609:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-tree",{ref:"tree",staticClass:"super-search-downdrop-tree",attrs:{data:e.options,"show-checkbox":e.multipe,"expand-on-click-node":e.multipe,props:{label:"_name",children:"children"},"node-key":"_id","highlight-current":""},on:{"node-click":e.nodeClickHandler,"check-change":e.checkChange},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node,n=t.data;return i("span",{staticClass:"custom-tree-node"},[i("span",{class:{"node-disabled":e.nodeDisabled(n)}},[e._v(e._s(s.label))])])}}])})},n=[],a={name:"DropdownTree",data:function(){return{treeMap:{}}},props:{multipe:{type:Boolean,default:!1},values:{type:[String,Array,Object],default:function(){return[]}},options:{type:Array,default:function(){return[]}},item:{type:Object,default:function(){return{}}}},mounted:function(){this.options&&this.options.length>0&&this.updateTree(),this.updateTreeNodeSelectedForValues()},methods:{updateTreeNodeSelectedForValues:function(){var e=this,t="array"==dsf.type(this.values)?this.values:[this.values],i=this.findNodePath(t);this.item.treeNodeSelected=[],i.length>0&&_.each(i,(function(t){e.item.treeNodeSelected.push(t)}))},change:function(){this.$emit("change")},nodeClickHandler:function(e,t){var i=this;this.multipe||this.$nextTick((function(){i.change()}))},checkChange:function(){var e=this;this.$nextTick((function(){e.change()}))},nodeDisabled:function(e){},getSelectedData:function(){return this.multipe?this.$refs.tree.getCheckedNodes():this.$refs.tree.getCurrentNode()},deepNode:function(e,t){var i=this;_.each(e,(function(e){dsf.isUnDef(e.__pathId__)&&Object.defineProperty(e,"__pathId__",{value:"",enumerable:!1,writable:!0}),e.__pathId__=t?t.__pathId__+"$$"+e._id:e._id,i.treeMap[e._id]=e,e.children&&i.deepNode(e.children,e)}))},findNodePath:function(e){var t=this,i=_.map(e,(function(e){return t.treeMap[e]}));return i=_.filter(i,(function(e){return dsf.isDef(e)})),i},updateTree:function(e){this.deepNode(e||this.options)},setCheckedKeys:function(e){this.$refs.tree.setCheckedKeys(e)},setCurrentKey:function(e){this.$refs.tree.setCurrentKey(e)},setSelectedKeys:function(e){this.multipe?(e="array"==dsf.type(e)?e:[e],this.$refs.tree.setCheckedKeys(e)):(e="array"==dsf.type(e)?e[0]:"",this.$refs.tree.setCurrentKey(e))}},watch:{options:function(e,t){e&&t!==e&&this.updateTree()},values:function(e,t){this.updateTreeNodeSelectedForValues()}}},r=a,l=i(0),o=Object(l["a"])(r,s,n,!1,null,null,null);t["a"]=o.exports}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_pc_supersearch.js.map