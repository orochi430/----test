/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[20],{1020:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ds-forgot-password"},[e.title?s("dsf-mobile-nav-bar",{attrs:{label:"",navTitle:e.title}}):e._e(),s("div",{staticClass:"ds-forgot-password-content",class:{hasTab:e.showPhoneOrEmail}},[e.showAccountModule?[s("div",{staticClass:"dsf-forgot-password-content"},[s("p",{staticClass:"step-title"},[e._v("账号验证")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.account,expression:"account"}],staticClass:"dsf-forgot-password-input",attrs:{type:"text",placeholder:"请输入手机号|身份证号|登录名"},domProps:{value:e.account},on:{input:function(t){t.target.composing||(e.account=t.target.value)}}})])]:e._e(),e.showPhoneOrEmail?s("div",{staticClass:"dsf-forgot-password-tab"},[s("div",{staticClass:"dsf-forgot-password-tab-item",class:{"password-tab-item-active":0===e.tabActive},on:{click:function(t){return e.tabClick(0)}}},[s("p",[e._v("手机号验证")])]),s("div",{staticClass:"dsf-forgot-password-tab-item",class:{"password-tab-item-active":1===e.tabActive},on:{click:function(t){return e.tabClick(1)}}},[s("p",[e._v("邮箱验证")])])]):e._e(),e.showPhoneModule?[s("div",{staticClass:"dsf-forgot-password-content"},[s("p",{staticClass:"step-title"},[e._v("手机号验证")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],staticClass:"dsf-forgot-password-input",attrs:{type:"text",maxlength:"11",placeholder:"请输入手机号"},domProps:{value:e.phone},on:{input:function(t){t.target.composing||(e.phone=t.target.value)}}}),s("div",{staticClass:"dsf-forgot-password-input-e"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],staticClass:"dsf-forgot-password-input",attrs:{type:"text",placeholder:"请输入验证码"},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}}),s("p",{on:{click:e.getCode}},[e._v(e._s(e.timeMsg))])])])]:e._e(),e.showResetPwdModule?s("div",{staticClass:"dsf-forgot-password-content"},[s("p",{staticClass:"step-title"},[e._v("设置新密码")]),s("div",{staticClass:"dsf-forgot-password-input-btn"},["checkbox"===e.type?s("input",{directives:[{name:"model",rawName:"v-model",value:e.newpwd,expression:"newpwd"}],attrs:{placeholder:"设置新密码",type:"checkbox"},domProps:{checked:Array.isArray(e.newpwd)?e._i(e.newpwd,null)>-1:e.newpwd},on:{change:function(t){var s=e.newpwd,i=t.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=e._i(s,n);i.checked?a<0&&(e.newpwd=s.concat([n])):a>-1&&(e.newpwd=s.slice(0,a).concat(s.slice(a+1)))}else e.newpwd=o}}}):"radio"===e.type?s("input",{directives:[{name:"model",rawName:"v-model",value:e.newpwd,expression:"newpwd"}],attrs:{placeholder:"设置新密码",type:"radio"},domProps:{checked:e._q(e.newpwd,null)},on:{change:function(t){e.newpwd=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.newpwd,expression:"newpwd"}],attrs:{placeholder:"设置新密码",type:e.type},domProps:{value:e.newpwd},on:{input:function(t){t.target.composing||(e.newpwd=t.target.value)}}}),s("i",{staticClass:"icon iconfont",class:{"icon-icon-invisible":"password"===e.type,"icon-icon-visible":"text"===e.type},on:{click:e.changeIcon}})]),s("div",{staticClass:"dsf-forgot-password-input-btn"},["checkbox"===(e.showConfirmNewpwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmNewpwd,expression:"confirmNewpwd"}],attrs:{placeholder:"确认新密码",type:"checkbox"},domProps:{checked:Array.isArray(e.confirmNewpwd)?e._i(e.confirmNewpwd,null)>-1:e.confirmNewpwd},on:{change:function(t){var s=e.confirmNewpwd,i=t.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=e._i(s,n);i.checked?a<0&&(e.confirmNewpwd=s.concat([n])):a>-1&&(e.confirmNewpwd=s.slice(0,a).concat(s.slice(a+1)))}else e.confirmNewpwd=o}}}):"radio"===(e.showConfirmNewpwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmNewpwd,expression:"confirmNewpwd"}],attrs:{placeholder:"确认新密码",type:"radio"},domProps:{checked:e._q(e.confirmNewpwd,null)},on:{change:function(t){e.confirmNewpwd=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmNewpwd,expression:"confirmNewpwd"}],attrs:{placeholder:"确认新密码",type:e.showConfirmNewpwd?"text":"password"},domProps:{value:e.confirmNewpwd},on:{input:function(t){t.target.composing||(e.confirmNewpwd=t.target.value)}}}),s("i",{staticClass:"icon iconfont",class:{"icon-icon-invisible":!e.showConfirmNewpwd,"icon-icon-visible":e.showConfirmNewpwd},on:{click:function(t){e.showConfirmNewpwd=!e.showConfirmNewpwd}}})]),s("p",{staticClass:"step-tip"},[e._v(e._s(e.notice))])]):e._e(),e.showEmailModule?[s("div",{staticClass:"dsf-forgot-password-content"},[s("p",{staticClass:"step-title"},[e._v("邮箱验证")]),s("div",{staticClass:"dsf-forgot-password-email"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"dsf-forgot-password-input",attrs:{type:"text",placeholder:"请输入邮箱地址"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("div",{staticClass:"dsf-forgot-password-input-e"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.emailcode,expression:"emailcode"}],staticClass:"dsf-forgot-password-input",attrs:{type:"text",placeholder:"请输入邮箱验证码"},domProps:{value:e.emailcode},on:{input:function(t){t.target.composing||(e.emailcode=t.target.value)}}}),s("p",{on:{click:e.sendEmailCode}},[e._v(e._s(e.mailTimeMsg))])])])])]:e._e(),e.showSuccessTipsModule?[e._m(0)]:e._e(),s("p",{staticClass:"error-msg"},[s("i",{directives:[{name:"show",rawName:"v-show",value:e.errorMessage,expression:"errorMessage"}],staticClass:"iconfont icon-tixingshixin"}),s("span",[e._v(e._s(e.errorMessage))])]),s("DsfMobileButton",{staticClass:"dsf-forgot-password-next-btn",attrs:{type:"primary"},on:{click:e.buttonClickHandler}},[e._v(e._s(e.buttonLabel))])],2)],1)},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dsf-forgot-password-content"},[s("i",{staticClass:"step-succss iconfont icon-icon-wancheng"}),s("p",{staticClass:"success-tip"},[e._v("登录密码更新成功")])])}],n=s(4),a=s.n(n),r=s(1),c=s.n(r),d=dsf.component({name:"DsfMobilePlatformForgotPassword",ctrlCaption:"忘记密码",mixins:[$mixins.control],props:{title:{type:String,default:"忘记密码"},intervalUrl:{type:String,default:":/user/password/getUpdatePwdRule"},getCodeUrl:{type:String,default:":/user/password/sendUpdatePwdSms"},authCodeUrl:{type:String,default:":/user/password/checkUpdatePwdSms"},alterPwdUrl:{type:String,default:":/user/password/updatePwdByForget"},authUrl:{type:String,default:"oua2/user/pwd/verify"},sendUpdatePwdEmail:{type:String,default:":/user/password/sendUpdatePwdEmail"},checkUpdatePwdEmail:{type:String,default:":/user/password/checkUpdatePwdEmail"},checkStrengthPwdByEmail:{type:String,default:":/user/password/checkStrengthPwdByEmail"},updatePwdByEmail:{type:String,default:":/user/password/updatePwdByEmail"}},data:function(){return{step:1,account:"",phone:"",gettingcode:!1,email:"",emailcode:"",disabled:!0,errorMessage:"",time:0,mailTime:0,countdownTimes:0,type:"password",newpwd:"",confirmNewpwd:"",notice:"",interval:null,mailInterval:null,code:"",isCodeSend:!1,isMailCodeSend:!1,codeAuthResult:"",token:"",tabActive:0,checkPhone:!1,showConfirmNewpwd:!1}},watch:{code:function(){this.codeAuthResult=""},emailcode:function(e){this.codeAuthResult="",""!=e&&this.disabled?this.disabled=!1:""!==e||this.disabled||(this.disabled=!0)}},computed:{forget_pwd_setting_mode:function(){var e,t=["phone","mail","all"],s={0:"phone",1:"mail",2:"all",3:"account_and_phone",4:"account_and_mail",5:"account_and_phone_or_mail"},i=(null===(e=dsf)||void 0===e||null===(e=e.config)||void 0===e?void 0:e.setting_public_forget_pwd_setting)||"5";return t.includes(i)?i:s[i]},timeMsg:function(){return this.interval?this.time+" s":this.isCodeSend?"重新获取":"获取验证码"},mailTimeMsg:function(){return this.mailInterval?this.mailTime+" s":this.isMailCodeSend?"重新获取":"发送验证码"},verifyAccount:function(){return["account_and_phone","account_and_mail","account_and_phone_or_mail"].includes(this.forget_pwd_setting_mode)},steps:function(){var e=[{label:"账号验证",handler:"accountCheck"},{label:"手机验证",handler:"codeCheck"},{label:"邮箱验证",handler:"emailCheck"},{label:"手机、邮箱验证",handler:"phoneOrEmailCheck"}],t=[],s=this.forget_pwd_setting_mode;return this.verifyAccount&&t.push(e[0]),["phone","account_and_phone"].includes(s)&&t.push(e[1]),["mail","account_and_mail"].includes(s)&&t.push(e[2]),["all","account_and_phone_or_mail"].includes(s)&&t.push(e[3]),t.concat([{label:"设置操作",handler:"setpwd"},{label:"完成",handler:"reLogin"}])},showAccountModule:function(){return 1===this.step&&this.forget_pwd_setting_mode.indexOf("account")>-1},showPhoneOrEmail:function(){return 1===this.step&&"all"===this.forget_pwd_setting_mode||2===this.step&&"account_and_phone_or_mail"===this.forget_pwd_setting_mode},showPhoneModule:function(){return!(!this.showPhoneOrEmail||0!==this.tabActive)||(1===this.step&&"phone"===this.forget_pwd_setting_mode||2===this.step&&"account_and_phone"===this.forget_pwd_setting_mode)},showEmailModule:function(){return!(!this.showPhoneOrEmail||1!==this.tabActive)||(1===this.step&&"mail"===this.forget_pwd_setting_mode||2===this.step&&"account_and_mail"===this.forget_pwd_setting_mode)},showResetPwdModule:function(){return!!(2===this.step&&!this.verifyAccount||3===this.step&&this.verifyAccount)},showSuccessTipsModule:function(){return(3===this.step&&!this.verifyAccount||4===this.step)&&(dsf.storage.local.remove("rememberToken"),!0)},buttonLabel:function(){return this.showAccountModule?"请点击验证":this.showSuccessTipsModule?"确定":"下一步"}},mounted:function(){this.isDesign||this.getInterval()},beforeDestroy:function(){this.interval&&clearInterval(this.interval),this.mailInterval&&clearInterval(this.mailInterval),this.time=this.countdownTimes,this.mailTime=this.countdownTimes,this.interval=null,this.mailInterval=null},methods:{getStyle:function(){return{width:4===this.steps.length?"50px":"86px"}},buttonClickHandler:function(){var e;null===this||void 0===this||null===(e=this[this.steps[this.step-1].handler])||void 0===e||e.call(this)},accountCheck:function(){this.account?(this.errorMessage="",this.step+=1):this.errorMessage="请输入账号"},phoneCheck:function(e){""===this.phone?this.errorMessage="手机号不能为空":/^1(3|4|5|7|8|9|6)\d{9}$/.test(this.phone)?(this.errorMessage="",e||(this.code="")):this.errorMessage="手机格式不正确"},codeCheck:function(){var e=this;return a()(c.a.mark((function t(){var s,i,o;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.phoneCheck(!0),!e.errorMessage){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.authCode();case 5:s=t.sent,i=s.err,o=s.token,i?e.errorMessage=i:(e.token=o,e.step+=1);case 9:case"end":return t.stop()}}),t)})))()},emailCheck:function(){var e=this;if(this.email&&this.emailcode){this.errorMessage="";var t={code:this.emailcode,email:this.email};this.verifyAccount&&(t.account=this.account),this.httpRequestHandler("get",this.checkUpdatePwdEmail,t,(function(t){e.token=t,e.step+=1}),"验证码错误")}else""===this.email?this.errorMessage="邮箱地址不能为空":""===this.emailcode&&(this.errorMessage="请输入验证码")},phoneOrEmailCheck:function(){0===this.tabActive?this.codeCheck():this.emailCheck()},setpwd:function(){var e=this;return a()(c.a.mark((function t(){var s,i;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.errorMessage="",e.newpwd){t.next=5;break}e.errorMessage="请输入新密码",t.next=22;break;case 5:if(e.confirmNewpwd){t.next=9;break}e.errorMessage="请再次输入新密码",t.next=22;break;case 9:if(e.newpwd==e.confirmNewpwd){t.next=13;break}e.errorMessage="两次密码输入不一致",t.next=22;break;case 13:if(["mail","account_and_mail"].includes(e.forget_pwd_setting_mode)||1==e.tabActive){t.next=21;break}return t.next=16,e.alterPassword();case 16:s=t.sent,i=s.err,i?e.errorMessage=i:e.step+=1,t.next=22;break;case 21:e.httpRequestHandler("post",e.updatePwdByEmail,{token:e.token,param:dsf.sm2.encode(e.newpwd,dsf.config.setting_public_smpublickey)},(function(t){e.step+=1}));case 22:case"end":return t.stop()}}),t)})))()},confrim:function(){var e,t;this.$listeners["complete"]?this.$dispatch("complete"):null===this||void 0===this||null===(e=this.$dialog)||void 0===e||null===(t=e.close)||void 0===t||t.call(e)},tabClick:function(e){this.errorMessage="",this.tabActive=e},getInterval:function(){var e=this;this.httpRequestHandler("get",this.intervalUrl,{},(function(t){e.countdownTimes=t.interval,e.time=t.interval,e.mailTime=t.interval,e.notice=t.notice}),"layerErrorMessage")},sendEmailCode:function(){var e=this;return a()(c.a.mark((function t(){var s;return c.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.mailInterval){t.next=2;break}return t.abrupt("return",!1);case 2:""===e.email?e.errorMessage="邮箱地址不能为空":/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(e.email)?(e.errorMessage="",s={email:e.email},e.verifyAccount&&(s.account=e.account),e.httpRequestHandler("post",e.sendUpdatePwdEmail,s,(function(t){dsf.layer.message("发送成功"),e.isMailCodeSend=!0,e.mailInterval=setInterval((function(){e.mailTime--,e.mailTime<=0&&(clearInterval(e.mailInterval),e.mailInterval=null,e.mailTime=e.countdownTimes)}),1e3)}),"layerErrorMessage")):e.errorMessage="邮箱格式不正确";case 3:case"end":return t.stop()}}),t)})))()},changeIcon:function(){"text"===this.type?this.type="password":this.type="text"},getCode:function(){var e=this;if(this.phoneCheck(!0),!this.errorMessage&&!this.gettingcode&&!this.interval){this.gettingcode=!0;var t={phone:this.phone};this.verifyAccount&&(t.account=this.account),this.httpRequestHandler("post",this.getCodeUrl,t,(function(){e.isCodeSend=!0,dsf.layer.message("发送成功"),e.interval=setInterval((function(){e.time--,e.time<=0&&(clearInterval(e.interval),e.interval=null,e.time=e.countdownTimes)}),1e3)}),"layerErrorMessage")}},authCode:function(){var e=this;return new Promise((function(t){e.httpRequestHandler("get",e.authCodeUrl,{phone:e.phone,code:e.code},(function(e){t({err:null,token:e})}),(function(e){t({err:e||"请求异常",token:null})}))}))},alterPassword:function(){var e=this;return new Promise((function(t){e.httpRequestHandler("post",e.alterPwdUrl,{phone:e.phone,token:e.token,param:dsf.sm2.encode(e.newpwd,dsf.config.setting_public_smpublickey)},(function(e){t({err:null,token:e})}),(function(e){t({err:e||"请求异常",token:null})}))}))},httpRequestHandler:function(e,t,s,i,o){var n=this,a=dsf.layer.loading();this.$http[e](t,s).done((function(e){var t=e.success,s=e.data,a=e.message,r=e.state;!t&&s&&dsf.isString(s)&&(a=s),t?i(s):20531==r?(n.step-=1,n.code="",n.emailcode="",n.errorMessage=o||a):"layerErrorMessage"===o?dsf.layer.message(a||"请求异常",!1):dsf.isFunction(o)?o(a):n.errorMessage=o||a})).error((function(e){dsf.error(e),dsf.layer.message((null===e||void 0===e?void 0:e.message)||"请求异常",!1)})).always((function(){dsf.layer.closeLoading(a),n.gettingcode&&(n.gettingcode=!1)}))},reLogin:function(){this.$listeners["complete"]?this.$dispatch("complete"):this.$router.go(-1)}}}),l=d,u=(s(823),s(0)),p=Object(u["a"])(l,i,o,!1,null,null,null);t["default"]=p.exports},1021:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"ds-forgot-password"},[e.title?s("dsf-mobile-nav-bar",{attrs:{label:"",navTitle:e.title}}):e._e(),s("div",{staticClass:"ds-forgot-password-content"},[e.step?[s("div",{staticClass:"dsf-forgot-password-content"},[s("i",{staticClass:"step-succss iconfont icon-icon-wancheng"}),s("p",{staticClass:"success-tip"},[e._v("登录密码修改成功,"+e._s(e.setTimeout)+"秒后自动退出")])])]:s("div",{staticClass:"dsf-forgot-password-content"},["1"==e.isCheckOldPwd?s("div",{staticClass:"dsf-forgot-password-input-btn"},["checkbox"===(e.showOldPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.oldPwd,expression:"oldPwd"}],attrs:{placeholder:"请输入旧密码",type:"checkbox"},domProps:{checked:Array.isArray(e.oldPwd)?e._i(e.oldPwd,null)>-1:e.oldPwd},on:{change:function(t){var s=e.oldPwd,i=t.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=e._i(s,n);i.checked?a<0&&(e.oldPwd=s.concat([n])):a>-1&&(e.oldPwd=s.slice(0,a).concat(s.slice(a+1)))}else e.oldPwd=o}}}):"radio"===(e.showOldPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.oldPwd,expression:"oldPwd"}],attrs:{placeholder:"请输入旧密码",type:"radio"},domProps:{checked:e._q(e.oldPwd,null)},on:{change:function(t){e.oldPwd=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.oldPwd,expression:"oldPwd"}],attrs:{placeholder:"请输入旧密码",type:e.showOldPwd?"text":"password"},domProps:{value:e.oldPwd},on:{input:function(t){t.target.composing||(e.oldPwd=t.target.value)}}}),s("i",{staticClass:"icon iconfont",class:{"icon-icon-invisible":!e.showOldPwd,"icon-icon-visible":e.showOldPwd},on:{click:function(t){e.showOldPwd=!e.showOldPwd}}})]):e._e(),s("div",{staticClass:"dsf-forgot-password-input-btn"},["checkbox"===(e.showNewPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPwd,expression:"newPwd"}],attrs:{placeholder:"请输入新密码",type:"checkbox"},domProps:{checked:Array.isArray(e.newPwd)?e._i(e.newPwd,null)>-1:e.newPwd},on:{change:function(t){var s=e.newPwd,i=t.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=e._i(s,n);i.checked?a<0&&(e.newPwd=s.concat([n])):a>-1&&(e.newPwd=s.slice(0,a).concat(s.slice(a+1)))}else e.newPwd=o}}}):"radio"===(e.showNewPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPwd,expression:"newPwd"}],attrs:{placeholder:"请输入新密码",type:"radio"},domProps:{checked:e._q(e.newPwd,null)},on:{change:function(t){e.newPwd=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.newPwd,expression:"newPwd"}],attrs:{placeholder:"请输入新密码",type:e.showNewPwd?"text":"password"},domProps:{value:e.newPwd},on:{input:function(t){t.target.composing||(e.newPwd=t.target.value)}}}),s("i",{staticClass:"icon iconfont",class:{"icon-icon-invisible":!e.showNewPwd,"icon-icon-visible":e.showNewPwd},on:{click:function(t){e.showNewPwd=!e.showNewPwd}}})]),s("div",{staticClass:"dsf-forgot-password-input-btn"},["checkbox"===(e.showConfirmPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPwd,expression:"confirmPwd"}],attrs:{placeholder:"请再次输入新密码",type:"checkbox"},domProps:{checked:Array.isArray(e.confirmPwd)?e._i(e.confirmPwd,null)>-1:e.confirmPwd},on:{change:function(t){var s=e.confirmPwd,i=t.target,o=!!i.checked;if(Array.isArray(s)){var n=null,a=e._i(s,n);i.checked?a<0&&(e.confirmPwd=s.concat([n])):a>-1&&(e.confirmPwd=s.slice(0,a).concat(s.slice(a+1)))}else e.confirmPwd=o}}}):"radio"===(e.showConfirmPwd?"text":"password")?s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPwd,expression:"confirmPwd"}],attrs:{placeholder:"请再次输入新密码",type:"radio"},domProps:{checked:e._q(e.confirmPwd,null)},on:{change:function(t){e.confirmPwd=null}}}):s("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPwd,expression:"confirmPwd"}],attrs:{placeholder:"请再次输入新密码",type:e.showConfirmPwd?"text":"password"},domProps:{value:e.confirmPwd},on:{input:function(t){t.target.composing||(e.confirmPwd=t.target.value)}}}),s("i",{staticClass:"icon iconfont",class:{"icon-icon-invisible":!e.showConfirmPwd,"icon-icon-visible":e.showConfirmPwd},on:{click:function(t){e.showConfirmPwd=!e.showConfirmPwd}}})]),"1"==e.isCheckCode?s("div",{staticClass:"dsf-forgot-password-input-e"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],staticClass:"dsf-forgot-password-input",attrs:{type:"text",placeholder:"请输入验证码"},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}}),s("p",{on:{click:e.getCode}},[e._v(e._s(e.timeMsg))])]):e._e(),s("p",{staticClass:"step-tip"},[e._v(e._s(e.notice))])]),s("p",{staticClass:"error-msg"},[s("i",{directives:[{name:"show",rawName:"v-show",value:e.tips,expression:"tips"}],staticClass:"iconfont icon-tixingshixin"}),s("span",[e._v(e._s(e.tips))])]),e.step?s("DsfMobileButton",{staticClass:"dsf-forgot-password-next-btn",attrs:{type:"primary"},on:{click:e.backLogin}},[e._v(" 重新登录 ")]):s("DsfMobileButton",{staticClass:"dsf-forgot-password-next-btn",attrs:{type:"primary",disabled:e.nextStepDisabled},on:{click:e.nextStep}},[e._v(" 下一步 ")])],2)],1)},o=[],n=dsf.component({name:"DsfMobilePlatformAlterPassword",ctrlCaption:"修改密码",mixins:[$mixins.control],props:{title:{type:String,default:"修改密码"},alterUrl:{type:String,default:"oua2/user/pwd/selfupdate"},intervalUrl:{type:String,default:":/user/password/getUpdatePwdRule"},errorTips:{type:String,default:"新密码不能与旧密码一样，请重新输入"},onSuccess:{default:null},codeUrl:{type:String,default:"password/sendUpdatePwdCode"}},data:function(){return{showOldPwd:!1,showNewPwd:!1,showConfirmPwd:!1,loading:!1,notice:"密码设置6到20位,必须包含大写字母、小写字母、数字",step:!1,oldPwd:"",newPwd:"",confirmPwd:"",code:"",tips:"",setTimeout:5,codeIntervalTime:60,codeIntervalFn:null,isCheckOldPwd:1,isCheckCode:0}},computed:{nextStepDisabled:function(){var e=this.oldPwd,t=this.newPwd,s=this.confirmPwd,i=this.code,o=this.isCheckOldPwd,n=this.isCheckCode;return!t||t!==s||("1"==o&&"1"==n?!(e&&e!=t&&i):"1"==o&&"0"==n?!(e&&e!=t):"0"==o&&"1"==n?!i:"0"!=o||"0"!=n)},timeMsg:function(){return this.codeIntervalFn?this.codeIntervalTime+" s":this.isCodeSend?"重新获取":"获取验证码"}},mounted:function(){var e=this;this.loading=!0,this.$http.get(this.intervalUrl,{}).done((function(t){var s=t.success,i=t.data;s&&(e.notice=i.notice,e.isCheckOldPwd=(null===i||void 0===i?void 0:i.checkOldPwd)||"1",e.isCheckCode=(null===i||void 0===i?void 0:i.checkSmsCode)||"0")})).error((function(e){dsf.error(e)})).always((function(){e.loading=!1}))},watch:{oldPwd:function(e){this.checkPwd()},newPwd:function(){this.checkPwd()},confirmPwd:function(){this.checkPwd()}},methods:{nextStep:function(){this.alterPwd()},setTimeoutExit:function(){var e=this;this.setTimeout<=0?this.backLogin():(this.setTimeout--,clearTimeout(this.stopExit),this.stopExit=setTimeout((function(){e.setTimeoutExit()}),1e3))},alterPwd:function(){var e=this,t=dsf.sm2.encode(this.oldPwd,dsf.config.setting_public_smpublickey),s=dsf.sm2.encode(this.newPwd,dsf.config.setting_public_smpublickey);this.$http.post(this.alterUrl,{oldParam:"1"==this.isCheckOldPwd?t:"",param:s,code:this.code||""}).done((function(t){var s=t.success,i=t.message;s?e.loginOut():dsf.layer.message(i,!1)})).error((function(e){dsf.error(e),dsf.layer.message((null===e||void 0===e?void 0:e.message)||"请求异常",!1)})).always((function(){}))},loginOut:function(){var e=this;this.$webAPI.loginOut().then((function(t){var s,i=t.success,o=t.message;i?(dsf.clearLoginInfo(),dsf.storage.local.remove("rememberToken"),e.step=!0,null===(s=e.onSuccess)||void 0===s||s.call(e),e.setTimeoutExit()):dsf.layer.message(o,!1)})).catch((function(e){console.error(e),dsf.layer.message("退出失败",!1)}))},backLogin:function(){this.$listeners["complete"]?this.$dispatch("complete"):location.replace(dsf.config.setting_public_mobile_login_page)},checkPwd:_.debounce((function(){!this.oldPwd&&"0"!=this.isCheckOldPwd||!this.newPwd&&!this.confirmPwd?this.tips="":"1"!=this.isCheckOldPwd||this.oldPwd!==this.newPwd&&this.oldPwd!==this.confirmPwd?this.newPwd&&this.confirmPwd&&this.newPwd!=this.confirmPwd?this.tips="两次新密码输入不一致，请重新输入":this.tips="":this.tips=this.errorTips}),300),getCode:function(){var e=this;if(!this.codeIntervalFn){this.isCodeSend=!0;var t=this.codeIntervalTime;this.codeIntervalFn=setInterval((function(){e.codeIntervalTime--,0==e.codeIntervalTime&&(e.codeIntervalTime=t,e.clearInterval())}),1e3),this.$http.post(this.codeUrl).done((function(t){var s=t.success,i=t.message;s||(e.clearInterval(),dsf.layer.message(i,!1))})).error((function(t){dsf.error(t),dsf.layer.message((null===t||void 0===t?void 0:t.message)||"请求异常",!1),clearInterval(e.codeIntervalFn)}))}},clearInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){this.codeIntervalFn&&(clearInterval(this.codeIntervalFn),this.codeIntervalFn=null)}))},beforeDestroy:function(){this.stopExit&&clearTimeout(this.stopExit),this.clearInterval()}}),a=n,r=(s(825),s(0)),c=Object(r["a"])(a,i,o,!1,null,null,null);t["default"]=c.exports},593:function(e,t,s){var i=s(824);"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=s(19).default;o("444a00a4",i,!0,{sourceMap:!1,shadowMode:!1})},594:function(e,t,s){var i=s(826);"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=s(19).default;o("6351f9ea",i,!0,{sourceMap:!1,shadowMode:!1})},823:function(e,t,s){"use strict";s(593)},824:function(e,t,s){"use strict";s.r(t)},825:function(e,t,s){"use strict";s(594)},826:function(e,t,s){"use strict";s.r(t)},970:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ds-login-page"},[s("div",{staticClass:"ds-login-page-header"},[s("img",{staticClass:"logo",attrs:{src:e._f("imgFormat")(e.$logoSrc)}}),s("svg",{attrs:{viewBox:"0 50 500 35",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg"}},[s("path",{attrs:{fill:"#fff",d:"M 0 70 Q 87.5 47, 175 70 T 350 75 T 500 70 V 100 H 0 V 0"}})]),e._m(0)]),s("div",{staticClass:"ds-login-page-body",style:e.bodyStyle},[e.tabs.length>1?s("div",{staticClass:"ds-login-page-tab-header"},[s("i",{ref:"tabBar",style:e.tabPositions[e.tabActive]}),e._l(e.tabs,(function(t){return[s("div",{key:t.code,ref:"tabs",refInFor:!0,staticClass:"ds-login-page-tab-header-item",class:{active:e.tabActive==t.code},on:{click:function(s){return e.tabClick(t)}}},[e._v(" "+e._s(t.name)+" ")])]}))],2):e._e(),s("div",{staticClass:"ds-login-page-tab-body"},[e._t("default",(function(){return[e._l(e.tabs,(function(t){return["username"===t.code?["username"==e.tabActive?s("div",{key:t.code,staticClass:"ds-login-page-tab-body-item"},[s("form",{staticClass:"ds-login-page-form",on:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"ds-login-page-form-item"},[s("i",{staticClass:"beforeIcon iconfont icon-wodexuanzhong"}),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.username,expression:"username",modifiers:{trim:!0}}],attrs:{placeholder:e.userNamePlaceholder,type:"text",name:"username",autocomplete:"off"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"ds-login-page-form-item isPassword"},[s("i",{staticClass:"beforeIcon iconfont icon-password1"}),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.password,expression:"password",modifiers:{trim:!0}}],attrs:{placeholder:e.passwordPlaceholder,type:e.showPasswordText?"text":"password",name:"password",autocomplete:"off"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),s("i",{staticClass:"afterIcon iconfont",class:["icon-icon-"+(e.showPasswordText?"visible":"invisible")],on:{click:function(t){e.showPasswordText=!e.showPasswordText}}})]),s("div",{staticClass:"ds-login-page-form-item hasCode"},[s("img-code",{attrs:{src:e.codeUrl,placeholder:e.codePlaceholder,state:e.codeState},on:{changeCode:e.updateCodeUrl},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),e._t("loginBtBefore"),s("div",{staticClass:"ds-login-page-form-submit",on:{click:e.submitByUsername}},[e._v("登 录")]),e._t("loginBtAfter"),s("input",{staticStyle:{display:"none"},attrs:{type:"submit"},on:{click:e.submitByUsername}})],2)]):e._e()]:"phone"===t.code?["phone"==e.tabActive?s("div",{key:t.code,staticClass:"ds-login-page-tab-body-item"},[s("form",{staticClass:"ds-login-page-form",on:{submit:function(e){e.preventDefault()}}},[s("div",{staticClass:"ds-login-page-form-item"},[s("i",{staticClass:"beforeIcon iconfont icon-lianxidianhua"}),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.phoneNumber,expression:"phoneNumber",modifiers:{trim:!0}}],attrs:{type:"tel",name:"phoneNumber",maxlength:"20",autocomplete:"off",placeholder:e.phonePlaceholder},domProps:{value:e.phoneNumber},on:{input:function(t){t.target.composing||(e.phoneNumber=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"ds-login-page-form-item"},[s("div",{staticClass:"getCodeBt",class:[e.codeBtType],on:{click:function(t){return t.stopPropagation(),e.getCode.apply(null,arguments)}}},[e._v(" "+e._s(""!=e.codeBtType?e.countdownTime+"s后重新获取":"获取验证码")+" ")]),s("i",{staticClass:"beforeIcon iconfont icon-yanzhengma1"}),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.phoneCode,expression:"phoneCode",modifiers:{trim:!0}}],staticStyle:{"{'paddingRight'":"'2.4rem'}"},attrs:{type:"email",name:"phoneCode",maxlength:"12",autocomplete:"off",placeholder:e.SMSCodePlaceholder},domProps:{value:e.phoneCode},on:{input:function(t){t.target.composing||(e.phoneCode=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),e._t("loginBtBefore"),s("div",{staticClass:"ds-login-page-form-submit",on:{click:e.submitByPhone}},[e._v("登 录")]),e._t("loginBtAfter"),s("input",{staticStyle:{display:"none"},attrs:{type:"submit"},on:{click:e.submitByPhone}})],2)]):e._e()]:s("div",{key:t.code,staticClass:"ds-login-page-tab-body-item"},[e._t(t.code)],2)]}))]}))],2),e.isForgotPassword?s("div",{staticClass:"forgot-password",on:{click:e.toForgotPassword}},[e._v("忘记密码?")]):e._e()]),e.openPrivacy?s("div",{staticClass:"login-box-privacy"},[e.privacyRequired?[s("van-checkbox",{attrs:{shape:"square"},model:{value:e.privacyChecked,callback:function(t){e.privacyChecked=t},expression:"privacyChecked"}},[e._v("我已阅读并同意")]),s("span",{staticClass:"content",attrs:{title:"点击查看"},on:{click:function(t){return t.stopPropagation(),e.lookPrivacy.apply(null,arguments)}}},[e._v("隐私协议")])]:[e._v("登录即表示您已阅读并同意"),s("span",{staticClass:"content",attrs:{title:"点击查看"},on:{click:e.lookPrivacy}},[e._v("隐私协议")])],s("van-dialog",{attrs:{title:"隐私协议",confirmButtonText:"同意并继续",closeOnClickOverlay:!0,className:"ds-login-page_privacy"},on:{confirm:e.privacyConfirmSure},model:{value:e.showPrivacyTip,callback:function(t){e.showPrivacyTip=t},expression:"showPrivacyTip"}},[e._v(" 为了更好地保障您的合法权益，请您阅读并同意"),s("span",{on:{click:e.lookPrivacy}},[e._v("隐私协议")])])],2):e._e()])},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ds-login-page-header-bg"},[s("div"),s("div"),s("div"),s("div")])}],n=s(4),a=s.n(n),r=s(1),c=s.n(r),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-verification-img-code"},[s("div",{staticClass:"login-verification-img-code-input"},[s("i",{staticClass:"beforeIcon iconfont icon-yanzhengma1"}),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.codeProxy,expression:"codeProxy",modifiers:{trim:!0}}],staticClass:"code-input",attrs:{disabled:e.disabled,type:"text",placeholder:e.placeholder,size:"medium",name:"code",autocomplete:"off"},domProps:{value:e.codeProxy},on:{input:function(t){t.target.composing||(e.codeProxy=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"img-code"},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.handleShow(!0),expression:"handleShow(true)"}],class:"success"===e.state?"img-code-success":"img-code-fail",attrs:{src:e.getImgSrc()},on:{click:e.handleChangeCode}}),s("svg",{directives:[{name:"show",rawName:"v-show",value:e.handleShow(!1),expression:"handleShow(false)"}],staticClass:"img-code-loading",attrs:{x:"0px",y:"0px",viewBox:"0 0 100 100"}},[s("path",{attrs:{fill:"gray",d:"M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50"}})])])])},l=[],u={props:{src:{type:String,default:""},value:{type:String,default:""},disabled:{type:Boolean},placeholder:{type:String},state:{type:String}},data:function(){return{srcProxy:"",isError:!1,failSrc:"data:image/png;base64,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"}},computed:{codeProxy:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{handleChangeCode:function(){this.$emit("changeCode")},handleShow:function(e){return e^"loading"===this.state},getImgSrc:function(){return"success"===this.state?this.src:this.failSrc}}},p=u,h=s(0),m=Object(h["a"])(p,d,l,!1,null,null,null),f=m.exports,w={name:"DsfMobilePlatformLogin",props:{tabs:{type:Array,default:function(){return[{code:"username",name:"账号登录"},{code:"phone",name:"验证码登录"}]}},isForgotPassword:{type:Boolean,default:!1},login:{type:Function,default:null},userNamePlaceholder:{type:String,default:"请输入账户名称"},passwordPlaceholder:{type:String,default:"请输入密码"},codePlaceholder:{type:String,default:"请输入验证码"},phonePlaceholder:{type:String,default:"请输入手机号"},SMSCodePlaceholder:{type:String,default:"请输入验证码"},imgCodeUrl:{type:String,default:"/code/imageBase64"},logo:{type:String,default:function(){return dsf.config.setting_public_mobile_login_logo||dsf.config.setting_public_mobile_logo_image||"~/static/img/mobile-logo-login.png"}},bottomBg:{type:String,default:function(){return dsf.config.setting_public_mobile_login_bottom_bg}}},components:{imgCode:f},data:function(){return this.openPrivacy="1"===dsf.config.setting_public_open_privacy,this.privacyRequired=!(!this.openPrivacy||"1"!==dsf.config.setting_public_privacy_required),{tabPositions:[],tabActive:null,codeBtType:"",countdownTimes:120,codeUrl:"",codeState:"",countdownTime:0,username:"",password:"",code:"",phoneNumber:"",phoneCode:"",showPasswordText:!1,privacyChecked:!this.privacyRequired,showPrivacyTip:!1}},computed:{bodyStyle:function(){var e={};if(this.bottomBg){var t=Vue.filter("imgFormat")(this.bottomBg);e["background-image"]='url("'.concat(t,'")')}return e},$logoSrc:function(){var e=this.logo||dsf.config.setting_public_mobile_login_logo||dsf.config.setting_public_mobile_logo_image||"";return this.$replace(dsf.url.getWebPath(e))}},created:function(){this.tabs.length&&(this.tabActive=this.tabs[0].code),this.updateCodeUrl()},mounted:function(){this.tabs.length>1&&this.resize(),window.addEventListener("resize",this.resize)},destroyed:function(){clearInterval(this.timeout),window.removeEventListener("resize",this.resize)},methods:{privacyConfirmSure:function(){var e;this.privacyChecked=!0,null===(e=this.privacyConfirmFn)||void 0===e||e.call(this)},lookPrivacy:function(){var e="<div class='ds-login-page_privacy' style='padding:0 16px'>"+(dsf.config.setting_public_privacy_content||"")+"</div>",t=this,s=[];this.privacyRequired&&!this.privacyChecked&&s.push({text:"同意",handler:function(){t.showPrivacyTip?(t.showPrivacyTip=!1,t.privacyConfirmSure()):t.privacyChecked=!0}}),this.$openDialog({title:"隐私协议",template:e,fullscreen:!0,width:"100%",height:"100%",cancelButtonText:"<van-icon name='arrow-left' />",showCancelButton:!0,btns:s,btnPosition:"bottom"})},toForgotPassword:function(){location.href=dsf.config.setting_mobile_public_forgot_password_page},resize:function(){var e,t=this;if(null!==(e=this.$refs.tabs)&&void 0!==e&&e.length){var s=100,i={};_.forEach(this.$refs.tabs,(function(e,o){var n=(e.offsetWidth-6)/s,a=e.offsetLeft+e.offsetWidth/2+"px";i[t.tabs[o].code]={display:"block",transform:"translateX(".concat(a,") scale3d(").concat(n,", 1, 1)")}})),this.tabPositions=i}},tabClick:function(e){var t=this,s=e.code;this.$refs.tabBar.style.transition="transform .2s ease-in-out",setTimeout((function(){t.tabActive=s,setTimeout((function(){t.$refs.tabBar.style.transition="none"}),210)}),0)},updateCodeUrl:function(){var e=this;this.codeState="loading";var t=this.imgCodeUrl;dsf.http.get(t,null,{cache:!1}).done((function(t){t.success?(e.codeId=t.data.id,e.codeUrl="data:image/png;base64,"+t.data.imageBase64,e.codeState="success"):(e.codeState="fail",dsf.layer.message(t.message))})).catch((function(){e.codeState="fail"}))},getCode:function(){var e=this;if(""==this.codeBtType)if(""!==this.phoneNumber)if(dsf.validate("isMobileOrTelPhone",this.phoneNumber)){var t=dsf.layer.loading(),s="/exam/login/t/getVerificationCode";this.$http.post(s,{phoneNumber:this.phoneNumber}).then((function(s){var i=s.data;i.success?(e.codeBtType="countdown",dsf.layer.closeLoading(t),e.doCountdown()):(dsf.layer.message(i.message||"未知错误",!1),dsf.layer.closeLoading(t))}))}else dsf.layer.message("手机号输入有误",!1);else dsf.layer.message("手机号不能为空！",!1)},doCountdown:function(){var e=this;this.countdownTime=this.countdownTimes-1,this.timeout=setInterval((function(){e.countdownTime--,e.countdownTime<=-1&&(e.codeBtType="",clearInterval(e.timeout))}),1e3)},submitByUsername:function(){var e=this;if(this.privacyConfirmFn=this.submitByUsername,this.login)"function"==dsf.type(this.login)&&this.login({username:this.username,password:this.password,code:this.code,type:"usernameAndPassword",privacyChecked:this.privacyChecked}).then((function(t){e.setStateIsLogin(t.data)}));else{if(""===this.username)return void dsf.layer.message("账号不能为空！",!1);if(""===this.password)return void dsf.layer.message("密码不能为空！",!1);if(""===this.code)return void dsf.layer.message("验证码不能为空！",!1);if(!this.privacyChecked)return void(this.showPrivacyTip=!0);this.loginByUsername()}},loginByUsername:function(){var e=this,t=dsf.layer.loading();this.$webAPI.login({userName:this.username,password:dsf.safe.passwordEncode(this.password),code:this.code||"good",loginType:10,codeId:this.codeId}).done((function(t){var s=t.success,i=t.message,o=t.data;s?e.setStateIsLogin(o):(e.updateCodeUrl(),dsf.layer.message(i,!1))})).error((function(t){e.updateCodeUrl(),t&&dsf.layer.message(t.message||"未知错误",!1)})).finally((function(){dsf.layer.closeLoading(t)}))},submitByPhone:function(){var e=this;if(this.privacyConfirmFn=this.submitByPhone,this.login)"function"==dsf.type(this.login)&&this.login({phoneNumber:this.phoneNumber,phoneCode:this.phoneCode,type:"phoneAndSMSCode",privacyChecked:this.privacyChecked}).then((function(t){t.success&&2e4==t.state?e.setStateIsLogin(t.data):dsf.layer.message(t.message,!1)}));else{if(""===this.phoneNumber)return void dsf.layer.message("手机号不能为空！",!1);if(!dsf.validate("isMobileOrTelPhone",this.phoneNumber))return void dsf.layer.message("手机号输入有误",!1);if(""===this.phoneCode)return void dsf.layer.message("验证码不能为空！",!1);if(!this.privacyChecked)return void(this.showPrivacyTip=!0);this.loginByPhone()}},loginByPhone:function(){var e=this,t="/exam/login/t/checkLogin";this.$http.post(t,{phoneNumber:this.phoneNumber,phoneCode:this.phoneCode,codeId:this.codeId}).done((function(t){var s=t.success,i=t.message,o=t.data;s?e.setStateIsLogin(o):(e.updateCodeUrl(),dsf.layer.message(i,!1))})).error((function(t){e.updateCodeUrl(),t&&dsf.layer.message(t.message||"未知错误",!1)})).finally((function(){dsf.layer.closeLoading(loading)}))},setStateIsLogin:function(e){var t=this;return a()(c.a.mark((function s(){var i,o,n,a,r,d;return c.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=e.groupGo,o=t.$root.getAppId(),n="",a=t.$route.query.from,i&&(r=dsf.url.parse(i),r.searchQuery["appid"]&&(o=r.searchQuery["appid"],delete r.searchQuery["appid"]),n=(r.protocol?r.origin:r.hostname)+r.pathname+(dsf.isEmptyObject(r.searchQuery)?"":"?"+dsf.url.queryStringStringify(r.searchQuery))+r.hash),s.next=7,t.$root.initApp(o);case 7:d=function(){if(a)n=decodeURIComponent(a);else{n||(n=window.location.pathname,window.location.search&&(n+=window.location.search));var e=dsf.url.parse(n);!e.hash&&t.$root.navs.length&&(n+="#"+t.$root.navs[0].href),location.replace(n)}},!dsf.client.weixin()&&window.$sharedPreferences?$sharedPreferences.save({userId:dsf.session.get("userId"),loginName:t.username,password:""},d,(function(e){})):d();case 9:case"end":return s.stop()}}),s)})))()}}},g=w,v=Object(h["a"])(g,i,o,!1,null,null,null);t["default"]=v.exports}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_mobile_login_module.js.map