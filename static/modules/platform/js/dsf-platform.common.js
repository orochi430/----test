/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define("platform",[],e):"object"===typeof exports?exports["platform"]=e():t["platform"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=258)}({1:function(t,e,n){var i=n(27)();t.exports=i;try{regeneratorRuntime=i}catch(a){"object"===typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},10:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s}));var i=n(2),a=n.n(i);function r(t,e,n,i){var a=t.$options.mixins,r=[];if(_.each(a,(function(t){if(dsf.isFunction(t[e])){var n=t[e];r.push(n)}})),dsf.isFunction(t.$options[e])){var o=t.$options[e];r.push(o)}var s=0,l=function e(a,o){if(r[s]){var l=r[s];i&&(l=i(r[s]).bind(t)),l.apply(t,n).then((function(t){s++,e(a,o)})).catch((function(t){o(t)}))}else a()};return new Promise((function(t,e){l(t,e)}))}function o(t){return function(){var e=this,n=Array.prototype.slice.call(arguments);return new Promise((function(i,r){if(t){var o=function(t){!1===t?r({type:"nextFalse",message:""}):dsf.isError(t)?r(t):i()};n=n||[],t&&t&&t.apply(e,[o].concat(a()(n)))}else i()}))}}function s(t){return function(){var e=Array.prototype.slice.call(arguments),n=this;return new Promise((function(i,a){if(t){var r=function(t){!1===t?a({type:"nextFalse",message:""}):dsf.isError(t)?a(t):i(e)};t.apply(n,e.concat([r]))}else i()}))}}},12:function(t,e,n){"use strict";n.r(e);var i=n(2),a=n.n(i);function r(t){if(!t)return{};if(!t.active){var e=t.color,n=t.image,i=t.size,a=t.repeat,r=t.position;return n=this.$replace(n,this.local),{"background-color":e,"background-image":"url('".concat(dsf.url.getWebPath(n),"')"),"background-size":i,"background-repeat":a,"background-position":r}}var o=t.active,s=t.color,l=t.pattern,u=t.linear,d=t.radial;switch(o){case"color":var c=s.isTheme,f=s.theme,h=s.value;return{"background-color":c?"var(--t--".concat(f,")"):h};case"pattern":return{"background-image":"url('".concat(dsf.url.getWebPath(l.image),"')"),"background-size":l.size,"background-repeat":l.repeat,"background-position":l.position};case"linear":var p=u.point.map((function(t){var e=t.length,n=t.color;return"".concat(n," ").concat(e,"%")})).join(",");return{background:"linear-gradient(".concat(u.angle,"deg, ").concat(p,")")};case"radial":var v=d.point.map((function(t){var e=t.length,n=t.color;return"".concat(n," ").concat(e,"%")})).join(","),m=d.position.map((function(t){return t+"%"})).join(" ");return{background:"radial-gradient(".concat(d.shape," ").concat(d.size," at ").concat(m,", ").concat(v,")")}}}function o(){!this.isDesign&&this.designId&&d(this)&&(this.dataHashWatch=this.$watch((function(){return this.$dataHash}),(function(t,e){t&&(e&&u.call(this,e),l.call(this))}),{immediate:!0}))}function s(){var t;1==(null===this||void 0===this||null===(t=this.$el)||void 0===t?void 0:t.nodeType)&&(this.$options.ctrlType&&this.$el.setAttribute("ctrl_type",this.$options.ctrlType),this.isDesign?this.$designId?this.$el.setAttribute("id","des-"+this.$designId):this.$el.removeAttribute("id"):(this.anchorKey?this.$el.setAttribute("anchor-key",this.anchorKey):this.$el.removeAttribute("anchor-key"),this.$designId?this.$el.setAttribute("des-id",this.$designId):this.$el.removeAttribute("des-id")))}function l(){var t=this.$designId;if(this.$vm){var e=this.$vm.$controls[t];if(e||(e=dsf.mix(!0,{},this.$vm.$controls[this.designId]),this.$vm.$set(this.$vm.$controls,t,e)),this.$list&&this.$list.updateSubControls){var n=this.$list.updateSubControls(e,this,this.local);n&&(e=n),this.$vm.$set(this.$vm.$controls,t,e)}this.$vm.$controlsRef||(this.$vm.$controlsRef={}),this.$vm.$controlsRef[t]||(this.$vm.$controlsRef[t]=[]),this.$vm.$controlsRef[t].push(this)}}function u(t){var e,n=null===this||void 0===this||null===(e=this.$list)||void 0===e?void 0:e.virtualScroll,i=this.designId+"-"+(t||this.local.$hash);this.$vm&&this.$vm.$controlsRef&&(dsf.array.remove(this.$vm.$controlsRef[i],this),this.$vm.$controlsRef[i]&&this.$vm.$controlsRef[i].length<=0&&(n||delete this.$vm.$controls[i],delete this.$vm.$controlsRef[i])),this.$list&&this.$list.removeSubControls&&this.$list.removeSubControls(this,t)}function d(t){return!!(t.$vm&&t.local&&dsf.hasOwn(t.local,"$hash")&&t.designId)}function c(){if(this.$props)for(var t in this.$props)f.call(this,this.$props,t)}function f(t,e){var n=this;Object.defineProperty(this,e,{set:function(t){n.$emit("update:"+e,t)},get:function(){return n.$props[e]}})}e["default"]={inject:{$designer:{default:null},$vm:{default:null},$page:{default:null},$form:{default:null},$dialog:{default:null},$list:{default:null},$sublistContent:{default:null},$dynamicForm:{default:null},$layoutTree:{default:null},$isMobile:{default:!1},$homePanel:{default:null}},comments:!0,props:{isDsf:{type:Boolean,default:!0},isBusiness:{type:Boolean,default:!1},isDesign:{type:Boolean,default:!1},designId:{type:String,default:""},caption:{type:String,default:""},visible:{type:Boolean,default:!0},forceHidden:{type:Boolean,default:!1},metadata:{type:Object,default:function(){return null}},classList:{type:Array,default:function(){return[]}},noPadding:{type:Boolean,default:function(){return!1}},slots:{type:Array,default:function(){return[]}},tbNoPadding:{type:Boolean,default:!1},lrNoPadding:{type:Boolean,default:!1},local:{type:Object,default:function(){return null}},staticValue:{type:[String,Boolean,Number,Date,Array,Object],default:function(){return null}},backgroundConfig:{type:Object,default:null},isBlockControl:{type:Boolean,default:!1},development:{type:Object,default:function(){return{attrs:{}}}},anchorKey:{type:String,default:""},designerInfo:{type:[String,Number,Boolean,Array,Object],default:function(){return null}},metadataAttach:{type:Object,default:function(){return{}}},defer:{type:[String,Number],default:"inited"},designProxy:{type:Boolean,default:!1},designDisabledProps:{type:Array,default:function(){return null}},designOnlySlot:{type:Boolean,default:!1},designInductionSlot:{type:[Function,Array,Boolean],default:function(){return!0}},designShowMarkCaption:{type:Boolean,default:!1},designShowMarkInfo:{type:Boolean,default:!0},designShowMarkRemove:{type:Boolean,default:!0},designShowMarkDragDrop:{type:Boolean,default:!0},desCopyedChangeCaption:{type:[Boolean,String],default:!0}},computed:{slotsMap:function(){return _.keyBy(this.slots,"name")},getCss:function(){return this.$getClass()},getBackgroundStyle:function(){return r.call(this,this.backgroundConfig)},props:function(){var t=this.$vm;if(t&&!this.isDesign){var e="";return this.designId?(e=this.$designId,t.$controls[e]):null}},$designId:function(){return this.designId+(this.$dataHash?"-"+this.$dataHash:"")},queryString:function(){var t,e;return this.$vm?(null===this||void 0===this||null===(t=this.$vm)||void 0===t?void 0:t.queryString)||{}:(null===this||void 0===this||null===(e=this.$route)||void 0===e?void 0:e.query)||{}},$dataHash:function(){return this.local&&dsf.hasOwn(this.local,"$hash")&&this.$list?this.local["$hash"]:null},$isPrototype:function(){var t;return(null===this||void 0===this||null===(t=this.$page)||void 0===t?void 0:t.mode)==dsf.enums.viewMode.PROTOTYPE},$isUseStaticData:function(){return this.$isPrototype&&this.staticValue}},data:function(){return{}},beforeCreate:function(){},created:function(){this.isDesign&&c.call(this),this.$dispatch("created",this),o.call(this)},mounted:function(){s.call(this),this.$dispatch("mounted",this)},updated:function(){s.call(this),this.$dispatch("updated",this)},beforeDestroy:function(){this.dataHashWatch&&this.dataHashWatch(),!this.isDesign&&d(this)&&u.call(this,this.local.$hash),this.$dispatch("before-destroy",this)},destroyed:function(){this.$dispatch("destroy",this)},methods:{$getControlInSlot:function(t,e){var n,i=null===this||void 0===this||null===(n=this.slotsMap)||void 0===n||null===(n=n[t])||void 0===n?void 0:n.controls;return e&&(i=_.filter(i,e)),i},$addCustom:function(t,e){var n,i;null===this||void 0===this||null===(n=this.$vm)||void 0===n||null===(i=n.$addCustom)||void 0===i||i.call(n,t,e)},$removeCustom:function(t){var e,n;null===this||void 0===this||null===(e=this.$vm)||void 0===e||null===(n=e.$removeCustom)||void 0===n||n.call(e,t)},$clearCustom:function(t){var e,n;null===this||void 0===this||null===(e=this.$vm)||void 0===e||null===(n=e.$clearCustom)||void 0===n||n.call(e,t)},$dispatch:function(t,e){var n={target:this,name:t,args:e};this.$emit(t,n)},$dispatchTo:function(t,e,n){var i={target:this,name:e,args:n};h.dispatch.call(this,t,e,i)},removeClass:function(t){var e=this;t="array"==dsf.type(t)?t:[t],_.each(t,(function(t){return dsf.array.remove(e.classList,t)}))},addClass:function(t){var e=this;t="array"==dsf.type(t)?t:[t],_.each(t,(function(t){return dsf.array.ensure(e.classList,t)}))},clearClass:function(){var t=this;_.eachRight(this.classList,(function(e,n){dsf.array.removeAt(t.classList,n)}))},postBefore:function(){return new Promise((function(t,e){t()}))},$getClass:function(t){var e=a()(this.classList);return this.visible&&!this.forceHidden||e.push(this.isDesign?"ds-design-hide":"ds-hide"),this.noPadding&&e.push("ds-no-padding"),this.tbNoPadding&&e.push("ds-top-bottom-no-padding"),this.lrNoPadding&&e.push("ds-left-right-no-padding"),e},$getSlot:function(t){var e=_.filter(this.slots,(function(e){return e.name==t}));return e[0]?e[0]:null},$childrenReloadData:function(){var t=[];this.$vm&&this.$vm.$data._isLayoutView&&t.push.apply(t,a()(this.$vm.reloadList));var e=[];_.each(this.$children,(function(n){t.indexOf(n)<0&&e.push(n)})),_.each(e,(function(t){var e;null===t||void 0===t||null===(e=t.reloadData)||void 0===e||e.call(t)}))},$colorFormat:function(t){return r.call(this,t)},$compileColor:function(t){if(!t)return"";"theme"!=t&&"theme-linear"!=t||(t="@normal");var e=t.replace(/^(theme:|@)/,"");return t!=e?"var(--t--".concat(e,")"):t},$getCaptionCtrl:function(){var t=this;while(!t.caption&&t.$parent)t=t.$parent;if(t.caption)return t}},watch:{},design:{dataPropKey:"value",staticDataPropKey:"staticValue",isMask:!0,toolButtons:{infoButton:!0,dragButton:!0,removeButton:!0,settingButton:!0},showCaption:!1,settingMenus:function(){return[{text:"保存为业务组件",command:"save-business",handler:function(){this.$designer.saveBusinessComponentSingle(this,"")},hidden:function(){return!(null!==this&&void 0!==this&&this.$designer.$allowSaveBusinessControl)}}]},settingButtonHandler:null,fit:!1,layout:{isDeep:!0,unnecessary:["isDsf","development","staticValue","classList","forceHidden","defer","noPadding","lrNoPadding","tbNoPadding","backgroundConfig","development","designDisabledProps","designOnlySlot","desCopyedChangeCaption","designShowMarkDragDrop","designShowMarkRemove","designShowMarkInfo","designShowMarkCaption","designInductionSlot"],include:[],exclude:[],nameValidate:!0,accpetContextData:!1,attachAttributes:{},attachSlot:[]},defaultInitProps:function(){return{}},metadata:{isDeep:!0,isRoot:!0,create:function(){}},toMobile:{getMobileControl:function(){var t=["slots","isDesign","ctrlName","ctrlType"],e=dsf.designer.createMobileComponent(this.ctrlType,{},!0);if(e){var n=dsf.mix(!0,{},this.$props);for(var i in n)t.includes(i)||dsf.isDef(e[i])&&dsf.isDef(n[i])&&(e[i]=n[i]);e.designId=dsf.uuid(),e.metadata&&delete e.metadata.content}return e}}}};var h={broadcast:function(t){function e(e,n,i){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e,n){this.$children.forEach((function(i){var a=i.$options._componentTag;a===t?i.$emit.apply(i,[e].concat(n)):broadcast.apply(i,[t,e].concat([n]))}))})),dispatch:function(t,e,n){var i=this.$parent||this.$root,a=i.$options._componentTag;while(i&&(!a||a!==t))i=i.$parent,i&&(a=i.$options._componentTag);i&&i.$emit.apply(i,[e].concat(n))}}},14:function(t,e,n){var i=n(15);function a(t,e){if(t){if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}t.exports=a,t.exports.__esModule=!0,t.exports["default"]=t.exports},15:function(t,e){function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},16:function(t,e,n){var i=n(9)["default"],a=n(25);function r(t){var e=a(t,"string");return"symbol"==i(e)?e:String(e)}t.exports=r,t.exports.__esModule=!0,t.exports["default"]=t.exports},18:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n.n(i),r=n(2),o=n.n(r),s=n(1),l=n.n(s),u=n(12),d="model-value-mutation",c="update:value",f=_.debounce((function(t){var e,n;null===t||void 0===t||null===(e=t.$list)||void 0===e||null===(n=e.rowDataChange)||void 0===n||n.call(e,t.local)}),100);function h(){var t;1==(null===this||void 0===this||null===(t=this.$el)||void 0===t?void 0:t.nodeType)&&this.$el.setAttribute("form-name",this.$formName)}function p(){var t;if(null!==this&&void 0!==this&&null!==(t=this.metadata)&&void 0!==t&&t.validate){var e=this.metadata.validate.config,n=this.metadata.validate.rules,i=1,a=!1;if(this.metadata.validate.version&&this.metadata.validate.version>=i)return;if(this.metadata.validate.version=i,a=!0,e&&(!n||n.length<=0)){var r=[],o=function(t){var n=e[t];if(n.required){var i={attr:t,type:"required",minLength:"",maxLength:"",numberMax:"",numberMin:"",precision:"",arrayMin:"",arrayMax:"",express:"",expressName:""};i.errorMsg=n.errorMsg["required"],i.triggerExpress="",r.push(i)}if(n.express){var a,o={attr:t,type:"express",minLength:"",maxLength:"",numberMax:"",numberMin:"",precision:"",arrayMin:"",arrayMax:""};return o.express=n.express,o.expressName=(null===(a=n.expressName)||void 0===a?void 0:a[0])||"",o.errorMsg=n.errorMsg["express"],o.triggerExpress="",r.push(o),1}if(n.isNumber){var s={attr:t,type:"number",minLength:"",maxLength:"",numberMax:"",numberMin:"",precision:"",arrayMin:"",arrayMax:"",express:"",expressName:""};s.errorMsg=n.errorMsg["isNumber"],s.triggerExpress="",r.push(s);var l=["precision","numberMax","numberMin"];_.each(l,(function(e){if(n[e]){var i={attr:t,type:"number",minLength:"",maxLength:"",numberMax:"",numberMin:"",precision:""};i[e]=n[e],i.arrayMin="",i.arrayMax="",i.express="",i.expressName="",s.triggerExpress="",i.errorMsg=n.errorMsg[e],r.push(i)}}))}else{var u=["min","max"];_.each(u,(function(e){var i={attr:t,type:"string"};i.minLength="min"==e?n[e]:"",i.maxLength="max"==e?n[e]:"",i.numberMax="",i.numberMin="",i.precision="",i.arrayMin="",i.arrayMax="",i.express="",i.expressName="",rule.triggerExpress="",i.errorMsg=n.errorMsg[e],r.push(i)}))}};for(var s in e)o(s);delete this.metadata.validate.config,this.metadata.validate.rules=r}else a&&n&&n.length&&n.forEach((function(t){"express"==t.type&&"string"!=dsf.type(t.errorMsg)&&(t.errorMsg=t.errorMsg[t.type]),"array"==dsf.type(t.expressName)&&t.expressName.length&&(t.expressName=t.expressName[0])}))}}function v(){var t=this;this.$openDialog({title:"数据维护",content:"DesStaticDataFormItem",width:"70vw",height:"60vh",params:{designer:this.$designer,value:t.staticValue||[],owner:this},btns:[{text:"确定",handler:function(e){var n=null===e||void 0===e?void 0:e.yes();if(t.caption&&n){var i=t.metadata.valueAttributes;if(i.length>0)if(1==i.length){var a=i[0],r=n[a.code];t.staticValue=r}else t.staticValue=n}}},{text:"清除",handler:function(){t.staticValue=null}},{text:"取消"}]})}function m(){var t,e,n,i=this;if(!this.isDesign&&null!==this&&void 0!==this&&null!==(t=this.$vm)&&void 0!==t&&t.$registerUFUNC&&null!==this&&void 0!==this&&null!==(e=this.formula)&&void 0!==e&&null!==(e=e.formula)&&void 0!==e&&null!==(n=e.trim)&&void 0!==n&&n.call(e))return dsf.ufunc(this.formula).then((function(t){var e,n=(null===i||void 0===i||null===(e=i.$vnode)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.model)||{},a=n.expression,r=n.callback;n.value;if(a){var o,s,l={immediate:i.formulaImmediate,local:i.local,model:{callback:r,expression:a},expression:t.expression,computed:t.computed};null===i||void 0===i||null===(o=i.$vm)||void 0===o||null===(s=o.$registerUFUNC)||void 0===s||s.call(o,i.$designId,l)}}))}function g(){if(!this.isDesign&&this.$vm)for(var t=this.metadata.validate,e=(null===t||void 0===t?void 0:t.rules)||[],n=0;n<e.length;n++){var i,a,r,o=e[n],s=o.triggerExpress;null===this||void 0===this||null===(i=this.$vm)||void 0===i||null===(a=(r=i).$addFormValidateUpdateWatch)||void 0===a||a.call(r,this.$formName,s,{self:this})}}function y(){if(!this.isDesign&&this.$vm)for(var t=this.metadata.validate,e=(null===t||void 0===t?void 0:t.rules)||[],n=0;n<e.length;n++){var i,a,r,o=e[n],s=o.triggerExpress;null===this||void 0===this||null===(i=this.$vm)||void 0===i||null===(a=(r=i).$removeFormValidateUpdateWatch)||void 0===a||a.call(r,this.$formName,s)}}function $(){m.call(this),g.call(this)}function b(){y.call(this)}e["default"]={model:{prop:"value",event:d},inject:{$formLayoutBox:{default:null}},props:{isAcceptIsView:{type:Boolean,default:!0},isFormControl:{type:Boolean,default:!0},label:{type:String,default:""},showLabel:{type:Boolean,default:!0},readOnly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},allowPost:{type:Boolean,default:!0},required:{type:Boolean,default:!1},value:{type:[String,Number,Object,Array,Boolean,Date],default:function(){return null}},tabIndex:{type:String,default:""},dataCapion:{type:String,default:""},showDataCaptionIcon:{type:Boolean,default:!0},showDataCaptionTrigger:{type:String,default:"click"},showDataCaptionMode:{type:String,default:"popover"},metadata:{type:Object,default:function(){return null}},readOnlyShowText:{type:String,default:"text"},metadata_fullcode:{type:String,default:""},simple:{type:Boolean,default:!1},formatter:{type:String,default:""},validateRule:{type:String,default:""},isValidate:{type:Boolean,default:!0},colSpan:{type:[String,Number],default:""},enabledLabelWidth:{type:Boolean,default:!1},labelWidth:{type:Number,default:120},textProxy:{type:Boolean,default:!1},textProxyIcon:{type:String,default:""},textProxyIconColor:{type:String,default:""},controlMode:{type:String,default:"normal"},showBorder:{type:Boolean,default:!0},formula:{type:Object,default:function(){return{formula:"",func:"",realFormula:""}}},intersectionWatch:{type:Boolean,default:!1},formulaImmediate:{type:Boolean,default:!1},inputAlign:{type:String,default:"left"},disabledIgnoreValidate:{type:Boolean,default:!1},outputWordStr:{type:String,default:""},forLabel:{type:[String,Array],default:""},designShowMarkInfo:{type:Boolean,default:!0},designShowMarkCaption:{type:Boolean,default:!0}},data:function(){return this.vmValidateErrorWatch=null,{gridRowChangeKey:"change",_errors:[],inClient:!0}},mixins:[u["default"]],computed:{$metaDataLevel:function(){var t;return(null===this||void 0===this||null===(t=this.metadata)||void 0===t?void 0:t.level)||0},validating:function(){var t;return null===this||void 0===this||null===(t=this.$form)||void 0===t?void 0:t.validating},errors:{get:function(){return this.$data._errors.filter((function(t){var e;return!(null!==t&&void 0!==t&&null!==(e=t.info)&&void 0!==e&&e.ignore)}))},set:function(t){this.$data._errors=t}},getCss:function(){var t=[];if(!this.isDesign){var e,n="";if(this.isFormControl&&this.$formLayoutBox&&this.$parent==this.$formLayoutBox)if(dsf.global.$isMobile)n=24,t=["van-col","van-col--"+n];else n=this.colSpan?this.colSpan:null===(e=this.$formLayoutBox)||void 0===e?void 0:e.colSpan,parseInt(n||0)&&(t=["el-col","el-col-"+n])}var i=this.errors&&this.errors.length>0;return[].concat(o()(this.$getClass()),[i?"ds-error":"",this.showLabel?"ds-has-label":"",this.required?"ds-required":"",this.$$readOnly?"ds-readonly":"",!this.showLabel&&this.required?"ds-nolabel-required":"",this.$$disabled?"ds-disabled":"",this.showBorder?"":"ds-no-border","left"!=this.inputAlign?"input-align-"+this.inputAlign:"",this.simple?"ds-form-item-simple":""],o()(t))},errorsMsg:function(){return _.map(this.errors,"message").join(",")},$fontSize:function(){var t=dsf.themeConfig.setting,e=t.fontSize,n=t.fontSizeMap;return n[e]||(dsf.isNumber(e)?e:0)},$labelWidth:function(){var t=dsf.themeConfig.setting.fontSize,e=0;e=this.enabledLabelWidth?this.labelWidth:this.$page?this.$page.formItemLabelWidth||this.labelWidth||120:this.labelWidth;var n={bigFont:10,bigFont_1:20,bigFont_2:30,bigFont_3:40};return e+=(n[t]||0)+this.$fontSize/2,e},$formItemLabelAlign:function(){var t;return(null===(t=this.$page)||void 0===t?void 0:t.formItemLabelAlign)||"config"},formName:function(){return this.$attrs["form-name"]||this.metadata_fullcode||""},$formName:function(){var t=this.formName;return t?this.formName+(this.$dataHash?"-"+this.$dataHash:""):""},$$disabled:function(){return this.disabled},$$readOnly:function(){return this.readOnly}},created:function(){!this.isDesign&&this.$vm&&this.$vm.$addFiled(this),!this.isDesign&&this.$dynamicForm&&this.$dynamicForm.$addFiled(this),this.isDesign&&this.metadata&&(this.metadata.isFromMetaData?this.metadata.$isValidate=!1:this.metadata.$isValidate=!0),!this.isDesign&&this.intersectionWatch&&(this.inClient=!1),this.isDesign||(this.vmValidateErrorWatch=this.watchVmFormValidateErrors()),p.call(this)},mounted:function(){h.call(this)},updated:function(){h.call(this)},beforeDestroy:function(){!this.isDesign&&this.$vm&&this.$vm.$removeFiled(this),!this.isDesign&&this.$dynamicForm&&this.$dynamicForm.$removeFiled(this),b.call(this),this.vmValidateErrorWatch&&this.vmValidateErrorWatch()},methods:{showHelper:function(t){var e={title:"填写说明",template:'<div v-html="dsf.safe.xss(params.value)"></div>',width:"30vw",height:"50vh",params:{value:this.dataCapion}},n=dsf.mix(!0,e,t);this.$openDialog(n)},getLabelWidth:function(t){return t?this.pxToRem(this.$labelWidth+"px"):this.$labelWidth+"px"},getLabelWidthStyle:function(t){return t?this.$labelWidth&&this.showLabel?{width:this.pxToRem(this.$labelWidth+"px")}:{}:this.$labelWidth&&this.showLabel?{width:this.$labelWidth+"px"}:{}},getFormItemBlockMarginLeft:function(){return this.$labelWidth&&this.showLabel?{"margin-left":this.$labelWidth+"px"}:{}},getShowContent:function(){return"object"==dsf.type(this.value)?this.value[this.readOnlyShowText]:"array"==dsf.type(this.value)?_.map(this.value,this.readOnlyShowText).join(","):this.value},$emitValueChange:function(t){t=this.$filterInValidMetaDataValueAttrs(t),this.isTrim&&dsf.isString(t)&&(t=t.trim());var e=this.$listeners||{};e[d]?this.$emit(d,t):e[c]&&this.$emit(c,t)},emitFormValidate:function(t,e){var n=this;return a()(l.a.mark((function t(){var i,a;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.$form){t.next=7;break}if(a=null,n.$list&&(a=n.local.$index),null===n||void 0===n||null===(i=n.$vm)||void 0===i||!i.validateField){t.next=7;break}return t.next=6,n.$vm.validateField(n.value,dsf.isDef(e)?e:a,n);case 6:return t.abrupt("return",t.sent);case 7:return t.abrupt("return",[]);case 8:case"end":return t.stop()}}),t)})))()},emitValueChange:function(t){this.$emitValueChange(t),this.$dispatchValueChange(t)},$dispatchValueChange:function(t){this.$dispatch("value-change",t)},$dispatch:function(t,e){var n,i,a,r=this;(u["default"].methods.$dispatch.call(this,t,e),this.isDesign||this.$isPrototype)||this.$list&&t==this.gridRowChangeKey&&null!==(n=this.local)&&void 0!==n&&n.$hash&&(1!=(null===this||void 0===this||null===(i=this.metadata)||void 0===i?void 0:i.level)&&this.$list.isRowDataChangePost?this.$nextTick((function(){var t;r.$vm.removeErrorsByRowHash(null===(t=r.local)||void 0===t?void 0:t.$hash),r.emitListRowChange()})):1==(null===this||void 0===this||null===(a=this.metadata)||void 0===a?void 0:a.level)&&this.$nextTick((function(){r.emitListRowChange()})))},emitListRowChange:function(){f(this)},$filterInValidMetaDataValueAttrs:function(t){var e,n=this,i=_.map((null===this||void 0===this||null===(e=this.metadata)||void 0===e?void 0:e.valueAttributes)||[],(function(t){return t.code}));if(i.length>1)if(dsf.isObject(t))for(var a in t)~i.indexOf(a)||delete t[a];else dsf.isArray(t)&&_.each(t,(function(t){n.$filterInValidMetaDataValueAttrs(t)}));return t},watchVmFormValidateErrors:function(){return this.$watch((function(){var t;return null===this||void 0===this||null===(t=this.$vm)||void 0===t||null===(t=t.$errors)||void 0===t?void 0:t[this.$formName]}),(function(t,e){var n;this._data._errors.splice(0,this._data._errors.length);var i,a=(null===(n=this.$vm)||void 0===n||null===(n=n.$errors)||void 0===n?void 0:n[this.$formName])||[];a&&a.length>0&&(i=this._data._errors).push.apply(i,o()(a))}),{immediate:!0})}},watch:{caption:{handler:function(t,e){this.isDesign&&this.metadata&&(this.metadata._isValidate=!0)}},"$vm.$isReady":{handler:function(t,e){!0===t&&$.call(this)},immediate:!0}},design:{toolButtons:{infoButton:!0,settingButton:!0},settingMenus:function(){return[{text:"校验规则",command:"validate-rules",handler:function(){dsf.designer.triggerDialogPropty("metadata.validate")},hidden:function(){return this.isOneToMany}},{text:"默认值",command:"default-value",handler:function(){dsf.designer.triggerDialogPropty("metadata.defaultValue")},hidden:function(){return this.isOneToMany}},{text:"静态数据维护",command:"static-editor",handler:v,hidden:function(){return!this.$isPrototype}},{text:"保存为业务组件",command:"save-business",handler:function(){this.$designer.saveBusinessComponentSingle(this,this.label)},hidden:function(){return!(null!==this&&void 0!==this&&this.$designer.$allowSaveBusinessControl)}}]},showCaption:!0,settingButtonHandler:null,layout:{exclude:["value"],unnecessary:["isAcceptIsView","allowPost","required","tabIndex","dataCapion","showDataCaptionIcon","showDataCaptionTrigger","showDataCaptionMode","dataAudioUrl","dataVideoUrl","readOnlyShowText","metadata_fullcode","simple","validateRule","isValidate","colSpan","enabledLabelWidth","labelWidth","textProxy","textProxyIcon","textProxyIconColor","controlMode","showBorder","formula","intersectionWatch","formulaImmediate","disabledIgnoreValidate","outputWordStr","forLabel","staticValue"]},metadata:{include:null,exclude:["ctrlType","ctrlName","value","items","readOnly","metadata","metadata_fullcode","textProxy","disabled","validateRule","labelWidth","metaDataLevel","visible","noPadding","slots","tbNoPadding","lrNoPadding","local","development","designProxy","designOnlySlot","designInductionSlot","designShowMark","designShowMarkInfo","designShowMarkCaption","designShowMarkDragDrop","designShowMarkRemove","desCopyedChangeCaption","designDisabledProps","designId","isDesign","classList","showLabel","visible"],create:function(t){var e,n,i,a=this;this.metadata||(this.metadata={});var r=null===this||void 0===this||null===(e=this.$el)||void 0===e||null===(n=e.closest)||void 0===n?void 0:n.call(e,".ds-design-hide");this.metadata.hidden=!!r||(!this.visible||!this.forceHidden),this.metadata.required=this.required;var s,l,u=dsf.getComponentMixins(this.$options),d=null===this||void 0===this||null===(i=this.$options)||void 0===i||null===(i=i.design)||void 0===i?void 0:i.metadata,c=[],f=[];d.include&&(s=f).push.apply(s,o()(d.include));d.exclude&&(l=c).push.apply(l,o()(d.exclude));var h=dsf.mix(!0,{},this.metadata.validate);_.each(u,(function(t){var e,n,i=null===t||void 0===t||null===(e=t.design)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.exclude;i&&i.length>0&&(c=i.concat(c));var a=null===t||void 0===t||null===(n=t.design)||void 0===n||null===(n=n.metadata)||void 0===n?void 0:n.include;a&&a.length>0&&(f=a.concat(f))})),f=_.uniq(f),c=_.uniq(c);var p={},v=Object.keys(this.$props);_.each(v||[],(function(t){dsf.hasOwn(a.$props,t)&&(p[t]=a.$props[t])})),_.each(c||[],(function(t){f.indexOf(t)<0&&delete p[t]})),p.metadata_validate=h,this.metadata.content=dsf.isEmptyObject(p)?"{}":JSON.stringify(p);this.$options.name;if(this.metadata){var m=this.$options.ctrlCaption,g=this.$options.ctrlType.replace(".mobile.",".");this.metadata.currentControl={text:m,value:g},this.metadata.controls=[this.metadata.currentControl]}return{self:this,init:null,metadata:this.metadata}}},toMobile:{getMobileControl:function(){var t,e=(null===this||void 0===this||null===(t=this.$options)||void 0===t||null===(t=t.design)||void 0===t||null===(t=t.layout)||void 0===t?void 0:t.exclude)||[],n=["slots","isDesign","ctrlName","ctrlType"].concat(o()(e)),i=dsf.designer.createMobileComponent(this.ctrlType,{},!0);if(i){var a=dsf.mix(!0,{},this.$props);for(var r in a)n.includes(r)||dsf.isDef(i[r])&&dsf.isDef(a[r])&&(i[r]=a[r]);i.designId=dsf.uuid(),i.metadata&&delete i.metadata.content}return i}},dataPropKey:"value",staticDataPropKey:"staticValue"}}},2:function(t,e,n){var i=n(23),a=n(20),r=n(14),o=n(24);function s(t){return i(t)||a(t)||r(t)||o()}t.exports=s,t.exports.__esModule=!0,t.exports["default"]=t.exports},20:function(t,e){function n(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},21:function(t,e){function n(t){if(Array.isArray(t))return t}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},22:function(t,e){function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},23:function(t,e,n){var i=n(15);function a(t){if(Array.isArray(t))return i(t)}t.exports=a,t.exports.__esModule=!0,t.exports["default"]=t.exports},24:function(t,e){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},25:function(t,e,n){var i=n(9)["default"];function a(t,e){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}t.exports=a,t.exports.__esModule=!0,t.exports["default"]=t.exports},258:function(t,e,n){t.exports=n(353)},259:function(t,e,n){"use strict";n.r(e);var i=n(2),a=n.n(i),r=n(3),o=n.n(r),s=n(18);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e,n,i){var a=t[0].children;null!==a&&void 0!==a&&a.length&&d(a,e,n),t.sort((function(t,a){var r=e[t[i]],o=void 0;if(a){o=e[a[i]];var s=a[n];null!==s&&void 0!==s&&s.length&&d(s,e,n)}return void 0===r&&void 0===o?0:void 0===o||r<o?-1:1}))}e["default"]={props:{value:{type:[Object,String,Number,Array],required:!1},items:{type:Array,default:function(){return[]}},isOther:{type:Boolean,default:!1},itemLabelFormatter:{type:[String,Function],default:""},formatter:{type:String,default:"textValue^text"},valueField:{type:String,default:"value"},textField:{type:String,default:"text"},optionsTextField:{type:String,default:"text"},selectedTextField:{type:String,default:"text"},aliasField:{type:String,default:"alias"},childrenField:{type:String,default:"children"},attachField:{type:String,default:"attach"},postHasAlias:{type:Boolean,default:!1},needInputOptions:{type:String,default:""},needHideOptions:{type:String,default:""},needDisabledOptions:{type:String,default:""},needTipsOptions:{type:Object,default:function(){return{}}},attachWidth:{type:String,default:"200px"},metadata:{type:Object,default:function(){var t=dsf.metadata.get("items-meta-data");return t}},showModel:{type:String,default:"none"},treeMaxRowNum:{type:Number,default:4},disperseFields:{type:Boolean,default:!1}},data:function(){return{valueCopy:[],attachOptions:{},inputValue:null}},computed:{selectValue:{get:function(){var t=this;return this.multiple?dsf.isArray(this.valueCopy)?this.valueCopy.map((function(e){return e[t.valueField]})):[]:dsf.isArray(this.valueCopy)&&this.valueCopy.length?this.valueCopy[0][this.valueField]:""},set:function(t){this.initValue(t)}},realItems:function(){var t,e=this.isDesign,n=this.items,i=this.$isOther,a=this.needHideOptions,r=this.needDisabledOptions,s=this.textField,l=this.valueField,c=this.childrenField,f=this.metadata;a=_.trim(a),a=a?a.split(","):[],r=_.trim(r),r=r?r.split(","):[];var h=(null===(t=f.dataSource)||void 0===t?void 0:t.attachOrderMaps)||null,p=dsf.cloneDeepWith(n,(function(t){if(-1===a.indexOf(t[l])){var e=r.indexOf(t[l])>-1;return u(u({},t),{},o()(o()({disabled:e},s,t[s]),l,t[l]))}}),{children:c});return p.length?h&&!dsf.isEmptyObject(h)&&d(p,h,c,l):e&&(p=[o()(o()({},s,"数据1"),l,"1"),o()(o()({},s,"数据2"),l,"2")]),i&&p.push(o()(o()({},s,"其他"),l,"$else")),p},$isOther:function(){return this.isOther&&-1===this.items.findIndex((function(t){return"$else"===t.value}))},attachItemValues:function(){return Object.keys(this.attachOptions)}},watch:{value:{handler:function(t){if(this.multiple){var e=[];_.forEach(t||[],(function(t){e.push(t.value)})),this.inputValue=e.join(",")}else this.inputValue=(null===t||void 0===t?void 0:t.value)||null;this.initValue(t)},immediate:!0},realItems:function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&this.initValue(this.value)},"metadata.dataSource.attachFullMaps":{handler:function(t){var e="";if(t){var n=[],i=this.metadata.dataSource,a=i.type,r=i.code;_.each(t,(function(t){("db"!=a&&"dict"!=a||r==t.rmId)&&n.push(t.value)})),e=n.join(",")}this.needInputOptions!=e&&this.$emit("update:needInputOptions",e)},deep:!0},"metadata.dataSource.attachHideMaps":{handler:function(t){var e=t?t.join(","):"";this.needHideOptions!=e&&this.$emit("update:needHideOptions",e)},deep:!0},"metadata.dataSource.attachDisabledMaps":{handler:function(t){var e=t?t.join(","):"";this.needDisabledOptions!=e&&this.$emit("update:needDisabledOptions",e)},deep:!0},"metadata.dataSource.attachTipsMaps":{handler:function(t){this.$emit("update:needTipsOptions",t||{})},deep:!0},needInputOptions:{handler:function(t){var e=this.metadata.dataSource;e.attachFullMaps?e.attachFullMaps.length=0:e.attachFullMaps=[];var n=t.trim();if(n){var i=e.attachFullMaps,a=e.code||null,r={};_.forEach(n.split(","),(function(t,e){r[t]="",i[e]={attachText:!0,rmId:a,value:t}})),this.attachOptions=r}else this.attachOptions={}},immediate:!0},needHideOptions:{handler:function(t){t=t.trim(),this.metadata.dataSource.attachHideMaps=t?t.split(","):[]},immediate:!0},needDisabledOptions:{handler:function(t){t=t.trim(),this.metadata.dataSource.attachDisabledMaps=t?t.split(","):[]},immediate:!0}},methods:{getLabelText:function(t,e){var n=t[this.optionsTextField]||t[this.textField],i=n;if(!this.itemLabelFormatter)return i;if(dsf.isString(this.itemLabelFormatter)){var a={};dsf.isDef(e)&&(a.index=e+1),a.text=t[this.optionsTextField],a.alias=t[this.aliasField],a.value=t[this.valueField];var r="proxy",o=this.itemLabelFormatter,s=dsf.global.Vue.filter(r),l=null;o&&s&&(l=s(a,o)),dsf.isUnDef(l)&&dsf.isObject(l)&&(l=n),i=l}else dsf.isFunction(this.itemLabelFormatter)&&(i=this.itemLabelFormatter(t));return i},selectChange:function(){var t=this;this.$nextTick((function(){t.$dispatch("change",t.value),t.emitFormValidate(t.value)}))},setAttach:function(t,e){var n;if(this.$set(this.attachOptions,t,e),dsf.isArray(this.value)){var i=_.findIndex(this.value,(function(e){return e.value===t}));this.$set(this.value[i],"attach",e),this.valueCopy[i].attach=e}else(null===(n=this.value)||void 0===n?void 0:n.value)===t&&(this.$set(this.value,"attach",e),this.valueCopy.attach=e)},initValue:function(t){var e;dsf.isObject(t)&&""===t.text&&""===t.value&&!t.alias&&(t=null),e=void 0===t||null===t?[]:"array"===dsf.type(t)?this.filterValue(t):this.filterValue([t]),this.isSame(e,this.valueCopy)||(this.valueCopy=e,this.updateValue(_.cloneDeep(e)))},filterValue:function(t){var e=this,n=[];return _.forEach(t,(function(t){var i=void 0;dsf.isObject(t)&&void 0!==t.value?(t.attach&&e.$set(e.attachOptions,t.value,t.attach),i=e.getObjectByValue(t.value)):(dsf.isString(t)||dsf.isNumber(t))&&(i=e.getObjectByValue(t)),i&&n.push(i)})),n},getObjectByValue:function(t){var e=null;return dsf.deepForEach(this.realItems,(function(n){var i=dsf.isDef(n.value)?n.value.toString():"",a=dsf.isDef(t)?t.toString():"";if(i===a)return e=n,-1})),e},isSame:function(t,e){if("array"===dsf.type(t)&&"array"===dsf.type(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++){for(var i=!1,a=0;a<e.length;a++){var r=t[n][this.textField]===e[a][this.textField],o=t[n][this.valueField]===e[a][this.valueField],s=!this.postHasAlias||t[n][this.aliasField]===e[a][this.aliasField],l=t[n][this.attachField]===e[a][this.attachField];if(r&&o&&s&&l){i=!0;break}}if(!i)return!1}return!0}return t===e},updateValue:function(t){var e=this,n=_.map(t,(function(t){var n={};for(var i in t)"text"==i||"value"==i||"alias"==i?n[i]=t[e[i+"Field"]]:"children"!==i&&(n[i]=t[i]);return e.attachItemValues.length&&(n.attach=e.attachOptions[n.value]||""),n})),i={text:"",value:""};this.postHasAlias&&(i.alias=""),this.multiple?(n.length&&(i=n),this.emitValueChange(n),this.emitFormValidate(n)):(n.length&&(i=n[0]),this.emitValueChange(i),this.emitFormValidate(i))},keyupHandler:function(t){this.$dispatch("keyup")},inputBlurHandler:function(){this.$dispatch("blur")},inputFocusHandler:function(){this.$dispatch("focus")}},design:{layout:{exclude:["value","#items"]},settingMenus:function(){return[].concat(a()(s["default"].design.settingMenus()||[]),[{text:"选项设置",command:"datasource",handler:function(){dsf.designer.triggerDialogPropty("metadata.dataSource")}}])},metadata:{create:function(t){var e=s["default"].design.metadata.create.call(this,t),n=_.findIndex(e.metadata.valueAttributes,(function(t){return"alias"===t.code}));this.postHasAlias&&-1===n?e.metadata.valueAttributes.push({name:"别名",code:"alias",type:dsf.metadata.getDataType("string"),length:100,defaultValue:null,encrypt:!1,unit:null}):!this.postHasAlias&&n>-1&&e.metadata.valueAttributes.splice(n,1);var i=_.findIndex(e.metadata.valueAttributes,(function(t){return"attach"===t.code}));return this.attachItemValues.length&&-1===i?e.metadata.valueAttributes.push({name:"附加填写文本",code:"attach",type:dsf.metadata.getDataType("string"),length:100,defaultValue:null,encrypt:!1,unit:null}):!this.attachItemValues.length&&i>-1&&e.metadata.valueAttributes.splice(i,1),e.metadata.valueField=this.valueField||"value",e.metadata.isTextValueEnum=!0,e.metadata.disperseFields=this.disperseFields,e}}}}},26:function(t,e){function n(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,a,r,o,s=[],l=!0,u=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=r.call(n)).done)&&(s.push(i.value),s.length!==e);l=!0);}catch(t){u=!0,a=t}finally{try{if(!l&&null!=n["return"]&&(o=n["return"](),Object(o)!==o))return}finally{if(u)throw a}}return s}}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports},260:function(t,e,n){"use strict";n.r(e);var i=n(12),a={mixins:[i["default"]],provide:function(){return{$page:this}},props:{compileRender:{type:Boolean,default:!1},loadPrecedence:{type:String,default:"data"},isLoaded:{type:Boolean,default:!1},name:{type:String,default:""},serial:{type:Number,default:0},isView:{type:Boolean,default:!0},context:{type:Object,default:function(){return{B:"",M:""}}},clientVersion:{type:String,default:"2.0"},title:{type:String,default:""},headfootwidth:{type:String,default:"same"},fit:{type:[String,Number,Boolean],default:"1"},fitInModel:{type:[String,Number,Boolean],default:"1"},topBottom:{type:String,default:""},leftRight:{type:String,default:""},viewSplit:{type:[Array,String],default:function(){return["0px","auto","0px"]}},viewSplitFlex:{type:Array,default:function(){return[]}},pageWidth:{type:String,default:""},hasHeader:{type:Boolean,default:!0},hasFooter:{type:Boolean,default:!0},pagePrivilege:{type:Array,default:function(){return[]}},pageType:{type:String,default:"other"},xssConfig:{type:Object,default:function(){return{allow:!1}}},customCss:{type:String,default:""},footFixed:{type:Boolean,default:!0},needLogin:{type:Boolean,default:!0},footerBackground:{type:String,default:"transparent"},dataAccessRole:{type:Array,default:function(){return[]}},mode:{type:String,default:dsf.enums.viewMode.DEVELOP},waterMark:{type:Boolean,default:!0},isEs:{type:Boolean,default:!1},esIndexName:{type:String,default:""},requests:{type:Array,default:function(){return[]}},enterFocusNext:{type:Boolean,default:!1},openDesignerUrl:{type:String,default:""}},data:function(){return{$serialNum:this.serial,intersectionObserverTextBoxElementsList:{}}},computed:{nameSpace:function(){var t,e;return this.$vm?this.$vm.nameSpace:null!==this&&void 0!==this&&null!==(t=this.context)&&void 0!==t&&t.B&&null!==this&&void 0!==this&&null!==(e=this.context)&&void 0!==e&&e.M?this.context.B+"."+this.context.M:""},$isLoaded:function(){var t=this.isDesign,e=this.isLoaded;return!!t||e},$isPrototype:function(){return(null===this||void 0===this?void 0:this.mode)==dsf.enums.viewMode.PROTOTYPE},serialNum:function(){return this.$data.$serialNum}},updated:function(){},destroyed:function(){},mounted:function(){},beforeMount:function(){},created:function(){var t,e;!this.isDesign&&this.$vm&&(null===(t=this.$vm)||void 0===t||null===(e=t.$pageCreated)||void 0===e||e.call(t,this))},methods:{getSerial:function(){var t=++this.$data.$serialNum;return this.$emit("update:serial",t),t},setSerial:function(t){this.$data.$serialNum=t,this.$emit("update:serial",t)},formSave:function(){this.isDesign},$createViewIntersectionObserver:function(){if(this.$el&&1==this.$el.nodeType)for(var t in this._intersectionObserver=new window.IntersectionObserver((function(t){_.each(t,(function(t){var e,n=t.isIntersecting,i=t.intersectionRatio,a=null===t||void 0===t||null===(e=t.target)||void 0===e?void 0:e.__vue__;a&&(n||i?a.inClient=!0:n||i||(a.inClient=!1))}))}),{rootMargin:"0px 0px 0px 0px",root:this.$el,threshold:[0,Number.MIN_VALUE,.01]}),this.intersectionObserverTextBoxElementsList)this._intersectionObserver.observe(this.intersectionObserverTextBoxElementsList[t])},$addFieldToViewIntersectionObserver:function(t){t.$designId&&(this.intersectionObserverTextBoxElementsList[t.$designId]=t.$el,this._intersectionObserver&&this._intersectionObserver.observe(t.$el))},$removeFieldToViewIntersectionObserver:function(t){if(t.$designId){var e=this.intersectionObserverTextBoxElementsList[t.$designId];e&&(delete this.intersectionObserverTextBoxElementsList[t.$designId],this._intersectionObserver.unobserve(e))}},$destroyViewIntersectionObserver:function(){var t=this;this._intersectionObserver&&(_.each(this.intersectionObserverTextBoxElementsList||{},(function(e,n){t._intersectionObserver.unobserve(e)})),this.intersectionObserverTextBoxElementsList={},this._intersectionObserver.disconnect())}},design:{isMask:!1,toolButtons:{infoButton:!1}},watch:{"$vm.$isLoaded":{handler:function(t,e){var n=this;t&&this.$nextTick((function(){n.isDesign||n.$createViewIntersectionObserver()}))},immediate:!0},serial:{handler:function(t,e){this.$data.$serialNum=t},immediate:!0}}};e["default"]=a},261:function(t,e,n){"use strict";n.r(e);var i=n(2),a=n.n(i),r=n(4),o=n.n(r),s=n(3),l=n.n(s),u=n(1),d=n.n(u),c=n(10);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var p={provide:function(){return{$form:this}},props:{params:{type:Object,default:function(){return{}}},localData:{type:Object,default:function(){return null}}},data:function(){return{_isForm:!0,loading:!1,isView:!1,ignoreValidate:!1,validating:!1,_errors:{},savedCloseTime:1e3}},beforeCreate:function(){},created:function(){this.$updateForceReadOnly()},dataLoaded:function(t,e){e()},beforeDestroy:function(){for(var t in this.metaDataAndCtrls)delete this.metaDataAndCtrls[t];this.metaDataAndCtrls=null},methods:{$updateForceReadOnly:function(){this.$data.$forceReadOnly=1==this.queryString.isview},$loadData:function(){if(this.localData)return Promise.resolve({data:this.localData});var t=this.queryString.copyFormId;if(this.$dataKey||t){var e=h(h({},this.queryString),{},{pageName:this.pageName,namespace:this.nameSpace});return e.data=JSON.stringify({_id:this.$dataKey||t}),this.$dataKey||(e.id=t,e.copy=1),this.$getFormDataAPI(e).then((function(t){return t.data}))}return Promise.resolve()},$updateData:function(){var t=this;return o()(d.a.mark((function e(){var n;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.setInitData();case 4:return e.next=6,t.$loadData();case 6:return n=e.sent,e.next=9,t.setViewData(null===n||void 0===n?void 0:n.data);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),dsf.httpError(e.t0,{isSilent:!0});case 14:return e.prev=14,t.loading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})))()},setInitData:function(){var t=this;return o()(d.a.mark((function e(){var n;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$initData();case 2:n=e.sent,dsf.mix(t.context.$$viewInitData,n);case 4:case"end":return e.stop()}}),e)})))()},setViewData:function(t){var e=this.$initControls(this);for(var n in t=dsf.mix(e,t||null),e){var i=this.metadataDict[n];if(i&&"subtable"==i.type){var a=e[n]||[];a.forEach((function(t){dsf.isUnDef(t.$hash)&&(t.$hash=dsf.uuid())}))}}this.context.$$viewData=t,c["b"](this,"updateData",[],c["c"])},validate:function(t,e){var n=arguments,i=this;return o()(d.a.mark((function a(){var r,o,s,l,u,c;return d.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=i.metadataDict,l=i.$metadataKeyList,u=[],u=0==n.length?l.filter((function(t){return!s[t].inSubTable})):"array"==dsf.type(t)?t:[t],c=null===i||void 0===i||null===(r=i.$getValidateFns)||void 0===r?void 0:r.call(i,u,s,e),a.next=6,null===i||void 0===i||null===(o=i.$execValidateFns)||void 0===o?void 0:o.call(i,c);case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}}),a)})))()},formValidate:function(t){var e=this;return o()(d.a.mark((function n(){var i;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.validating=!0,n.prev=1,n.next=4,c["b"](e,"validateBefore",[t],c["c"]);case 4:if(e.ignoreValidate){n.next=7;break}return n.next=7,e.validate();case 7:e.clearErrors(),n.next=29;break;case 10:if(n.prev=10,n.t0=n["catch"](1),i=n.t0,!dsf.isArray(i)){n.next=28;break}if(e.pushError(i),e.$scrollToError(i),!i.length){n.next=26;break}if(!i.filter((function(t){var e;return!(null!==t&&void 0!==t&&null!==(e=t.info)&&void 0!==e&&e.ignore)})).length){n.next=23;break}throw e.$emit("open-audit-state"),i={type:"ValidateError",result:n.t0,message:"表单校验错误"},i;case 23:if(t.isSkipIgnore){n.next=26;break}throw e.$emit("open-audit-state"),"请确认忽略性错误";case 26:n.next=29;break;case 28:throw i;case 29:return n.prev=29,n.next=32,c["b"](e,"validateAfter",[t],c["c"]);case 32:return e.validating=!1,n.finish(29);case 34:case"end":return n.stop()}}),n,null,[[1,10,29,34]])})))()},validateField:function(t,e,n){var i=this;return o()(d.a.mark((function a(){var r,o,s,l;return d.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if([],n){a.next=3;break}return a.abrupt("return");case 3:if(a.prev=3,n.isOneToMany){a.next=10;break}return null===i||void 0===i||null===(r=i.removeErrorsByTarget)||void 0===r||r.call(i,n.$formName),a.next=8,null===i||void 0===i||null===(o=i.validate)||void 0===o?void 0:o.call(i,n.formName,e);case 8:a.next=17;break;case 10:return s=n.formName,_.filter(i.$metadataKeyList,(function(t){return i.metadataDict[t].inSubTable==s})),l=t,dsf.isDef(e)&&(l=[t[e]]),_.each(l,(function(t){i.removeErrorsByRowHash(t.$hash)})),a.next=17,i.validate(n.formName,e);case 17:return a.abrupt("return",[]);case 20:return a.prev=20,a.t0=a["catch"](3),"array"==dsf.type(a.t0)&&i.pushError(a.t0),a.abrupt("return",a.t0);case 24:case"end":return a.stop()}}),a,null,[[3,20]])})))()},resetValidate:function(){var t=this.allComponents;this.clearErrors(),_.each(t,(function(t){t.errors=[]}))},$addFiled:function(t){var e=this,n=t._isVue;n&&this.allComponents.push(t),this.$nextTick((function(){e.updateMetaDataDict(t)}))},$removeFiled:function(t){var e=t._isVue;this.metadataDict[t.formName]&&(e?dsf.array.remove(this.metadataDict[t.formName].refs||[],t):dsf.array.remove(this.metadataDict[t.formName].proxyRefs||[],t)),dsf.array.removeWith(this.allComponents,(function(e){return e==t}))},updateMetaDataDict:function(t){var e=t._isVue;if(this.metadataDict){var n=t.formName,i=t.metadata_fullcode,a=t.metadata;if(e||(n=i),a&&n){var r=n.split("."),o=(r[0],r[1]&&r[1],!1);t.isOneToMany?(this.metadataDict[n]||(this.metadataDict[n]={type:"subtable",fieldsLength:0,valueAttributes:[],level:1,refs:[]},o=!0),this.metadataDict[n].refs=this.metadataDict[n].refs||[],this.metadataDict[n].validate=a.validate,this.metadataDict[n].refs.push(t),this.metadataDict[n].allowPost=!1!==t.allowPost):(this.metadataDict[n]||(this.metadataDict[n]={type:"field",fieldsLength:a.valueAttributes&&a.valueAttributes.length,level:0,valueAttributes:_.map(a.valueAttributes,"code"),refs:[],proxyRefs:[]},o=!0),t.$list&&this.metadataDict[t.$list.formName]&&(this.metadataDict[n].level=1,this.metadataDict[n].inSubTable=t.$list.formName),this.metadataDict[n].refs=this.metadataDict[n].refs||[],this.metadataDict[n].proxyRefs=this.metadataDict[n].proxyRefs||[],this.metadataDict[n].validate=a.validate,e?this.metadataDict[n].refs.push(t):dsf.array.ensure(this.metadataDict[n].proxyRefs,t),this.metadataDict[n].allowPost=!1!==t.allowPost),this.metadataDict[n]&&(this.metadataDict[n].isUser=o,t.validateRule&&(this.metadataDict[n].validateRule=t.validateRule))}}},$postBefore:function(){for(var t=[],e=[],n=0;n<this.allComponents.length;n++){var i=this.allComponents[n];if(i.isFormControl){var a=i.postBefore;i.designId?!e[i.$formName]&&a&&(t.push(a()),e.push(i.$formName)):a&&t.push(a())}}return Promise.all(t)},$postAfter:function(t){for(var e=[],n=[],i=0;i<this.allComponents.length;i++){var a=this.allComponents[i];if(a.isFormControl){var r=a.postAfter;a.designId?!n[a.$formName]&&r&&(e.push(r(t)),n.push(a.$formName)):r&&e.push(r(t))}}return Promise.all(e)},$postError:function(){var t=[],e=[];return _.each(this.$postFields,(function(n){var i=n.postError;n.designId?!e[n.$formName]&&i&&(t.push(i()),e.push(n.$formName)):i&&t.push(i())})),Promise.all(t)},$scrollToError:function(t){var e=this;return o()(d.a.mark((function n(){var i,a,r,o,s,l,u,c,f,h;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:if(i=null,n.prev=3,a=(dsf.isArray(t)?t:[t]).filter((function(t){var e;return!(null!==t&&void 0!==t&&null!==(e=t.info)&&void 0!==e&&e.ignore)})),!(a&&a.length>0)){n.next=24;break}if(r=a[0],o=r.target,s=null,o&&dsf.isString(o)?s=null===e||void 0===e||null===(l=e.$el)||void 0===l||null===(u=l.querySelector)||void 0===u?void 0:u.call(l,'[form-name="'.concat(o,'"]')):o&&1==o.nodeType?s=o:o&&o.__vue__&&(s=null===o||void 0===o?void 0:o.$el),!s||1!=s.nodeType){n.next=24;break}c=s.__vue__.$parent,f=s,h=0;case 14:if(!(c&&h<100)){n.next=23;break}if(!c.formScrollIntoViewErrorControl){n.next=19;break}return n.next=18,c.formScrollIntoViewErrorControl(f,r);case 18:f=c.$el;case 19:c=c.$parent,h++,n.next=14;break;case 23:i=setTimeout((function(){s.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),i&&clearTimeout(i)}),e.$isMobile?400:200);case 24:n.next=30;break;case 26:n.prev=26,n.t0=n["catch"](3),dsf.error(n.t0),dsf.warn("无法正确定位到错误元素");case 30:case"end":return n.stop()}}),n,null,[[3,26]])})))()},formSave:function(t,e,n,i){var a=this;return o()(d.a.mark((function n(){var r,o,s,l,u;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return!1,a.$dataKey||!0,t=t||{},r={isRefresh:!1,savedClose:!1,successMsg:"保存成功",errorMsg:"保存失败",isSilent:!1,isSkipIgnore:!1},r=dsf.mix(r,t),n.prev=5,n.next=8,a.$formSave(r,i);case 8:if(s=n.sent,null===s||void 0===s||null===(o=s.data)||void 0===o||!o._id){n.next=16;break}if(!e||!dsf.isFunction(e)){n.next=13;break}return n.next=13,e(s);case 13:for(u in a.$dataKey=(null===s||void 0===s||null===(l=s.data)||void 0===l?void 0:l._id)||"",null===s||void 0===s?void 0:s.data)a.$set(a.$viewData,u,s.data[u]);r.savedClose?a.closeForm():a.$updateUrl((null===s||void 0===s?void 0:s.data)||{});case 16:return n.abrupt("return",s);case 19:throw n.prev=19,n.t0=n["catch"](5),dsf.error(n.t0),n.t0;case 23:case"end":return n.stop()}}),n,null,[[5,19]])})))()},closeForm:function(t){var e=this;this.loading=!0;var n=window.setTimeout((function(){e.loading=!1,e.$closeWindow&&e.$closeWindow(),n&&clearTimeout(n),null===t||void 0===t||t()}),this.savedCloseTime)},$formSave:function(){var t=arguments,e=this;return o()(d.a.mark((function n(){var i,a,r,o,s,l,u,f;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.length>0&&void 0!==t[0]?t[0]:{},a=null,r=e.$options.saveComplete,n.prev=3,e.resetValidate(),e.showLogicHandler(),n.next=8,e.$postBefore();case 8:return n.next=10,e.formValidate(i);case 10:if(n.t0=e.formulaPyCheckFormDataFn,!n.t0){n.next=14;break}return n.next=14,e.formulaPyCheckFormDataFn(i);case 14:return _.each(e.$subTables,(function(t){t.editAllEnd&&t.editAllEnd()})),n.next=17,c["b"](e,"saveBefore",[i],c["c"]);case 17:return n.next=19,e.$nextTick();case 19:return e.loading=!0,o=null,n.prev=21,n.next=24,e.$save(i);case 24:o=n.sent,n.next=30;break;case 27:throw n.prev=27,n.t1=n["catch"](21),n.t1;case 30:return a=o,n.next=33,e.$postAfter(o);case 33:return e.$emit("saveAfter",a.data,i),n.next=36,c["b"](e,"saveAfter",[a.data,i],c["c"]);case 36:if(i.isSilent){n.next=40;break}return n.next=39,e.$nextTick();case 39:window.setTimeout((function(){e.$message(i.successMsg,!0)}),300);case 40:return n.abrupt("return",o);case 43:if(n.prev=43,n.t2=n["catch"](3),s=null,l="",dsf.isObject(n.t2)&&"ValidateError"==n.t2.type&&(dsf.layer.message("填写内容不符合要求，请检查",!1),s=n.t2),dsf.isObject(n.t2)&&"nextFalse"==n.t2.type?s=n.t2:dsf.isObject(n.t2)&&dsf.hasOwn(n.t2,"state")?(l=20001===n.t2.state?i.errorMsg:n.t2.message,s=n.t2):"string"===dsf.type(n.t2)?(l=n.t2,s=n.t2):"error"===dsf.type(n.t2)&&(l=i.errorMsg,s=n.t2),!l){n.next=53;break}return n.next=52,e.$nextTick();case 52:window.setTimeout((function(){e.$message(l,!1)}),300);case 53:return a=null,n.next=56,e.$postError();case 56:if(!s){n.next=58;break}throw s;case 58:return n.prev=58,null!==(u=a)&&void 0!==u&&u.data&&(e.$data._postState="FORMSAVE",e.$data._postState=""),e.ignoreValidate=!1,i.isRefresh&&null!==(f=a)&&void 0!==f&&null!==(f=f.data)&&void 0!==f&&f._id&&e.reloadParentViewData(),r&&r.call(e,a),e.loading=!1,a=null,delete e.__showLogicRecordCtrl__,n.finish(58);case 67:case"end":return n.stop()}}),n,null,[[3,43,58,67],[21,27]])})))()},$getSaveParams:function(t){var e=this;return o()(d.a.mark((function n(){var i,a,r;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e,i=e.$getPostData(t),e.$options.postDataBefore,e.$options.postDataAfter,n.next=6,c["b"](e,"postDataBefore",[i,t],c["c"]);case 6:return a={namespace:e.nameSpace,pageName:e.pageName,data:i,attach:JSON.stringify({})},e.$dataKey&&(a.data["_id"]=e.$dataKey),r=e.getSavePostParams,r&&r.call(e,a),a.data=e.$postDataToJson(a.data),n.abrupt("return",a);case 12:case"end":return n.stop()}}),n)})))()},$save:function(t){var e=this;return o()(d.a.mark((function n(){var i,a,r,o;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$getSaveParams(t);case 2:return i=n.sent,n.prev=3,n.next=6,e.saveAPI(i);case 6:if(a=n.sent,!a||!a.data){n.next=18;break}return r=a.data,o="20000",r.state==o&&_.each(e.$subTables,(function(t){t.deleted=[]})),n.next=13,c["b"](e,"postDataAfter",[r,t],c["c"]);case 13:if(r.state!=o){n.next=17;break}return n.abrupt("return",r);case 17:throw r;case 18:n.next=23;break;case 20:throw n.prev=20,n.t0=n["catch"](3),n.t0;case 23:case"end":return n.stop()}}),n,null,[[3,20]])})))()},$updateUrl:function(t){var e,n=(null===t||void 0===t?void 0:t._id)||"";if(n)if(null!==this&&void 0!==this&&null!==(e=this.$frame)&&void 0!==e&&e.independent)this.$frame.urlChange({pageName:this.pageName,nameSpace:this.nameSpace,query:h(h({},this.$localParams),{},{id:n})},!0);else if(this.$dialog){var i=this.$dialog.currentView.pageName,a=this.$dialog.currentView.nameSpace,r=this.$dialog.currentView.localParams;this.$dialog.currentView&&this.$dialog.currentView.urlChange({pageName:i,nameSpace:a,query:h(h({},r),{},{id:n})},!0)}else{var o=dsf.mix({},this.$route.query,{id:t._id});this.$router.replace({path:this.$route.path,query:o})}},getSubTable:function(t){return _.find(this.$subTables,(function(e){return e.metadata_fullcode==t}))},yes:function(){var t=this;return o()(d.a.mark((function e(){var n;return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.resetValidate(),t.showLogicHandler(),e.next=5,t.$postBefore();case 5:return e.next=7,t.formValidate();case 7:return n=t.$getPostData(),e.abrupt("return",n);case 11:return e.prev=11,e.t0=e["catch"](0),dsf.error(e.t0),t.$postError(),e.abrupt("return",!1);case 16:return e.prev=16,delete t.__showLogicRecordCtrl__,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,11,16,19]])})))()},saveAPI:function(t){return this.$webAPI.formSave(t,!0)},$getFormDataAPI:function(t){return this.$webAPI.getFormData(t,!0)},$getPostData:function(){var t=this,e=dsf.mix(!0,{},this.$viewData);this.$asyncItemFields(e);var n=_.filter(this.$postFields,(function(t){return t.isFormControl&&!t.isOneToMany&&!t.metadata.inSubTable}));return n=_.keyBy(n,"designId"),_.each(this.$subTables,(function(n){var i,r,o=n.metadata_fullcode,s=e[o]||[];if(1==s.length&&(null!==(i=s[0])&&void 0!==i&&null!==(i=i.$hash)&&void 0!==i&&null!==(r=i.startsWith)&&void 0!==r&&r.call(i,dsf.global.$const.subTableEmptyRowHash))){var l=n.isEmptyData(s[0]);l&&(s=[])}if(_.each(s,(function(e,i){1!=e[o+".ds_deleted"]&&(e[o+".ds_deleted"]=0),n.autoOrder&&(e[o+".ds_order"]=i),t.$asyncItemFields(e)})),n.openTotalRow&&n.totlResultPost&&n.totalData&&s.length){var u=o+"."+n.totalRowFieldKey;dsf.array.removeWith(s,(function(t){return t[u]==n.totalRowFieldTrueValue})),n.totalData[o+".ds_order"]=s.length,""!=n.totalData[o+".ds_deleted"]&&void 0!=n.totalData[o+".ds_deleted"]||(n.totalData[o+".ds_deleted"]=0),n.totalData[u]=n.totalRowFieldTrueValue,s=[].concat(a()(s),[n.totalData])}if(n.deleted){var d=[];_.each(n.deleted,(function(t){if(t["_id"]){var e=_.find(s,(function(e){return e["_id"]==t["_id"]}));e||(t[o+".ds_deleted"]=1,d.push(t))}})),e[o]=[].concat(a()(s),d)}_.each(e[o],(function(t){var e=null;e=dsf.isFunction(n.ignoreFields)?n.ignoreFields()||[]:n.ignoreFields||[],_.each(e,(function(e){delete t[e]}))}))})),this.$filterInValidMetaDataValueAttrs(e),e},$postDataToJson:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,i=[dsf.config.kw.updatetime,dsf.config.kw.updateusername,dsf.config.kw.updateuserid,dsf.config.kw.createuserid,dsf.config.kw.createusername,dsf.config.kw.createtime],a=JSON.stringify(t,(function(t,a){if(!t.startsWith("$")){var r,o=!1;return!1===(null===(r=n.metadataDict)||void 0===r||null===(r=r[t])||void 0===r?void 0:r.allowPost)&&(o=!0),!o&&e&&(o=_.find(i,(function(e){return t.endsWith(".".concat(e))}))),o?void 0:a}}));return a},$filterInValidMetaDataValueAttrs:function(t){var e=this;_.forOwn(t,(function(t,n){if(e.metadataDict[n]){var i=e.metadataDict[n],a=i.valueAttributes;"field"==i.type?a.length>1&&g(i,t):"subtable"==i.type&&dsf.isDef(t)&&_.each(t,(function(t,n){e.$filterInValidMetaDataValueAttrs(t)}))}}))},$getValidateMetaList:function(){return this.$metadataKeyList},$asyncItemFields:function(t){var e=this,n=function(n){var i=e.metadataDict[n];if((null===i||void 0===i||!i.disperseFields)&&((null===i||void 0===i?void 0:i.itemFields)||[]).length<=0)return 1;var a=i.itemFields;_.each(a,(function(e,a){var r=t[n];r=dsf.isDef(r)&&dsf.isArray(r)?r:[r],r=_.map(r,i.valueField||"value");var o=r.indexOf(e.itemValue)>=0?e.itemValue:"";t[e.key]=o}))};for(var i in t)n(i)},showLogicHandler:function(){var t=this,e={},n=this.showLogicCompile,i=this.ctrlTreeInfo,a=this.$controls,r=this.$controlsMapping,o=this.$viewData;_.each(n,(function(n,s){var u=a[s],d=u.metadata.inSubTable;if(d){var c=r[d];if(e[c])return;var f=o[d];null!==f&&void 0!==f&&f.length&&_.each(f,(function(r){var u;if(null===(u=e[s])||void 0===u||!u[r.$hash]){var d=n.call(t,o,r);if(!d){var c=l()({},s,i[s]),f=function(){var t={};_.each(c,(function(n,i){e[i]||(e[i]={}),e[i][r.$hash]=!0,Object.assign(t,n),m(r,a[i])})),c=t};while(_.keys(c).length)f()}}}))}else{if(e[s])return;var h=n.call(t,o);if(!h){var p=l()({},s,i[s]),g=function(){var t={};_.each(p,(function(n,i){e[i]=!0,v(a[i])||Object.assign(t,n),m(o,a[i])})),p=t};while(_.keys(p).length)g()}}})),this.__showLogicRecordCtrl__=e}},watch:{"queryString.id":function(t){this.$isForm&&(this.$dataKey=t)}}};function v(t){return t.isOneToMany&&t.isFormControl}function m(t,e){if(e.isFormControl){var n=e.metadata_fullcode;if(v(e))t[n]=[];else{var i=e.metadata.valueAttributes;if(i.length>1){var a={};_.each(i,(function(t){var e=t.code;return a[e]=""})),t[n]=a}else t[n]=""}}}function g(t,e){var n=t.valueAttributes;if(dsf.isObject(e))for(var i in e)~n.indexOf(i)||delete e[i];else dsf.isArray(e)&&_.each(e,(function(t,e){if(dsf.isObject(t))for(var i in t)~n.indexOf(i)||delete t[i]}))}e["default"]=p},262:function(t,e,n){"use strict";n.r(e);var i=n(3),a=n.n(i),r=n(4),o=n.n(r),s=n(1),l=n.n(s);function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){var n,i=this,a=dsf.designer.createComponentMetaData(this,this.$page),r=this.$options.design.staticDataPropKey,o=this[r]||[];if(o.length<=0){var s={};o.push(s)}var l=o;o=[];var u=[],d=(null===a||void 0===a||null===(n=a[0])||void 0===n?void 0:n.schema)||[],c=_.keyBy(d,"key");if(this.childMetaDataCodes.length>0&&_.each(this.childMetaDataCodes,(function(t){var e,n="";c[t]&&(n=null===(e=c[t])||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.name);var i=dsf.metadata.getField(t);u.push({name:i,displayName:n||i})})),0==u.length&&!this.isFormControl){var f=this.getLastColumns();_.each(f,(function(t){u.push({name:t.columnId,displayName:t.label})}))}for(var h=function(){var t={};for(var e in _.each(u,(function(e){t[e.name]=null})),l[p]){var n=dsf.metadata.getField(e);n in t&&(t[n]=l[p][e])}o.push(t)},p=0;p<l.length;p++)h();this.$openDialog({title:"数据维护",content:"DesStaticListData",width:"90vw",height:"60vh",overflow:"hidden hidden",params:{designer:this.$designer,value:{data:o,fields:u}},btns:[{text:"确定",handler:function(t){var e=null===t||void 0===t?void 0:t.yes();if(i.caption&&e){var n=[];_.each(e||[],(function(t,e){var a={};_.each(u,(function(e){var n=e.name,r=e.name,o=_.find(i.childMetaDataCodes,(function(t){var e=dsf.metadata.getField(t);return e==r}));o&&(n=o),a[n]=dsf.isDef(t[r])?t[r]+"":""})),a._id=e,n.push(a)})),i[r]=n}}},{text:"清除",handler:function(){i[r]=null}},{text:"取消"}]})}e["default"]={provide:function(){return{$list:this,$buttonOwner:this,$childCaptionUniqueScope:this}},props:{childMetaDataCodes:{type:Array,default:function(){return[]}}},methods:{$getChildMetadataList:function(){if(this.isDesign){var t,e=dsf.designer.createComponentMetaData(this,this.$page),n=null;if(null!==e&&void 0!==e&&null!==(t=e[0])&&void 0!==t&&t.schema){var i,a=null===e||void 0===e||null===(i=e[0])||void 0===i?void 0:i.schema;n=_.filter(a,(function(t){return t.metadata}))}return n}},$getMetadataTree:function(t){var e=this;return o()(l.a.mark((function n(){var i;return l.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.isDesign){n.next=10;break}if(i=null,e.$isPrototype){n.next=8;break}return n.next=5,e.$getRealTreeData(t[0].metadata,t[0].metadata.rm_type||3);case 5:i=n.sent,n.next=9;break;case 8:i=e.$getStaticTreeData(t);case 9:return n.abrupt("return",i);case 10:case"end":return n.stop()}}),n)})))()},$getRealTreeData:function(t,e){var n=this;return o()(l.a.mark((function i(){var a,r,o;return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!n.isDesign){i.next=15;break}if(a=[],"8"!=e){i.next=9;break}return r={rmId:t.rmId},i.next=6,n.$webAPI.getDbSourceFieldsTree(r);case 6:a=i.sent,i.next=14;break;case 9:if("3"!=e){i.next=14;break}return o={namespace:t.at},i.next=13,n.$webAPI.getMetaDataFieldsTree(o);case 13:a=i.sent;case 14:return i.abrupt("return",a);case 15:case"end":return i.stop()}}),i)})))()},$getStaticTreeData:function(t){var e=dsf.mix(!0,[],t),n={name:"可用字段",children:[]};return _.each(e,(function(t){var e=d({},t.metadata);e.children=[];var i=e.name,a=e.at.replace(/\./g,"_");e.id=a+"."+e.code,e.field=e.code,e.fieldCaption=e.name,e.metadata=e,e.name=i||e.id,e.valueAttributes.length>1&&_.each(e.valueAttributes,(function(t){var n=i?i+"("+t.name+")":a+"."+t.code;e.children.push(d(d({},t),{},{id:a+"."+t.code,name:n,field:e.code+"_"+t.code,fieldCaption:n,metadata:e}))})),n.children.push(e)})),[n]},$getPageList:function(t,e,n){var i=(e-1)*n,a=i+n;return t.slice(i,a)}},design:{settingMenus:function(){return[{text:"静态数据维护",command:"list-static-data",handler:c,hidden:function(){return!this.$isPrototype}},{text:"保存为业务组件",command:"save-business",handler:function(){this.$designer.saveBusinessComponentSingle(this,"")},hidden:function(){return!(null!==this&&void 0!==this&&this.$designer.$allowSaveBusinessControl)}}]}}}},263:function(t,e,n){"use strict";n.r(e);var i=n(3),a=n.n(i),r=n(18);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l=["[]","{}",null,void 0,""];e["default"]={mixins:[r["default"]],props:{childMetaDataCodes:{type:Array,default:function(){return[]}},isOneToMany:{type:Boolean,default:!0},metadata:{type:Object,default:function(){return dsf.metadata.get("sublist-meta-data")}},ignoreFields:{type:[Function,Array],default:function(){return[]}},redundanceFields:{type:Array,default:function(){return[]}},totalRowFieldKey:{type:String,default:""},totalRowFieldTrueValue:{type:[String,Number],default:"1"},totalRowFieldFalseValue:{type:[String,Number],default:"0"},openTotalRow:{type:Boolean,default:!1},followIndexDataKey:{type:String,default:""},isLeastOne:{type:Boolean,default:!0},leastOneRowIsEmptyNotSave:{type:Boolean,default:!1},totlResultPost:{type:Boolean,default:!1},clipboardDataHandler:{type:Function,default:null}},data:function(){return{emptyRowData:null,totalData:{$hash:"__total__"+dsf.uuid(),$ignoreValidate:!0},virturlRowHash:dsf.global.$const.subTableEmptyRowHash}},computed:{$totalRowFieldKey:function(){return this.totalRowFieldKey?this.metadata_fullcode+"."+this.totalRowFieldKey:""},metadataDict:function(){var t,e=null===this||void 0===this||null===(t=this.$vm)||void 0===t?void 0:t.metadataDict;if(e){var n=_.map((null===this||void 0===this?void 0:this.childMetaDataCodes)||[],(function(t){return{key:t,obj:e[t]}})),i={};return _.each(n,(function(t){i[t.key]=t.obj})),i}return{}},$followIndexDataKey:function(){var t,e=this;if(!this.isDesign&&(null===this||void 0===this||null===(t=this.childMetaDataCodes)||void 0===t?void 0:t.length)>0){var n=_.find(this.childMetaDataCodes,(function(t){return e.followIndexDataKey===t||t.endsWith("."+e.followIndexDataKey)}));return n}return""},$leastOneRowHash:function(){return this.leastOneRowIsEmptyNotSave?this.virturlRowHash+dsf.uuid():dsf.uuid()}},methods:{$clipboardDataHandler:function(t){for(var e=this,n=[],i=function(){var i=t[a],r=[],o={};if(_.each(e.childMetaDataCodes,(function(t){var n=e.metadataDict[t];if(n.inColumn){var i=_.find(r,(function(t){return t.columnName==n.inColumn}));i||(r.push({columnName:null===n||void 0===n?void 0:n.inColumn,metadata:[]}),i=r[r.length-1]),i.metadata.push(n)}})),r.length)for(var s=0;s<r.length;s++){var l,u=r[s],d=null===u||void 0===u||null===(l=u.metadata)||void 0===l?void 0:l[0];d&&(o[d.id]=(null===i||void 0===i?void 0:i[s])||null)}n.push(o)},a=0;a<t.length;a++)i();return n},attachMustFieldToData:function(t){t&&(!("$editing"in t)&&this.$set(t,"$editing",!1),!("$hash"in t)&&this.$set(t,"$hash",dsf.uuid()),this.isUseRowButtons&&!("$buttons"in t)&&this.$set(t,"$buttons",dsf.mix(!0,[],this.rowButtons||[])),this.$set(t,"$order",t.$index))},setRowDefaultValue:function(t){var e,n;if(this.isDesign||null!==this&&void 0!==this&&this.$vm){var i=(null===this||void 0===this||null===(e=this.$vm)||void 0===e||null===(n=e.$getSubTableRowDefault)||void 0===n?void 0:n.call(e,this))||{};if(!dsf.isUnDef(i))for(var a in i)if(dsf.isUnDef(t[a])){var r=this.getVmDefaultValue(a);dsf.isDef(r)&&this.$set(t,a,r)}}},getVmDefaultValue:function(t){var e,n;return(null===this||void 0===this||null===(e=this.$vm)||void 0===e||null===(n=e.$getDefaultValue)||void 0===n?void 0:n.call(e,t))||null},updateIndexDataField:function(t,e){!this.isDesign&&this.$followIndexDataKey&&this.$set(t,this.$followIndexDataKey,e)},separateTotalRowFromValue:function(t){var e=this;if(!this.isDesign&&this.openTotalRow&&this.$totalRowFieldKey&&this.totalRowFieldTrueValue){var n=this.$totalRowFieldKey;this.$set(this.totalData,n,this.totalRowFieldTrueValue);var i=_.findIndex(t,(function(t){return t[n]==e.totalRowFieldTrueValue}));if(i>=0){var a;if(null!==this&&void 0!==this&&null!==(a=this.value)&&void 0!==a&&null!==(a=a[i])&&void 0!==a&&a._id)for(var r in this.value[i])this.$set(this.totalData,r,this.value[i][r]);return this.value.splice(i,1),!0}}return!1},emitValueChange:function(t,e){var n={row:e||null,list:t};r["default"].methods.$emitValueChange.call(this,t),this.$dispatch("value-mutation",n)},setEmptyRowData:function(t){var e=this;this.$nextTick((function(){t=t||e.value[0],e.emptyRowData=dsf.mix(!0,{},t)}))},createLeastOneRow:function(){if(!this.isDesign&&this.isLeastOne&&!this.readOnly){var t=null;if(t=this.value?this.value:[],t.length<=0){var e={$hash:this.$leastOneRowHash,$index:0};this.attachMustFieldToData(e),this.setRowDefaultValue(e),this.updateIndexDataField(e,e.$index+1),t.push(e)}this.emitValueChange(t),this.setEmptyRowData()}},rowHasChange:function(t,e){for(var n=!1,i=["string","number","boolean"],a=Object.keys(t),r=Object.keys(e),o=_.uniq([].concat(a,r)),s=0;s<o.length;s++){var u=o[s],d=t[u],c=e[u];if((!l.includes(d)||!l.includes(c))&&!dsf.isEqualObject(d,c))if(dsf.isArray(d)&&dsf.isArray(c)){if(d.length!=c.length){n=!0;break}for(var f=0;f<d.length;f++){var h=d[f],p=c[f];if(this.rowHasChange(h,p)){n=!0;break}}if(n)break}else if(dsf.isObject(d)&&dsf.isObject(c)){if(this.rowHasChange(d,c)){n=!0;break}}else{var v=dsf.type(d),m=dsf.type(c);if("null"!=v&&"undefined"!=v||(v="empty"),"null"!=m&&"undefined"!=m||(m="empty"),"empty"==v&&v==m)continue;if(i.includes(v)&&i.includes(m)){if(v==m&&d!==c){n=!0;break}if("string"==v&&"number"==m||"number"==v&&"string"==m){if(String(d)!==String(c)){n=!0;break}}else if(d!==c){n=!0;break}}else if(!dsf.isEmptyObject(d)||!dsf.isEmptyObject(c))if("empty"==v&&dsf.isObject(c)){var g=Object.values(c).filter((function(t){return dsf.isDef(t)})).join("");if(g){n=!0;break}}else{if("empty"!=m||!dsf.isObject(d)){n=!0;break}var y=Object.values(d).filter((function(t){return dsf.isDef(t)})).join("");if(y){n=!0;break}}}}return n},rowDataChange:function(t){if(1==this.value.length&&t.$hash.startsWith(this.virturlRowHash)&&this.emptyRowData){var e,n,i=this.rowHasChange(this.emptyRowData,t);if(!i)null===this||void 0===this||null===(e=this.$vm)||void 0===e||null===(n=e.removeErrorsByRowHash)||void 0===n||n.call(e,t.$hash)}},isEmptyData:function(t){return!this.rowHasChange(this.emptyRowData,t)}},design:{isMask:!1,metadata:{isDeep:!1,create:function(t){var e=this;this.metadata||(this.metadata={});var n=[],i="";dsf.designer.recursionLayoutTree(this,null,null,(function(a,r,o){if(a!=e){r==e&&(i=o);var s=a.$options.design||{},l=s.metadata||{},u=l.create&&l.create.call(a,t);if(u&&u.metadata){u.self=a,u.metadata.inColumn=i,u&&n.push(u);var d=!dsf.isDef(l.isDeep)||l.isDeep;if(!d)return!1}}})),_.each(this.redundanceFields,(function(e){var a=document.querySelector("#des-"+e);if(a.__vue__){var r=a.__vue__,o=Vue.extend(Vue.options.components[r.ctrlName]),s=new o;for(var l in r.$props)dsf.isObject(r.$props[l])?s[l]=dsf.mix(!0,{},r.$props[l]):dsf.isArray(r.$props[l])?s[l]=dsf.mix(!0,[],r.$props[l]):s[l]=r.$props[l];s.caption="main_"+r.caption,delete s.metadata.isFromMetaData,delete s.metadata.isuser;var u=s.$options.design||{},d=u.metadata||{},c=d.create&&d.create.call(s,t);c&&c.metadata&&(delete c.metadata.content,delete s.$props.metadata.content,c.metadata.inColumn=i,c&&n.push(c))}}));var a={};return _.each(this.exportOptions,(function(t,n){t&&t.length>0&&(a[e.caption+"."+n]=t)})),[{self:this,init:null,export:s({},a),metadata:this.metadata}].concat(n)}},toMobile:{childComponentAddToMobileSubTable:function(){}}}}},264:function(t,e,n){"use strict";n.r(e);var i=n(37);e["default"]={mixins:[i["default"]],data:function(){return{isWindowOpener:!1}},created:function(){try{var t;if(this.$multiView)this.$dialogArgs=this.$multiView.dialogArgs?JSON.parse(this.$multiView.dialogArgs):null,this.$openerVm=this.$multiView.openerVm;else if(null!==(t=window)&&void 0!==t&&null!==(t=t.frameElement)&&void 0!==t&&t.closest('.el-dialog[role="dialog"]')){var e,n,i=(null===(e=window)||void 0===e||null===(e=e.frameElement)||void 0===e?void 0:e.$dialog)||(null===(n=window)||void 0===n||null===(n=n.frameElement)||void 0===n||null===(n=n.args)||void 0===n?void 0:n.$dialog);if(i){var a,r,o=(null===(a=window)||void 0===a||null===(a=a.frameElement)||void 0===a?void 0:a.args)||(null===(r=window)||void 0===r||null===(r=r.frameElement)||void 0===r||null===(r=r.$dialog)||void 0===r?void 0:r.dialogArgs)||null;"string"==dsf.type(o)&&(o=JSON.parse(o)),this.$dialogArgs=window.frameElement.args?JSON.parse(window.frameElement.args):null,this.$openerVm=i.openerVm}}else if(this.$dialog)this.$dialogArgs=this.$dialog.dialogArgs||null,this.$openerVm=this.$dialog.openerVm;else if(window.opener){this.isWindowOpener=!0;var s=null;try{var l=window.opener;if(l.dialogArgs&&l.dialogArgs[window.name])try{this.$dialogArgs=JSON.parse(l.dialogArgs[window.name])||null}catch(u){s=u}l.openerVms&&l.openerVms[window.name]&&(this.$openerVm=l.openerVms[window.name]||null)}catch(d){if(console.error(d),s)throw s}}this.$openerVm&&this.$openerVm._isVue&&this.$openerVm.$on("hook:destroyed",this.$clearOpenerVm)}catch(c){dsf.error(c)}},beforeDestroy:function(){this.$clearOpenerVm()},methods:{$openerClosed:function(){this.$clearOpenerVm()},$clearOpenerVm:function(){this.$openerVm&&this.$openerVm.$off("hook:destroyed",this.$clearOpenerVm),this.$openerVm=null},$closeWindow:function(){if(dsf.isMultiPage()){var t=this.$el.closest(".dsf-multiPage-home-view");if(t){var e,n=t.__vue__;return void(null===n||void 0===n||null===(e=n.close)||void 0===e||e.call(n))}this.$multiView}dsf.layer.closeWindow(window,this)},reloadParentViewData:function(){this.$openerVm&&this.$openerVm&&this.$openerVm.reloadData&&this.$openerVm.reloadData()}}}},265:function(t,e,n){"use strict";n.r(e);var i=n(35);e["default"]={mixins:[i["default"]],design:{layout:{exclude:["active"]}},props:{tabHeight:{type:String,default:"100%",desc:"组件高度"},slots:{type:Array,default:function(){return[]}},tabStyle:{type:String,default:"",desc:"组件风格"},tabPosition:{type:String,default:"top",desc:"组件位置"},enableDelete:{type:Boolean,default:!1,desc:"标签是否可关闭"},showPadding:{type:Boolean,default:!0,desc:"是否有边距"},openLazy:{type:Boolean,default:!1,desc:"开启懒加载"},active:{type:String,default:""},contentPadding:{type:Array,default:function(){return["0","0","0","0"]}},formErrorLocationSlot:{type:Boolean,default:!0}},data:function(){return{activeName:this.active,height:"100%"}},computed:{activeNames:function(){var t=[];for(var e in this.slots){var n=this.slots[e];if(this.isDesign)t.push(n.name);else{var i=this.$expressParams();this.$eval(n.disable,i)||this.$eval(n.isHide,i)||t.push(n.name)}}return t}},watch:{activeName:function(){var t=this;this.$nextTick((function(){t.$page&&dsf.resizeComponent(t.$page)}))}},created:function(){var t=this;if(this.isDesign&&0==this.slots.length){for(var e=[],n=0;n<4;n++)e.push({title:"Tab"+(n+1),name:"tab"+(n+1),disable:"false",isHide:"false",badge:null,lazy:"false",controls:[],showTip:"false",tipContent:""});this.slots=e}this.$nextTick((function(){t.changeActive()}))},mounted:function(){var t=this;this.$nextTick((function(){t.resizeHeight()}))},methods:{isdisable:function(t){if(this.isDesign)return!1;if(t.disable){var e=this.$expressParams();return this.$eval(t.disable,e)}return!1},isHide:function(t){if(!this.isDesign){var e=this.$expressParams();return this.$eval(t.isHide,e)}return!1},isLazy:function(t){if(this.isDesign)return!1;var e=this.$expressParams();return this.$eval(t.lazy,e)},changeActive:function(){this.activeNames.length&&-1===this.activeNames.indexOf(this.activeName)&&(this.activeName=this.activeNames[0])},resizeHeight:function(){this.$parent.__desContext__&&(this.$parent.__desContext__.height=this.tabHeight)},tabChange:function(t){this.activeName=t.name},tabClick:function(t,e){var n=this;this.$emit("tab-click",t),this.$nextTick((function(){dsf.resizeComponent(n)}))},tabRemove:function(t,e){},renderTabContent:function(t){var e=t&&t.name?t.name:this.activeName,n=_.find(this.slots,(function(t){return t.name===e}));n.isHide="true",this.$nextTick((function(){n.isHide="false"}))},reloadData:function(){this.$childrenReloadData()}}}},266:function(t,e,n){"use strict";n.r(e);var i=n(12);e["default"]={mixins:[i["default"]],inject:{$formLayoutBox:{default:null}},props:{isTextContent:{type:Boolean,default:!0},value:{type:[String,Number],default:""},defaultValue:{type:[String,Number],default:""},dataCapion:{type:String,default:""},dataCapionTarget:{type:String,default:"icon"},dataCapionType:{type:String,default:"hoverPop"},padding:{type:Array,default:function(){return[8,8,8,8]}},colSpan:{type:[String,Number],default:"24"},color:{type:String,default:""}},design:{isMask:!1},data:function(){return{$value:"文本"}},computed:{getStyle:function(){var t=this,e={};return this.isDesign||(e.padding=_.map(this.padding,(function(e){return t.unitSize(e)})).join(" ")),e},realColor:function(){return this.$compileColor(this.color)}},watch:{value:function(t){!t&&this.defaultValue&&(this.$value=this.defaultValue)}},methods:{showHelper:function(){this.$openDialog({title:"详细描述",template:'<div v-html="params.value"></div>',width:"30vw",height:"50vh",params:{value:this.dataCapion}})},$getClass:function(){var t=[];if(!this.isDesign){var e,n="";if(this.isTextContent&&this.$formLayoutBox&&this.$parent==this.$formLayoutBox)if(dsf.global.$isMobile)n=24,t=["van-col","van-col--"+n];else n=this.colSpan?this.colSpan:null===(e=this.$formLayoutBox)||void 0===e?void 0:e.colSpan,parseInt(n||0)&&(t=["el-col","el-col-"+n])}var a=i["default"].methods.$getClass.call(this);return a.push.apply(a,t),a}}}},267:function(t,e,n){"use strict";function i(t,e){var n=this;this.$openDialog({title:"数据维护",content:"DesStaticTreeData",width:"90vw",height:"60vh",params:{value:n.staticValue||[]},btns:[{text:"确定",handler:function(t){n.staticValue=null===t||void 0===t?void 0:t.yes()}},{text:"清除",handler:function(){n.staticValue=null}},{text:"取消"}]})}n.r(e),e["default"]={design:{settingButton:!0,settingMenus:function(){return[{text:"保存为业务组件",command:"save-business",handler:function(){this.$designer.saveBusinessComponentSingle(this,"")},hidden:function(){return!1}},{text:"静态数据维护",command:"tree-static-data",handler:i,hidden:function(){return!0}}]}}}},268:function(t,e,n){"use strict";n.r(e);var i=n(8),a=n.n(i),r=n(4),o=n.n(r),s=n(1),l=n.n(s);e["default"]={inject:{$buttonOwner:{default:null},$isPreView:{default:!1}},props:{visible:{type:Boolean,default:!0},isButtonBar:{type:Boolean,default:!0},buttons:{type:Array,default:function(){return[]}},size:{type:String,default:""},align:{type:String,default:"center"},emitPrefix:{type:String,default:""},renderButton:{type:Function,default:null},disabledButton:{type:Function,default:null},maxNumber:{type:Number,default:2},moreButtonStyle:{type:String,default:""},moreButtonText:{type:String,default:"更多"},isAllSelected:{type:Boolean,default:!1},slotScopeData:{type:Object,default:function(){return null}}},data:function(){return{client:"pc",buttonHandler:null,sPID:null,sCurNodeID:null,sCurLinkID:null}},computed:{owner:function(){return this.$buttonOwner}},mounted:function(){var t,e,n,i,a,r,o,s,l,u,d;this.isDesign||(null!==(t=this.$vm)&&void 0!==t&&null!==(t=t.$dialog)&&void 0!==t&&null!==(t=t.dialogArgs)&&void 0!==t&&t.data&&(d=this.$vm.$dialog.dialogArgs.data[0]),this.sPID=(null===(e=d)||void 0===e?void 0:e.sPID)||(null===(n=this.$route)||void 0===n||null===(n=n.query)||void 0===n?void 0:n.sPID)||(null===(i=this.queryString)||void 0===i?void 0:i.sPID),this.sCurNodeID=(null===(a=d)||void 0===a?void 0:a.sCurNodeID)||(null===(r=this.$route)||void 0===r||null===(r=r.query)||void 0===r?void 0:r.sCurNodeID)||(null===(o=this.queryString)||void 0===o?void 0:o.sCurNodeID),this.sCurLinkID=(null===(s=d)||void 0===s?void 0:s.sCurLinkID)||(null===(l=this.$route)||void 0===l||null===(l=l.query)||void 0===l?void 0:l.sCurLinkID)||(null===(u=this.queryString)||void 0===u?void 0:u.sCurLinkID),this.initFlowBtns())},methods:{isFunctionCode:function(t){var e=/^\s*function(\s+\w*)?\(.*\)\s*{/g;return e.test(t)},execFunction:function(t,e,n){var i=["var result= ("+n+").call(this,data,button,owner,self);","data=null;","button=null;","owner=null;","self=null;","return result;"],a=new Function("data","button","owner","self",i.join("\n")),r=a.call(this.$vm,this.local,t,e,this);return r=this.$replace(r,this.local),r},getButtonParams:function(t){var e=this,n=this.owner||this,i={system_datagrid_batch_delete:function(t,e,n,i){return n===e.params.length-1?t:i}},a=function(t,n,a){var r=e.$expressParams(e.local),o=e.$replace(t,r);return i[n.actionName]&&(o=i[n.actionName](t,n,a,o)),o},r=_.map(t.params,(function(i,r){var o=null;if("string"==dsf.type(i.value)){var s=i.value.trim();o=e.isFunctionCode(s)?e.execFunction(t,n,s):a(s,t,r)}else if("object"==dsf.type(i.value))if("static"==i.value.type){var l=i.value.code;o=a(l,t,r)}else if("switch"==i.value.type){var u=e.local[i.value.code.field];i.value.code.value[u]&&i.value.value[u],o=a(u,t,r)}else{var d=i.value.code;e.isFunctionCode(d)&&(o=e.execFunction(t,n,d))}return(""==o||dsf.isUnDef(o))&&(o=i.default||null),"false"===o?o=!1:"true"===o&&(o=!0),o}));return r},clickBeforeHandler:function(t,e,n){var i=t.actionBeforeName;if(i&&this.$vm[i]&&dsf.isFunction(this.$vm[i])){var a={owner:this.owner||this,data:this.local,_self:this,targetButton:t,response:n,execWindow:window},r=this.$vm[i](a,e);return dsf.isFunction(r.then)?r:Promise.resolve(r)}return Promise.resolve()},clickHandler:function(t,e,n){var i=this;return o()(l.a.mark((function a(){return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!i.isDesign){a.next=2;break}return a.abrupt("return");case 2:if(!i.$isPreView){a.next=5;break}return dsf.layer.message("当前状态下按钮不可执行此操作",!1),a.abrupt("return");case 5:if(t.execing){a.next=20;break}if(t.execing=!0,a.prev=7,!t.disabled&&!i.isDesign){a.next=10;break}return a.abrupt("return");case 10:return a.next=12,i.execButtonAction(t,e,n);case 12:a.next=17;break;case 14:a.prev=14,a.t0=a["catch"](7),dsf.error(a.t0);case 17:return a.prev=17,t.execing=!1,a.finish(17);case 20:case"end":return a.stop()}}),a,null,[[7,14,17,20]])})))()},buttonAction:function(t,e,n){var i=this;return o()(l.a.mark((function r(){var o,s,u,d,c,f,h,p,v,m,g,y,$,b,x,w,D,_,S,O,k,C,T,I;return l.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(null!==t&&void 0!==t&&t.children&&t.children.length>0)){r.next=2;break}return r.abrupt("return");case 2:if(o=i.owner||i,dsf.isUnDef(t.loading)&&i.$set(t,"loading",!1),!t.isSystem){r.next=21;break}if(d=(null===t||void 0===t?void 0:t.uploadSuccessHandlerParamIndex)||[],c=a()(d,2),f=c[0],h=c[1],!(t.isUploadImportTemplate&&null!==t&&void 0!==t&&null!==(s=t.params)&&void 0!==s&&s[f]&&null!==t&&void 0!==t&&null!==(u=t.params)&&void 0!==u&&null!==(u=u[f])&&void 0!==u&&null!==(u=u.value)&&void 0!==u&&u.code)){r.next=12;break}y=null===(p=t.params)||void 0===p||null===(p=p[h+2])||void 0===p||null===(p=p.value)||void 0===p?void 0:p.code,y?(x=y.split(","),w=a()(x,2),$=w[0],b=w[1]):($="620px",b="auto"),i.$openDialog({title:"导入",width:$,height:b,content:"importTemplateDownload",footerAlign:"center",params:{ids:null===(v=t.params)||void 0===v||null===(v=v[f])||void 0===v||null===(v=v.value)||void 0===v?void 0:v.code,names:null===(m=t.params)||void 0===m||null===(m=m[h])||void 0===m||null===(m=m.value)||void 0===m?void 0:m.code,tips:null===(g=t.params)||void 0===g||null===(g=g[h+1])||void 0===g||null===(g=g.value)||void 0===g?void 0:g.code,button:t,owner:i},btns:[]}),r.next=19;break;case 12:if(D=i.buttonHandler(t.actionName,i.client),_=i.getButtonParams(t),!D||!dsf.isFunction(D)){r.next=19;break}return S={owner:o,data:i.local,_self:i,targetButton:t,params:_},n&&(S.response=n),r.next=19,D.call(i.$vm,S,e);case 19:r.next=40;break;case 21:if(O=(i.emitPrefix?i.emitPrefix+"-":"")+t.actionName,k=o.$listeners[O],!k){r.next=31;break}if(!dsf.isFunction(k)){r.next=29;break}return C={owner:o,data:i.local,_self:i,targetButton:t,execWindow:window},n&&(C.response=n),r.next=29,k(C,e);case 29:r.next=40;break;case 31:if(T=t.actionName,!(T&&i.$vm[T]&&dsf.isFunction(i.$vm[T]))){r.next=39;break}return I={owner:o,data:i.local,_self:i,targetButton:t,execWindow:window},n&&(I.response=n),r.next=37,i.$vm[T](I,e);case 37:r.next=40;break;case 39:i.$message("设置的动作名称"+T+"不存在或不是一个函数",!1);case 40:t.execing=!1;case 41:case"end":return r.stop()}}),r)})))()},execButtonAction:function(t,e,n){var i=this,a=t.secondConfirm,r=t.secondConfirmText;return a?dsf.layer.confirm({message:this.$replace(r||"确认提交？",this.local),dangerouslyUseHTMLString:!0}).then((function(){return i.buttonAction(t,e,n)})):this.buttonAction(t,e,n)},addFlowBtns:function(t,e,n){var i,a=this;if(!e&&this.flowButtons.length>0)return t.popVisible=!t.popVisible,void setTimeout((function(){document.addEventListener("click",a.hidePopVisible)}),0);if(dsf.recursionComponentProps(this.$page.$props,(function(t){t.isFormControl&&"wfinfo"===t.caption&&(i=t.chooseFlow&&t.chooseFlow.id)})),i){var r={sWFID:i,sPID:this.sPID,sCurNodeID:this.sCurNodeID,sCurLinkID:this.sCurLinkID,sExInfos:""};this.getFlowBtns(r,t,e,n)}},getFlowBtns:function(t,e,n,i){var a=this;return this.$http.get("/wfr/getLines",{sWFID:t.sWFID,sPID:t.sPID,sCurNodeID:t.sCurNodeID,sCurLinkID:t.sCurLinkID,sExInfos:""}).done((function(t){if(t.success){var r,o=t.data,s=null===o||void 0===o||null===(r=o.SendParams)||void 0===r||null===(r=r.Lines)||void 0===r?void 0:r.filter((function(t){return 0==t.ccLine||dsf.isUnDef(t.ccLine)})),l=[];return s&&(s.forEach((function(t){"审核通过"===t.Name?t.order=0:"返回修改"===t.Name?t.order=1:"审核不通过"===t.Name?t.order=2:t.order=1})),s.sort((function(t,e){return t.order-e.order})),s.forEach((function(t,r){var o=Object.assign({},e,{caption:t.Name,text:t.Name,title:t.Name,line:t});o.visible=e.flowVisible,delete o.flowVisible,n?(dsf.global.$isMobile||setTimeout((function(){o.style={width:"auto",transform:"scale(1)"}}),0),n.splice(i+r+1,0,o),l.push(o)):(a.flowButtons.push(o),a.$set(e,"popVisible",!0),document.addEventListener("click",a.hidePopVisible))})),n&&n.splice(n.indexOf(e),1)),a.$dispatch("getStepBtns",n,l),l}return t.message})).catch((function(t){return[]}))},hideFlowBtn:function(t){var e,n=t.actionName;if(!this.sPID)return["system_flow_send","system_batch_flow_send","system_flow_openDialog","system_flow_changeHandler"].includes(n);if(null!==(e=this.$vm)&&void 0!==e&&null!==(e=e.flows)&&void 0!==e&&e.flowCurInfo){var i=this.$vm.flows.flowCurInfo,a=i.processstatus,r=i.STATUS;return 1==a?[0,1].includes(r)?!["system_flow_recovery","system_flow_recoveryLink","system_flow_applyRecovery","system_flow_forceRecovery","system_flow_urge"].includes(n):!![2,-4].includes(r)&&(i.sendBack?"system_flow_situation"===n:["system_flow_forceRecovery","system_flow_recovery","system_flow_situation"].includes(n)):"system_flow_situation"===n}return!0},initFlowBtns:function(){var t=this,e=!1,n=!1;this.buttons.forEach((function(i,a){i.execing=!1;var r=i.isLinkSend,o=i.isLinkSendFold,s=i.actionName,l=["system_flow_send","system_batch_flow_send"];i.isSystem&&r&&!o&&l.indexOf(s)>=0&&(dsf.client.type&&dsf.client.type.indexOf("IE")>-1&&(i.style={transform:"scale(0.99)"}),i.flowVisible=i.visible,t.$form&&(i.visible=!1),t.addFlowBtns(i,t.buttons,a)),t.$form&&i.isSystem&&(s.indexOf("system_flow")>-1||s.indexOf("system_batch_flow")>-1)&&(e=!0),i.autoReceive&&(n=!0)})),e&&dsf.flow.getLinkCurInfo(n,this)}}}},269:function(t,e,n){"use strict";n.r(e),e["default"]={ctrlCaption:"处理意见",props:{allowPost:{type:Boolean,default:!1},caption:{type:String,default:function(){return""}},label:{type:String,default:function(){return""}},placeholder:{type:String,default:function(){return"请输入"}},showLabel:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}},visible:{type:Boolean,default:function(){return!0}},isTextarea:{type:Boolean,default:function(){return!1}},textareaRows:{type:Number,default:function(){return 3}},visibleUpBtn:{type:Boolean,default:function(){return!0}},visibleOptionsBtn:{type:Boolean,default:function(){return!0}},visibleUpImgBtn:{type:Boolean,default:function(){return!0}},tbNoPadding:{type:Boolean,default:function(){return!1}},defaultValue:{type:String,default:function(){return""}},metadata:{type:Object,default:function(){return{id:"",name:"处理意见",type:dsf.metadata.mmtype(3),valueAttributes:[{name:"文本",code:"text",type:dsf.metadata.getDataType("string"),length:"1000",defaultValue:null,unit:null}],dataSource:{attachTipsMaps:{},code:dsf.config.setting_encrypt_level_dictionary,type:"dict"}}}}},data:function(){return{showOptions:!1,sPID:0,sCurLinkID:0,options:[],isSave:!0,sOpinion:{Content:"",Attachments:[]},dataKey:""}},computed:{uploadFiles:{get:function(){return JSON.stringify(this.sOpinion.Attachments)},set:function(t){this.$set(this.sOpinion,"Attachments",JSON.parse(t))}}},watch:{"$vm.$isReady":function(t){t&&(this.sOpinion.Content=this.$replace(this.defaultValue,this.local))},"sOpinion.Content":function(t){var e=this;this.emitValueChange(t),this.$nextTick((function(){e.emitFormValidate(t),e.$dispatch("change",t)}))}},mounted:function(){if(this.$vm&&this.$vm.$dialog&&this.$vm.$dialog.dialogArgs&&this.$vm.$dialog.dialogArgs.data){var t=this.$vm.$dialog.dialogArgs.data[0];this.sPID=t.sPID,this.sCurLinkID=t.sCurLinkID}else this.sPID=this.$route.query.sPID||this.queryString.sPID,this.sCurLinkID=this.$route.query.sCurLinkID||this.queryString.sCurLinkID;!this.isDesign&&this.sPID&&this.sCurLinkID&&this.initOptions(),this.$vm&&this.$vm.flows&&(this.$vm.flows.disposeIdea=this),this.dataKey=this.metadata.dataKey},methods:{initOptions:function(){var t=this;this.$http.get("wfr/getOpinionKeyWord",{sPID:this.sPID}).then((function(e){e.data.success&&(t.options=e.data.data.map((function(t){return t.name=t.key_word,t})))}))},setValue:function(t){this.sOpinion.Content=t.key_word,this.showOptions=!1},upload:function(){this.$refs.uploadFile.openSelectFile()},getAttachments:function(t){this.sOpinion.Attachments=JSON.parse(t.args)},setDoSave:function(t){this.isSave=t},postBefore:function(t){var e=this;if(this.isSave&&(this.sPID||this.sCurLinkID)){var n={sPID:this.sPID,sCurLinkID:this.sCurLinkID,sOpinion:this.sOpinion};n.sOpinion=JSON.stringify(n.sOpinion),this.$http.get("wfr/opinion",n).then((function(t){t.data.success||e.$message(t.data.message||(e.label||"处理意见")+"异常",!1)})).catch((function(t){e.$message((e.label||"处理意见")+"异常",!1)}))}else;}}}},27:function(t,e,n){var i=n(9)["default"];function a(){"use strict";t.exports=a=function(){return n},t.exports.__esModule=!0,t.exports["default"]=t.exports;var e,n={},r=Object.prototype,o=r.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},l="function"==typeof Symbol?Symbol:{},u=l.iterator||"@@iterator",d=l.asyncIterator||"@@asyncIterator",c=l.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(e){f=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var a=e&&e.prototype instanceof b?e:b,r=Object.create(a.prototype),o=new P(i||[]);return s(r,"_invoke",{value:T(t,n,o)}),r}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=h;var v="suspendedStart",m="suspendedYield",g="executing",y="completed",$={};function b(){}function x(){}function w(){}var D={};f(D,u,(function(){return this}));var _=Object.getPrototypeOf,S=_&&_(_(F([])));S&&S!==r&&o.call(S,u)&&(D=S);var O=w.prototype=b.prototype=Object.create(D);function k(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(a,r,s,l){var u=p(t[a],t,r);if("throw"!==u.type){var d=u.arg,c=d.value;return c&&"object"==i(c)&&o.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(c).then((function(t){d.value=t,s(d)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;s(this,"_invoke",{value:function(t,i){function r(){return new e((function(e,a){n(t,i,e,a)}))}return a=a?a.then(r,r):r()}})}function T(t,n,i){var a=v;return function(r,o){if(a===g)throw new Error("Generator is already running");if(a===y){if("throw"===r)throw o;return{value:e,done:!0}}for(i.method=r,i.arg=o;;){var s=i.delegate;if(s){var l=I(s,i);if(l){if(l===$)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(a===v)throw a=y,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);a=g;var u=p(t,n,i);if("normal"===u.type){if(a=i.done?y:m,u.arg===$)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(a=y,i.method="throw",i.arg=u.arg)}}}function I(t,n){var i=n.method,a=t.iterator[i];if(a===e)return n.delegate=null,"throw"===i&&t.iterator["return"]&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),$;var r=p(a,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,$;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,$):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,$)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function F(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,r=function n(){for(;++a<t.length;)if(o.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}throw new TypeError(i(t)+" is not iterable")}return x.prototype=w,s(O,"constructor",{value:w,configurable:!0}),s(w,"constructor",{value:x,configurable:!0}),x.displayName=f(w,c,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,f(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},n.awrap=function(t){return{__await:t}},k(C.prototype),f(C.prototype,d,(function(){return this})),n.AsyncIterator=C,n.async=function(t,e,i,a,r){void 0===r&&(r=Promise);var o=new C(h(t,e,i,a),r);return n.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},k(O),f(O,c,"Generator"),f(O,u,(function(){return this})),f(O,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=F,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,a){return s.type="throw",s.arg=t,n.next=i,a&&(n.method="next",n.arg=e),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],s=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var l=o.call(r,"catchLoc"),u=o.call(r,"finallyLoc");if(l&&u){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=t,r.arg=e,a?(this.method="next",this.next=a.finallyLoc,$):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),$},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),$}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var a=i.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:F(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),$}},n}t.exports=a,t.exports.__esModule=!0,t.exports["default"]=t.exports},270:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__["default"]={ctrlCaption:"流程信息",props:{caption:{type:String,default:function(){return"wfinfo"}},chooseFlow:{type:Object,default:function(){return{}}},sWFID:{type:String,default:function(){return""}},sObjectID:{type:String,default:function(){return""}},sObjectName:{type:String,default:function(){return""}},sPID:{type:String,default:function(){return""}},sCurLinkID:{type:String,default:function(){return""}},sCurNodeID:{type:String,default:function(){return""}},sOpinion:{type:String,default:function(){return""}},sExInfos:{type:String,default:function(){return""}},sLineIDs:{type:String,default:function(){return""}},sReceivers:{type:String,default:function(){return""}},eventName:{type:String,default:function(){return""}},countDown:{type:String,default:function(){return"3"}},linkData:{type:Array,default:function(){return[]}},forceHidden:{type:Boolean,default:!0},metadata:{type:Object,default:function(){return dsf.metadata.get("flow-info-meta-data")}}},data:function(){return{Objects:{}}},watch:{chooseFlow:function(t){var e={wf_id:t.ID,wf_name:t.name};this.emitValueChange(e)}},computed:{},mounted:function(){this.$vm&&this.$vm.flows&&(this.$vm.flows.flowInfo=this)},destroyed:function(){},methods:{getCurrLinkID:function(t){var e,n,i=this.$replace(this.sCurLinkID,this.$vm);return i||(null===t||void 0===t?void 0:t.sCurLinkID)||(null===(e=this.$route.query)||void 0===e?void 0:e.sCurLinkID)||(null===(n=this.queryString)||void 0===n?void 0:n.sCurLinkID)},linkSetChooseFlow:function(){var t;null===(t=document.querySelector("[rel='linkData'] .ds-button"))||void 0===t||t.click()},flowSend:function flowSend(res,targetButton,Objects){var line=targetButton.line,IsSPSend=targetButton.IsSPSend;this.Objects=Objects;var sWFID=this.chooseFlow.dsfa_rm_id;if(sWFID){var _this$$vm$$refs$this$,_ds_security_level,_ds_security_level2,sObjectName=this.$replace(this.sObjectName,this.$vm);sWFID=this.$replace(this.sWFID,this.$vm)||sWFID;var sCurNodeID=this.$replace(this.sCurNodeID,this.$vm),sPID=this.$replace(this.sPID,this.$vm),sOpinion=this.$replace(this.sOpinion,this.$vm),sLineIDs=this.$replace(this.sLineIDs,this.$vm),sObjectID=this.$replace(this.sObjectID,this.$vm),sExInfos=this.$replace(this.sExInfos,this.$vm),sReceivers=this.$replace(this.sReceivers,this.$vm),ds_security_level;for(var key in sExInfos=sExInfos?eval("("+sExInfos+")"):"",sOpinion=sOpinion?eval("("+sOpinion+")"):"",sLineIDs=sLineIDs?eval("("+sLineIDs+")"):"",sExInfos=sExInfos||Object.assign({},dsf.removePoint(this.$vm.$viewData),this.$route.query),this.$vm.$viewData){var _this$$vm$$viewData;if((null===key||void 0===key?void 0:key.indexOf(".ds_security_level"))>-1)ds_security_level=null===(_this$$vm$$viewData=this.$vm.$viewData)||void 0===_this$$vm$$viewData?void 0:_this$$vm$$viewData[key]}var url=IsSPSend?"wfr/startSPSend":"wfr/startSend",param={sWFID:sWFID,sObjectID:sObjectID||res._id,sObjectName:sObjectName||(null===(_this$$vm$$refs$this$=this.$vm.$refs[this.eventName])||void 0===_this$$vm$$refs$this$?void 0:_this$$vm$$refs$this$.value)||"",sCurNodeID:sCurNodeID||"",sExInfos:JSON.stringify(sExInfos),sReceivers:sReceivers,securityClassValue:null===(_ds_security_level=ds_security_level)||void 0===_ds_security_level?void 0:_ds_security_level.value,securityLevelExpiryDate:null===(_ds_security_level2=ds_security_level)||void 0===_ds_security_level2?void 0:_ds_security_level2.expirydate},_this$$route$query2,_this$queryString2,_ds_security_level3,_ds_security_level4,_this$$vm,_this$$vm2,_this$$vm3;if(Objects||this.$route.query.sPID||this.queryString.sPID)url=IsSPSend?"wfr/spSend":"wfr/send",param={sPID:sPID||(null===Objects||void 0===Objects?void 0:Objects.sPID)||(null===(_this$$route$query2=this.$route.query)||void 0===_this$$route$query2?void 0:_this$$route$query2.sPID)||(null===(_this$queryString2=this.queryString)||void 0===_this$queryString2?void 0:_this$queryString2.sPID),sCurLinkID:this.getCurrLinkID(this.Objects),sExInfos:JSON.stringify(sExInfos),sReceivers:sReceivers,securityClassValue:null===(_ds_security_level3=ds_security_level)||void 0===_ds_security_level3?void 0:_ds_security_level3.value,securityLevelExpiryDate:null===(_ds_security_level4=ds_security_level)||void 0===_ds_security_level4?void 0:_ds_security_level4.expirydate};if(sOpinion)param.sOpinion=JSON.stringify(sOpinion);else null!==(_this$$vm=this.$vm)&&void 0!==_this$$vm&&null!==(_this$$vm=_this$$vm.flows)&&void 0!==_this$$vm&&null!==(_this$$vm=_this$$vm.disposeIdea)&&void 0!==_this$$vm&&_this$$vm.sOpinion&&(param.sOpinion=JSON.stringify(this.$vm.flows.disposeIdea.sOpinion)),(null!==(_this$$vm2=this.$vm)&&void 0!==_this$$vm2&&null!==(_this$$vm2=_this$$vm2.flows)&&void 0!==_this$$vm2&&null!==(_this$$vm2=_this$$vm2.sOpinion)&&void 0!==_this$$vm2&&_this$$vm2.Content||(null===(_this$$vm3=this.$vm)||void 0===_this$$vm3||null===(_this$$vm3=_this$$vm3.flows)||void 0===_this$$vm3||null===(_this$$vm3=_this$$vm3.sOpinion)||void 0===_this$$vm3||null===(_this$$vm3=_this$$vm3.Attachments)||void 0===_this$$vm3?void 0:_this$$vm3.length)>0)&&(param.sOpinion=JSON.stringify(this.$vm.flows.sOpinion));sLineIDs?param.sLineIDs=sLineIDs:line&&(param.sLineIDs=line.LineID);var config={param:param,url:targetButton.flowUrl||url,countDown:this.countDown};dsf.flow.startSend(config)}else this.$message("请先配置流程信息控件的'选择流程'",!1)}}}},271:function(t,e,n){"use strict";n.r(e),e["default"]={ctrlCaption:"表单意见框",props:{caption:{type:String,default:function(){return""}},label:{type:String,default:function(){return""}},showLabel:{type:Boolean,default:function(){return!0}},visible:{type:Boolean,default:function(){return!0}},tbNoPadding:{type:Boolean,default:function(){return!1}},lrNoPadding:{type:Boolean,default:function(){return!1}},showAddComment:{type:Boolean,default:function(){return!1}},showBack:{type:Boolean,default:function(){return!0}},addCommentText:{type:String,default:function(){return"填写处理意见"}},scope:{type:Number,default:function(){return 0}},nodes:{type:Array,default:function(){return[]}},order:{type:Number,default:function(){return 0}},template:{type:Number,default:function(){return 0}},metadata:{type:Object,default:function(){return{id:"",name:"表单意见框",type:{value:3,text:"业务元数据"},valueAttributes:[{name:"文本",code:"text",type:dsf.metadata.getDataType("string"),length:"50",defaultValue:null,unit:null}]}}}},data:function(){return{sPID:this.$route.query.sPID,sCurLinkID:this.$route.query.sCurLinkID,curNodeId:null}},computed:{data:function(){var t;return this.isDesign||!this.sPID?[{nodename:"拟稿",STATUS:0,linkid:"faedda583f7742948b0714f0f17d1085",opinionatts:{Content:"同意"},ruserid:"",pid:"af60e455757d48dd801d07b1538eb806",rusername:"平台管理员",rdeptname:"平台管理组",reachtime:"2020年01月06日 18:21:21",receivetime:"2020年1月2日 10:21:21"}]:null!==(t=this.$vm)&&void 0!==t&&null!==(t=t.flows)&&void 0!==t&&t.flowProcess?this.formatData(_.cloneDeep(this.$vm.flows.flowProcess)):[]},isShowAdd:function(){var t,e,n,i,a,r=this;return this.isDesign?this.showAddComment:2!=(null===(t=this.$vm)||void 0===t||null===(t=t.flows)||void 0===t||null===(t=t.flowCurInfo)||void 0===t?void 0:t.STATUS)&&(!(!this.showAddComment||null===(e=this.$vm)||void 0===e||null===(e=e.flows)||void 0===e||!e.flowProcess)&&(null===(n=this.$vm)||void 0===n||null===(n=n.flows)||void 0===n||null===(n=n.flowProcess)||void 0===n||n.forEach((function(t){r.sCurLinkID===t.linkid&&"299"!=t.nodetype&&(a=t.nodeid)})),(null===(i=this.nodes)||void 0===i?void 0:i.indexOf(a))>-1))}},mounted:function(){var t=this.$dialog&&this.$dialog.dialogArgs&&this.$dialog.dialogArgs.data&&this.$dialog.dialogArgs.data[0]||null;this.sPID=t?t.sPID:this.$route.query.sPID||this.queryString.sPID,this.sCurLinkID=t?t.sCurLinkID:this.$route.query.sCurLinkID||this.queryString.sCurLinkID,this.sPID&&this.init()},methods:{init:function(){var t,e=this;null!==(t=this.$vm)&&void 0!==t&&null!==(t=t.flows)&&void 0!==t&&t.loadFlowProcess||(this.$vm.flows.loadFlowProcess=!0,this.$http.get("wfr/getProcessInfoByPID",{sPID:this.sPID}).then((function(t){var n,i;t.data.success&&(null!==(n=e.$vm)&&void 0!==n&&n.flows&&(e.$set(e.$vm.flows,"flowProcess",t.data.data),null===(i=e.$vm.flows)||void 0===i||null===(i=i.flowProcess)||void 0===i||i.forEach((function(t){e.sCurLinkID===t.linkid&&"299"!=t.nodetype&&(e.$vm.flows.sOpinion=JSON.parse(t.opinionatts))}))))})))},addComment:function(){this.$listeners["click"]?this.$dispatch("click",this):this.openDialog()},openDialog:function(){this.$openDialog({title:"处理意见",width:dsf.global.$isMobile?"100vw":"800px",height:dsf.global.$isMobile?"100vw":"490px",content:dsf.global.$isMobile?"DsfMobileFlowAddComment":"DsfFlowAddComment",hasFooter:!1,footerAlign:"center",params:{$vm:this.$vm,flow:{sPID:this.sPID,sCurLinkID:this.sCurLinkID}},dialogArgs:{},btns:[]})},formatData:function(t){var e=this,n=[];return t.forEach((function(t){t.opinionatts=JSON.parse(t.opinionatts),e.nodes&&e.nodes.forEach((function(i){i===t.nodeid&&(e.showBack||-4!=t["STATUS"])&&n.push(t)}))})),n}}}},272:function(t,e,n){"use strict";n.r(e);var i=n(2),a=n.n(i);e["default"]={mixins:[$mixins.propertyDialogSetting],props:{noUrl:{type:Boolean,default:!1},selectTabsVals:{type:Array,default:function(){return[]}}},computed:{selectTabs:function(){var t=this;return this.selectTabValues.map((function(e){return t.tabMap[e]})).filter((function(t){return!!t}))}},data:function(){return{tabs:[],selectTabValues:[],loadComplete:!1,options:{animation:300,delay:100,forceFallback:!0,ghostClass:"ghost",dragClass:"drag",chosenClass:"drag-chosen"}}},created:function(){var t=this;this.tabMap={};var e=[];this.currentData.forEach((function(n){t.tabMap[n.name]=n,n&&e.push(n)}));var n=[];this.selectTabsVals.forEach((function(e){var i;!t.tabMap[e]||null!==(i=t.tabMap[e])&&void 0!==i&&i.hide||n.push(e)})),this.tabs=e,this.selectTabValues=n,this.loadScript((function(){t.loadComplete=!0}))},methods:{yes:function(){var t=this.selectTabValues;return t.length||(t=this.tabs.filter((function(t){return!t.hide})).map((function(t){return t.name}))),t},reset:function(){return this.selectTabValues=this.tabs.filter((function(t){return!t.hide})).map((function(t){return t.name})),this.selectTabValues},loadScript:function(t){var e=this;window.vuedraggable?(this.scriptLoaded=!0,null===t||void 0===t||t()):this.$http.importFiles([dsf.url.getWebPath("$/js/libs/vuedraggable/Sortable-1.13.0.js"),dsf.url.getWebPath("$/js/libs/vuedraggable/vuedraggable.umd.js")]).then((function(){e.scriptLoaded=!0,null===t||void 0===t||t()})).catch((function(t){console.error(t),dsf.layer.message("加载fabric文件报错",!1)}))},update:function(t){var e=t.oldIndex,n=t.newIndex;this.swapArray(this.selectTabValues,e,n)},swapArray:function(t,e,n){return t.splice.apply(t,[n,0].concat(a()(t.splice(e,1)))),t},removeTag:function(t,e){this.selectTabValues.splice(e,1)}},mounted:function(){}}},273:function(t,e,n){"use strict";n.r(e),e["default"]={mixins:[$mixins.propertyDialogSetting],data:function(){return{tableData:[],names:[]}},created:function(){for(var t=this.currentData,e=0;e<t.length;e++){var n=t[e];"string"!=typeof n.more&&n.more||this.$set(n,"more",{url:n.more||""})}this.tableData=t||[this.newTab()]},methods:{tableRowClassName:function(t){var e=t.row,n=t.rowIndex,i="";if(e.name){this.names[n]="";var a=this.names.indexOf(e.name);-1!=a&&a<n&&(i="warning-row"),this.names[n]=e.name}return i},newTab:function(){return{title:"Tab"+(this.tableData.length+1),name:"tab"+(this.tableData.length+1),hide:!1,badge:null,lazy:!1,url:"",controls:[],more:{},showTip:!1,tipContent:""}},add:function(){this.tableData.push(this.newTab())},insert:function(t){this.tableData.splice(t.$index+1,0,this.newTab())},deleted:function(t){this.tableData.splice(t.$index,1)},up:function(t){if(t.$index>0){var e=this.tableData[t.$index];this.tableData.splice(t.$index,1),this.tableData.splice(t.$index-1,0,e)}},down:function(t){if(this.tableData.length-1>t.$index){var e=this.tableData[t.$index];this.tableData.splice(t.$index,1),this.tableData.splice(t.$index+1,0,e)}},validate:function(){for(var t in this.tableData){this.tableData[t]["name"]=this.tableData[t]["name"]||dsf.uuid();var e=this.names.indexOf(this.tableData[t]["name"]);if(-1!=e&&e<t)return dsf.layer.message("请解决重复标识",!1),!1}return!0},yes:function(){return this.tableData},checkMaxSpan:function(t,e){t[e]=dsf.isNumber(t[e])?Number(t[e]):null,t[e]&&t[e]>24&&(t[e]=24),t[e]&&t[e]<0&&(t[e]=null)},toUrlSet:function(t,e){var n=this;t[e]||this.$set(t,e,{}),this.$openDialog({title:"跳转配置",content:"ToUrlEdit",height:"400px",width:"700px",params:{currentData:t[e]},btns:[{text:"确定",handler:function(i){n.$set(t,e,i.yes())}},{text:"取消"}]})}}}},274:function(t,e,n){"use strict";n.r(e);var i=n(12);e["default"]={mixins:[i["default"]],inject:{$list:{default:null},$cardList:{default:null}},props:{buttons:{type:Array,default:function(){return[]}},keysMap:{type:[Array,Function],default:function(){return[]}},local:{type:Object,default:function(){return{}}},clickBefore:{type:Function,required:!1},errorSrc:{type:String,default:""}},computed:{keysObj:function(){var t={};return _.forEach(this.keysMap,(function(e){t[e.to]=e})),t},data:function(){var t=this,e={};return _.forEach(this.keysMap,(function(n){var i=n.to,a=n.from,r=n.type,o=t.local[a];e[i]="Boolean"===r?!!o:o})),e},checked:{get:function(){var t=this.$cardList.rowKey;return this.$cardList.checkIdList.indexOf(this.local[t])>-1},set:function(t){this.$cardList.checkChange(this.local,!!t)}},disabled:function(){return this.$cardList.selectableHandler(this.local,this.local.$index)}},methods:{getLabel:function(t){return this.keysObj[t].label||""},getPrefix:function(t){return this.keysObj[t].prefix||""},getSuffix:function(t){return this.keysObj[t].suffix||""},_clickBefore:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];if(!this.isDesign){var r=null===(e=this.clickBefore)||void 0===e?void 0:e.call(this,this.local);r&&r.then?r.then((function(e){!1!==e&&t.apply(void 0,i)})):!1!==r&&t.apply(void 0,i)}},clickAfter:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.$nextTick((function(){t.$dispatch("click-after",n)}))}}}},275:function(t,e,n){"use strict";n.r(e);var i=n(2),a=n.n(i),r=n(35);e["default"]={mixins:[r["default"]],inject:{$list:{default:null}},provide:function(){return{$cardList:this}},props:{rowKey:{type:[String,Function],default:"_id"},data:{type:Array,default:null},url:{type:String,default:""},horizontal:{type:Boolean,default:!1},columnNumber:{type:Number,default:3},columnWidth:{type:String,default:"32%"},lineHeight:{type:String,default:"120px"},marginTop:{type:String,default:"15px"},marginLeft:{type:String,default:"15px"},checkbox:{type:Boolean,default:!1},checkboxStyle:{type:String,default:"style1"},maxCheckNum:{type:Number,default:0},showCheckAll:{type:Boolean,default:!0},selectable:{type:[Array,Function],required:!1},slots:{type:Array,default:function(){return[{name:"default",controls:[],scope:"scope",dataKey:"row",textProxy:!0,repeat:!0}]}},dataFormat:{type:Function,default:null}},data:function(){return{dataCopy:[],checkIdList:[],checkDataList:[]}},computed:{cWidth:function(){return this.$isMobile?this.pxToRem(this.columnWidth):this.columnWidth},lHeight:function(){return this.$isMobile?this.pxToRem(this.lineHeight):this.lineHeight},mTop:function(){return this.$isMobile?this.pxToRem(this.marginTop):this.marginTop},listStyle:function(){var t=this;if(!this.horizontal)return{};var e=_.map(this.padding,(function(e){return t.pxToRem(e)})),n="".concat(this.columnNumber," * ").concat(this.lHeight," + ").concat(this.columnNumber-1," * ").concat(this.mTop);return{height:"calc(".concat(n,")"),"padding-left":e[3],"padding-right":e[1]}},itemStyle:function(){var t=this.marginLeft;this.$isMobile&&(t=this.pxToRem(t)),this.horizontal||(t="calc((100% - ".concat(this.cWidth," * ").concat(this.columnNumber,") / ").concat(this.columnNumber-1,")"));var e={width:this.cWidth,"margin-Left":t,"margin-top":this.mTop};return this.horizontal&&(e["height"]=this.lHeight),e},realData:function(){return this.$list?this.data:this.data?_.map(this.data,(function(t,e){return Object.assign({$hash:dsf.uuid(),$order:e,$index:e},t)})):this.dataCopy},realMaxCheckNum:function(){return this.maxCheckNum?Math.min(this.maxCheckNum,this.realData.length):this.realData.length},checkAll:function(){var t=this.getCurrentCheckInfo(),e=t.checkedList,n=t.notCheckedList,i=e.length,a=n.length;return i&&(!a||i>=this.realMaxCheckNum)},isIndeterminate:function(){var t=this.checkIdList.length;return!this.checkAll&&(t>0&&t<this.realMaxCheckNum)}},watch:{url:function(){this.reloadData()}},created:function(){this.reloadData()},methods:{getItemClass:function(t){var e=this.columnNumber;return this.horizontal?{"no-margin-top":!(t%e),"no-margin-left":t<e}:{"no-margin-left":!(t%e),"no-margin-top":t<e}},reloadData:function(){this.isDesign||this.data||this.getUrlData()},getUrlData:function(){var t=this;if(this.url){var e=dsf.layer.loading(),n=this.$replace(this.url,this);this.$http.get(n).done((function(e){var n=e.success,i=e.data,a=e.message;n?("Function"===dsf.type(t.dataFormat)&&(i=t.dataFormat(i)),t.dataCopy=_.map(i,(function(t,e){return Object.assign({$hash:dsf.uuid(),$order:e,$index:e},t)}))):t.$message(a||"请求异常",!1)})).error((function(e){dsf.error(e),t.$message((null===e||void 0===e?void 0:e.message)||"请求异常",!1)})).always((function(){dsf.layer.closeLoading(e)}))}else this.dataCopy=[]},getCurrentCheckInfo:function(){var t=this,e=[],n=[],i=[],a=[];return _.forEach(this.realData,(function(r,o){var s=r[t.rowKey],l=t.checkIdList.indexOf(s)>-1,u=!t.selectableHandler(r,o);u?(n.push(r),l&&i.push(r)):l?e.push(r):a.push(r)})),{checkedList:e,disabledList:n,disabledCheckedList:i,notCheckedList:a}},selectableHandler:function(t,e){var n=t[this.rowKey];return dsf.isArray(this.selectable)?-1===this.selectable.indexOf(n):!dsf.isFunction(this.selectable)||this.selectable(t,e)},checkChange:function(t,e){var n=t[this.rowKey],i=this.checkIdList.indexOf(n),a=!this.selectableHandler(t,t.$index);if(!a)if(!e&&i>-1)this.checkIdList.splice(i,1),this.checkDataList.splice(i,1),this.$emit("select",this.checkDataList,t);else if(e&&-1===i)if(1==this.maxCheckNum)this.checkIdList=[n],this.checkDataList=[t],this.$emit("select",this.checkDataList,t);else{if(this.maxCheckNum>1){var r=this.getCurrentCheckInfo(),o=r.checkedList;if(o.length>=this.maxCheckNum)return void this.$message("最多只能选择".concat(this.maxCheckNum,"条数据"),!1)}this.checkIdList.push(n),this.checkDataList.push(t),this.$emit("select",this.checkDataList,t)}},handleCheckAllChange:function(t,e){var n,i,r=this.getCurrentCheckInfo(),o=r.disabledCheckedList,s=r.notCheckedList;t?s.length&&((n=this.checkIdList).push.apply(n,a()(_.map(s,this.rowKey))),(i=this.checkDataList).push.apply(i,a()(s))):(this.checkDataList=o,this.checkIdList=_.map(o,this.rowKey));e||this.$emit("select-all",this.checkDataList)},clearSelection:function(){this.checkIdList=[],this.checkDataList=[]},toggleRowSelection:function(t,e){this.checkChange(t,e)},toggleAllSelection:function(){this.handleCheckAllChange(!this.checkAll,!0)}}}},276:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__);__webpack_exports__["default"]={props:{slots:{type:Array,default:function(){return[{name:"default",controls:[]}]}},dataType:{type:String,default:"static"},chartString:{type:String,default:""},dataURL:{type:String,default:""},width:{type:String,default:"100%"},configAttachRequestParams:{type:Array,default:function(){return[]}},height:{type:String,default:"300px"}},watch:{width:function(){var t=this;this.$nextTick((function(){t.chartObj&&t.chartObj.resize()}))},height:{handler:function(t){var e=this;if(this.isDesign){var n=t;t||(n="auto"),dsf.isNumber(n)&&(n+="px"),this.$dispatch("design-height-change",n)}this.$nextTick((function(){e.chartObj&&e.chartObj.resize()}))},immediate:!0},dataType:function(){var t=this;this.$nextTick((function(){t.init(!0)}))},dataURL:function(){var t=this;this.$nextTick((function(){t.init()}))},chart:{handler:function(t){var e=this;this.$nextTick((function(){e.reset()}))},deep:!0},excelData:{handler:function(t){this.isDesign&&this.dataExcelAnalysis(t)},deep:!0}},data:function(){return{chartObj:null}},created:function created(){if(this.chartString){var chartString=this.chartString,tmp="(function () {\n        return ".concat(chartString,"\n      })()");this.$emit("update:chart",eval(tmp))}},mounted:function(){var t=this;this.loadCharts(this).then((function(){"function"===typeof t.beforeInit?t.beforeInit():t.init()})).catch((function(t){dsf.error(t)}))},beforeDestroy:function(){var t,e;this.chartObj&&this.chartObj.dispose(),null===(t=dsf)||void 0===t||null===(t=t.emit)||void 0===t||null===(e=t.$remove)||void 0===e||e.call(t,"loadCharts",this)},methods:{objectTostring:function(t,e){var n=this;if(null===t)return"null,\n";if("string"===typeof t)return"'".concat(t,"',\n");if("function"===typeof t)return t.toString()+",";if(Array.isArray(t)){var i="[\n          ";return t.forEach((function(t){i+="".concat(n.objectTostring(t))})),i+="]","".concat(i,",\n")}if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(t)){var a="{\n          ";return Object.keys(t).forEach((function(e){a+="".concat(e,":"),a+=n.objectTostring(t[e])})),a+="}","".concat(a,e?"\n":",\n")}return"".concat(t,",\n")},dataExcelAnalysis:function(){},loadCharts:function(){var t=this;return dsf.chart.loadEcharts(this).then((function(){var e=window.$echarts||window.echarts;t.chartObj=e.init(t.$refs["chart"])})).catch((function(t){throw t}))},init:function(){var t=this;if(!this.chartObj)return!1;if(this.chartObj.showLoading({text:"正在加载数据"}),"interface"!==this.dataType||this.isDesign)"datasource"!==this.dataType||this.isDesign?"excel"===this.dataType?this.dataExcelAnalysis(this.excelData):this.analysis():this.dataURL?this.$http.get(this.$replace(this.dataURL,this.local)).done((function(e){var n=e.success,i=e.data;n&&t.dataSourceAnalysis(i)})).error((function(e){t.$message(e&&e.message||"请求异常",!1)})):this.$message("数据源地址未配置",!1);else if(this.dataURL){var e=this.getConfigAttachRequestParams();this.$http.get(this.$replace(this.dataURL,this.local),e).done((function(e){var n=e.success,i=e.data,a=e.message;if(n)return Promise.resolve(i);t.$dispatch("httpError",{message:a,options:t.chart,vm:t}),t.chartObj&&t.chartObj.hideLoading()})).then((function(e){e&&t.analysis(e)})).error((function(e){t.$message(e&&e.message||"请求异常",!1)}))}else this.$dispatch("interceptData",{options:this.chart,vm:this})},getConfigAttachRequestParams:function(){var t,e=this,n={};return null===(t=this.configAttachRequestParams)||void 0===t||t.forEach((function(t){if(t.queryKey)if("text"==t.origin)n[t.queryKey]=t.valueKey;else if(t.valueKey)if("queryString"==t.origin){if(e.queryString){var i=e.$replace(t.valueKey,e.queryString);n[t.queryKey]=i||""}}else if("cookie"==t.origin){var a=dsf.session.get(),r=e.$replace(t.valueKey,a);n[t.queryKey]=r||""}else if("localStorage"==t.origin){var o=e.$replace(t.valueKey,localStorage);n[t.queryKey]=o||""}else if("sessionStorage"==t.origin){var s=e.$replace(t.valueKey,sessionStorage);n[t.queryKey]=s||""}else if("vm"==t.origin)if(e.$vm){var l=e.$replace(t.valueKey,e.$vm);n[t.queryKey]=l}else n[t.queryKey]="";else if("dialog"==t.origin)if(e.$vm&&e.$vm.dialogArgs){var u=e.$replace(t.valueKey,e.$vm.dialogArgs);n[t.queryKey]=u}else n[t.queryKey]=""})),n},resetByHttp:function(t,e){var n=this;return this.$http.get(t,e).done((function(t){var e=t.success,i=t.data;if(e){if("datasource"!==n.dataType)return Promise.resolve(i);n.dataSourceAnalysis(i)}})).then((function(t){if(t)return n.analysis(t)})).error((function(t){n.$message(t&&t.message||"请求异常",!1)}))},reset:function(){this.chartObj&&this.chartObj.hideLoading(),this.chartObj&&this.chartObj.setOption(this.chart,!0),setTimeout(this.resetCallback,500)},resetCallback:function(){var t=this,e=this.chartObj;try{e.off("click")}catch(n){}e.on("click",(function(e){t.$listeners["chart-click"]&&t.$dispatch("chart-click",e)}))},$resize:function(){var t=this;setTimeout((function(){t.chartObj&&t.chartObj.resize()}),0)},resize:function(){var t=this;setTimeout((function(){t.$resize()}),500)}}}},277:function(t,e,n){"use strict";n.r(e);var i=n(2),a=n.n(i),r=n(3),o=n.n(r),s=n(12);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d=[{_id:1,imgUrl:"",icon:"icon-shouyeweixuanzhong",backgroundColor:"",foreColor:"",openType:"1",name:"首页",url:""},{_id:2,imgUrl:"",icon:"icon-shezhi",backgroundColor:"",foreColor:"",openType:"1",name:"工作台",url:""},{_id:3,imgUrl:"",icon:"icon-tab-addressbook-fill",backgroundColor:"",foreColor:"",openType:"1",name:"通讯录",url:""},{_id:4,imgUrl:"",icon:"icon-tab_message_d",backgroundColor:"",foreColor:"",openType:"1",name:"消息中心",url:""},{_id:5,imgUrl:"",icon:"icon-xiaoxitongzhi",backgroundColor:"",foreColor:"",openType:"1",name:"短信中心",url:""},{_id:6,imgUrl:"",icon:"icon-xitongguanli",backgroundColor:"",foreColor:"",openType:"1",name:"系统管理",url:"",children:[{mobileUrlTypeValue:"0",backgroundColor:null,code:"smsblacklist",icon:"icon-tk",pid:"40fb4c030e63403da0ac9b99356d1743",params:null,url:"hmd",mark_type:null,imgUrl:"[]",name:"黑名单",_level:2,serveCode:null,_id:"38f9ab69fbda41ceab510fa72704f4f1",id:"38f9ab69fbda41ceab510fa72704f4f1",opentype:null,order:20},{mobileUrlTypeValue:"0",backgroundColor:null,code:"smssensitive",icon:"icon-ziyuan1",pid:"40fb4c030e63403da0ac9b99356d1743",params:null,url:"mgc",mark_type:null,imgUrl:"[]",name:"敏感词",_level:2,serveCode:null,_id:"dedd25017a1943ceb5e9e9c15c7bfe0d",id:"dedd25017a1943ceb5e9e9c15c7bfe0d",opentype:null,order:25}]},{_id:7,imgUrl:"",icon:"icon-tab-addressbook-fill",backgroundColor:"",foreColor:"",openType:"1",name:"通讯录",url:""},{_id:8,imgUrl:n(46),icon:"item icon-tools",backgroundColor:"",foreColor:"",openType:"1",name:"配置管理",url:""},{_id:9,imgUrl:"",icon:"icon-yingyongguanli",backgroundColor:"",foreColor:"",openType:"1",name:"应用管理",url:""}];e["default"]={defaultData:d,mixins:[s["default"]],props:{height:{type:String,default:"auto"},minHeight:{type:String,default:"none"},innerHeightAuto:{type:Boolean,default:!0},colNum:{type:Number,default:5},rowNum:{type:Number,default:0},maxPages:{type:Number,default:0},useDefaultStyle:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},dataSource:{type:String,default:"http"},dataSourceUrl:{type:String,default:""},dataSourceList:{type:Array,default:function(){return[]}},displayStyle:{type:String,default:"style1"},moreText:{type:String,default:"更多"},moreIcon:{type:String,default:"icon-quanbu"},moreUrl:{type:String,default:""},moreOpentype:{type:String,default:"0"},itemClick:{type:Function,required:!1},clickBefore:{type:Function,required:!1},enableMark:{type:String,default:""},showPriority:{type:String,default:"img"},defaultIcon:{type:String,default:""},iconWidth:{type:String,default:"50px"},iconHeight:{type:String,default:"50px"},iconRadius:{type:String,default:"5px"},iconBgColor:{type:String,default:"#fff"},iconBgShadow:{type:Boolean,default:!0},iconFontSize:{type:String,default:"25px"},iconFontBold:{type:Boolean,default:!1},iconFontColor:{type:String,default:"@normal"},iconFontShadow:{type:Boolean,default:!0},cellMargin:{type:Array,default:function(){return["5px","5px","5px","5px"]}},cellPadding:{type:Array,default:function(){return["0px","0px","0px","0px"]}},cellWidth:{type:String,default:"100%"},cellRadius:{type:String,default:"0px"},cellColor:{type:String,default:""},hasDesc:{type:Boolean,default:!1},iconAndInfoOfSpacing:{type:String,default:"0px"},menuType:{type:Number,default:1},needRoleFilter:{type:Boolean,default:!0},dataSourceMenuCode:{type:Array,default:function(){return[]}},enableLevel:{type:Boolean,default:!1},levelMode:{type:Number,default:1},myMenuEditBtnStyle:{type:Number,default:1},myMenuEditUrl:{type:String,default:"#/mobile/mdsfa/service/usermenu/mobile-edit"},myMenuEditOpenMode:{type:Number,default:1},myMenuEditText:{type:String,default:"编辑"},myMenuEditIcon:{type:String,default:"icon-home-cyj"}},data:function(){return{loading:!1,activeIndex:0,sourceData:[],isIniting:!0}},computed:u(u({},Vuex.mapState("cornerMark",["badges","menuIds"])),{},{dataList:function(){return!this.isDesign||"json"===this.dataSource&&this.dataSourceList.length&&2!=this.menuType?"json"!==this.dataSource||2==this.menuType?this.sourceData:this.dataSourceList:d},editInfo:function(){return 2!==this.menuType||1==this.myMenuEditBtnStyle||this.loading?{}:{_id:"myMenuEdit",imgUrl:"",icon:this.myMenuEditIcon,backgroundColor:"",bgColor:"",url:this.myMenuEditUrl,openType:this.myMenuEditOpenMode,name:this.myMenuEditText}},moreInfo:function(){return!this.hasMore||this.loading?{}:{_id:"more",imgUrl:"",icon:this.moreIcon,backgroundColor:"",bgColor:"",url:this.moreUrl,openType:this.moreOpentype,name:this.moreText}},menuList:function(){var t,e=this;if(this.enableLevel&&null!==(t=this.dataList)&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&t[0])return this.dataList;var n=function(t,n){var i=a()(t);if(n&&!dsf.isEmptyObject(e.moreInfo)&&i.push(e.moreInfo),dsf.isEmptyObject(e.editInfo)||i.push(e.editInfo),i=_.chunk(i,e.colNum),i.length&&_.last(i).length<e.colNum){var r,o=e.colNum-_.last(i).length;(r=_.last(i)).push.apply(r,a()(new Array(o).fill({_hide:!0})))}if(e.rowNum){if(i=_.chunk(i,e.rowNum),i.length&&_.last(i).length<e.rowNum){var s,l=e.rowNum-_.last(i).length;(s=_.last(i)).push.apply(s,a()(new Array(l).fill([])))}}else i=[i];return e.maxPages&&i.length>e.maxPages&&(i.length=e.maxPages),i};if(1==this.menuType&&this.enableLevel&&2==this.levelMode){var i=[],r=this.dataList;(this.isDesign||"json"===this.dataSource)&&(r=this.setData(r));var o=!1;return _.forEach(r,(function(t){if(null!==t&&void 0!==t&&t.children){var a=!1;(t._isOther||1==r.length)&&(o=!0,a=e.hasMore),i.push({name:t.name,code:t.code,children:n(t.children,a)})}})),this.hasMore&&!o&&i.push({name:"其余",code:null,children:n([],!0)}),i}return n(this.dataList,this.hasMore)}}),watch:{dataList:function(t,e){t&&t.length>0&&!this.isDesign&&this.enableMark&&this.getCornerMarkInfo(t)}},created:function(){this.reloadData(),this.$eventBus.$on("selected-app-change",this.reloadData)},methods:{getCornerMarkInfo:function(t){var e=this,n={markTypes:[],menu_ids:[]};_.forEach(t,(function(t){var i=t.mark_type,a=n.markTypes,r=t.id;i&&!e.menuIds.includes(r)&&(n.menu_ids.push(r),a.includes(i)||a.push(i))}));var i=n.markTypes;i.length&&this.$http.get("cornerMark/getMarkIdList",{markTypes:i.join(",")}).done((function(t){t.success&&e.$store.dispatch("cornerMark/init",{markId:t.data,menu_ids:n.menu_ids,type:"convenientMenu"})})).error((function(t){dsf.layer.message((null===t||void 0===t?void 0:t.message)||"根据菜单类型获取所有角标业务ID异常",!1)}))},_clickBefore:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];if(!this.isDesign){var r=null===(e=this.clickBefore)||void 0===e?void 0:e.call.apply(e,[this].concat(i));r&&r.then?r.then((function(e){!1!==e&&t.apply(void 0,i)})):!1!==r&&t.apply(void 0,i)}},reloadData:function(){var t=this;if(!(this.isDesign||"json"===this.dataSource&&2!=this.menuType)){var e={},n=this.dataSourceUrl;2==this.menuType?n="mobileMenu/getMobileMenu":1==this.menuType&&"menuCode"==this.dataSource&&(n="mobileMenu/getMenuTree",e={menuCode:_.map(this.dataSourceMenuCode,(function(t){return t.code})).join(","),queryAll:this.needRoleFilter?0:1}),""!=n?(this.loading=!0,this.$http.get(n,e).done((function(e){var n=e.success,i=e.data,a=e.message;n?(t.sourceData=t.setData(i),t.loading=!1):dsf.layer.message(a,!1)})).error((function(t){dsf.layer.message(t.message,!1)})).always((function(){t.isIniting=!1}))):this.data=[]}},setData:function(t){var e=this,n=[];if(2==this.menuType)n=t;else{var i=1==this.menuType&&this.enableLevel&&1==this.levelMode,a=1==this.menuType&&this.enableLevel&&2==this.levelMode,r={name:"其余",children:[],_isOther:!0},o=function(t){return!(null!==t&&void 0!==t&&t.children)&&t.url},s=function t(n,s,l){_.forEach(n,(function(n){var u=_.cloneDeep(n);delete u.children;var d,c,f,h=null;o(n)?a&&1==l?r.children.push(u):s.push(u):(i&&null!==n&&void 0!==n&&null!==(d=n.children)&&void 0!==d&&d.length&&1==l||a&&null!==n&&void 0!==n&&null!==(c=n.children)&&void 0!==c&&c.length&&l<=2||!e.enableLevel&&n.url?s.push(u):h=s,null!==n&&void 0!==n&&null!==(f=n.children)&&void 0!==f&&f.length&&(u.children=[],h||(h=u.children),(i&&l>=2||a&&l>=3||!e.enableLevel)&&(h=s),t(n.children,h,l+1)))}))};s(t,n,1),(i||a)&&_.forEachRight(n,(function(t,e){var i;o(t)||null!==t&&void 0!==t&&null!==(i=t.children)&&void 0!==i&&i.length||n.splice(e,1)})),r.children.length&&n.push(r)}return n},getImgUrl:function(t){var e=t.imgUrl,n=t.icon;return"[]"==e?"":"img"==this.showPriority?e:n&&""!=n?"":e},getIcon:function(t){return t&&""!=t||(t=this.defaultIcon),t?"".concat(t," icon-").concat(t):""},showMark:function(t){var e,n=t.mark_type;t.id;return""!=this.enableMark&&(!!this.isDesign||!!n&&((null===(e=this.badges)||void 0===e||null===(e=e.id)||void 0===e?void 0:e.num)||0))},markVal:function(t){var e,n=t.id;if(this.isDesign)return"99+";var i=(null===(e=this.badges)||void 0===e||null===(e=e[n])||void 0===e?void 0:e.num)||0;return/^\d$/.test(i)&&parseInt(i)>99?"99+":i},onClick:function(t){var e=this,n=function(){"myMenuEdit"==t._id&&e.openEdit?e.openEdit():e.openPage(t)};if(this.itemClick){var i=this.itemClick(t);if(!1===i)return;if(i.then)return void i.then((function(t){!1!==t&&n()}))}n()},openPage:function(t){var e=t.url;if(e&&""!=e){0==e.indexOf("#")&&0!=e.indexOf("#/")&&(e=e.replace("#","#/")),e=this.$replace(e,this.local);var n={url:e,state:t.openType||t.opentype,cancelButtonText:"关闭",showCancelButton:!0};3==n.state&&(n["title"]=t.dialogTitle||t.name||void 0,n["width"]=t.dialogWidth||"70vw",n["height"]=t.dialogHeight||"60vh"),4==n.state&&(n.state=3,n["title"]=t.dialogTitle||t.name||void 0,n["width"]="100vw",n["height"]="100vh"),this.$open(n)}},getIconStyle:function(t){var e=dsf.mix({},this.iconStyle);return this.useDefaultStyle||(t.backgroundColor&&(e["background-color"]=t.backgroundColor),t.foreColor&&(e.color=t.foreColor)),e}}}},278:function(t,e,n){"use strict";n.r(e),e["default"]={inject:{$choiceParams:{default:null}},data:function(){return{fromDataChioce:!1,searchResetSelect:!0}},created:function(){!this.isDesign&&this.$vm&&this.caption&&!this.$vm.$data.$choice&&(this.$vm.$data.$choice=this)},methods:{getReturnValue:function(){}}}},279:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n.n(i),r=n(1),o=n.n(r);e["default"]={props:{editEncryptfileDeadline:{type:Boolean,default:!1},dataKey:{type:String,default:""},hideSecurity:{type:Boolean,default:!1},securityLevel:{type:Array,default:function(){return[]}}},created:function(){this.$eventBus.$on("changeFormEncryptLevel",this.mxFileEncryptFormEncryptLevelChange)},computed:{mxFileEncryptIsFileEncrypt:function(){return!this.hideSecurity&&"1"==dsf.config.setting_security_is_open_classified},mxFileEncryptSecurityLevel:function(){var t,e=this;if(!this.mxFileEncryptIsFileEncrypt)return[];var n=(null===(t=this.$vm)||void 0===t||null===(t=t.$viewInitData)||void 0===t||null===(t=t[this.metadata.dataKey||this.dataKey])||void 0===t?void 0:t.dataSource)||this.securityLevel||[];return dsf.isArray(n)&&n.length>0?_.filter(n,(function(t){return""!==e.mxFileEncryptFormEncryptLevel&&(null===e.mxFileEncryptFormEncryptLevel||t.value<=e.mxFileEncryptFormEncryptLevel)})):[]},$$securityLevelMap:function(){var t={};return _.forEach(this.mxFileEncryptSecurityLevel,(function(e){t[e.value]=e.text})),t}},data:function(){return{_securityLevelExpiryDateObj:{},mxFileEncryptFormEncryptLevel:null}},methods:{mxFileEncryptFormEncryptLevelChange:function(t){var e=this;if(this.mxFileEncryptFormEncryptLevel=t,this.mxFileEncryptIsFileEncrypt&&t){var n=[],i=[];_.forEach(this.multipleFiles||[],(function(a){if(a.isNew)if(a.securityLevelValue>t){var r=[];_.forEach(e.mxFileEncryptSecurityLevel,(function(e){var n=e.value;n<=t&&r.push(n)}));var o=Math.max.apply(null,r)+"";o&&(a.securityLevelValue=o,a.securityLevelText=e.$$securityLevelMap[o],n.push({dmId:a.id,securityLevelValue:a.securityLevelValue,securityLevelText:a.securityLevelText}),i.push(e.mxFileEncryptGetExpiryDate(a.securityLevelValue)))}else if(""===a.securityLevelValue){var s=e.mxFileEncryptSecurityLevel[0]||{},l=s.text,u=s.value;(l||u)&&(a.securityLevelValue=u,a.securityLevelText=l,n.push({dmId:a.id,securityLevelValue:a.securityLevelValue,securityLevelText:a.securityLevelText}),i.push(e.mxFileEncryptGetExpiryDate(u)))}})),i.length&&Promise.all(i).done((function(t){var i={};_.forEach(t,(function(t,e){var a=n[e].dmId;i[a]=t,n[e].securityLevelExpiryDate=t})),e.$http.post("/file/batchUpdateFileSecret",n,{headers:{"Content-Type":"application/json;charset=UTF-8"}}).then((function(t){var n=t.data,a=n.success,r=n.message;a?(_.forEach(e.multipleFiles,(function(t){void 0!==i[t.id]&&(t.securityLevelExpiryDate=i[t.id])})),e.updateValue(e.multipleFiles)):dsf.layer.message(r||"请求异常",!1)}))}))}},mxFileEncryptGetExpiryDate:function(t){var e=this;return a()(o.a.mark((function n(){var i,a;return o.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(void 0==(null===(i=e.$data._securityLevelExpiryDateObj)||void 0===i?void 0:i[t])){n.next=2;break}return n.abrupt("return",e.$data._securityLevelExpiryDateObj[t]);case 2:return a="",n.next=5,e.$http.get("/setting/getDefaultExpiryDate",{secretLevel:t}).then((function(n){var i=n.data;dsf.isString(i.data)&&i.data?(a=i.data,e.$data._securityLevelExpiryDateObj[t]=a):e.$data._securityLevelExpiryDateObj[t]=""}));case 5:return n.abrupt("return",a);case 6:case"end":return n.stop()}}),n)})))()}},beforeDestroy:function(){this.$eventBus.$off("changeFormEncryptLevel",this.mxFileEncryptFormEncryptLevelChange)}}},280:function(t,e,n){"use strict";n.r(e);var i=n(2),a=n.n(i),r=n(3),o=n.n(r),s=n(4),l=n.n(s),u=n(1),d=n.n(u),c=n(18);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){var i,a,r={client:t,ns:e,pn:n};null===(i=dsf)||void 0===i||null===(a=i.formulaAuditStateInitEvGetModuleNameBefore)||void 0===a||a.call(i,r);var o=v(r.ns);return(r.client+"/"+o.path+"/"+r.pn+".ev.js").replace(/(\/\/)/g,"/")}function v(t){t.startsWith(".")&&(t=t.substr(1));var e=t.split("."),n=e[e.length-1],i=e.slice(0,e.length).join("."),a=e.slice(0,e.length-1).join(".");return{path:i,file:n,ns:a}}function m(t,e,n){Object.defineProperty(t,e,{get:function(){return n},configurable:!0,enumerable:!1})}e["default"]={mixins:[c["default"]],props:{caption:{type:String,default:"audit_state"},label:{type:String,default:"审核状态"},metadata:{type:Object,default:function(){var t=dsf.metadata.get("big-text-meta-data");return t}},triggerType:{default:"watch"},visible:{default:!1},openService:{default:!0},customEvJsPath:{default:""}},data:function(){return{drawerOpen:!1,jsFormulaList:[],remarkMap:{}}},computed:{showSaveBtn:function(){return this.verifyErrorList.length||this.ignoreErrorList.length},showOpenBtn:function(){return this.mandatoryErrorList.length||this.verifyErrorList.length||this.ignoreErrorList.length},isVisible:function(){return this.isDesign||!this.isDesign&&this.visible},metadataDict:function(){var t;return(null===(t=this.$vm)||void 0===t?void 0:t.metadataDict)||{}},jsFormulaLsitMap:function(){var t={};return this.jsFormulaList.forEach((function(e){e.fields.forEach((function(n){t[n]||(t[n]=[]),t[n].push(e)}))})),t},valueErrorList:function(){try{var t=JSON.parse(this.value);return dsf.isObject(t)?this.buildNewFormulaFormErrorListFn(t):dsf.isArray(t)?t:[]}catch(e){return[]}},verifyErrorListMap:function(){var t={};return this.valueErrorList.forEach((function(e){t[e.auditId]=e})),t},mandatoryErrorList:function(){return this.buildErrorList(this.valueErrorList.filter((function(t){return 1==t.mandatoryType.value}))||[])},ignoreErrorList:function(){return this.buildErrorList(this.valueErrorList.filter((function(t){return 4==t.mandatoryType.value}))||[])},verifyErrorList:function(){return this.buildErrorList(this.valueErrorList.filter((function(t){return 3==t.mandatoryType.value}))||[])}},watch:{"$vm.$isReady":{handler:function(t){t&&this.initValue(this.value)}}},methods:{initValue:function(t){var e,n=this;if(!this.isInitValue&&null!==(e=this.$vm)&&void 0!==e&&null!==(e=e.queryString)&&void 0!==e&&e.id){this.isInitValue=!0;try{var i=JSON.parse(t);dsf.isObject(i)?(i.verifyErrorList.length&&i.verifyErrorList.forEach((function(t){n.$vm.pushError(new window.$$ValidateError(t.message,t.target,t.info))})),i.ignoreErrorList.length&&i.ignoreErrorList.forEach((function(t){n.$vm.pushError(new window.$$ValidateError(t.message,t.target,t.info))})),i.mandatoryErrorList.length&&i.mandatoryErrorList.forEach((function(t){n.$vm.pushError(new window.$$ValidateError(t.message,t.target,t.info))}))):dsf.isArray(i)&&this.buildPyErrorsList(i)}catch(a){console.error(errr)}}},getFormulaVerifyFn:function(t,e,n,i,a,r){var o=this,s=[];try{var u;this.jsFormulaLsitMap&&null!==(u=this.jsFormulaLsitMap[t])&&void 0!==u&&u.length&&this.jsFormulaLsitMap[t].forEach((function(n){var u,c=null===(u=n.mandatoryType)||void 0===u?void 0:u.value;s.push((function(){return new Promise(function(){var s=l()(d.a.mark((function s(l){var u,f,p,v,m,g,y,$,b,x,w,D,S,O;return d.a.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return u=[],f=h({},r),delete f.refs,p=_.cloneDeep(o.$vm.$viewData),v=_.cloneDeep(o.$vm.$formulaArgs),m=null===t||void 0===t?void 0:t.split("."),null!==m&&void 0!==m&&m.length&&(g=m[0],y=m[1]),s.next=9,dsf.formula;case 9:if($=s.sent,b=h(h(h({$row:void 0,$this:o,$main:p,$viewData:p,$tableName:g,$code:y,$key:t,$val:e,$formulaArgs:v,$args:{}},$.customFuctionMap),$.privateFuctionMap),{},{get_main:function(t,e){return p["".concat(t,".").concat(e)]}}),(r.inSubTable||1==r.level)&&(b.$row=_.cloneDeep(a),b.$index=null===b||void 0===b||null===(x=b.$row)||void 0===x?void 0:x.$index),w=!0,!dsf.isFunction(n.verify)){s.next=19;break}return s.next=16,n.verify.call(o.$vm,b);case 16:w=s.sent,s.next=28;break;case 19:if(!dsf.isFunction(n.contentJs)){s.next=25;break}return s.next=22,n.contentJs.call(o.$vm,b);case 22:w=s.sent,s.next=28;break;case 25:return s.next=27,new Function("sandboxParams","with (sandboxParams) {\n                    ".concat(n.contentJs,"\n                  }")).call(o.$vm,b);case 27:w=s.sent;case 28:!dsf.isObject(w)&&w||(S={formula:n,mandatoryType:c,mandatoryTypeText:null===(D=n.mandatoryType)||void 0===D?void 0:D.text,ignore:4==c||3==c&&o.remarkMap[n.id]},O=n.message,dsf.isObject(w)&&"message"in w&&(O=w.message),u.push(new window.$$ValidateError(O,i,S))),u.length||o.jsFormulaLsitMap[t].forEach((function(t){t.fields.forEach((function(e){o.removeRelationErrors(e,t,i)}))})),l(u);case 31:case"end":return s.stop()}}),s)})));return function(t){return s.apply(this,arguments)}}())}))}))}catch(c){console.error("验证错误",c)}return s},removeRelationErrors:function(t,e,n){var i=this,a=this.$vm.$errors;for(var r in a)n===r&&a[r].forEach((function(t){var n,a;null!==t&&void 0!==t&&null!==(n=t.info)&&void 0!==n&&null!==(n=n.formula)&&void 0!==n&&n.id&&e.id==(null===t||void 0===t||null===(a=t.info)||void 0===a||null===(a=a.formula)||void 0===a?void 0:a.id)&&i.$vm.removeErrorsByTarget(t.target)}))},checkIsError:function(){var t=this.$vm.$errors,e=0,n=0,i=0;for(var a in t)for(var r=t[a]||[],o=0;o<r.length;o++){var s=r[o];4==s.info.mandatoryType&&(e=1),s.info.ignore||(3==s.info.mandatoryType&&(n=1),i=1)}return e?1:n?2:i?3:0},formulaPyCheckFormDataFn:function(t){var e=this;return l()(d.a.mark((function n(){var i,a;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.openService){n.next=3;break}return e.buildFormulaFormErrorListFn(),n.abrupt("return");case 3:return i=dsf.layer.loading(),n.next=6,e.$vm.$getSaveParams(t);case 6:return a=n.sent,n.abrupt("return",new Promise((function(n,r){dsf.http.post("/formula/checkFormData",a,{timeout:6e4}).done((function(i){var a,o;if(i&&i.success)if(null!==(a=i.data)&&void 0!==a&&a.auditStatus||null===(o=i.data)||void 0===o||null===(o=o.auditFields)||void 0===o||!o.length)e.buildFormulaFormErrorListFn(),n();else{e.buildPyErrorsList(i.data.auditFields),e.buildFormulaFormErrorListFn();var s=e.checkIsError();0!=s?1==s?t.isSkipIgnore?n():(e.open(),r("请确认忽略性错误")):(e.open(),r({type:"ValidateError",result:Object.values(e.$vm.$errors),message:"表单校验错误"})):n()}else e.open(),r(i)})).catch((function(t){console.error(t),e.open(),r("Python检测接口错误")})).finally((function(){dsf.layer.closeLoading(i)}))})));case 8:case"end":return n.stop()}}),n)})))()},buildErrorList:function(t){var e=this,n=[];return t.forEach((function(t){var i=t.mandatoryType,a=h(h({},t),{},{fields:[]});t.fields.forEach((function(n){var r;if(n.isSubTable){var o=e.$vm.getSubTable(n.tableName);if(o){var s=o.value[n.index];s&&(r=s.$hash)}}n.fields.forEach((function(o){var s=n.tableName+"."+o.split("-")[0];n.isSubTable&&(s=s+"-"+r);var l=!1;(4==(null===i||void 0===i?void 0:i.value)||3==(null===i||void 0===i?void 0:i.value)&&e.remarkMap[t.auditId])&&(l=!0),a.fields.push({id:s,tableName:n.tableName,isSubTable:n.isSubTable,code:o,ignore:l,index:n.index,label:e.getFieldLabel(n.tableName+"."+o,n.isSubTable,n.index)})}))})),a.fields.length&&n.push(a)})),n},buildPyErrorsList:function(t){var e,n=this,i=null===(e=this.$vm.nameSpace)||void 0===e?void 0:e.replace(/\./g,"_");t.forEach((function(t){var e=t.mandatoryType;t.id=t.auditId,n.remarkMap[t.auditId]||n.$set(n.remarkMap,t.auditId,t.remark);t.fields.some((function(t){return!t.tableName.includes(i)}));t.fields.forEach((function(a){var r;if(a.tableName.includes(i)){if(a.isSubTable){var o=n.$vm.getSubTable(a.tableName);if(o){var s=o.value[a.index];s&&(r=s.$hash)}}a.fields.forEach((function(i){var o=a.tableName+"."+i;a.isSubTable&&(o=o+"-"+r);var s=!1;(4==(null===e||void 0===e?void 0:e.value)||3==(null===e||void 0===e?void 0:e.value)&&n.remarkMap[t.auditId])&&(s=!0);var l={formula:t,mandatoryType:null===e||void 0===e?void 0:e.value,mandatoryTypeText:null===e||void 0===e?void 0:e.text,ignore:s};n.$vm.pushError(new window.$$ValidateError(t.message,o,l))}))}}))}))},buildFormulaFormErrorListFn:function(){var t=this,e=Object.values(this.$vm.$errors||{}),n={};this.verifyErrorList.forEach((function(t){var e,i=null===t||void 0===t||null===(e=t.info)||void 0===e||null===(e=e.formula)||void 0===e?void 0:e.id;i&&(n[i]=t)}));var i=[],a=[],r=[],o={};e.length&&e.forEach((function(e){e.forEach((function(e){var s,l,u,d=t.metadataDict[e.target.replace(/\-.*/,"")],c=null===d||void 0===d?void 0:d.inSubTable,f={info:e.info,inSubTable:c,subTable:null===d||void 0===d||null===(s=d.inSubTable)||void 0===s?void 0:s.replace(new RegExp("".concat(t.$vm.nameSpace.replace(/\./g,"_"),"_")),""),target:e.target,label:"".concat(d?null===d||void 0===d?void 0:d.name:e.target),message:e.message,remark:""};if(c){var h;if(!o[c])o[c]={},null===(h=t.$vm.$viewData[c])||void 0===h||h.forEach((function(t){o[c][t.$hash]=t}));var p=e.target.split("-")[1];p&&o[c][p]&&(f.row=o[c][p],f.rowIndex=o[c][p].$index)}var v=null===e||void 0===e||null===(l=e.info)||void 0===l?void 0:l.mandatoryType;if(3==v){var m,g,y,$=null===e||void 0===e||null===(m=e.info)||void 0===m||null===(m=m.formula)||void 0===m?void 0:m.id;if($)f.rowIndex=null===(g=n[$])||void 0===g?void 0:g.rowIndex,f.remark=null===(y=n[$])||void 0===y?void 0:y.remark;r.push(f)}else 4==v||null!==e&&void 0!==e&&null!==(u=e.info)&&void 0!==u&&u.ignore?a.push(f):i.push(f)}))}));var s=this.buildNewFormulaFormErrorListFn({ignoreErrorList:a,verifyErrorList:r,mandatoryErrorList:i});this.emitValueChange(JSON.stringify(s))},buildNewFormulaFormErrorListFn:function(t){var e=this,n=t.ignoreErrorList,i=t.mandatoryErrorList,r=t.verifyErrorList,o=[].concat(a()(n),a()(i),a()(r)),s=[];return o.forEach((function(t){var n,i,a,r,o=null===(n=t.target)||void 0===n||null===(n=n.split("."))||void 0===n?void 0:n[0],l=null===(i=t.target)||void 0===i||null===(i=i.split("."))||void 0===i||null===(i=i[1])||void 0===i?void 0:i.split("-")[0],u=null===(a=t.target)||void 0===a?void 0:a.split("-")[1],d=!!t.inSubTable,c=null===(r=t.info)||void 0===r?void 0:r.formula,f=null===c||void 0===c?void 0:c.id;f||c||(f=dsf.uuid());var h=s.find((function(e){return null!==t&&void 0!==t&&t.row,e.auditId==f}));if(!h){var p=(null===c||void 0===c?void 0:c.message)||t.message,v=(null===c||void 0===c?void 0:c.mandatoryType)||{text:"强制性",value:1};h={auditId:f,fields:[],message:p,mandatoryType:v,remark:e.remarkMap[f]||t.remark,label:t.label},3!=h.mandatoryType.value&&(delete h.remark,delete e.remarkMap[f]),s.push(h)}var g=h.fields.find((function(t){return d?t.$hash==u&&t.tableName==o:t.tableName==o}));!g&&o&&(g={tableName:o,fields:[],isSubTable:!!t.inSubTable,index:t.row.$index},d&&m(g,"$hash",u),h.fields.push(g)),g.fields.find((function(t){return t==l}))||g.fields.push(l)})),s},getFieldLabel:function(t,e,n){e&&(t=t.split("-")[0]);var i=this.metadataDict[t],a=(null===i||void 0===i?void 0:i.name)||i.id;return e&&(a="[".concat(n+1||0,"] ").concat(a)),a},getSubTableLabel:function(t){return t.inSubTable?"[".concat(t.subTable,"][").concat(t.rowIndex+1,"]"):""},getRemark:function(t){return this.remarkMap[null===t||void 0===t?void 0:t.auditId]||""},remarkInput:function(t,e){this.$set(this.remarkMap,null===e||void 0===e?void 0:e.auditId,t)},errorClick:function(t){var e=this;this.$form.$scrollToError({target:t.id}),setTimeout((function(){clearTimeout(e.stopRemoveClass),$(".ds-form-item-audit-state-foucs").removeClass("ds-form-item-audit-state-foucs"),$('[form-name="'.concat(t.id,'"]')).addClass("ds-form-item-audit-state-foucs"),e.stopRemoveClass=setTimeout((function(){$('[form-name="'.concat(t.id,'"]')).removeClass("ds-form-item-audit-state-foucs")}),400)}),600)},drawerClose:function(){$(".ds-form-item-audit-state-foucs").removeClass("ds-form-item-audit-state-foucs"),this.drawerOpen=!1},open:function(){var t=this;this.buildFormulaFormErrorListFn(),setTimeout((function(){t.showOpenBtn&&(t.drawerOpen=!0,t.$nextTick((function(){$(".ds-dm-reportform").each((function(t,e){var n;null===e||void 0===e||null===(n=e.__vue__)||void 0===n||n.resize()}))})))}))},showDrawerOpen:function(){var t=this;this.buildFormulaFormErrorListFn(),setTimeout((function(){t.drawerOpen=!0,t.$nextTick((function(){$(".ds-dm-reportform").each((function(t,e){var n;null===e||void 0===e||null===(n=e.__vue__)||void 0===n||n.resize()}))}))}))},initEvJs:function(){var t=this,e=p("ev",this.$vm.nameSpace,this.$vm.pageName);e=dsf.config.serverCreateHtmlDir+e,this.customEvJsPath&&(e=this.customEvJsPath);var n=dsf.layer.loading();try{dsf.require({urlArgs:"_t="+(new Date).getTime()},[e],(function(e){var i;e&&e.jsFormulaList&&(t.jsFormulaList.length=0,(i=t.jsFormulaList).push.apply(i,a()(e.jsFormulaList)),t.$vm.getFormulaVerifyFn=t.getFormulaVerifyFn);dsf.layer.closeLoading(n)}),(function(t){console.error(t),dsf.layer.closeLoading(n)}))}catch(i){console.error(i),dsf.layer.closeLoading(n)}},save:function(){var t=this;return l()(d.a.mark((function e(){return d.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.buildFormulaFormErrorListFn(),!t.isSaveAfter&&t.drawerOpen&&(t.isSaveAfter=!0,t.$vm.$once("saveAfter",(function(){t.isSaveAfter=!1,t.drawerClose()}))),t.$vm.formSave({isSkipIgnore:!0});case 3:case"end":return e.stop()}}),e)})))()}},created:function(){this.$vm&&!this.isDesign&&(this.$vm.formulaPyCheckFormDataFn=this.formulaPyCheckFormDataFn,this.initEvJs())},mounted:function(){var t;null===(t=this.$vm)||void 0===t||t.$on("open-audit-state",this.open)},destroy:function(){var t;null===(t=this.$vm)||void 0===t||t.$off("open-audit-state",this.open)}}},281:function(t,e,n){"use strict";n.r(e);var i=n(3),a=n.n(i),r=n(8),o=n.n(r),s=n(2),l=n.n(s);e["default"]={props:{emptyText:{default:"暂无数据"},data:{default:function(){return[]}},nodeKey:{default:"id"},props:{default:function(){return{label:"label",children:"children",disabled:"disabled",isLeaf:"leaf",showCheckbox:"showCheckbox",customClass:null}}},nodeHeight:{default:26},defaultExpandAll:{type:Boolean,default:!1},defaultExpandLevel:{type:Number,default:1},levelIndentWidth:{default:20},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:{default:null},defaultExpandedKeys:{default:function(){return[]}},showCheckbox:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},accordion:{type:Boolean,default:!1},currentNodeKey:{default:null},highlightCurrent:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},load:{default:null},filterNodeMethod:{default:null},draggable:{type:Boolean,default:!1},filterType:{default:""}},data:function(){return{dragstart:!1,isInit:!1,showHeight:0,scrollY:0,maxHeight:0,showNodes:[],totalData:0,currentNode:null,filterText:null,nodeTree:this.getRootNode()}},computed:{_defaultExpandedKeys:function(){var t=new Set,e=this.defaultExpandedKeys||[];return e.forEach((function(e){t.add(e)})),t},_defaultCheckedKeys:function(){var t=new Set,e=this.defaultCheckedKeys||[];return e.forEach((function(e){t.add(e)})),t},existNodeKey:function(){return!dsf.isUnDef(this.nodeKey)},isLeafKey:function(){var t;return null===this||void 0===this||null===(t=this.props)||void 0===t?void 0:t.isLeaf},childrenKey:function(){var t;return(null===(t=this.props)||void 0===t?void 0:t.children)||"children"},labelKey:function(){var t;return(null===(t=this.props)||void 0===t?void 0:t.label)||"label"},nodeData:function(){var t;return(null===this||void 0===this||null===(t=this.nodeTree)||void 0===t?void 0:t.childNodes)||[]}},methods:{customNodeClass:function(t){var e,n=null===this||void 0===this||null===(e=this.props)||void 0===e?void 0:e.customClass;return dsf.isFunction(n)?n(t.data,t):n||null},isShowCheckbox:function(t){var e,n,i=null===this||void 0===this||null===(e=this.props)||void 0===e?void 0:e.showCheckbox;return!!this.showCheckbox&&(dsf.isFunction(i)?i(t.data,t):dsf.isString(i)?!1!==(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n[i]):this.showCheckbox)},dragStart:function(t,e){this.dragNode=e,this.dragstart=!0},dragEnd:function(t,e){this.dragstart=!1},dragOver:function(t,e){var n;t.preventDefault();var i=t.offsetY;if(this.oldOffsetY!=i){this.oldOffsetY=i;var a=t.target,r=a.getAttribute("node-id"),o=null===this||void 0===this||null===(n=this.dropNode)||void 0===n?void 0:n.id;o!=r&&(o&&$(this.$el).find(".ds-virtual-tree-node[node-id=".concat(o,"]")).removeAttr("drop-over-type"),this.dropNode=this.nodeMap[r],this.dropNodeHeight=a.clientHeight||this.nodeHeight),this.dropOverType="in",i<5?this.dropOverType="before":i>this.dropNodeHeight-5&&(this.dropOverType="after"),a.setAttribute("drop-over-type",this.dropOverType)}},drop:function(t,e){this.dragstart=!1,e.id!=this.dragNode.id&&("in"==this.dropOverType?this.append(this.dragNode,e):"before"==this.dropOverType?this.insertBefore(this.dragNode,e):"after"==this.dropOverType&&this.insertAfter(this.dragNode,e),e.id&&$(this.$el).find(".ds-virtual-tree-node[node-id=".concat(e.id,"]")).removeAttr("drop-over-type"))},dblclickNode:function(t,e){this.$emit("node-dblclick",e,t.data,t)},contextmenuNode:function(t,e){this.$emit("node-contextmenu",e,t.data,t)},clickNode:function(t,e){this.checkOnClickNode&&!this.isDisabledNode(t)&&this.checkboxClick(t,!t.checked),this.expandOnClickNode&&this.expandNode(t,!t.expanded),this.highlightCurrent&&this.setCurrentNode(t),this.$emit("node-click",t.data,t)},checkboxClick:function(t,e){var n,i=this;if(this.checkNode(t,e),null!==(n=this.$listeners)&&void 0!==n&&n.check){var a=this.getCheckedNodes(),r=this.getHalfCheckedNodes();this.$emit("check",t.data,{checkedNodes:a,checkedKeys:a.map((function(t){return i.getNodeDataKey(t)})),halfCheckedKeys:r,halfCheckedNodes:r.map((function(t){return i.getNodeDataKey(t)}))})}},expandNode:function(t,e,n){var i=this;this.isExpandedOpacity(t)||(!this.lazy||t.loading||t.loaded?this._expandNode(t,e,n):this.loadData(t,(function(){i._expandNode(t,e,n)})))},_expandNode:function(t,e,n){var i=this,a=t.expanded!=e;if(t.expanded=e,e&&this.autoExpandParent&&t.parent&&this.expandNode(t.parent,e,!1),e&&this.accordion){var r,o=(null===(r=t.parent)||void 0===r?void 0:r.childNodes)||this.nodeData;null===o||void 0===o||o.forEach((function(t){return t.expanded=!1}))}if(n){var s=t.childNodes;null===s||void 0===s||s.forEach((function(t){return i.expandNode(t,e,n)}))}a?(this.updateMaxHeight(),e?this.$emit("node-expand",t.data,t):this.$emit("node-collapse",t.data,t)):this.updateShowNodes()},checkNode:function(t,e){var n,i=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.existNodeKey&&t&&!this.isDisabledNode(t)){var o=t.checked!=e;t.checked=e,this.setIndeterminateNode(t,!1),this.checkStrictly||a&&t.parent&&this.updateParentCheckSatus(t.parent,e),this.checkStrictly&&!r||null===(n=t.childNodes)||void 0===n||!n.length||t.childNodes.forEach((function(t){i.checkNode(t,e,!1,!0)})),o&&!t.isRoot&&this.$emit("check-change",t.data,t.checked,t)}},setChecked:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=[];r=a?this.keysGetNodes(t,a).filter((function(t){return!!t})):[this.getNode(t)],r.forEach((function(t){n.checkNode(t,e,!0,i)}))},setCurrentKey:function(t){this.existNodeKey&&this.setCurrentNode(this.getNode(t))},setCurrentNode:function(t){this.existNodeKey&&(this.currentNode&&(this.currentNode.isCurrent=!1),t&&(t.isCurrent=!0),this.currentNode=t)},getCurrentKey:function(){return this.existNodeKey?this.getNodeKey(null===this||void 0===this?void 0:this.currentNode):null},getCurrentNode:function(){return this.existNodeKey?null===this||void 0===this?void 0:this.currentNode:null},getCheckedNodes:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return this.nodeDataDeepForEach((function(i,a){e&&i.indeterminate&&(n.push(null===i||void 0===i?void 0:i.data),a.continue()),i.checked&&(t&&!i.isLeaf&&a.continue(),n.push(null===i||void 0===i?void 0:i.data))})),n},getCheckedKeys:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=this.getCheckedNodes(e,n),r=a.map((function(e){return t.getNodeDataKey(e)}));return i?_.uniqBy(r):r},setCheckedNodes:function(t,e){var n=this;t&&!dsf.isArray(t)&&(t=[t]),t=t.map((function(t){return n.getNode(t)})).filter((function(t){return!!t}));var i=l()(this.nodeData),a=function(){var a,r=i.shift(),o=!1;t.findIndex((function(t){return(null===t||void 0===t?void 0:t.id)==r.id}))>=0?n.checkStrictly?n.checkNode(r,!0,!1):e?(o=!0,r.checked&&n.checkNode(r,!1),n.setCheckedNodeIsLeaf(r)):(o=!0,n.checkNode(r,!0,!0,!0)):r.checked&&n.checkNode(r,!1),!o&&null!==r&&void 0!==r&&null!==(a=r.childNodes)&&void 0!==a&&a.length&&i.push.apply(i,l()(r.childNodes))};while(i.length)a()},setCheckedNodeIsLeaf:function(t){var e=[t];while(e.length){var n,i=e.shift();i.isLeaf&&this.checkNode(i,!0,!1,!1),null!==i&&void 0!==i&&null!==(n=i.childNodes)&&void 0!==n&&n.length&&e.push.apply(e,l()(i.childNodes))}},setCheckedKeys:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&!dsf.isArray(t)&&(t=[t]),this.setCheckedNodes(this.keysGetNodes(t,n).filter((function(t){return!!t})),e)},keysGetNodes:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];dsf.isArray(t)||(t=[t]);var i=[];return n?t.forEach((function(t){var n,a=e.getNode(t,!0);dsf.isArray(a)?(n=i).push.apply(n,l()(a)):i.push(a)})):i=t.map((function(t){return e.getNode(t)})),i},getHalfCheckedNodes:function(){var t=[];return this.nodeDataDeepForEach((function(e){e.indeterminate&&t.push(null===e||void 0===e?void 0:e.data)})),t},getHalfCheckedKeys:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=(null===(t=this.getHalfCheckedNodes())||void 0===t?void 0:t.map((function(t){return e.getNodeDataKey(t)})))||[];return n?_.uniqBy(i):i},updateParentCheckSatus:function(t,e){if(t){var n=this.getIsIndeterminate(null===t||void 0===t?void 0:t.childNodes),i=n.isAllChecked,a=n.isAllNotChecked,r=n.indeterminate;r?this.setIndeterminateNode(t,!0):(void 0===e&&(i?e=!0:a&&(e=!1)),this.checkNode(t,e,!0))}},getIsIndeterminate:function(t){var e=!0,n=!0,i=!1,a=t;if(null!==a&&void 0!==a&&a.length)for(var r=0;r<a.length;r++){if(a[r].indeterminate){i=!0;break}if(a[r].checked?n=!1:e=!1,!e&&!n){i=!0;break}}return{isAllChecked:e,isAllNotChecked:n,indeterminate:i}},setIndeterminateNode:function(t,e){t.indeterminate=e,e&&(t.checked=!1,t.parent&&this.setIndeterminateNode(t.parent,e))},nodeDataDeepForEach:function(t,e){var n,i=l()(e||this.nodeData),a=function(){var e,n=i.shift(),a=!1,r=!1;return null===t||void 0===t||t(n,{continue:function(){a=!0},break:function(){r=!0}}),r?0:a?1:void(null!==(e=n.childNodes)&&void 0!==e&&e.length&&i.unshift.apply(i,l()(n.childNodes)))};while(i.length)if(n=a(),0===n)break},onScroll:function(t,e){var n=e.scrollTop;Math.abs(this.scrollY-n)>this.nodeHeight&&(this.scrollY=n,this.updateShowNodes())},isExpandedOpacity:function(t){var e;return!(this.lazy&&!t.isLeaf)&&(null===(e=t.childNodes)||void 0===e||!e.length)},updateMaxHeight:function(){var t=this.filterNodeData,e=this.nodeData,n=this.nodeHeight,i=l()(t||e||[]),a=0,r=[];while(i.length){var o,s=i.shift(),u=this.getNode(s);u&&(u.expanded&&null!==s&&void 0!==s&&null!==(o=s.childNodes)&&void 0!==o&&o.length&&i.unshift.apply(i,l()(s.childNodes)),u.top=a,u.style={"padding-left":(u.level-1)*this.levelIndentWidth+"px",height:n+"px","line-height":n+"px",top:u.top+"px"},r.push(u.id),a+=n)}this.maxHeight=a,this.expandNodeIds=r,this.updateShowNodes()},updateShowNodes:function(){var t=this,e=this.expandNodeIds,n=this.nodeHeight,i=this.showHeight,a=this.scrollY;if(null===e||void 0===e||!e.length||!i)return this.showNodes=[];var r=Math.floor(a/n)-2;r<0&&(r=0);var o=r+Math.ceil(i/n)+4;this.showNodes=e.slice(r,o).map((function(e){return t.nodeMap[e]}))},createTreeNodeId:function(){return dsf.isUnDef(this.$maxTreeNodeId)?this.$maxTreeNodeId=0:this.$maxTreeNodeId++,this.$maxTreeNodeId},updateShowHeight:function(){this.showHeight=this.$el.clientHeight,this.updateMaxHeight()},getNodeKey:function(t){var e;return null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e[null===this||void 0===this?void 0:this.nodeKey]},getNodeDataKey:function(t){return null===t||void 0===t?void 0:t[null===this||void 0===this?void 0:this.nodeKey]},getNode:function(t,e){if(this.isTreeNode(t))return this.nodeMap[t.id];if(this.isTreeNodeData(t))return this.nodeMap[t.$treeNodeId];if(this.existNodeKey&&this.nodeDataMap&&dsf.isString(t)){var n=this.nodeDataMap[t];return e&&dsf.isArray(n)?n:dsf.isArray(n)?null===n||void 0===n?void 0:n[0]:n}return null},isTreeNode:function(t){return dsf.isObject(t)&&!dsf.isUnDef(null===t||void 0===t?void 0:t.isTreeNode)},isTreeNodeData:function(t){return dsf.isObject(t)&&!dsf.isUnDef(null===t||void 0===t?void 0:t.$treeNodeId)},append:function(t,e){var n=this,i=e?this.getNode(e):this.nodeTree;if(i&&t){var a,r=t;dsf.isArray(r)||(r=[r]),r.forEach((function(t){var e,r,o;if(dsf.isObject(t)&&(o=n.isTreeNode(t)||n.isTreeNodeData(t)?n.remove(t):[t],null!==(e=o)&&void 0!==e&&e.length)){var s,u=null;if(null!==i&&void 0!==i&&i.data)null!==(s=i.data)&&void 0!==s&&s[n.childrenKey]||(i.data[n.childrenKey]=[]),u=i.data[n.childrenKey],i.expanded=!0;else u=n.data;(r=u).push.apply(r,l()(o)),a=!0}})),a&&this.resetBuildDataNodes()}},insertBefore:function(t,e){var n=this,i=this.getNode(e);if(i&&t){var a,r=t;dsf.isArray(r)||(r=[r]),r.forEach((function(t){var e,r;if(dsf.isObject(t)&&(r=n.isTreeNode(t)||n.isTreeNodeData(t)?n.remove(t):[t],null!==(e=r)&&void 0!==e&&e.length)){var o,s=i.parent;o=s?s.data[n.childrenKey]:n.data;var u,d=o.findIndex((function(t){return t.$treeNodeId==i.data.$treeNodeId}));if(d>=0)d<0&&(d=0),(u=o).splice.apply(u,[d,0].concat(l()(r))),a=!0}})),a&&this.resetBuildDataNodes()}},insertAfter:function(t,e){var n=this,i=this.getNode(e);if(i&&t&&(dsf.isObject(t)||dsf.isArray(t))){var a,r=t;dsf.isArray(r)||(r=[r]),r.forEach((function(t){var e,r;if(dsf.isObject(t)&&(r=n.isTreeNode(t)||n.isTreeNodeData(t)?n.remove(t):[t],null!==(e=r)&&void 0!==e&&e.length)){var o,s=i.parent;o=s?s.data[n.childrenKey]:n.data;var u,d=o.findIndex((function(t){return t.$treeNodeId==i.data.$treeNodeId}));if(d>=0)(u=o).splice.apply(u,[d+1,0].concat(l()(r))),a=!0}})),a&&this.resetBuildDataNodes()}},remove:function(t){var e=this;if(this.existNodeKey&&t){var n,i=t;dsf.isArray(i)||(i=[i]);var a=[],r=[];return i.forEach((function(t){var i,o=e.getNode(t);if(o){var s,l=[];if(null!==o&&void 0!==o&&null!==(i=o.parent)&&void 0!==i&&i.data)l=null===(s=o.parent.data)||void 0===s?void 0:s[e.childrenKey];else l=e.data;var u=l.findIndex((function(t){var e;return t.$treeNodeId==(null===o||void 0===o||null===(e=o.data)||void 0===e?void 0:e.$treeNodeId)}));if(u>=0){var d=l.splice(u,1)[0];a.push(d);var c=e.getNode(d);(null===c||void 0===c?void 0:c.parent)&&r.push(c.parent),n=!0}}})),r.length&&this.$once("loadDataSuccess",(function(){r.forEach((function(t){t&&e.updateParentCheckSatus(t)}))})),n&&this.resetBuildDataNodes(),a}},updateKeyChildren:function(t,e){var n=this.getNode(t);if(n&&e){var i=e;dsf.isArray(i)||(i=[i]);var a,r=this.getNodeDataChildren(n);i.forEach((function(t){dsf.isObject(t)&&(r.push(t),a=!0)})),a&&this.resetBuildDataNodes()}},getNodeDataChildren:function(t){var e,n;return t&&null!==t&&void 0!==t&&t.data?(null!==t&&void 0!==t&&null!==(e=t.data)&&void 0!==e&&e[this.childrenKey]||(t.data[this.childrenKey]=[]),null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n[this.childrenKey]):null},loadData:function(t,e){var n=this;this.lazy&&dsf.isFunction(this.load)&&(t&&(this.$set(t,"loading",!0),this.$set(t,"loaded",!1)),(null===t||void 0===t||!t.loaded)&&this.load(t,(function(i,a){var r,o;(a&&n.$once("loadDataSuccess",a),e&&n.$once("loadDataSuccess",e),t&&(t.loaded=!0,t.loading=!1),dsf.isArray(i))&&(!t||t.isRoot?(r=n.data).splice.apply(r,[0,n.data.length].concat(l()(i))):t.data&&(t.data[n.childrenKey]||(t.data[n.childrenKey]=[]),(o=t.data[n.childrenKey]).push.apply(o,l()(i)),n.resetBuildDataNodes()))})))},isDisabledNode:function(t){var e,n,i=(null===this||void 0===this||null===(e=this.props)||void 0===e?void 0:e.disabled)||"disabled",a=!1;dsf.isString(i)?a=null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n[i]:dsf.isFunction(i)&&(a=i(null===t||void 0===t?void 0:t.data,t));return a},filter:function(t){return this.filterText=t,"lazy"==this.filterType?(this.filterNodeData=null,void this.reloadData()):this.filterText&&dsf.isFunction(this.filterNodeMethod)?(this.filterNodeData=p.call(this,this.nodeData),void this.updateMaxHeight()):(this.filterNodeData=null,void this.updateMaxHeight())},resetBuildDataNodes:function(){var t=this;this.throttleResetBuildDataNodes||(this.throttleResetBuildDataNodes=_.throttle((function(){var e;if(d.call(t,t.data),t.updateMaxHeight(),null!==t&&void 0!==t&&null!==(e=t.defaultExpandNodeIdsLoop)&&void 0!==e&&e.length)while(t.defaultExpandNodeIdsLoop.length){var n=t.defaultExpandNodeIdsLoop.shift();t.nodeMap[n]&&t.expandNode(t.nodeMap[n],!0)}t.$emit("loadDataSuccess",t)}),200,{leading:!1,trailing:!0})),this.throttleResetBuildDataNodes()},getNodePath:function(t){var e=[];t=this.getNode(t);while(t)e.unshift(t.data),t=t.parent;return e},nodeScrollIntoView:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center";if(t=this.getNode(t),t){var i=parseInt(t.style.top);(dsf.isNumber(i)||dsf.isNumber(n)||["center","top","bottom"].includes(n))&&(dsf.isNumber(n)?i-=n:"center"==n?i=i-this.showHeight/2+this.nodeHeight:"bottom"==n&&(i-=this.showHeight-this.nodeHeight),this._expandNode(t,!0,!1),null===(e=this.$refs)||void 0===e||null===(e=e.virtualScroll)||void 0===e||e.scrollTo(null,i))}},getRootNode:function(){return this.nodeTree||(this.nodeTree=f.call(this,{}),h(this.nodeTree,"label","全部"),this.nodeTree.data={},this.nodeTree.data[this.childrenKey]=[],this.nodeTree.data[this.nodeKey]="__root__",this.nodeTree.data[this.labelKey]=this.nodeTree.label,this.nodeTree.isRoot=!0,this.nodeTree.level=0),this.nodeTree},reloadData:function(){var t=this;this.lazy&&(this.isInit=!1,this.loadData(this.nodeTree,(function(e){t.isInit=!0})))}},watch:{currentNodeKey:{immediate:!0,handler:function(t){this.setCurrentKey(t)}},data:{immediate:!0,handler:function(){this.resetBuildDataNodes(),this.isInit=!0}},defaultExpandedKeys:{handler:function(t){var e=this;null===t||void 0===t||t.forEach((function(t){var n=e.getNode(t);n&&e.expandNode(n,!0)}))}},defaultCheckedKeys:{handler:function(t){this.setCheckedKeys(t)}}},created:function(){this.reloadData()},mounted:function(){var t=this;this.__resizeObserver=new ResizeObserver((function(e){var n=o()(e,1);n[0];t.updateShowHeight()})),this.__resizeObserver.observe(this.$el)},beforeDestroy:function(){this.__resizeObserver&&this.__resizeObserver.disconnect()}};var u=["previousSibling","nextSibling","isTreeNode","label"];function d(t){var e=this,n=c.call(this,t,this.nodeTree),i=0,r=a()({},this.nodeTree.id,this.nodeTree),o=a()({},this.getNodeKey(this.nodeTree),this.nodeTree);return dsf.deepForEach(n,(function(t){i++;var n=e.getNodeKey(t),a=o[n];a?dsf.isArray(a)?a.push(t):a=[a,t]:a=t,o[n]=a,r[t.id]=t}),{children:"childNodes"}),this.nodeTree.childNodes=n,this.nodeTree.data={},this.nodeTree.data[this.childrenKey]=t||[],this.nodeMap=r,this.nodeDataMap=o,this.totalData=i,n}function c(t,e){dsf.isObject(t)&&(t=[t]);for(var n=[],i=0;i<t.length;i++){var a,r=t[i],o=r[this.childrenKey]||[],s=void 0;if(null!==(a=this.nodeMap)&&void 0!==a&&a[null===r||void 0===r?void 0:r.$treeNodeId]?(s=this.nodeMap[r.$treeNodeId],dsf.setObjAttr(s,"parent",e),s.level=e?e.level+1:1):s=f.call(this,r,e),!this.checkStrictly&&e&&e.checked&&(s.checked=e.checked),null!==o&&void 0!==o&&o.length?(s.childNodes=c.call(this,o,s),s.isLeaf=!1,s.loaded=!0):s.childNodes=[],this.lazy){var l=!1;if(!s.loaded||null!==o&&void 0!==o&&o.length){var u,d,p,v=(null===this||void 0===this||null===(u=this.props)||void 0===u?void 0:u.isLeaf)||"leaf";if(dsf.isString(v)){if(void 0!==(null===(d=s)||void 0===d||null===(d=d.data)||void 0===d?void 0:d[v]))l=null===(p=s)||void 0===p||null===(p=p.data)||void 0===p?void 0:p[v]}else if(dsf.isFunction(v)){var m;l=v(null===(m=s)||void 0===m?void 0:m.data,s)}}else l=!0;l&&(s.isLeaf=!0,s.loaded=!0)}else null!==o&&void 0!==o&&o.length||(s.isLeaf=!0,s.loaded=!0);h(s,"previousSibling",i?n[i-1]:null),i&&h(n[i-1],"nextSibling",s),n.push(s)}return n.length&&h(n[n.length-1],"nextSibling",null),n}function f(t,e){var n=this,i=this.createTreeNodeId();h(t,"$treeNodeId",i);var a={id:i,text:null,visible:!0,checked:!1,expanded:!1,indeterminate:!1,isCurrent:!1,isLeaf:!1,level:e?e.level+1:1,loaded:!1,loading:!1,childNodes:[],data:t},r=this.getNodeKey(a);if(r){var o,s,l;a.isCurrent=this.currentNodeKey===r,null!==this&&void 0!==this&&null!==(o=this._defaultCheckedKeys)&&void 0!==o&&null!==(s=o.has)&&void 0!==s&&s.call(o,r)&&(a.checked=!0);var u=parseInt(this.defaultExpandLevel);(this.defaultExpandAll||u>1||null!==this&&void 0!==this&&null!==(l=this.defaultExpandedKeys)&&void 0!==l&&l.length)&&(this.defaultExpandNodeIdsLoop||(this.defaultExpandNodeIdsLoop=[]),(this.defaultExpandAll||a.level<u||this._defaultExpandedKeys.has(r))&&this.defaultExpandNodeIdsLoop.push(a.id))}return dsf.setObjAttr(a,"parent",e),h(a,"label",t[this.labelKey]||""),h(a,"isTreeNode",!0),h(a,"loadData",(function(t){n.loadData(a,t)})),h(a,"remove",(function(){n.remove(a)})),h(a,"setData",(function(t){var e;if(null!==(e=a.parent)&&void 0!==e&&e.data){var i=a.parent.data[n.childrenKey],r=i.findIndex((function(t){return t.$treeNodeId==a.data.$treeNodeId}));r>-1&&(i.splice(r,1,t),n.resetBuildDataNodes())}})),a.isCurrent&&this.setCurrentNode(a),a}function h(t,e,n){dsf.isObject(t)&&(Object.getOwnPropertyDescriptor(t,e)&&Object.getOwnPropertyDescriptor(t,e).configurable,Object.defineProperty(t,e,{value:n,writable:!1,configurable:!0,enumerable:!1}))}function p(t){var e=this,n=[];return t?(null===t||void 0===t||t.forEach((function(t){var i=Object.assign({},t);u.forEach((function(e){h(i,e,t[e])})),i.childNodes=p.call(e,t.childNodes),(i.childNodes.length||e.filterNodeMethod(e.filterText,t.data,t))&&n.push(i)})),n):n}},3:function(t,e,n){var i=n(16);function a(t,e,n){return e=i(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}t.exports=a,t.exports.__esModule=!0,t.exports["default"]=t.exports},35:function(t,e,n){"use strict";n.r(e);var i=n(12);e["default"]={mixins:[i["default"]],props:{},design:{isMask:!1,toolButtons:{infoButton:!0,dragButton:!0,removeButton:!0,settingButton:!0},settingMenus:function(){return[{text:"保存为业务组件",command:"save-business",handler:function(){this.$designer.saveBusinessComponentSingle(this,"")},hidden:function(){return!(null!==this&&void 0!==this&&this.$designer.$allowSaveBusinessControl)}}]}}}},353:function(t,e,n){"use strict";n.r(e);var i=n(45),a=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",level:0,currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"大文本",code:"text",type:t.metadata.getDataType("object"),length:"",defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},r=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),dataSourceWatch:!0,defaultValue:null,dataSource:{code:null,type:"static",attach:[]},valueAttributes:[{name:"值",code:"value",type:t.metadata.getDataType("number"),length:1,defaultValue:0,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:100,defaultValue:"否",encrypt:!1,unit:null,textType:"normal"}]}},o=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),dataSourceWatch:!0,defaultValue:null,dataSource:{code:null,type:"static",attach:[]},valueAttributes:[{name:"路径",code:"path",type:t.metadata.getDataType("string"),length:120,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"值",code:"value",type:t.metadata.getDataType("string"),length:100,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:100,defaultValue:null,encrypt:!1,unit:null,textType:"normal"}]}},s=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"封面设置",code:"conver",type:t.metadata.getDataType("object"),length:500,defaultValue:null,unit:null,encrypt:!1,textType:"JSON"}]}},l=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,dataSource:{code:null,type:"static",attach:[]},valueAttributes:[{name:"值",code:"value",type:t.metadata.getDataType("string"),length:100,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:100,defaultValue:null,encrypt:!1,unit:null,textType:"normal"}]}},u=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"开始日期",code:"sdate",type:t.metadata.getDataType("date"),length:null,defaultValue:null,unit:null,textType:"normal"},{name:"结束日期",code:"edate",type:t.metadata.getDataType("date"),length:null,defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},d=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"日期",code:"date",type:t.metadata.getDataType("date"),length:null,defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},c=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,dataSource:{type:"static",code:"",attach:[]},valueAttributes:[{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:"200",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"值",code:"value",type:t.metadata.getDataType("string"),length:"200",defaultValue:null,encrypt:!1,unit:null,textType:"normal"}]}},f=function(t){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:"200",defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},h=function(t){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:"200",defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},p=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,isJSONString:!0,valueAttributes:[{name:"文件上传",code:"file",type:t.metadata.getDataType("object"),length:500,defaultValue:null,unit:null,encrypt:!1,textType:"JSON"}]}},v=function(){return{id:"",name:"流程信息",code:"",type:dsf.metadata.mmtype(3),at:"",level:0,controls:[],validate:dsf.metadata.validate(),defaultValue:null,valueAttributes:[{name:"流程id",code:"wf_id",type:dsf.metadata.getDataType("string"),length:"50",defaultValue:null,unit:null,encrypt:!1,textType:"normal"},{name:"流程名称",code:"wf_name",type:dsf.metadata.getDataType("string"),length:"50",defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},m=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),dataSourceWatch:!0,defaultValue:null,dataSource:{code:null,type:"static",attach:[]},valueAttributes:[{name:"值",code:"value",type:t.metadata.getDataType("string"),length:100,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:100,defaultValue:null,encrypt:!1,unit:null,textType:"normal"}]}},g=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"超大文本",code:"img",type:t.metadata.getDataType("longObject"),length:null,defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},y=function(t){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"地点",code:"address",type:t.metadata.getDataType("string"),length:200,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"建筑名称",code:"title",type:t.metadata.getDataType("string"),length:60,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"经度",code:"lng",type:t.metadata.getDataType("string"),length:20,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"纬度",code:"lat",type:t.metadata.getDataType("string"),length:20,defaultValue:null,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"}]}},$=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(2),at:"",currentControl:null,controls:[],level:0,dataFormatter:"tree",validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"节点名称",code:"name",type:t.metadata.getDataType("string"),length:"50",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree节点父标识",code:"pid",type:t.metadata.getDataType("string"),length:"50",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree节点图标",code:"icon",type:t.metadata.getDataType("string"),length:"200",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree全局标识",code:"globalid",type:t.metadata.getDataType("string"),length:"500",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree节点等级",code:"level",type:t.metadata.getDataType("number"),length:"2,0",defaultValue:null,encrypt:!1,unit:null,textType:"normal"}]}},b=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,isJSONString:!0,valueAttributes:[{name:"图片上传",code:"img",type:t.metadata.getDataType("object"),length:500,defaultValue:null,unit:null,encrypt:!1,textType:"JSON"}]}},x=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],dataSourceWatch:!0,validate:t.metadata.validate(),defaultValue:null,dataSource:{code:null,type:"static",attach:[]},valueAttributes:[{name:"当前值",code:"active",type:t.metadata.getDataType("number"),length:"2,0",defaultValue:0,emptyValidate:!0,encrypt:!1,unit:null,textType:"normal"},{name:"走过的最大步骤",code:"max",type:t.metadata.getDataType("number"),length:"2,0",defaultValue:0,encrypt:!1,unit:null,textType:"normal"},{name:"当前状态",code:"status",type:t.metadata.getDataType("string"),length:"30",defaultValue:"wait",encrypt:!1,unit:null,textType:"normal"}]}},w=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,level:1,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[]}},D=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(2),at:"",currentControl:null,controls:[],level:0,validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"",code:"",type:"",length:"",defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},S=function(t){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"文本",code:"text",type:t.metadata.getDataType("string"),length:100,defaultValue:null,emptyValidate:!0,unit:null,encrypt:!1,textType:"normal"}]}},O=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"开始时间",code:"stime",type:t.metadata.getDataType("time"),length:null,defaultValue:null,unit:null,textType:"normal"},{name:"结束时间",code:"etime",type:t.metadata.getDataType("time"),length:null,defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},k=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"时间",code:"time",type:t.metadata.getDataType("time"),length:length||50,defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}},C=function(t){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],level:0,validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"tree节点父标识",code:"pid",type:t.metadata.getDataType("string"),length:"50",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree节点图标",code:"icon",type:t.metadata.getDataType("string"),length:"200",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree全局标识",code:"globalid",type:t.metadata.getDataType("string"),length:"500",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree节点等级",code:"level",type:t.metadata.getDataType("number"),length:"2,0",defaultValue:null,encrypt:!1,unit:null,textType:"normal"},{name:"tree节点类型",code:"type",type:t.metadata.getDataType("string"),length:"10",defaultValue:null,encrypt:!1,unit:null,textType:"normal"}]}},T=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"签名上传",code:"file",type:t.metadata.getDataType("object"),length:500,defaultValue:null,unit:null,encrypt:!1,textType:"JSON"}]}},I=function(t,e){return{id:"",name:"",code:"",type:t.metadata.mmtype(3),at:"",level:0,currentControl:null,controls:[],validate:t.metadata.validate(),defaultValue:null,valueAttributes:[{name:"JSON数据",code:"json",type:t.metadata.getDataType("json"),length:"",defaultValue:null,unit:null,encrypt:!1,textType:"normal"}]}};dsf.metadata.add("big-text-meta-data",a),dsf.metadata.add("boolean-meta-data",r),dsf.metadata.add("cascader-meta-data",o),dsf.metadata.add("customer-img-meta-data",s),dsf.metadata.add("data-choice-meta-data",l),dsf.metadata.add("date-interval-meta-data",u),dsf.metadata.add("date-picker-meta-data",d),dsf.metadata.add("exam-items-meta-data",c),dsf.metadata.add("exam-meta-data",f),dsf.metadata.add("exam-subjective-meta-data",h),dsf.metadata.add("file-meta-data",p),dsf.metadata.add("flow-info-meta-data",v),dsf.metadata.add("items-meta-data",m),dsf.metadata.add("long-text-meta-data",g),dsf.metadata.add("map-meta-data",y),dsf.metadata.add("nav-tree-meta-data",$),dsf.metadata.add("photo-meta-data",b),dsf.metadata.add("steps-meta-data",x),dsf.metadata.add("sublist-meta-data",w),dsf.metadata.add("system-meta-data",D),dsf.metadata.add("text-meta-data",S),dsf.metadata.add("time-interval-meta-data",O),dsf.metadata.add("time-picker-meta-data",k),dsf.metadata.add("tree-info-meta-data",C),dsf.metadata.add("signature-meta-data",T),dsf.metadata.add("json-meta-data",I);var N={namespaced:!0,state:{queue:{}},mutations:{add:function(t,e){t.queue[e]||(t.queue[e]=!0)},remove:function(t,e){t.queue[e]&&delete t.queue[e]}},actions:{},getters:{}},L=N,P={namespaced:!0,state:{flowModel:"normal",page:{width:0,height:0,top:60,left:250,right:250,scale:1},svgRoot:{top:0,left:0,right:0,scrollLeft:0,scrollTop:0},lanes:{vertical:[],horizontal:[],height:30,width:30},LaneDirection:{vertical:"vertical",horizontal:"horizontal"},allPoints:{},selectedList:[],lineDefault:{Path:{id:"path",strokeWidth:"2",arrow:"block-wide-long",stroke:"#999",hoverStrokeWidth:"3",hoverStroke:"#990033",isSelected:"#333",isThrough:"#28c413"},Lines:{Line_0:{name:"一般线",stroke:"#999"},Line_1:{name:"汇总线",stroke:"#1E7EFF"},Line_2:{name:"退回线",stroke:"#F24B35"}}},checked:null},mutations:{setFlowModel:function(t,e){t.flowModel=e},setPage:function(t,e){t.page=Object.assign(t.page,e)},setSvgRoot:function(t,e){t.svgRoot=Object.assign(t.svgRoot,e)},setChecked:function(t,e){t.checked=e},resetLane:function(t,e){t.lanes=e},addLane:function(t,e){e.index>-1?t.lanes[e.direction].splice(e.index,0,e.lane):t.lanes[e.direction].push(e.lane),this.commit("flow/reloadLanes",e.direction)},deleteLane:function(t,e){var n=t.lanes[e.direction].indexOf(e);n>-1&&t.lanes[e.direction].splice(n,1),this.commit("flow/reloadLanes",e.direction)},changeLane:function(t,e){t.lanes[e.direction].forEach((function(t){t.id===e.id&&(t=Object.assign(t,e))})),this.commit("flow/reloadLanes",e.direction)},reloadLanes:function(t,e){var n;e===t.LaneDirection.vertical?t.lanes[e].forEach((function(t){t.left=n?n.size+n.left:0,n=t})):t.lanes[e].forEach((function(t){t.top=n?n.size+n.top:0,n=t}))},clearLanes:function(t){t.lanes.vertical=[],t.lanes.horizontal=[]},setPointsByNode:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:options,a=i.node,r=i.obj,o=[],s=a.open&&!a.open.show;e=s?a.open.width:a.width,n=s?a.open.height:a.height;for(var l=parseInt((e+r.width)/r.width),u=parseInt((e+r.width)%r.width/(l>2?l-2:1)),d=0,c=parseInt((n+r.height)%r.height/(d>2?d-2:1)),f=0;f<l;f++){var h={point:{x:(a.point.x+f*u+r.width*(f-.5))*t.page.scale,y:(a.point.y-1*r.img.width/2)*t.page.scale},index:f,direction:"top"},p={point:{x:(a.point.x+f*u+r.width*(f-.5))*t.page.scale,y:(a.point.y+n-1*r.img.width/2)*t.page.scale},index:f,direction:"bottom"};f===l-1&&(h.isMax=!0,p.isMax=!0),o.push(h),o.push(p)}for(var v=1;v<d-1;v++){var m={point:{x:(a.point.x-1*r.height/2)*t.page.scale,y:(a.point.y+c+r.height*(v-.5))*t.page.scale},index:v,direction:"left"},g={point:{x:(a.point.x+e-1*r.height/2)*t.page.scale,y:(a.point.y+c+r.height*(v-.5))*t.page.scale},index:v,direction:"right"};v===d-2&&(m.isMax=!0,g.isMax=!0),o.push(m),o.push(g)}t.allPoints[a.id]=o},addPoint:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:options,n=e.id,i=e.obj;t.allPoints[n]&&t.allPoints[n].push(i)},deletePoint:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:options,n=e.id,i=e.index;t.allPoints[n]&&t.allPoints[n].splice(i,1)},clearPoints:function(t){t.allPoints={}},setSelectedList:function(t,e){t.selectedList=e},addSelected:function(t,e){t.selectedList.push(e)},deleteSelected:function(t,e){e>-1&&t.selectedList.splice(e,1)}},actions:{},getters:{lanes:function(t,e){return t.lanes[e]},lanesWidth:function(t){return t.lanes.horizontal.length>0?t.lanes.width:0},lanesHeight:function(t){return t.lanes.vertical.length>0?t.lanes.height:0},getMousePointByCanvas:function(t,e){return function(n){var i=n.x,a=n.y,r=e.getSvgOffset;return i=i-t.page.left-r.left+t.svgRoot.scrollLeft,a=a-t.page.top-r.top+t.svgRoot.scrollTop,{x:i,y:a}}},getSvgOffset:function(t,e){var n=e.lanesWidth,i=e.lanesHeight,a={top:Math.abs(parseFloat(i||0)),left:Math.abs(parseFloat(n||0))};return a},getMousePointByPoint:function(t,e){return function(n){var i=n.x,a=n.y,r=e.getSvgOffset;return i=i+t.page.left+r.left-t.svgRoot.scrollLeft,a=a+t.page.top+r.top-t.svgRoot.scrollTop,{x:i,y:a}}},getPoints:function(t){return function(e){return t.allPoints[e]}}}},F=P,E={namespaced:!0,state:{compelPanelSize:{width:null,height:null},panelSize:{width:null,height:null,scale:1,left:0,top:0},newSeatItem:{id:null,pageX:null,pageY:null},activeId:"",regionPosition:{},seatInfo:{},newGroupItem:{id:null},switchNumSet:!1,haveSelectedItems:!1},getters:{},mutations:{changeCompelPanelSize:function(t,e){t.compelPanelSize=e},changePanelSize:function(t,e){t.panelSize=e},addSeat2Panel:function(t,e){t.newSeatItem=e},changeActiveId:function(t,e){t.activeId=e},changeRegionPosition:function(t,e){t.regionPosition=e},changeSeatInfo:function(t,e){t.seatInfo=e},addGroup2Panel:function(t,e){t.newGroupItem=e},changeSwitchNumSet:function(t,e){t.switchNumSet=e},changeHaveSelectedItems:function(t,e){t.haveSelectedItems=e}},actions:{}},V=E,j={namespaced:!0,state:{include:[],exclude:[],context:[]},mutations:{add:function(t,e){dsf.array.ensure(t.context,e,(function(t){return t.path==e.path})),t.include=_.map(t.context,"name"),_.each(t.include,(function(e){dsf.array.remove(t.exclude,e)}))},clear:function(t){t.context=[],t.include=[],t.exclude=[]},remove:function(t,e){var n=[];dsf.array.removeWith(t.context,(function(t){if(t.path==e)return t.vm&&(t.vm=null),n.push(t.name),!0})),t.include=_.map(t.context,"name"),_.each(n,(function(e){dsf.array.ensure(t.exclude,e)}))}},actions:{},getters:{instances:function(t){return _.keyBy(t.context,"path")}}},M=j,A={namespaced:!0,state:{checked:{},otherpageid:null},mutations:{updateChecked:function(t,e){t.checked=_.cloneDeep(e)},updateOtherpageid:function(t,e){t.otherpageid=e}}},B=A,R={namespaced:!0,state:{compelPanelSize:{width:null,height:null},panelSize:{width:null,height:null,scale:1,left:0,top:0},newSeatItem:{id:null,pageX:null,pageY:null},activeId:"",regionPosition:{},seatInfo:{},haveSelectedItems:!1,showBorderLine:!0},getters:{},mutations:{changeCompelPanelSize:function(t,e){t.compelPanelSize=e},changePanelSize:function(t,e){t.panelSize=e},addSeat2Panel:function(t,e){t.newSeatItem=e},changeActiveId:function(t,e){t.activeId=e},changeRegionPosition:function(t,e){t.regionPosition=e},changeSeatInfo:function(t,e){t.seatInfo=e},changeHaveSelectedItems:function(t,e){t.haveSelectedItems=e},changeShowBorderLine:function(t,e){t.showBorderLine=e}},actions:{}},H=R,K={namespaced:!0,state:{show:!1},mutations:{on:function(t){t.show=!0},off:function(t){t.show=!1}}},q=K,W=n(3),U=n.n(W);function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach((function(e){U()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Y=null,G={namespaced:!0,state:{menuSubscript:{},subscript:{},items:{}},mutations:{updateSubscript:function(t,e){var n=e.menu;n&&(delete e.menu,dsf.isEmptyObject(n)||(t.menuSubscript=J(J({},t.menuSubscript),n))),dsf.isEmptyObject(t)||(t.subscript=J(J({},t.subscript),e))}},actions:{init:function(t){var e=t.commit;Y||(Y=dsf.ws(),Y.$on("/websocket/subscript",(function(t){var n=t.data;e("updateSubscript",n)})))}},getters:{}},Q=G,X=n(2),Z=n.n(X);function tt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function et(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(n),!0).forEach((function(e){U()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nt=null,it={namespaced:!0,state:{badges:{},menuIds:[]},mutations:{updateBadges:function(t,e){var n=e.data,i={};_.forEach(n,(function(t){i[t.menuId]=t})),null!==n&&void 0!==n&&n.length&&(t.badges=et(et({},t.badges),i))},updateMenuIds:function(t,e){t.menuIds=_.uniq([].concat(Z()(t.menuIds),Z()(e)))}},actions:{init:function(t,e){var n=t.commit;+dsf.config.setting_public_ws_switch&&(nt=dsf.ws(dsf.config.setting_public_ws_url||"ws://"+location.hostname+":8888"),n("updateMenuIds",e.menu_ids),nt.$on("/menu/cornerMark",{markId:e.markId.join(",")},(function(t){var i=t.data;n("updateBadges",{data:i,type:e.type})})),nt.$send("/menu/cornerMark",e.menu_ids.join(","),{queryParams:{markId:e.markId.join(",")}},!0))}},getters:{}},at=it,rt={refreshQueue:L,flow:F,seatDesign:V,keepAlive:M,mobileMailChecked:B,printingDesign:H,userInfoWaterMark:q,ws:Q,cornerMark:at},ot={install:function(t){t.filter("proxy",(function(e){if(dsf.isDef(e)){var n=Array.prototype.slice.call(arguments,0);if(n[1]){var i=n[1].split("^");if(t.filter(i[0])){if(e.edate&&e.sdate)return[t.filter(i[0]).apply(this,[e.sdate].concat(Z()(i.slice(1)))),t.filter(i[0]).apply(this,[e.edate].concat(Z()(i.slice(1))))].join(" 至 ");var a=t.filter(i[0]).apply(this,[e].concat(Z()(i.slice(1))));return a}return e}return e}return""}))}},st={install:function(t){t.filter("proxyTitle",(function(e){if(dsf.isDef(e)){var n=Array.prototype.slice.call(arguments,0);if(n[1]){var i=n[1].split("^");return t.filter(i[0])?i[0].startsWith("html")?"":e.edate&&e.sdate?[t.filter(i[0]).apply(this,[e.sdate].concat(Z()(i.slice(1)))),t.filter(i[0]).apply(this,[e.edate].concat(Z()(i.slice(1))))].join(" 至 "):t.filter(i[0]).apply(this,[e].concat(Z()(i.slice(1)))):e}return e}return""}))}},lt={install:function(t){t.filter("textValue",(function(t,e){if(t){if(/^(\S+)\[(\S+)]$/.test(e)){var n=e.match(/^(\S+)\[(\S+)]$/);if("object"==dsf.type(t)){var i=t["attach"]?"(".concat(t["attach"],")"):"";return"".concat(t[n[1]]," [").concat(t[n[2]],"] ").concat(i)}if("array"==dsf.type(t))return _.map(t,(function(t){var e=t["attach"]?"(".concat(t["attach"],")"):"";return"".concat(t[n[1]]," [").concat(t[n[2]],"] ").concat(e)})).join("，")}else{if("object"==dsf.type(t))return t["attach"]?"".concat(t[e]," (").concat(t["attach"],")"):t[e];if("array"==dsf.type(t))return _.map(t,(function(t){return t["attach"]?"".concat(t[e]," (").concat(t["attach"],")"):t[e]})).join("，")}return t}return""}))}},ut={install:function(t){t.filter("dateTime",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-mm-dd hh:ii",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return t?dsf.date.format(t,e,n,i):""}))}},dt={install:function(t){t.filter("emptyFilter",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"function"===typeof t||"date"===dsf.type(t)?t:dsf.isUnDef(t)||dsf.isEmptyObject(t)?e:t}))}},ct={install:function(t){t.filter("multipleFiles",(function(t,e){return t?"string"==dsf.type(t)?_.map(JSON.parse(t),e).join(","):"array"==dsf.type(t)?_.map(t,e).join(","):t:""}))}},ft={install:function(t){t.filter("textValueByLast",(function(t,e,n){return t?"object"==dsf.type(t)?t[e].split(n).pop():"array"==dsf.type(t)?_.map(t,(function(t){return t[e].split(n).pop()})).join(","):t:""}))}},ht={install:function(t){t.filter("timeAgo",(function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?dsf.date.timeAgo(t,e):""}))}},pt={install:function(t){t.filter("htmlFiles",(function(t){if(!t)return"";if(dsf.isString(t))try{t=JSON.parse(t)}catch(n){return""}dsf.isObject(t)&&(t=[t]);var e=t.map((function(t){return vt(t)}));return'<div class="proxy-files" >\n        '.concat(e.join('<i class="splitter">、</i>'),"\n      </div>")}))}};function vt(t){var e=t.relativePath,n=t.suffix,i=t.originalFileName,a=dsf.url.getWebPath(e);return'<a class="proxy-file" href="'.concat(a,'" target="_blank" onclick="event.stopPropagation()">\n      <i class="dsf-file-icon ').concat(n,'"></i>\n      <span class="name">').concat(i,"</span>\n  </a>")}var mt={install:function(t){t.filter("htmlImage",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"relativePath";if(!t)return"";if(dsf.isString(t))try{t=JSON.parse(t)}catch(n){return gt(t)}return dsf.isObject(t)&&(t=[t]),t.map((function(t){return gt(t[e])})).join("")}))}};function gt(t){return t=dsf.url.getWebPath(t),'<img class="proxy-img" src="'.concat(t,'" style="max-width: 100%;max-height: 100%;" />')}var yt=/\^/g,$t={install:function(t){t.filter("splitArrow",(function(t,e){return t.replace(yt,e)}))}},bt={install:function(t){t.filter("htmlLink",(function(t){return dsf.isDef(t)?'<a title="'.concat(t,'" href="javascript:void(0)" class="ds-link text-proxy-link">').concat(t,"</a>"):""}))}},xt={install:function(t){t.filter("imgFormat",(function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(dsf.isUnDef(t)||""==t)return"";var n=t;return"string"==dsf.type(n)?-1==n.indexOf("relativePath")||-1==n.indexOf("absolutePath")?t:dsf.getFilePath(n,e):""}))}},wt={install:function(t){t.filter("express",(function(t,e){return t?"object"==dsf.type(t)?Dt(t,e):"array"==dsf.type(t)?_.map(t,(function(t){return Dt(t,e)})).join("，"):t:""}))}};function Dt(t,e){return dsf.isEmptyObject(t)?"":dsf.express.eval(e,t)}var _t=n(8),St=n.n(_t),Ot=[["ppt^pptx",n(47)],["pdf^pdfx",n(48)],["mp3^cda^wav^aif^aiff^mid^wma^ra^vqf^ape",n(49)],["doc^docx",n(50)],["avi^mp4^wmv^mpg^mov^mpeg^ram^flv^rm^swf",n(51)],["xlsx^xls^csv",n(52)],["png^jpg^bmp^jpeg",n(53)]],kt=n(54),Ct={install:function(t){t.filter("fileSuffixIcon",Tt),t.prototype.$fileSuffixIcon=Tt}};function Tt(t){if(dsf.isString(t)&&(t=JSON.parse(t)),dsf.isArray(t)&&(t=t[0]),dsf.isObject(t)){var e=Ot.find((function(e){var n=St()(e,1),i=n[0];return i.includes(t.suffix)}));return e=e?e[1]:kt,e}return""}var It={install:function(t){t.filter("periodTime",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy年MM月dd旬";if(t){var n=new Date(t),i=n.getFullYear(),a=n.getMonth(),r=n.getDate();return"yyyy年M半年"==e?"".concat(i,"年").concat(["上","下"][a],"半年"):"yyyy年第M季度"==e?"".concat(i,"年第").concat(a+1,"季度"):"".concat(i,"年").concat(a+1,"月").concat(["上","中","下"][[1,11,21].indexOf(r)],"旬")}return""}))}},Nt={install:function(t){t.filter("htmlContext",(function(t){return dsf.isDef(t)?t:""}))}},Lt=null,Pt=/[a-zA-Z0-9\W]/,Ft={install:function(t){t.filter("htmlJustify",(function(t){var e;t.split("");if(Lt||(Lt=document.createElement("div")),Lt.innerHTML=t,null!==(e=Lt)&&void 0!==e&&null!==(e=e.childNodes)&&void 0!==e&&e.length){Et(Lt,Vt);var n=1==Lt.childNodes[0].nodeType?Lt.childNodes[0].outerHTML:Lt.childNodes[0].nodeValue;return Lt.innerHTML="",n}return""}))}};function Et(t,e){var n;3==t.nodeType&&e&&e(t),null!==t&&void 0!==t&&null!==(n=t.childNodes)&&void 0!==n&&n.length&&t.childNodes.forEach((function(t){Et(t,e)}))}function Vt(t){var e=t.nodeValue,n=e.split(""),i=n.map((function(t,e){return Pt.lastIndex=0,Pt.test(t)&&e<n.length-1?"".concat(t,"&nbsp;"):t}));t.nodeValue=i.join("")}function jt(t){t.use(ot),t.use(st),t.use(lt),t.use(ut),t.use(dt),t.use(ct),t.use(ft),t.use(ht),t.use(pt),t.use(mt),t.use($t),t.use(bt),t.use(xt),t.use(Ct),t.use(It),t.use(wt),t.use(Nt),t.use(Ft)}var Mt=jt,At="mousedown",Bt="mousemove",Rt="mouseup";"ontouchstart"in window&&(At="touchstart",Bt="touchmove",Rt="touchend");var Ht={install:function(t){t.directive("drag",{inserted:function(t,e,n){function i(e){e=e.touches&&e.touches[0]||e,t.setAttribute("data-flag",!1);var n=e.clientX-t.offsetLeft,i=e.clientY-t.offsetTop,a=(new Date).getTime();function r(e){e.preventDefault(),e.stopPropagation(),e=e.touches&&e.touches[0]||e,t.classList.add("drag-active"),t.style.left=e.clientX-n+"px",t.style.top=e.clientY-i+"px"}function o(){window.removeEventListener(Bt,r,{passive:!1}),window.removeEventListener(Rt,o,{passive:!1});var e=(new Date).getTime();e-a<200&&t.setAttribute("data-flag",!0),t.classList.remove("drag-active")}window.addEventListener(Bt,r,{passive:!1}),window.addEventListener(Rt,o,{passive:!1})}t["on".concat(At)]=i},unbind:function(t){t["on".concat(At)]=null}})}};function Kt(t){t.use(Ht)}var qt=Kt,Wt={inputPlaceholder:"请输入",selectPlaceholder:"请选择",checkAll:"全选",save:"保存",datePicker:{early:"上旬",middle:"中旬",late:"下旬",firstHalf:"上半年",secondHalf:"下半年",firstQuarter:"第一季度",secondQuarter:"第二季度",thirdQuarter:"第三季度",fourthQuarter:"第四季度",SSText:"{0}年第{1}季度",MDText:"{0}年{1}月{2}旬",HYText:"{0}年{1}半年"},el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"},empty:{description:"暂无数据"}}},Ut={inputPlaceholder:"Please input",selectPlaceholder:"Please select",checkAll:"Select all",save:"Save",datePicker:{early:"early",middle:"middle",late:"late",firstHalf:"first half",secondHalf:"second half",firstQuarter:"1st quarter",secondQuarter:"2nd quarter",thirdQuarter:"3rd quarter",fourthQuarter:"4th quarter",SSText:"{0}-{1}",MDText:"{0}-{1}-{2}",HYText:"{0}-{1}"},el:{colorpicker:{confirm:"OK",clear:"Clear"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:""},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},empty:{description:"No Data"}}},zt={zh_CN:{platform:Wt},en_US:{platform:Ut}},Jt=dsf.enums,Yt="preView",Gt={pc:{},mobile:{}},Qt="EXTJS未能找到或内部代码错误";function Xt(t,e,n,i){i||(e=Yt+"_"+e),Gt[t][e]=n}function Zt(t,e,n){return n||(e=Yt+"_"+e),Gt[t][e]}function te(t,e){return t+"-"+e.replace(/\./g,"-")}function ee(t,e){var n=ne(e);dsf.config.serverCreateHtmlDir;return t+"/views/"+n.ns+"/"+n.file+".ext"}function ne(t){t.startsWith(".")&&(t=t.substr(1));var e=t.split("."),n=e[e.length-1],i=e.slice(0,e.length).join("."),a=e.slice(0,e.length-1).join(".");return{path:i,file:n,ns:a}}function ie(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(a,r){Zt(e,t,i)?a(Zt(e,t,i)):ue(t,e,n,i).then((function(o){if(Zt(e,t,i))a(Zt(e,t,i));else{var s=ee(e,t);dsf.performance.start("解析"+s+"布局");var l=o.context.tpl,u=null;if(o.context.render){var d=o.context.render,c=o.context.staticRenderFns||void 0;if("mobile"==e){var f=d;d=function(t){var e=this,n=f.call(e),i=t("div",{},dsf.isArray(n)?n:[n]);return i}}u={render:d,staticRenderFns:c}}else"mobile"==e&&(l="<div>".concat(l,"</div>")),u=Vue.compile(l);var h=dsf.config.serverCreateHtmlDir;n=se(n),dsf.performance.end("解析"+s+"布局"),dsf.performance.start("加载"+s);var p={staticRenderFns:u.staticRenderFns,render:function(t){return null!==this&&void 0!==this&&this.$noAccess?t("div",{class:"ds-error-wrap"},[t("div",{class:"redict-content"},[t("img",{attrs:{src:"/static/img/platform/error-403.png"},class:"error-img"}),t("p",{class:"sub-title sub-title1"},["抱歉！您没有访问权限，请联系管理员"])])]):u.render.call(this,t)}};if(i)dsf.require({baseUrl:h,urlArgs:n?null:"_t="+dsf.cacheTime},[s],(function(n){var i;if(!n){var r=s+".ext.js中可能存在错误或者浏览器不支持的语法";throw dsf.layer.message(r,!1),new Error(r)}var l=(null===(i=o)||void 0===i||null===(i=i.context)||void 0===i||null===(i=i.layout)||void 0===i?void 0:i.showLogicCompile)||{};ae(n,t,e,o),re(n,p,!0,l),Xt(e,t,n,!0),dsf.global.Vue.component(n.name,n),dsf.performance.end("加载"+s),a(n),o=null}),(function(t){t&&dsf.error(t);var e={message:Qt};dsf.layer.message(e,!1),r(e)}));else{var v,m={},g=(null===(v=o)||void 0===v||null===(v=v.context)||void 0===v||null===(v=v.layout)||void 0===v?void 0:v.showLogicCompile)||{};ae(m,t,e,o),re(m,p,!1,g);var y="preView"+m.name;m.name=y,Xt(e,t,m,!1),dsf.global.Vue.component(y,m),a(m),o=null}}})).catch((function(t){r(t)}))}))}function ae(t,e,n,i){var a,r,o,s,l,u,d;t.mode=(null===i||void 0===i||null===(a=i.context)||void 0===a||null===(a=a.layout)||void 0===a?void 0:a.mode)||Jt.viewMode.DEVELOP,t.pageType=null===i||void 0===i||null===(r=i.context)||void 0===r||null===(r=r.layout)||void 0===r?void 0:r.pageType,t.pageTitle=i.context.layout.title,t.name=_.camelCase(te(n,e)),t.needLogin=!1!==i.context.layout.needLogin,t.pageLevel=i.context.layout.pageLevel||1,t.isKeepAlive=i.context.layout.isKeepAlive||!1;var c="mobile"==n?$mixins.mobileLayoutView:$mixins.pcLayoutView;t.extends=c,t.mixins=[],t.isEs=(null===i||void 0===i||null===(o=i.context)||void 0===o||null===(o=o.layout)||void 0===o?void 0:o.isEs)||!1,t.esIndexName=(null===i||void 0===i||null===(s=i.context)||void 0===s||null===(s=s.layout)||void 0===s?void 0:s.esIndexName)||!1,t.waterMark=!1!==i.context.layout.waterMark,t.metadataDict=function(){var t;return JSON.parse(null===i||void 0===i||null===(t=i.context)||void 0===t?void 0:t.metadataDict)},t.layoutComponentProps=null===i||void 0===i||null===(l=i.context)||void 0===l?void 0:l.componentProps,t.$$service=dsf.mix(!0,{},(null===i||void 0===i||null===(u=i.context)||void 0===u?void 0:u.service)||{}),t.$$pageDesignId=(null===i||void 0===i||null===(d=i.context)||void 0===d||null===(d=d.layout)||void 0===d?void 0:d.designId)||"";var f=dsf.config.layoutViewMixins[i.context.layout.pageType];t.staticData=t.mode===Jt.viewMode.PROTOTYPE?function(){var t;return JSON.parse(null===i||void 0===i||null===(t=i.context)||void 0===t?void 0:t.staticValue)}:function(){return null},_.each(f||[],(function(e){window.$mixins[e]&&t.mixins.push(window.$mixins[e])}))}function re(t,e,n,i){var a={data:function(){this.controlJSON=t.layoutComponentProps;var e=this.$$getLayoutComponentsProps(),n=["isDsf","hidePostNullValue","hideIgnoreValidate","isPostNull","isMergeHttp","development","designerInfo","metadataAttach","designLock","desCopyedChangeCaption","metaDataLevel","designProxy","designOnlySlot","designInductionSlot","designShowMark","designShowMarkCaption","designShowMarkInfo","designShowMarkRemove","designShowMarkDragDrop","designDisabledProps","dataAudioUrl","dataVideoUrl"],a={};return _.each(e,(function(t,i){_.each(n,(function(e){delete t[e]})),oe(t,e,a)})),this.ctrlTreeInfo=Object.freeze(a),this.showLogicCompile=Object.freeze(i),{$$esIndexName:t.esIndexName,$$isEs:null===t||void 0===t?void 0:t.isEs,$$staticValue:t.staticData(),$$service:t.$$service,$$controls:e,$$keepAlive:null===t||void 0===t?void 0:t.isKeepAlive,$$pageType:null===t||void 0===t?void 0:t.pageType,$$mode:null===t||void 0===t?void 0:t.mode,$$pageDesignId:t.$$pageDesignId||"",metadataDict:t.metadataDict()}},computed:{$isEs:function(){return this._data.$$isEs},$esIndexName:function(){return this._data.$$esIndexName},$controls:function(){return this._data.$$controls},$controlsMapping:function(){var t={};for(var e in this._data.$$controls){var n=this._data.$$controls[e],i=e.split("-")[1];i=i?"-"+i:"";var a=n.caption+i;n.isFormControl&&(a=n.metadata_fullcode+i),t[a]=e}return t},$service:function(){var t;return null===this||void 0===this||null===(t=this._data)||void 0===t?void 0:t.$$service},$baseUrl:{get:function(){var t;return(null===this||void 0===this||null===(t=this.$service)||void 0===t?void 0:t.baseUrl)||""},set:function(t){this.$set(this.$service,"baseUrl",t)}},$pageComponentProps:function(){return this._data.$$controls[this._data.$$pageDesignId]}},created:function(){},methods:{$$getLayoutComponentsProps:function(){return JSON.parse(this.controlJSON)}},destroyed:function(){for(var t in this._data.$$controls)this._data.$$controls[t]=null,delete this._data.$$controls[t]}},r=dsf.mix(a,e);n||t.mixins.push({provide:function(){return{$isPreView:!0}}}),t.mixins.push(r)}function oe(t,e,n){var i={};_.each((null===t||void 0===t?void 0:t.slots)||[],(function(a){var r=_.map(a.controls,(function(a){return i[a.designId]=n[a.designId]||{},e[a.designId]?e[a.designId]:(oe(a,e,n,t),a)}));a.controls=r})),n[t.designId]?Object.assign(n[t.designId],i):n[t.designId]=i}function se(t){return dsf.isUnDef(t)&&(t=dsf.config.setting_public_layoutviewcache),t}function le(t,e,n){var i=ee(e,t),a=i.replace(/\.|\//g,"");if(!document.querySelector("#"+a)){n=se(n);var r=dsf.config.serverCreateHtmlDir,o=r+i+".js"+(n?"":"?_t="+dsf.cacheTime);dsf.preloadScript(o,a)}}function ue(t,e,n,i){return i&&le(t,e,n),new Promise((function(a,r){var o=null,s=null;de(t,e,n).then((function(t){o=t,s=ce(o?o.data:{});var e=function(t){return!(t.isFormControl&&t.textProxy)};return dsf.designer.requestAsyncComponentsByLayout(s.layout,e)})).then((function(){try{var e=dsf.fillComponentDefaultProps(s.layout),n=s.css;e["module-name"]=t;var r="<style>".concat(n,"</style>");e["customCss"]=r,dsf.setObjAttr(e,"showLogicCompile",s.showLogicCompile);var o=null;o=s.render&&i?dsf.designer.convertControlData(e):dsf.designer.convertTemplateAndControlData(e,!1,!1,i);var l={context:{tpl:o.tpl||"",componentProps:JSON.stringify(o.props),layout:e,moduleName:t,metadataDict:s.metadataDict||{},service:s.service||{},staticValue:s.staticValue||{},render:s.render,staticRenderFns:s.staticRenderFns,showLogicCompile:s.showLogicCompile}};a(l)}catch(u){throw u}})).catch((function(t){if("error"==dsf.type(t)){var e=/40[34]+|50.+/g;e.test(t.message)?r():dsf.error(t)}else r(t)})).finally((function(){o=null,s=null}))}))}function de(t,e,n){var i=ne(t),a=dsf.config.serverCreateHtmlDir,r=e+"/views/"+i.ns+"/"+i.file+".layout.html";n=se(n);var o=dsf.http.get(r,null,{cache:n,responseType:"text"},a).then((function(t){return t}));return o}function ce(t){var e=document.createDocumentFragment(),n=document.createElement("div");n.innerHTML=t,e.appendChild(n);var i,a,r=n.querySelector("#layout"),o=n.querySelector("#css"),s=n.querySelector("#showLogicCompile"),l=n.querySelector("#metadatedict"),u=l?l.innerHTML.trim():"",d=n.querySelector("#service"),c=n.querySelector("#staticValue"),f=n.querySelector("#staticRenderFns"),h=n.querySelector("#render"),p=["var staticRenderFns="+(f?f.innerHTML.trim():"null").trim()+";","return staticRenderFns;"],v=h?h.innerHTML.trim():"",m=function(){var t=JSON.parse(r?r.innerHTML:"");return t},g=function(){var t=(o?o.innerHTML:"").trim();return t},y=function(){var t=s?s.innerHTML.trim():null;return t?new Function(t+"\nreturn fnMap;")():{}},$=dsf.fillComponentDefaultProps(m()),b=g(),x=y(),w=(u||"{}").trim(),D=function(){var t=new Function(["var s=",(d?d.innerHTML:"{}").trim(),"return s"].join("\r\n"));return t()},S=D(),O=(c?c.innerHTML:"{}").trim(),k=null;if(v){k=new Function([v].join("\n"));var C=new Function(p.join("\n"));if(i=k,a=C(),a){var T=["var fns=[];"];_.each(a,(function(t,e){var n="var fn_"+e+"=function(){";n+=t,n+="};",n+="fns.push(fn_"+e+")",T.push(n)})),T.push("return fns;");try{var I=new Function(T.join("\r\n"));a=I()}catch(P){dsf.error(P)}}}m=null,g=null,D=null,v=null,p.splice(0,p.length);for(var N=n.childNodes.length-1;N>=0;N--)n.removeChild(n.childNodes[N]);for(var L=e.childNodes.length-1;L>=0;L--)e.removeChild(e.childNodes[L]);return n=null,e=null,{layout:$,css:b,showLogicCompile:x,metadataDict:w,service:S,staticValue:O,staticRenderFns:a,render:i}}var fe=function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return e=e||"pc",ie(t,e,n,i)};fe.remove=function(t,e){var n=te(t,e);n=_.camelCase(n),delete Vue.options.components[n],delete Gt[t][e];var i=ee(t,e);dsf.require.undef(i)};var he=fe,pe={},ve={},me=function(t,e,n){Object.defineProperty(t,e,{get:function(){return ve[e]||(ve[e]=n()),ve[e]},enumerable:!0,configurable:!0})};me(pe,"control",(function(){return n(12).default})),me(pe,"formControl",(function(){return n(18).default})),me(pe,"itemsMixins",(function(){return n(259).default})),me(pe,"layout",(function(){return n(35).default})),me(pe,"view",(function(){return n(260).default})),me(pe,"layoutView",(function(){return n(37).default})),me(pe,"form",(function(){return n(261).default})),me(pe,"list",(function(){return n(262).default})),me(pe,"oneToMany",(function(){return n(263).default})),me(pe,"mobileLayoutView",(function(){return n(387).default})),me(pe,"pcLayoutView",(function(){return n(264).default})),me(pe,"tabControl",(function(){return n(265).default})),me(pe,"text",(function(){return n(266).default})),me(pe,"tree",(function(){return n(267).default})),me(pe,"buttonBar",(function(){return n(268).default})),me(pe,"disposeIdea",(function(){return n(269).default})),me(pe,"flowInfo",(function(){return n(270).default})),me(pe,"formCommentBox",(function(){return n(271).default})),me(pe,"tabPanelSetting",(function(){return n(272).default})),me(pe,"tabPanelTabSetting",(function(){return n(273).default})),me(pe,"card",(function(){return n(274).default})),me(pe,"cardList",(function(){return n(275).default})),me(pe,"chart",(function(){return n(276).default})),me(pe,"convenientMenu",(function(){return n(277).default})),me(pe,"dataResult",(function(){return n(278).default})),me(pe,"fileEncrypt",(function(){return n(279).default})),me(pe,"formulaAuditStateMixin",(function(){return n(280).default})),me(pe,"virtualTreeMixin",(function(){return n(281).default}));var ge=pe;!function(t){Object(i["a"])(dsf),dsf.mix(dsf,{dynamicComponent:he}),dsf.global.$mixins||(dsf.global.$mixins={});var e=function(t){Object.defineProperty(dsf.global.$mixins,t,{get:function(){return ge[t]},enumerable:!0,configurable:!0})};for(var n in ge)e(n);dsf.mix(!0,t.$i18n,zt),dsf.mix(!0,t.$platformStore,rt),Vue.use(Mt),Vue.use(qt)}(dsf.global||(dsf.global={}))},37:function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"$runUFUNC",(function(){return S})),n.d(i,"$updateUFUNC",(function(){return O})),n.d(i,"$registerUFUNC",(function(){return k})),n.d(i,"$unRegisteUFUNC",(function(){return C})),n.d(i,"$UFUNCWatch",(function(){return I}));var a=n(2),r=n.n(a),o=n(3),s=n.n(o),l=n(4),u=n.n(l),d=n(1),c=n.n(d);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){this.message=t,this.target=e,this.info=n?h({},n):{}}window&&(window.$$ValidateError=p);var v=p,m={data:function(){return this.$formValidated={},{_error:{},validateRules:{}}},computed:{$errors:function(){return this.$data._errors}},methods:{$getValidateFns:function(t,e,n){for(var i=this,a=this.__showLogicRecordCtrl__,o=void 0===a?{}:a,s=this.$viewData,l=this.$controlsMapping,u=[],d=function(){var a,d,f=t[c],h=e[f];if(null!==h&&void 0!==h&&null!==(a=h.refs)&&void 0!==a&&a.length||null!==h&&void 0!==h&&null!==(d=h.proxyRefs)&&void 0!==d&&d.length)if("subtable"==h.type){var p=i.$getValidateIsDisabledFn(f),v=dsf.isDef(s[f])?s[f]:null;if(!0!==p(v,s)){var m=f,g=i.$getValidateFunction(f,v,e,m,s,h),y=g||null;y&&u.push(y)}var $=s[f]||[],b=[];_.each(e,(function(t,e){t.inSubTable==f&&b.push(e)})),dsf.isDef(n)&&($=[$[n]]),_.each($,(function(t){var n,a=t.$ignoreValidate||!1,s=(null===t||void 0===t?void 0:t.$hash)||"";if(!a&&1==$.length&&null!==s&&void 0!==s&&null!==(n=s.startsWith)&&void 0!==n&&n.call(s,dsf.global.$const.subTableEmptyRowHash)){var d,c=null===i||void 0===i||null===(d=i.$postFieldMap)||void 0===d?void 0:d[f];if(c){var h=c.isEmptyData(t);a=h}}for(var p=0;p<b.length;p++){var v,m,g=b[p],y=l[g];if(t.$hash){var x=g+"-"+t.$hash,w=dsf.isDef(t[g])?t[g]:null,D=g,_=e[g],S="HTML"==(null===_||void 0===_||null===(v=_.valueAttributes)||void 0===v||null===(v=v[0])||void 0===v?void 0:v.textType);"string"==dsf.isString(w)&&S&&(w=i.$getEditorConent(w)),_.validateRule&&(D=_.validateRule);var O=!0===(null===(m=o[y])||void 0===m?void 0:m[t.$hash]);if(!a&&!O){var k=i.$getValidateIsDisabledFn(D);if(!0!==k(w,t)){var C=i.$getValidateFunction(D,w,e,x,t,_),T=C||null;T&&u.push(T)}}var I=[];dsf.isFunction(i.getFormulaVerifyFn)&&(I=i.getFormulaVerifyFn(D,w,e,x,t,_)),I.length&&u.push.apply(u,r()(I))}}}))}else{var x,w=l[f],D=f,S=!1,O=!0===o[w];if(h.inSubTable&&dsf.isDef(n)){var k,C,T=i.$viewData[h.inSubTable];if(s=T[n],D=D+"-"+s.$hash,S=s.$ignoreValidate||!1,!S&&1==T.length&&null!==(k=s)&&void 0!==k&&null!==(k=k.$hash)&&void 0!==k&&null!==(C=k.startsWith)&&void 0!==C&&C.call(k,dsf.global.$const.subTableEmptyRowHash)){var I,N=null===i||void 0===i||null===(I=i.$postFieldMap)||void 0===I||null===(I=I[D])||void 0===I?void 0:I.$list;if(N){var L=N.rowHasChange(N.emptyRowData,s);S=!L}}}var P=dsf.isDef(s[f])?s[f]:null,F="HTML"==(null===h||void 0===h||null===(x=h.valueAttributes)||void 0===x||null===(x=x[0])||void 0===x?void 0:x.textType);if("string"==dsf.type(P)&&F&&(P=i.$getEditorConent(P)),h.validateRule&&(f=h.validateRule),!S&&!O){var E=i.$getValidateIsDisabledFn(f);if(!0!==E(P,s)){var V=i.$getValidateFunction(f,P,e,D,s,h),j=V||null;j&&u.push(j)}}var M=[];dsf.isFunction(i.getFormulaVerifyFn)&&(M=i.getFormulaVerifyFn(f,P,e,D,s,h,n)),M.length&&u.push.apply(u,r()(M))}},c=0;c<t.length;c++)d();return u},$getValidateIsDisabledFn:function(t){if(this.validateRules[t]){var e=this.validateRules[t].disabled||dsf.noop;return e.bind(this)}return dsf.noop},createValidateError:function(t,e,n){return new v(t,e,n)},resetValidate:function(){var t=this.allComponents;this.clearErrors(),_.each(t,(function(t){t.errors=[]}))},pushError:function(t){var e=this,n="array"==dsf.type(t)?t:[t];n=_.filter(n,(function(t){return dsf.isDef(t)}));for(var i=_.map(n,"target"),a={},r=0;r<i.length;r++){var o=[];a[i[r]]=o}var s=function(t){var i=_.filter(n,(function(e){return e.target==t}));i.length>0&&e.$set(e.$data._errors,t,i)};for(var l in a)s(l)},clearErrors:function(){this.$data._errors={}},removeErrorsByTarget:function(t){this.$delete(this.$data._errors,t)},removeErrorsByRowHash:function(t){for(var e in this.$data._errors)e.endsWith(t)&&this.$delete(this.$data._errors,e)},$getValidateFunction:function(t,e,n,i,a,o){var s,l=null,u=n[t],d=this.validateRules[t],c=(null===this||void 0===this||null===(s=this.$postFieldMap)||void 0===s?void 0:s[i])||null;if(d&&(dsf.isFunction(d)||d.handler)){var f=g.call(this,d.handler||d,a,i,u);f?(l=function(){var t=[],n=null,r=[];return n=f&&f.call(this,e,a,i,o)||null,n&&t.push(n),r&&r.length>0&&t.push.apply(t,r),t}.bind(this),l.target=i,l.key=t):l=null}else{var h=null,p=null;if(u&&u.validate){var v=x.bind(this);h=b.call(this,v,a,i,u)}if(c&&c.$formItemInnerValidate){var m=c.$formItemInnerValidate.bind(c);p=y.call(this,m,a,i,u)}h||p?(l=function(){var t=[],n=null,s=[];return n=h&&h(e,a,i,o)||null,n||(s=p&&p(e,a,i,o)||[]),n&&t.push(n),s&&s.length>0&&t.push.apply(t,r()(s)),t}.bind(this),l.target=i,l.key=t):l=null}return l||dsf.noop},$execValidateFns:function(t){var e=this;return u()(c.a.mark((function n(){var i,a;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=[],e,a=[],n.abrupt("return",new Promise(function(){var n=u()(c.a.mark((function n(o,s){var l,u,d;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:l=0;case 1:if(!(l<t.length)){n.next=13;break}if(u=t[l],!dsf.isFunction(u)&&!dsf.isPromise(u)){n.next=8;break}return n.next=6,u.call(e);case 6:d=n.sent,d&&d.length&&a.push.apply(a,r()(d));case 8:dsf.isUnDef(e.$formValidated)&&(e.$formValidated={}),e.$formValidated[u.target]=!0;case 10:l++,n.next=1;break;case 13:Promise.all(a).then((function(t){_.each(t,(function(t){var e=dsf.isArray(t)?t:[t];_.each(e,(function(t){if(t&&t instanceof $$ValidateError){var e={target:t.target,info:t.info,message:t.message};i.push(e)}}))})),i.length?s(i):o()})).catch((function(t){dsf.error(t)}));case 14:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()));case 4:case"end":return n.stop()}}),n)})))()}}};function g(t,e,n,i){var a=t;return a?function(t,e,n,i){var r=a.call(this,t,e,n,i);if(!dsf.isUnDef(r)){if(r.then&&r.catch)return new Promise((function(t,e){r.then((function(e){if(e){var i="string"==dsf.type(e)?e:e.message;t(new v(i,n,e))}else t()}))}));if(r){var o="string"==dsf.type(r)?r:r.message;return new v(o,n,r)}}}:dsf.noop}function y(t,e,n,i){var a=t;if(a)return function(t,e,n,i){var r=a(t,e,n,i);if(r){var o=[];return r=dsf.isArray(r)?r:[r],_.each(r,(function(t){var e="",i="";dsf.isString(t)?(e=t.message,i=n):dsf.isObject(t)&&(e=t.message,i=t.target||n),o.push(new v(e,i,t))})),o}}}function b(t,e,n,i){var a=t;if(a)return function(t,e,n,i){var r=a(t,e,n,i);if(r){var o=[];return r=dsf.isArray(r)?r:[r],_.each(r,(function(t){var e="",i="";dsf.isString(t)?(e=t.message,i=n):dsf.isObject(t)&&(e=t.message,i=t.target||n),o.push(new v(e,i,t))})),o}}}function x(t,e,n,i){if(i&&i.validate){var a=i.validate._rules||i.validate.rules;if(!a)return;var o=[],s=_.findIndex(a,(function(t){return"required"==t.type}));if(s>=0){var l=a[s];a.splice(s,1),a.unshift(l),o=a}o=r()(a);for(var u=0;u<o.length;u++){var d=o[u],c=d.attr,f=d.errorMsg,h=i.valueAttributes||[],p=null;if(d.triggerExpress){var m=this.$expressParams(e),g=this.$eval(d.triggerExpress,m);if(!g)continue}if(1==h.length)p=t;else if(dsf.isArray(t)){var y=t;p=_.map(y,c).join("??")}else p=t?t[c]:"";if("required"==d.type){if(!0===dsf.validate("isNull",p))return new v(dsf.express.replace(f,d),n,{attributes:c})}else if("number"==d.type){if(dsf.isUnDef(p)||""===p||null===p)continue;if(!1===dsf.validate("isNumber",p))return new v(dsf.express.replace(f,d),n,{attributes:c});if(dsf.isNumber(d.numberMax)&&!0===dsf.validate("isNumberOver",p,parseFloat(d.numberMax)))return new v(dsf.express.replace(f,d),n,{attributes:c});if(dsf.isNumber(d.numberMin)&&!0===dsf.validate("isNumberUnder",p,parseFloat(d.numberMin)))return new v(dsf.express.replace(f,d),n,{attributes:c});if(d.precision&&!1===dsf.validate("precision",p,parseFloat(d.precision)))return new v(dsf.express.replace(d.errorMsg,d),n,{attributes:c})}else if("array"==d.type){if(dsf.isUnDef(t)||!t.length)continue;var $=t?dsf.isArray(t)?t:[t]:[],b=dsf.isNumber(d.arrayMin)?parseFloat(d.arrayMin):0,x=dsf.isNumber(d.arrayMax)?parseFloat(d.arrayMax):0;if(b>0&&$.length<b)return new v(dsf.express.replace(f,d),n,{attributes:c});if(x>0&&$.length>x)return new v(dsf.express.replace(f,d),n,{attributes:c})}else if("string"==d.type){if(dsf.isUnDef(p)||""===p)continue;if(dsf.isNumber(d.maxLength)&&!0===dsf.validate("maxLength",p,parseFloat(d.maxLength)))return new v(dsf.express.replace(f,d),n,{attributes:c});if(dsf.isNumber(d.minLength)&&!0===dsf.validate("minLength",p,parseFloat(d.minLength)))return new v(dsf.express.replace(f,d),n,{attributes:c})}else if("express"==d.type){if(dsf.isUnDef(p)||""===p)continue;if(0==dsf.validate(d.express,p))return new v(dsf.express.replace(f,d),n,{attributes:c})}}}}var w=n(10),D={};function S(){for(var t in this.$computeds)this.$updateUFUNC(t,this.$computeds[t])}function O(t,e){this.$ufuncWatchs||(this.$ufuncWatchs={});var n=this.$ufuncWatchs[t];n&&(n(),delete this.$ufuncWatchs[t]);var i=I.call(this,e,t);this.$ufuncWatchs[t]=i}function k(t,e){if(t&&e){var n=!0;if(this.$computeds[t]){var i=this.$computeds[t];n=T(i,e)}n&&(e=Vue.reactive(e),this.$computeds[t]=e,this.$isDataLoaded&&this.$updateUFUNC(t,e))}}function C(t,e){var n,i=null===(n=this.$ufuncWatchs)||void 0===n?void 0:n[t];i&&dsf.isFunction(i)&&(i(),delete this.$ufuncWatchs[t],delete this.$computeds[t],delete D[t])}function T(t,e){return!t||!e||(t.expression!==e.expression||t.immediate!==e.immediate)}function I(t,e){var n=this;dsf.isUnDef(n.depCalls)&&(n.depCalls={}),dsf.isUnDef(D[e])&&(D[e]=!0);var i=function(){var i=null;if(this.$isDataLoaded){var a=dsf.isFunction(t)?t():t,r=a.computed,o=a.local;i=r.call(this,n,o);var s=i+"",l=s.match(/NaN|Infinity|undefined|null/);l&&(i=null)}return!t.immediate&&D[e]&&(i="__depCall__"),D[e]&&(D[e]=!1),i},a=function(e){"__depCall__"!==e&&t.model.callback.call(this,e)},r=this.$watch(i,a,{immediate:t.immediate});return r}function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P=function(t,e,n,i){var a=function(){try{return dsf.express.eval("{{"+e+"}}",t.$viewData)}catch(n){return}};return t.$watch(a,n,i)},F=function(t){var e=t.$options.formWatch||{};for(var n in e){var i=e[n],a=void 0,r={};if(dsf.isFunction(i))a=i.bind(t);else{if(!dsf.isObject(i))break;if(!i.handler||!dsf.isFunction(i.handler))break;a=i.handler.bind(t),i.deep&&(r.deep=!0),i.immediate&&(r.immediate=!0)}var o=P(t,n,a,r);t.$formWatchs||(t.$formWatchs=[]),t.$formWatchs.push(o)}},E=function(t){t=dsf.isArray(t)?t:[t];for(var e=0;e<t.length;e++){var n=t[e];if(this.$options[n]){var i=this.$options[n];i=dsf.isArray(i)?i:[i];for(var a=0;a<i.length;a++)try{i[a]&&i[a].call(this)}catch(r){throw r}}}};function V(t,e){if(e){var n={};try{n=JSON.parse(e._custom||"{}")}catch(i){dsf.error("custom信息转换错误")}n=dsf.isObject(n)?n:{},e._custom=n,t.context.$$viewInitData=e}j.call(t),M.call(t),A.call(t)}function j(){for(var t in this.context.$$viewInitData){var e=this.context.$$viewInitData[t];e&&e.dataSource&&this.$set(this.context.$$enum,t,e.dataSource)}}function M(){var t;null!==(t=this.$viewInitData)&&void 0!==t&&t.workflow&&(this.$viewInitData.workflow.ctrls&&(this.workFlow.ctrls=_.keyBy(this.$viewInitData.workflow.ctrls,(function(t){return dsf.isDef(t.metadataCode)?t.metadataCode:t.caption}))),this.$viewInitData.workflow.btns&&(this.workFlow.btns=_.keyBy(this.$viewInitData.workflow.btns,(function(t){return t.id}))))}function A(){var t;if(null!==(t=this.$viewInitData)&&void 0!==t&&t.state){var e,n=null===(e=this.$viewInitData)||void 0===e||null===(e=e.state)||void 0===e?void 0:e.data;n.ctrls&&(this.stateManage.ctrls=_.keyBy(n.ctrls,(function(t){return t.designId}))),n.buttons&&(this.stateManage.buttons=_.keyBy(n.buttons,(function(t){return t.id})))}}function B(){var t=this;Object.defineProperty(this,"$page",{get:function(){return this.$refs.page},enumerable:!1,configurable:!0}),Object.defineProperty(this,"$topView",{get:function(){var e=$(t.$el),n=e.parents(".ds-control.ds-page"),i=n.get(n.length-1);if(i){var a=i.__vue__;return a.$data._isLayoutView?a:(null===a||void 0===a?void 0:a.$vm)||{}}return this},enumerable:!1,configurable:!0})}var R=null;e["default"]={inheritAttrs:!1,inject:{$app:{default:null},$parentView:{default:null},$frame:{default:null},$dialog:{default:null},$isMobile:{default:!1}},provide:function(){return{$vm:this,$parentView:this,$choiceParams:this.choiceParams,$serviceInfo:(null===this||void 0===this?void 0:this.$service)||{}}},mixins:[m],props:{nameSpace:{type:String,default:""},pageName:{type:String,default:""},queryString:{type:Object,default:function(){return{}}},choiceParams:{type:Object,default:function(){return null}},pageProps:{type:Object,default:function(){return{}}}},data:function(){return this._viewDataBak=null,this.$formValidateWatchs={},this.hookMap={initBefore:0,inited:1,dataLoadBefore:3,dataLoaded:4,ready:5},{context:{$$viewInitData:{},$$viewRequestsData:{},$$viewData:{},$$dataview:{},$$enum:{},$$notAllowPostKey:[],$$postNullKeys:[],$$saved:!1},staticData:{},frames:{},metadataDict:{},loading:!1,flows:{},workFlow:{ctrls:{},btns:{}},stateManage:{ctrls:{},buttons:{}},allComponents:[],firstLoaded:!0,currentHook:this.hookMap.initBefore,_isLoaded:!1,_isForm:!1,_postState:"",_isReady:!1,_dataKey:this.queryString.id,_isLayoutView:!0,_fromDesigner:!0,_pageContentHeight:"auto",_viewRequests:{inited:[],dataLoaded:[],ready:[]},_isDataLoaded:!1,$pureness:!1,$forceReadOnly:!1,$choice:null,$isDestroyed:!1,_errors:{},_noAccess:!1}},computed:{$noAccess:function(){var t;return null===(t=this.$data)||void 0===t?void 0:t._noAccess},$dataKey:{get:function(){return this.$data._dataKey},set:function(t){this.$data._dataKey=t}},$isLayoutView:function(){var t;return null===(t=this.$data)||void 0===t?void 0:t._isLayoutView},$isPrototype:function(){return this.$data.$$mode==dsf.enums.viewMode.PROTOTYPE},$staticValue:function(){return this.$data.$$staticValue},$localParams:function(){return this.$frame.localParams},$viewData:function(){return this.context.$$viewData},$dataview:function(){return this.context.$$dataview},$viewInitData:function(){return this.context.$$viewInitData},$viewRequestsData:function(){return this.context.$$viewRequestsData},$enum:function(){return this.context.$$enum},$isLoaded:function(){return this.$data._isLoaded},$isReady:function(){return this.$data._isReady},$isDataLoaded:function(){return this.$data._isDataLoaded},$keepAlive:function(){return this.$data.$$keepAlive||!1},$pageType:function(){return this.$data.$$pageType||""},$isForm:function(){return this.$data._isForm},$errors:function(){return this.$data._errors},$metadataKeyList:function(){var t=this.metadataDict,e=Object.keys(t);return e=e.sort((function(e,n){var i=t[e].order,a=t[n].order;return i<a?-1:1})),e},$pageContentHeight:{get:function(){return this.$data._pageContentHeight},set:function(t){this.$data._pageContentHeight=t}},$subTables:function(){return _.filter(this.allComponents,(function(t){return t.isFormControl&&t.isOneToMany}))},$postFields:function(){return _.filter(this.allComponents,(function(t){return t.isFormControl}))},$postFieldMap:function(){return _.keyBy(this.$postFields,"$formName")}},beforeCreate:function(){this.reloadList=[],this.$dialogArgs=null,this.$openerVm=null,B.call(this)},created:function(){var t=this,e=dsf,n=e.performance;if(n.start("创建"+this.nameSpace+"."+this.pageName+"对象"),this.i18nMessage){var i=Object.keys(this.i18nMessage);i.forEach((function(e){var n=t.i18nMessage[e];t.$i18n.mergeLocaleMessage(e,s()({},"$".concat(t.$options.name),n))}))}this.$frame&&(this.$frame.content=this),this.$on("page-resize",this.$pageSizeChange),this.$computeds={},n.end("创建"+this.nameSpace+"."+this.pageName+"对象"),this.$emit("created",this)},activated:function(){},deactivated:function(){},mounted:function(){this.$init()},beforeDestroy:function(){for(var t in this.$data.$isDestroyed=!0,this.$data.$choice=null,this.context.$$viewData=null,this.context.$$viewInitData=null,this.context.$$notAllowPostKey=null,this.context.$$enum=null,this.$off("page-resize",this.$pageSizeChange),this.frames)this.frames[t]=null,this.$delete(this.frames,t);if(this.$frame&&(this.$frame.content=null,delete this.$frame.content),null!==this&&void 0!==this&&this.$formWatchs&&(_.each(this.$formWatchs||[],(function(t,e){t&&t()})),this.$formWatchs=null),null!==this&&void 0!==this&&this.$ufuncWatchs&&(_.each(this.$ufuncWatchs,(function(t){t&&t()})),this.$ufuncWatchs=null),this.$formValidateWatchs){for(var e in this.$formValidateWatchs){var n=this.$formValidateWatchs[e];dsf.isFunction(n)&&n()}this.$formValidateWatchs=null}this.allComponents=null},destroyed:function(){this.$computeds=null,this.$dialogArgs=null,this.$openerVm=null,this._viewDataBak=null},methods:L(L({},i),{},{getControl:function(t,e){return this.$refs[t]},$defer:function(t){var e=0;return dsf.isString(t)?e="null"===t?999999:this.hookMap[t]:dsf.isNumber(t)&&(e=t),e<=this.currentHook},$init:function(t){var e=this,n=null,i=null,a=null,r=this,o=(this.$data.$pureness,dsf),s=o.performance;return Promise.resolve().then((function(){if(!e.$data.$isDestroyed)return e.currentHook=e.hookMap.initBefore,e.$initData()})).then((function(t){if(!e.$data.$isDestroyed){i=t?t.data:{};var n=null;return s.start(e.nameSpace+"."+e.pageName+" init回调"),n=w["b"](e,"inited",[i],w["a"]),s.end(e.nameSpace+"."+e.pageName+" init回调"),n}})).then((function(){if(!e.$data.$isDestroyed)return s.start(e.nameSpace+"."+e.pageName+"页面数据初始化"),i&&V(e,i),n=e.$initControls(),s.end(e.nameSpace+"."+e.pageName+"页面数据初始化"),e.$data._isLoaded=!0,s.start(e.nameSpace+"."+e.pageName+"获取表单数据"),e.firstLoaded&&(e.firstLoaded=!1),e.currentHook=e.hookMap.inited,e.$nextTick()})).then((function(){if(e.currentHook=e.hookMap.dataLoadBefore,!e.$data.$isDestroyed){if(e.$isPrototype)return e.$loadFormStaticData();if(e.$loadData)return e.loading=!0,e.$loadData(e.nameSpace)}})).then((function(t){if(!e.$data.$isDestroyed)return a=t?t.data:{},s.end(e.nameSpace+"."+e.pageName+"获取表单数据"),s.start(e.nameSpace+"."+e.pageName+"获取表单数据回调"),e.$nextTick()})).then((function(){if(!e.$data.$isDestroyed)return w["b"](e,"dataLoaded",[a],w["a"])})).then((function(){if(!e.$data.$isDestroyed){for(var t in a&&dsf.mix(n,a),n){var i=e.metadataDict[t];i&&"subtable"==i.type&&_.each(n[t]||[],(function(t){dsf.isUnDef(t.$hash)&&(t.$hash=dsf.uuid())}))}e.context.$$viewData=n,e.$data._isDataLoaded=!0,e.loading=!1,s.end(e.nameSpace+"."+e.pageName+"获取表单数据回调")}})).catch((function(t){if(t.noAccess)r.$data._noAccess=!0;else{if(dsf.isObject(t)&&"nextFalse"==t.type)dsf.error(t);else{var n=dsf.isString(t)?t:null===t||void 0===t?void 0:t.message;dsf.layer.message(n||"请求异常",!1),dsf.error(t)}dsf.config.setting_public_layoutview_fail_display&&(e.$data._isLoaded=!0)}e.loading=!1})).finally((function(){e.loading=!1,e.$noAccess||(s.start(e.nameSpace+"."+e.pageName+"加载完毕调用ready函数"),e.$nextTick((function(){try{e.$runUFUNC();var r=e.$options.ready;r&&r.call(e);var o=!1;e.$data._isReady||(o=!0),e.$data._isReady=!0,e.currentHook=e.hookMap.ready,F(e),o&&(e._viewDataBak=dsf.mix(!0,{},e.context.$$viewData)),e.$attachEnterKeyEvent(),t&&t(),a=null,i=null,n=null,s.end(e.nameSpace+"."+e.pageName+"加载完毕调用ready函数")}catch(l){dsf.error(l)}})))}))},$initData:function(){var t=this;return new Promise((function(e,n){var i=L({pageName:t.pageName,namespace:t.nameSpace},t.queryString);if(t.nameSpace&&t.pageName)return t.$dataKey&&(i.id=t.$dataKey),t.$getInitDataAPI(i).then((function(t){e(t.data)})).catch((function(t){n(t)}));e({})}))},$getInitDataAPI:function(t){return this.$webAPI.getInitData(t,!0).then((function(t){var e=t.data,n=1==e.success&&2e4==e.state,i=0==e.success&&20107==e.state;if(n)return t;if(i)return Promise.reject({message:e.message,noAccess:!0});throw e.message}))},$getDefaultValue:function(t){if(dsf.isDef(this.$viewInitData[t])&&dsf.isDef(this.$viewInitData[t].defaultValue)){var e=this.$viewInitData[t].defaultValue,n=dsf.type(e);return"object"!=n&&"array"!=n||(e=dsf.mix(!0,"object"==n?{}:[],e)),e}},$dataFormat:function(t,e,n){if(e){var i=Vue.filter(t);if(i)return i(n,e)}return n},$setControlInitProps:function(t,e){var n=this,i=1==this.queryString._wfdebug,a=this.$viewInitData;if(dsf.isEmptyObject(a.workflow)){if(!dsf.isEmptyObject(a.state)){var r=this.stateManage;if(!dsf.isEmptyObject(r)){var o="formControl"==e||"block"==e,s="buttons"==e;if(o){var l=["readOnly","visible","required"],u=r.ctrls||{},d=t.designId,c=u[d]||{};l.forEach((function(e){var i=dsf.isDef(c[e])&&dsf.isDef(t[e]);i&&(t[e]=c[e]);var a=t.isFormControl&&"required"==e;a&&(c[e]?n.$setRequired(t):n.$setNotRequired(t))}))}else if(s){var f=r.buttons?r.buttons:[],h=t.designId,p=_.filter(f,(function(t){return t.ownerId==h}));p.forEach((function(e){var i=_.find(t.buttons,(function(t){return e.id==t.actionName+(t.alias?"."+t.alias:"")}));i&&n.$set(i,"visible",e.visible)}))}}}}else if("formControl"==e){var v=["readOnly","visible","required"],m=this.workFlow.ctrls||{},g=t.isFormControl?t.metadata_fullcode:"",y=m[g]||{};v.forEach((function(e){dsf.isDef(y[e])&&(i&&dsf.log('"组件：'.concat(t.caption+(t.label?"("+t.label+")":""),"的").concat(e,"属性被流程设置为").concat(y[e])),t[e]=y[e],t.isFormControl&&"required"==e&&(y[e]?n.$setRequired(t):n.$setNotRequired(t)))}))}else if("buttons"==e){var $=a.workflow&&a.workflow.btns;$&&_.each(t.buttons,(function(t){var e,a=n.workFlow.btns[t.id];null===t||void 0===t||null===(e=t.children)||void 0===e||e.forEach((function(t){a.children.forEach((function(e){e.id==t.id&&(t.visible=e.visible)}))})),a&&dsf.isDef(a.visible)&&(i&&dsf.log("按钮：".concat(t.caption,"的visible属性被流程设置为").concat(a.visible)),t.visible=a.visible)}))}else if("block"==e){var b=["readOnly","visible"],x=t.caption||"",w=this.workFlow.ctrls[x]||{};b.forEach((function(e){dsf.isDef(w[e])&&(i&&dsf.log('"组件：'.concat(t.caption,"的").concat(e,"属性被流程设置为").concat(w[e])),t[e]=w[e])}))}},$initControls:function(){var t={},e=this.$controls,n=this.$viewInitData;for(var i in e){var a,r=e[i];if(r.metadata){var o=r.metadata_fullcode;0==r.metadata.level?n&&n[o]&&dsf.isDef(this.$getDefaultValue(o))&&(t[r.metadata_fullcode]=this.$getDefaultValue(o)):1==r.metadata.level&&r.isOneToMany&&dsf.isDef(this.$getDefaultValue(o))&&(t[r.metadata_fullcode]=this.$getDefaultValue(o)),this.$setControlInitProps(r,"formControl")}else r.isButtonBar?this.$setControlInitProps(r,"buttons"):r.isBlockControl&&this.$setControlInitProps(r,"block");if(null!==(a=this.$staticValue)&&void 0!==a&&a[r.caption]&&(r.staticValue=this.$staticValue[r.caption]),r.isAcceptIsView&&this.$data.$forceReadOnly)r.readOnly=!0;else{var s=this.$viewInitData._custom||{};dsf.mix(r,s[r.caption]||{})}}return t},$reset:function(){for(var t in this.$refs){var e=this.$refs[t],n=e&&dsf.isFunction(e.reset);n&&this.$refs[t].reset()}},reloadData:function(){var t=this;for(var e in this.reloadList=[],this.$refs){var n,i=this.$refs[e];dsf.isArray(i)?(n=this.reloadList).push.apply(n,r()(i)):this.reloadList.push(i)}this.reloadList=this.reloadList.filter((function(t){return(null===t||void 0===t?void 0:t._isVue)&&dsf.isFunction(null===t||void 0===t?void 0:t.reloadData)})),_.each(this.reloadList,(function(t){return t.reloadData()})),this.$nextTick((function(){t.reloadList=[]}))},$loadFormStaticData:function(){var t=this;return new Promise((function(e,n){t.$nextTick((function(){var n={};for(var i in t.$refs){var a=t.$refs[i];if(a.designId&&(t.$staticValue&&a.isFormControl&&!a.$dataHash)){var r=t.$staticValue[a.caption],o=t.$getRealStaticValue(r);n[a.metadata_fullcode]=o}}e({data:n})}))}))},reloadParentViewData:function(){},$setRequired:function(t){var e;if(t.isFormControl){var n=null===t||void 0===t||null===(e=t.metadata)||void 0===e?void 0:e.validate,i=[];if(n?(n._rules||(n._rules=dsf.mix(!0,[],n.rules)),i=_.filter(n._rules,(function(t){return"required"==t.type}))):(t.metadata.validate={_rules:[]},n=t.metadata.validate),i.length<=0){var a=t.metadata.validate._rules;_.each(t.metadata.valueAttributes,(function(t){var e=dsf.validate.fn.getMetaDataValidateObject();e.type="required",e.errorMsg="该项必须填写",a.push(e)}))}else t.metadata.validate._rules=dsf.mix(!0,[],t.metadata.validate.rules||[])}},$setNotRequired:function(t){var e;if(t.isFormControl){var n=null===t||void 0===t||null===(e=t.metadata)||void 0===e?void 0:e.validate,i=[];n?(n._rules||(n._rules=dsf.mix(!0,[],n.rules)),i=_.filter(n._rules,(function(t){return"required"==t.type}))):(t.metadata.validate={_rules:[]},n=t.metadata.validate),i.length>0&&_.eachRight(n._rules,(function(t){"required"==t.type&&dsf.array.remove(n._rules,t)}))}},yes:function(){var t;return(null===(t=this.$data.$choice)||void 0===t?void 0:t.getReturnValue())||null},$addFiled:function(t){var e=this,n=t._isVue;n&&this.allComponents.push(t),this.$nextTick((function(){e.updateMetaDataDict(t)}))},$removeFiled:function(t){var e=t._isVue;this.metadataDict[t.formName]&&(e?dsf.array.remove(this.metadataDict[t.formName].refs||[],t):dsf.array.remove(this.metadataDict[t.formName].proxyRefs||[],t)),dsf.array.removeWith(this.allComponents,(function(e){return e==t}))},updateMetaDataDict:function(t){var e=t._isVue;if(this.metadataDict){var n=t.formName,i=(t.metadata_fullcode,t.metadata);if(!i||!n)return;var a=n.split("."),r=(a[0],a[1]&&a[1],!1);this.metadataDict[n]||(this.metadataDict[n]={type:"field",fieldsLength:i.valueAttributes&&i.valueAttributes.length,level:0,valueAttributes:_.map(i.valueAttributes,"code"),refs:[],proxyRefs:[]},r=!0),this.metadataDict[n].refs=this.metadataDict[n].refs||[],this.metadataDict[n].proxyRefs=this.metadataDict[n].proxyRefs||[],this.metadataDict[n].validate=i.validate,e?this.metadataDict[n].refs.push(t):this.metadataDict[n].proxyRefs.push(t),this.metadataDict[n]&&(this.metadataDict[n].isUser=r,t.validateRule&&(this.metadataDict[n].validateRule=t.validateRule))}},getScopeMetaDataDict:function(t){var e=this;if(dsf.isEmptyObject(this.metadataDict))return{};var n=t.metadata;if(!n||!t.metadata_fullcode)return{};var i=t.metadata_fullcode;if(this.metadataDict[i]){if(this.metadataDict[i].inSubTable){var a={};return _.each(this.metadataDict,(function(t,n){t.inSubTable===e.metadataDict[i].inSubTable&&(a[n]=t)})),a}var r={};return _.each(this.metadataDict,(function(t,e){dsf.isUnDef(t.inSubTable)&&(r[e]=t)})),r}},resize:function(){var t=this;return new Promise((function(e){t.$page?dsf.resizeComponent(t.$page).then((function(){e()})):e()}))},$getEditorConent:function(t){R=R||document.createElement("DIV"),R.innerHTML=t;var e=R.querySelector("img");return e?R.innerHTML:R.innerText.trim()},$updateForceReadOnly:function(){},$viewDataReset:function(t){this.$updateForceReadOnly(),this.context.$$viewData={},this.context.$$viewInitData={},this.$init()},$attachEnterKeyEvent:function(){var t,e=this;if(this.$isForm&&null!==this&&void 0!==this&&null!==(t=this.$page)&&void 0!==t&&t.enterFocusNext){var n=$(this.$el);n.on("keypress","input",(function(t){if("13"==t.keyCode){var n=$(e.$el),a="input[type=text]:visible,input[type='password']:enabled:visible,textarea:enabled:visible",r=t.currentTarget.closest(".ds-form-item"),o=n.find(".ds-form-item[allow-enter-focus]:visible"),s=[];o.each((function(t,n){var i=n.__vue__,a=n.getAttribute("allow-enter-focus");if(dsf.isDef(a)&&(a=!0),!i){var r=n.getAttribute("proxy-id");r&&(i=e.$controls[r],i=L(L({},i||{}),{},{$el:n}))}i&&i.isFormControl&&a&&(i.readOnly||!i.visible||i.disabled||(i.metadata.inSubTable?dsf.array.ensure(s,i.$list):dsf.array.ensure(s,i)))}));var l=[];s.forEach((function(t,e){if(t.isOneToMany){var n=t;(n.value||[]).forEach(n.value,(function(t){var e=t.$hash,a=$(n.$el);(n.childMetaDataCodes||[]).forEach((function(t){var n=a.find(".ds-form-item[form-name='"+t+"-"+e+"']:visible");n&&n.length>0&&n.each((function(t,e){var n=e.__vue__;n&&i(n)&&l.push(n)}))}))}))}else i(t)&&l.push(t)}));var u=r.__vue__;if(u&&u.isFormControl){var d=$(u.$el).find(a),c=[];if(_.each(d,(function(t,e){c.push(t)})),c[c.length-1]==document.activeElement){var f=_.findIndex(l,(function(t){return t==u}));if(f>=0){var h=l[f+1];h=h||l[0],h.inClient=!0,e.$nextTick((function(){var t,e;null===(t=document.activeElement)||void 0===t||null===(e=t.blur)||void 0===e||e.call(t);var n=$(h.$el).find(a);n.length>0?n.eq(0).focus():n.focus()}))}}else{var p,v,m=_.findIndex(c,(function(t){return t==document.activeElement})),g=c[m+1];null===(p=document.activeElement)||void 0===p||null===(v=p.blur)||void 0===v||v.call(p),$(g).focus()}}t.preventDefault(),t.stopPropagation()}}))}function i(t){var e=!1;if(t.isFormControl&&!t.readOnly&&t.visible&&!t.disabled){(null===t||void 0===t||null===(n=t.$options)||void 0===n?void 0:n.name)||(null===t||void 0===t||t.ctrlName);var n,i=$(t.$el);e=!(!dsf.isDef(i.attr("allow-enter-focus"))||!i.is(":visible"))}return e}},$getSubTableRowDefault:function(t){var e=this,n={};return _.each(t.metadataDict||[],(function(t,i){if(dsf.isUnDef(n[i])){var a,r=null===e||void 0===e||null===(a=e.$getDefaultValue)||void 0===a?void 0:a.call(e,i);dsf.isDef(r)&&e.$set(n,i,r)}})),n},$setComponentProp:function(t,e,n,i){var a=t+(i?"-"+i:"");a=this.$controlsMapping[a];var r=this.$controls[a];r&&(r[e]=n)},$getComponentProp:function(t,e){var n=t+(e?"-"+e:"");n=this.$controlsMapping[n];var i=this.$controls[n];return i},$loopSubTable:function(t,e){var n=[];return _.each(this.$viewData[t]||[],(function(t){var i=e&&e(t);n.push(i)})),n},$pageSizeChange:function(){var t=this.$el;if(t&&1==t.nodeType&&this.$page){var e=this.$page.getContentHeight();this.$pageContentHeight=e}},$addCustom:function(t,e){dsf.custom.add(this,t,e)},$removeCustom:function(t){dsf.custom.remove(this,t)},$clearCustom:function(t){dsf.custom.clear(this,t)},$addFormValidateUpdateWatch:function(t,e,n){if(t||e){dsf.isUnDef(this.$formValidateWatchs)&&(this.$formValidateWatchs={});var i="".concat(t,"^^").concat(e);if(!this.$formValidateWatchs[i]){var a=this.$watch((function(){var t=n.self.local,i=this.$expressParams(t);return this.$eval(e,i)}),(function(t,e){var i,a=null===n||void 0===n?void 0:n.self;a&&this.$formValidated[a.$formName]&&(null===a||void 0===a||null===(i=a.emitFormValidate)||void 0===i||i.call(a,a.value))}));this.$formValidateWatchs[i]=a}}},$removeFormValidateUpdateWatch:function(t,e){var n;if(t||e){var i="".concat(t,"^^").concat(e);if(null!==this&&void 0!==this&&null!==(n=this.$formValidateWatchs)&&void 0!==n&&n[i]){var a=this.$formValidateWatchs[i];dsf.isFunction(a)&&a(),delete this.$formValidateWatchs[i]}}},$showLogic:function(t,e){var n=this,i=this.showLogicCompile[t];if(!i)return!0;var a=this.$controls[t];return dsf.isArray(i)?_.every(i,(function(t){return t.call(n,n.$viewData,null===e||void 0===e?void 0:e.row,a)})):i.call(this,this.$viewData,null===e||void 0===e?void 0:e.row,a)},$refreshView:function(){var t=this;try{var e;null===this||void 0===this||null===(e=this.$refreshViewCallback)||void 0===e||e.call(this),this.$nextTick().then((function(){var e=["beforeDestroy","destroyed"];return E.call(t,e),t.$data._isLoaded=!1,t.$nextTick()})).then((function(){var e=t.$options.data,n=e.call(t);for(var i in t.$data)t.$data[i]=n[i];return t.$nextTick()})).then((function(){var e=["beforeCreate","created","beforeMount"];E.call(t,e),t.$nextTick((function(){E.call(t,"mounted")}))}))}catch(n){dsf.warn(n)}}}),watch:{$isLoaded:{handler:function(t,e){var n=this;t!=e&&!0===t&&this.$nextTick().then((function(){return n.resize(),n.$nextTick()})).then((function(){n.$emit("loaded",n)}))}},$isReady:{handler:function(t,e){var n=this;this.$nextTick((function(){n.$emit("ready",n)}))}}}}},387:function(t,e,n){"use strict";n.r(e);var i=n(37),a=n(3),r=n.n(a);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l={computed:s({},u()),methods:s(s({},d()),{},{$popRefresh:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.$refreshQueue&&this.$refreshQueue[this.$route.path])try{var e,n;null===this||void 0===this||null===(e=this.$removeRefresh)||void 0===e||e.call(this,this.$route.path),t&&(null===this||void 0===this||null===(n=this.reloadData)||void 0===n||n.call(this))}catch(i){dsf.isError(i)&&dsf.error("刷新"+this.$route.path+"失败")}}})};function u(){try{var t=Vuex.mapState("refreshQueue",{$refreshQueue:"queue"});return t}catch(e){return{}}}function d(){try{var t=Vuex.mapMutations("refreshQueue",{$pushRefresh:"add",$removeRefresh:"remove"});return t}catch(e){return{}}}e["default"]={mixins:[i["default"],l],data:function(){return{fromPath:"",_pagings:[],_pagingIndex:0}},computed:{$pagings:function(){return this._data._pagings},$pagingIndex:{get:function(){return this._data._pagingIndex},set:function(t){this._data._pagingIndex=t}},isShowNavsBar:function(){return this.$attrs["is-show-nav-bar"]}},created:function(){var t=this;try{if(this.$dialog)this.$dialogArgs=this.$dialog.dialogArgs||null,this.$openerVm=this.$dialog.openerVm;else{var e=_.findIndex(dsf.global.$$state.routeChain,(function(e){return e.path==t.$route.path})),n=window.$$state.routeChain[e-1];if(n){var i,a=this.$store.getters["keepAlive/instances"][n.path];if(a)if(this.$openerVm=a.vm,dsf.global.$windowArgs&&dsf.global.$windowArgs[this.$route.path])this.$dialogArgs=null===(i=dsf)||void 0===i||null===(i=i.global)||void 0===i?void 0:i.$windowArgs[this.$route.path];else this.$dialogArgs=null}}}catch(r){dsf.error(r)}},activated:function(){if(this.$isLoaded&&(this.$popRefresh(),this.$el&&1==this.$el.nodeType)){var t=this.$el.querySelectorAll("[scroll-id]"),e=this.$route.meta.scrolls;_.each(t,(function(t){var n=t.getAttribute("scroll-id"),i=e[n];i&&(t.scroll(i.x,i.y),delete e[n])}))}},mounted:function(){var t=this;this.$popRefresh(!1);var e=_.findLastIndex(window.$$state.routeChain,(function(e,n){return e.path==t.$route.path})),n=null;e>=0&&(n=window.$$state.routeChain[e-1]),this.fromPath=n||null},methods:{$closeWindow:function(){var t=this.$dialog;t?t.close():this.$openerVm?this.$router.back():window.uni&&"back"==this.$route.query.mpaction?uni.navigateBack():window.history.go(-1)},reloadParentViewData:function(){if(dsf.global.$isMobile&&dsf.global.$$state){var t=null;t=this.fromPath?this.fromPath:window.$$state.routeChain[window.$$state.routeChain.length-2],t&&t.path&&"/"!=t.path&&this.$store&&this.$pushRefresh(t.path)}}},beforeRouteLeave:function(t,e,n){if(this.$el&&1==this.$el.nodeType){var i=this.$el.querySelectorAll("[scroll-id]"),a={};_.each(i,(function(t){var e=t.getAttribute("scroll-id");a[e]={y:t.scrollTop,x:t.scrollLeft}})),e&&e.meta&&(e.meta.scrolls=a)}n()},beforeDestroy:function(){dsf.global.$windowArgs&&delete dsf.global.$windowArgs[this.$route.path]}}},4:function(t,e){function n(t,e,n,i,a,r,o){try{var s=t[r](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,a)}function i(t){return function(){var e=this,i=arguments;return new Promise((function(a,r){var o=t.apply(e,i);function s(t){n(o,a,r,s,l,"next",t)}function l(t){n(o,a,r,s,l,"throw",t)}s(void 0)}))}}t.exports=i,t.exports.__esModule=!0,t.exports["default"]=t.exports},45:function(t,e,n){"use strict";var i=n(2),a=n.n(i),r=n(3),o=n.n(r);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e["a"]=function(t){var e=t.api.addAPI;e("dbSourceInterface",(function(t,e,n,i){var a=e;a.startsWith("/")&&(a=a.substr(1));var r="/dbsource/interface/"+a;return this.$http.get(r,t,n,i)})),e("getInitData",(function(t,e,n){var i="/meta/init";return this.$http.get(i,t,e,n)})),e("getFormData",(function(t,e,n){var i="/meta/data";return this.$http.get(i,t,e,n)})),e("getBatchDict",(function(t,e,n){return t.dicts=JSON.stringify(t.dicts),this.$http.get("/dict/data",t,e,n)})),e("pageBuild",(function(t,e,n){var i=l(l({},e||{}),{},{timeout:6e4});return this.$http.post("/meta/build",t,i,n)})),e("pageSaveTemplate",(function(t,e,n){var i=l(l({},e||{}),{},{timeout:6e4});return this.$http.post("/template/saveTemp",t,i,n)})),e("formSave",(function(e,n,i){var a=t.url.queryStringStringify(this.queryString),r="/meta/persistData".concat(a?"?"+a:"");return this.$http.post(r,e,n,i)})),e("getDesignerButtons",(function(t,e,n){return this.$http.get("/meta/temp/button",t,e,n).done((function(t){return t}))})),e("selectButtonsAndBusiness",(function(t,e,n){return this.$http.get("/template/initPageTemplatePermission",t,e,n).done((function(t){return t}))})),e("getComponents",(function(t,e,n){var i=t.strIds.join(","),a=t.terminal;return i.length>0?this.$http.get("component/findComponents",{strIds:i,terminal:a,type:0},e,n).then((function(t){var e=t.data;return e})):new Promise((function(t,e){t({data:[]})}))})),e("getBusinessComponets",(function(t,e,n){var i=t.strIds.join(","),a=t.terminal;return i.length>0?this.$http.get("component/findComponents",{strIds:i,terminal:a,type:1},e,n).then((function(t){var e=t.data;return e})):new Promise((function(t,e){t({data:[]})}))})),e("getMetaListData",(function(t,e,n){var i={pageNum:1,pageSize:10,query:JSON.stringify({searchValue:""}),order:JSON.stringify([{code:"",sort:""}]),namespace:"",pageName:""};return Object.assign(i,t),this.$http.get("/meta/list/data",i,e,n).then((function(t){var e=t.data;return e}))})),e("getMetaDataFieldsTree",(function(e,n,i,a){var r=[];function o(e){if(e.metadata){var i=_.map(e.metadata,(function(e,i){var a=t.mix(!0,{},e),r=a.valueAttributes;return!1!==n?r.length>1?(a.children=r,_.each(r,(function(t){t.fieldCaption=a.name+"("+t.name+")",t.field=a.code+"_"+t.code,t.id=a.at.replace(/\./g,"_")+"."+a.code+"_"+t.code,t.metadata=a}))):(a.id=a.at.replace(/\./g,"_")+"."+a.code,a.fieldCaption=a.name,a.field=a.code,a.metadata=a):(a.id=a.id.replace(/\./g,"_"),a.fieldCaption=a.name,a.field=a.code,a.metadata=a),a}));i=i.sort((function(t,e){return t.order<e.order?-1:1})),e.children=i,delete e.metadata}}return this.$http.get("/rm/list/meta",e,i,a).then((function(n){for(var i=n.data,a=i.data,s=0;s<a.length;s++){var l=t.mix({},a[s]);o(l),r.push(l)}return e.namespace&&(r=_.filter(r,(function(t){return t.ID==e.namespace}))),r}))})),e("getMetaDataFieldsSelect",(function(e,n,i,r){var o=[];function s(e){if(e.metadata){var i=[];return _.each(e.metadata,(function(e,r){var o,s=t.mix(!0,{},e),l=s.valueAttributes;!1!==n?l.length>1?(_.each(l,(function(t){t.fieldCaption=s.name+"("+t.name+")",t.field=s.code+"_"+t.code,t.id=s.at.replace(/\./g,"_")+"."+s.code+"_"+t.code,t.metadata=s,t.order=s.order})),(o=i).push.apply(o,a()(l))):(s.id=s.at.replace(/\./g,"_")+"."+s.code,s.fieldCaption=s.name,s.field=s.code,s.metadata=s,i.push(s)):(s.id=s.id.replace(/\./g,"_"),s.fieldCaption=s.name,s.field=s.code,s.metadata=s,i.push(s))})),i=i.sort((function(t,e){return t.order<e.order?-1:1})),i}return[]}return this.$http.get("/rm/list/meta",e).then((function(n){for(var i=n.data,r=i.data,l=0;l<r.length;l++){var u=t.mix({},r[l]),d=s(u);(!e.namespace||e.namespace&&r[l].ID===e.namespace)&&o.push.apply(o,a()(d))}return o}))})),e("getDbSourceFieldsTree",(function(e,n,i,a){var r=[];function o(e){if(e.metadata){var i=_.map(e.metadata,(function(e,i){var a=t.mix(!0,{},e),r=a.valueAttributes;return!1!==n?r.length>1?(a.children=r,_.each(r,(function(t){t.fieldCaption=a.name+"("+t.name+")",t.field=a.code+"_"+t.code,t.id=a.at.replace(/\./g,"_")+"."+a.code+"_"+t.code,t.metadata=a}))):(a.id=a.at.replace(/\./g,"_")+"."+a.code,a.fieldCaption=a.name,a.field=a.code,a.metadata=a):(a.id=a.id.replace(/\./g,"_"),a.fieldCaption=a.name,a.field=a.code,a.metadata=a),a}));i=i.sort((function(t,e){return t.order<e.order?-1:1})),e.children=i,delete e.metadata}}return this.$http.get("/dbsource/rmId",e,i,a).then((function(n){for(var i=n.data,a=i.data,s=0;s<a.length;s++){var l=t.mix({},a[s]);o(l),r.push(l)}return e.namespace&&(r=_.filter(r,(function(t){return t.ID==e.namespace}))),r}))})),e("getOuaRulesTree",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.$http.get("/oua/getChooseTreeRole",t,e,n).done((function(t){return t}))})),e("getCurrentUserRoles",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.$http.get("/oua2/current/user/role",t,e,n).done((function(t){return t}))})),e("login",(function(e,n,i){var a=t.config.setting_public_loginin||"login/login";return n=t.mix(n||{},{buriedPoint:{await:!0}}),this.$http.post(a,e,n,i).then((function(e){var n=e.data;return t.storage.session.remove("homeMenu"),n}))})),e("loginQuick",(function(e,n,i){var a="login/quickLogin";return n=t.mix(n||{},{buriedPoint:{await:!0}}),this.$http.post(a,e,n,i).then((function(e){var n=e.data;return t.storage.session.remove("homeMenu"),n}))})),e("loginOut",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,a=t.config.setting_public_loginout||"login/loginOut";return n=t.mix(n||{},{buriedPoint:{await:!0}}),t.http.post(a,e,n,i).then((function(t){var e=t.data;return e}))})),e("mobileLoginOut",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,a=t.config.setting_public_mobile_loginout||"login/loginOut";return n=t.mix(n||{},{buriedPoint:{await:!0}}),t.http.post(a,e,n,i).then((function(t){var e=t.data;return e}))})),e("appInit",(function(e,n,i){return e?t.http.get("mobile/navigation/btn/".concat(e),{},n,i):new Promise((function(t,e){t()}))}))}},46:function(t,e,n){t.exports=n.p+"modules/platform/img/banner-demo1.png"},47:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_ppt_icon.png"},48:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_pdf_icon.png"},49:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_mp3_icon.png"},50:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_word_icon.png"},51:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_mp4_icon.png"},52:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_excel_icon.png"},53:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_png_icon.png"},54:function(t,e,n){t.exports=n.p+"modules/platform/img/file_type_df_icon.png"},8:function(t,e,n){var i=n(21),a=n(26),r=n(14),o=n(22);function s(t,e){return i(t)||a(t,e)||r(t,e)||o()}t.exports=s,t.exports.__esModule=!0,t.exports["default"]=t.exports},9:function(t,e){function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports["default"]=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports["default"]=t.exports}})["default"]}));
//# sourceMappingURL=../../../smap/platform/dsf-platform.common.js.map