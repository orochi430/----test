/*!
 * Name: @dsf/cli-platform
 * Version: 5.17.0-alpha.5
 * Description: 平台基础包
 * BuildTime: 2024/6/19 17:49:40
*/
(("undefined"!==typeof self?self:this)["webpackJsonpplatform"]=("undefined"!==typeof self?self:this)["webpackJsonpplatform"]||[]).push([[51],{950:function(e,t,n){"use strict";n.r(t),n.d(t,"directiveInserted",(function(){return x})),n.d(t,"directiveUpdate",(function(){return p})),n.d(t,"directiveUnbind",(function(){return m})),n.d(t,"createRow",(function(){return v})),n.d(t,"createCell",(function(){return g})),n.d(t,"removeColumn",(function(){return w})),n.d(t,"getRangeSelectedCells",(function(){return b})),n.d(t,"mergeCellsHanlder",(function(){return y})),n.d(t,"splitCellHandler",(function(){return I})),n.d(t,"getMergedCells",(function(){return C})),n.d(t,"getIndexByCellProp",(function(){return S})),n.d(t,"getCellByIndex",(function(){return W})),n.d(t,"updateRowsAndCells",(function(){return R})),n.d(t,"updateRangeWrap",(function(){return E})),n.d(t,"clearRangeWrap",(function(){return N})),n.d(t,"filterSelfCell",(function(){return M})),n.d(t,"mergeCells",(function(){return A})),n.d(t,"splitCell",(function(){return H})),n.d(t,"insertRowBefore",(function(){return L})),n.d(t,"insertRowAfter",(function(){return B})),n.d(t,"insertColumnBefore",(function(){return T})),n.d(t,"insertColumnAfter",(function(){return k})),n.d(t,"deleteRows",(function(){return D})),n.d(t,"deleteColumns",(function(){return z})),n.d(t,"resetColWidth",(function(){return F})),n.d(t,"resetRowHeight",(function(){return P})),n.d(t,"setTableCell",(function(){return X})),n.d(t,"setTableCellStyle",(function(){return Y})),n.d(t,"clearChooseCell",(function(){return G})),n.d(t,"clearAllCell",(function(){return O})),n.d(t,"getCellContextMenuConfig",(function(){return J})),n.d(t,"setSelectedCellsByPosition",(function(){return q})),n.d(t,"parseMatrix",(function(){return U})),n.d(t,"setCellStyle",(function(){return K})),n.d(t,"setCellBorder",(function(){return j})),n.d(t,"contextMenuHandler",(function(){return Z})),n.d(t,"clearMouseDownHandler",(function(){return ee})),n.d(t,"mouseDownHandler",(function(){return te})),n.d(t,"mouseMoveHandler",(function(){return ne})),n.d(t,"mouseUpHandler",(function(){return re}));var r=n(8),l=n.n(r),o=null,i=null,a=50;function s(e,t,n,r,l){f(e,n,r);var s=!1,c=0,u=0,h=[0,0],x=[0,0];function p(e,t){var n=e.getAttribute("c-index").split(",");return"0"===n[1]?t>e.offsetWidth-5?"right":null:e.nextElementSibling?t>e.offsetWidth-5?"right":t<5?"left":void 0:t<5?"left":null}function m(){var o=JSON.parse(JSON.stringify(n[r])),i=e.offsetWidth,s=parseInt(t.style.left)-u,c=e.querySelector("thead th:nth-child(".concat(h[0]+1,")")).offsetWidth+s,d=e.querySelector("thead th:nth-child(".concat(h[1]+1,")")).offsetWidth-s;c<a||d<a||(o[h[0]]={width:_.round(100*c/i,3)+"%"},o[h[1]]={width:_.round(100*d/i,3)+"%"},l&&l(o))}n.mousemoveW=function(n){var r=n||window.event,l=$(r.target).closest("td");if(l.length&&l.closest("table").get(0)===e){var i=d(r,l.get(0)).offsetX;if(o=p(l.get(0),i),o&&(r.cancelBubble=!0,r.stopPropagation()),o?("left"===o?s||(u=l.get(0).offsetLeft,t.style.left=u+"px"):s||(u=l.get(0).offsetLeft+l.get(0).offsetWidth,t.style.left=u+"px"),"col-resize"!==document.body.style.cursor&&(document.body.style.cursor="col-resize")):s||"col-resize"!==document.body.style.cursor||(document.body.style.cursor=""),s){var a=(window.$designerSscale||100)/100,f=(r.screenX-c)/a;f>x[1]&&(f=x[1]),f<x[0]&&(f=x[0]),t.style.left=u+f+"px"}}else s||(document.body.style.cursor="")},n.mousedownW=function(n){var r=n||window.event,l=$(r.target).closest("td");if(l.length&&l.closest("table").get(0)===e){var u=d(r,l.get(0)).offsetX;if(o=p(l.get(0),u),o&&(r.cancelBubble=!0,r.stopPropagation()),!i&&o){if(c=r.screenX,s=!0,t.style.visibility="visible",document.body.style.cursor="col-resize","left"===o)h[1]=+l.get(0).getAttribute("c-index").split(",")[1],h[0]=h[1]-1;else{var f=+l.get(0).getAttribute("colspan")||1;h[0]=+l.get(0).getAttribute("c-index").split(",")[1]+f-1,h[1]=h[0]+1}var m=e.querySelector("thead th:nth-child(".concat(h[0]+1,")")).offsetWidth,v=e.querySelector("thead th:nth-child(".concat(h[1]+1,")")).offsetWidth;x[0]=a-m,x[1]=v-a}}},n.mouseupW=function(e){var n=e||window.event;s&&(n.cancelBubble=!0,n.stopPropagation(),t.style.visibility="hidden",document.body.style.cursor="",s=!1,m())}}function c(e,t,n,r,l){var a=!1,s=0,c=0,u=null,f=0;function h(e,t){var n=e.getAttribute("c-index");if(n&&""!==n){var r=e.getAttribute("c-index").split(",")[0];return"0"===r?t>e.offsetHeight-5?"bottom":void 0:t>e.offsetHeight-5?"bottom":t<5?"top":void 0}}function x(){var e=parseInt(t.style.top)-c,n=+u.children[0].getAttribute("c-index").split(",")[0];l&&l(n,u.offsetHeight+e+"px")}n.mousemoveH=function(n){var r=n||window.event,l=$(r.target).closest("td");if(l.length&&l.closest("table").get(0)===e){var o=d(r,l.get(0)).offsetY;if(i=h(l.get(0),o),i?(r.cancelBubble=!0,r.stopPropagation(),"top"===i?a||(c=l.get(0).parentElement.offsetTop,t.style.top=c+"px"):a||(c=l.get(0).parentElement.offsetTop+l.get(0).parentElement.offsetHeight,t.style.top=c+"px"),"row-resize"!==document.body.style.cursor&&(document.body.style.cursor="row-resize")):a||"row-resize"!==document.body.style.cursor||(document.body.style.cursor=""),a){var u=(window.$designerSscale||100)/100,x=(r.screenY-s)/u;x<f&&(x=f),t.style.top=c+x+"px"}}else a||(document.body.style.cursor="")},n.mousedownH=function(n){var r=n||window.event,l=$(r.target).closest("td");if(l.length&&l.closest("table").get(0)===e){var c=d(r,l.get(0)).offsetY;i=h(l.get(0),c),i&&(r.cancelBubble=!0,r.stopPropagation()),i&&!o&&(s=r.screenY,a=!0,t.style.visibility="visible",document.body.style.cursor="row-resize",u="top"===i?l.get(0).parentElement.previousElementSibling:l.get(0).parentElement,f=57-u.offsetHeight)}},n.mouseupH=function(e){var n=e||window.event;a&&(n.cancelBubble=!0,n.stopPropagation(),t.style.visibility="hidden",document.body.style.cursor="",a=!1,x())}}function d(e,t){var n=e.offsetX,r=e.offsetY,l=e.target;if(!t)return{offsetX:n,offsetY:r};while(l!==t)if(n+=l.offsetLeft,r+=l.offsetTop,l=l.parentNode,l===document.body){n=0,r=0;break}return{offsetX:n,offsetY:r}}function u(e,t){var n=document.createElement("div");return n.style.position="absolute",n.style.display="block",n.style.visibility="hidden",n.style.top="0",n.style.left="0",n.style.zIndex="10000","x"===t?(n.style.height="100%",n.style.width="1px",n.style.borderLeft="1px dashed #000"):(n.style.width="100%",n.style.height="1px",n.style.borderTop="1px dashed #000"),n.innerHTML="<span></span>","relative"!==e.style.position&&"absolute"!==e.style.position&&"fixed"!==e.style.position&&(e.style.position="relative"),e.appendChild(n),n}function f(e,t,n){var r=JSON.parse(JSON.stringify(t[n]));t.__col_number=r.length}function h(e,t,n,r){var l=e.offsetWidth,o=JSON.parse(JSON.stringify(t[n])),i=[],a=t.__col_number;t.__col_number=o.length;var s=a/o.length;o.length;o.forEach((function(e,t){var n=e.width;if(0===n||n&&""!==n&&"auto"!==n)if("string"===typeof n&&n.indexOf("%")>0){var r=parseFloat(n)*s;i[t]={width:_.round(r,3)+"%"}}else if("string"===typeof n&&n.indexOf("px")>0){var o=100*parseFloat(n)*s/l;i[t]={width:_.round(o,3)+"%"}}else{var a=parseFloat(n)*s;i[t]={width:_.round(a,3)+"%"}}else i[t]={width:"auto"}})),r&&r(i)}function x(e,t,n){var r=t.value,l=t.modifiers,o=n.context;o.isDesign&&((l.x||!l.x&&!l.y)&&(s(e,u(e,"x"),o,r.colList,r.onChangeCol),window.addEventListener("mousemove",o.mousemoveW),e.addEventListener("mousedown",o.mousedownW),window.addEventListener("mouseup",o.mouseupW),e.addEventListener("mouseleave",o.mouseupW)),(l.y||!l.x&&!l.y)&&(c(e,u(e,"y"),o,r.rowList,r.onChangeRow),window.addEventListener("mousemove",o.mousemoveH),e.addEventListener("mousedown",o.mousedownH),window.addEventListener("mouseup",o.mouseupH)),e.mouseleave=function(){document.body.style.cursor=""},window.addEventListener("mouseleave",e.mouseleave,{capture:!0}))}function p(e,t,n){var r=t.value,l=t.modifiers,o=n.context;o.isDesign&&(l.x||!l.x&&!l.y)&&o.__col_number!==o[r.colList].length&&h(e,o,r.colList,r.onChangeCol)}function m(e,t,n){var r=t.modifiers,l=n.context;l.isDesign&&((r.x||!r.x&&!r.y)&&(window.removeEventListener("mousemove",l.mousemoveW),e.removeEventListener("mousedown",l.mousedownW),window.removeEventListener("mouseup",l.mouseupW),e.removeEventListener("mouseleave",l.mouseupW)),(r.y||!r.x&&!r.y)&&(window.removeEventListener("mousemove",l.mousemoveH),e.removeEventListener("mousedown",l.mousedownH),window.removeEventListener("mouseup",l.mouseupH)),window.removeEventListener("mouseleave",e.mouseleave,{capture:!0}))}function v(){return dsf.designer.createComponent(window.$components.platform.DsfTableRow)}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return dsf.designer.createComponent(window.$components.platform.DsfTableCell,e)}function w(e){dsf.array.removeAt(this.columnsInfo,e)}function b(e,t){var n=[];if(t&&e.get(0)!=t.get(0)){if(!e.attr("c-index")||!t.attr("c-index"))return;var r=e.attr("c-index").split(","),l=Number(r[0]),o=Number(r[1]),i=t.attr("c-index").split(","),a=Number(i[0]),s=Number(i[1]);return q.call(this,o,l,s,a)}if(e.attr("c-index")){var c=e.attr("c-index").split(","),d=Number(c[0]),u=Number(c[1]),f=W.call(this,d,u);return f&&dsf.array.ensure(n,f),q.call(this,u,d,u,d)}}function y(){var e=this.rangeWrap.selected,t=V.call(this),n=e[0].rowIndex,r=e[0].cellIndex,l=this.getCells(this.rows[n]),o=_.find(l,(function(e){return e.cellIndex===r}));A.call(this,o,t.maxRowIndex-t.minRowIndex+1,t.maxCellIndex-t.minCellIndex+1)}function I(){var e=C.call(this);H.call(this,e)}function C(){for(var e=this.rangeWrap.selected,t=[],n=0;n<e.length;n++){var r=e[n];(r.rowspan>1||r.colspan>1)&&t.push(r)}return t}function S(e){for(var t in this.allCells)if(this.allCells[t]===e){var n=t.split(",");return{rowIndex:Number(n[0]),cellIndex:Number(n[1])}}return null}function W(e,t){return this.allCells[e+","+t]}function R(e){for(var t,n,r=0;r<e.length;r++){for(var l=e[r],o=[],i=0;i<l.length;i++){var a=l[i];a&&!a.isSpan&&o.push(a)}this.rows[r].slots[0].controls=o}U.call(this),null===this||void 0===this||null===(t=this.$designer)||void 0===t||null===(n=t.recordPageChange)||void 0===n||n.call(t)}function E(e){var t=this;if(this.isDesign&&e){var n=(window.$designerSscale||100)/100,r=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER,u=function(e){var u=e.rowIndex,f=e.cellIndex,h=e.colspan,x=e.rowspan,p=$(t.$el).find("td[c-index='"+u+","+f+"']");if(a=Math.min(a,u),s=Math.max(s,u+x-1),c=Math.min(c,f),d=Math.max(d,f+h-1),p=M.call(t,p),p){var m=p.eq(0).position(),v=p.parent(),g=v.position().top/n,w=m.left/n;r=Math.min(r,g),l=Math.min(l,w),o=Math.max(o,w+p.outerWidth()),i=Math.max(i,g+p.outerHeight())}};_.each(e,(function(e){return e.isSpan||u(e)}));var f=o-l,h=i-r,x=this.borderWidth;this.rangeWrap.startRowIndex=a,this.rangeWrap.endRowIndex=s,this.rangeWrap.startColIndex=c,this.rangeWrap.endColIndex=d;var p=x%2;this.rangeWrap.width=f+4-p,this.rangeWrap.height=h+4-p,this.rangeWrap.left=l-2+this.$refs.table.offsetLeft,this.rangeWrap.top=r-2+this.$refs.table.offsetTop+p,this.rangeWrap.selected=e}}function N(){this.rangeWrap.show&&(this.rangeWrap.show=!1,this.rangeWrap.startRowIndex=0,this.rangeWrap.endRowIndex=0,this.rangeWrap.startColIndex=0,this.rangeWrap.endColIndex=0,this.rangeWrap.width=0,this.rangeWrap.height=0,this.rangeWrap.left=-10,this.rangeWrap.top=-10,this.rangeWrap.selected=[])}function M(e){for(var t=0;t<e.length;t++){var n=e.eq(t),r=n.closest("table");if(this.$refs.table===r.get(0))return n}return null}function A(e,t,n){t=t||1,n=n||1;for(var r=S.call(this,e),l=U.call(this),o=r.rowIndex;o<r.rowIndex+t;o++)for(var i=r.cellIndex;i<r.cellIndex+n;i++)o===r.rowIndex&&i===r.cellIndex?(l[o].splice(i,1,e),e.rowspan=t,e.colspan=n):l[o].splice(i,1,{isSpan:!0,rowIndex:o,cellIndex:i,mergeCell:e});R.call(this,l),this.rangeWrap.show&&(this.rangeWrap.selected=[this.rangeWrap.selected[0]])}function H(e){var t=this,n=V.call(this),r=n.maxRowIndex,l=n.minRowIndex,o=n.maxCellIndex,i=n.minCellIndex;if(U.call(this),_.each(e,(function(e){for(var n=e.rowIndex;n<e.rowIndex+e.rowspan;n++)for(var r=e.cellIndex;r<e.cellIndex+e.colspan;r++){var l=t.matrix[n][r];l.isSpan&&(t.matrix[n][r]=g())}e.rowspan=1,e.colspan=1})),R.call(this,this.matrix),this.rangeWrap.show){for(var a=[],s=i;s<=o;s++)for(var c=l;c<=r;c++)a.push(W.call(this,c,s));this.rangeWrap.selected=a}}function L(){U.call(this);for(var e=[],t=V.call(this),n=t.minRowIndex,r=this.matrix[n],l=v(),o=0;o<r.length;o++){var i=r[o];if(i.isSpan){if(i.mergeCell.rowIndex<n){dsf.array.ensure(e,i.mergeCell);continue}}else if(i.rowspan>1&&n>i.rowIndex){dsf.array.ensure(e,i);continue}var a=g();l.slots[0].controls.push(a)}_.each(e,(function(e){e.rowspan++})),this.rows.splice(n,0,l),U.call(this)}function B(){U.call(this);for(var e=[],t=V.call(this),n=t.maxRowIndex,r=this.matrix[n],l=v(),o=0;o<r.length;o++){var i=r[o];if(i.isSpan){var a=i.mergeCell;if(1+i.rowIndex<a.rowspan+a.rowIndex){dsf.array.ensure(e,i.mergeCell);continue}}if(i.rowspan>1&&n<i.rowIndex+i.rowspan-1)dsf.array.ensure(e,i);else{var s=g();l.slots[0].controls.push(s)}}_.each(e,(function(e){e.rowspan++})),this.rows.splice(n+1,0,l),U.call(this)}function T(){U.call(this);var e=V.call(this),t=this.rows,n=this.matrix,r=e.minCellIndex;0==r?_.each(t,(function(e){e.slots[0].controls.unshift(g())})):_.each(t,(function(e,t){var l=n[t],o=l[r];if(o.isSpan&&(l[r-1].isSpan||l[r-1]===o.mergeCell))o.rowIndex==o.mergeCell.rowIndex&&o.mergeCell.colspan++;else{var i=e.slots[0].controls,a=_.findIndex(i,(function(e){return e.cellIndex==r}));i.splice(a,0,g())}})),addColumn.call(this,r),U.call(this)}function k(){U.call(this);var e=V.call(this),t=this.rows,n=this.matrix,r=e.maxCellIndex;r==n[0].length-1?_.each(t,(function(e){e.slots[0].controls.push(g())})):_.each(t,(function(e,t){var l=n[t],o=l[r];if(o.colspan>1)o.colspan++;else if(o.isSpan&&l[r+1].isSpan)o.rowIndex==o.mergeCell.rowIndex&&o.mergeCell.colspan++;else{var i=e.slots[0].controls,a=_.findIndex(i,(function(e){return e.cellIndex>r}));i.splice(a,0,g())}})),addColumn.call(this,r+1),U.call(this)}function D(){var e=this;U.call(this);for(var t=V.call(this),n=t.maxRowIndex;n>=t.minRowIndex;n--){var r=this.matrix[n],l=r.length-1,o=function(){var t=r[l];if(t.isSpan&&(t=t.mergeCell),t.rowspan>1)if(n>t.rowIndex)t.rowspan--,l-=t.colspan;else{if(t.rowIndex===n&&t.cellIndex===l){var o=g();o.rowspan=t.rowspan-1>1?t.rowspan-1:1,o.colspan=t.colspan,o.cellIndex=t.cellIndex,o.cellBorderStyle=t.cellBorderStyle,o.backgroundConfig=t.backgroundConfig,o.cellStyle=t.cellStyle;var i=_.findIndex(e.rows[n+1].slots[0].controls,(function(e){return e.cellIndex>t.cellIndex}));i>=0?e.rows[n+1].slots[0].controls.splice(i,0,o):e.rows[n+1].slots[0].controls.push(o)}l--}else l--};while(l>=0)o();this.rows.splice(n,1)}U.call(this)}function z(){U.call(this);var e=V.call(this),t=e.maxCellIndex,n=e.minCellIndex,r=this.rows,l=this.matrix;_.each(l,(function(e,l){for(var o=function(){var t=e[i];if(t.isSpan){if(t.rowIndex==t.mergeCell.rowIndex){var n=t.mergeCell.cellIndex,o=_.find(r[l].slots[0].controls,(function(e){if(n==e.cellIndex)return!0}));o.colspan--}}else if(t.colspan>1)t.colspan--;else{var a=r[l].slots[0].controls,s=_.findIndex(a,(function(e){return t.cellIndex==e.cellIndex}));s>-1&&a.splice(s,1)}},i=t;i>=n;i--)o()}));for(var o=t;o>=n;o--)w.call(this,o);U.call(this)}function F(){var e="auto";this.onChangeCol(this.columnsInfo.map((function(){return{width:e}})))}function P(){var e=this;this.rows.forEach((function(e){e.height="57px"})),this.isDesign&&this.$nextTick((function(){E.call(e,e.rangeWrap.selected)}))}function X(){var e=this;dsf.layer.openDialog({title:"单元格设置",fullscreen:!1,content:"DesTableCellSet",width:"600px",btns:[{text:"确定",handler:function(t){var n=t.yes();Y.call(e,n),e.$forceUpdate()}},{text:"取消"}]})}function Y(e){for(var t=e.cellStyle,n=e.cellAttr,r=(e.borderPosition,U.call(this)),l=V.call(this),o=l.maxRowIndex,i=l.minRowIndex,a=l.maxCellIndex,s=l.minCellIndex,c=i;c<=o;c++)for(var d=s;d<=a;d++){var u=r[c][d];u.isSpan||(u.cellAttr=_.merge(u.cellAttr,n),u.cellStyle=_.merge(u.cellStyle,t))}}function G(){for(var e=U.call(this),t=V.call(this),n=t.maxRowIndex,r=t.minRowIndex,l=t.maxCellIndex,o=t.minCellIndex,i=r;i<=n;i++)for(var a=o;a<=l;a++){var s=e[i][a];s.isSpan||(this.$set(s,"cellAttr",{align:"",valign:""}),this.$set(s,"cellStyle",{}),this.$set(s,"cellBorderStyle",{}))}}function O(){for(var e=U.call(this),t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){var r=e[t][n];r.isSpan||(this.$set(r,"cellAttr",{align:"",valign:""}),this.$set(r,"cellStyle",{}),this.$set(r,"cellBorderStyle",{}))}}function J(e,t){return[{text:"字体",children:_.map([["跟随上下文",""],["仿宋","仿宋,FangSong"],["黑体","黑体, SimHei"],["楷体","楷体,楷体_GB2312, SimKai"],["隶书","隶书,SimLi"],["宋体","宋体,SimSun"],["微软雅黑","微软雅黑,Microsoft YaHei"],["幼圆","幼圆,YouYuan"],["andale mono","andale mono"],["arial","arial, helvetica,sans-serif"],["arial black","arial black,avant garde"],["comic sans ms","comic sans ms"],["impact","impact,chicago"],["times new roman","times new roman"]],(function(t){var n=l()(t,2),r=n[0],o=n[1];return{text:r,value:o,attr:"font-family",handler:e}}))},{text:"字体大小",children:_.map([["跟随上下文",""],["10px","10px"],["11px","11px"],["12px","12px"],["14px","14px"],["16px","16px"],["18px","18px"],["20px","20px"],["22px","22px"],["24px","24px"],["36px","36px"]],(function(t){var n=l()(t,2),r=n[0],o=n[1];return{text:r,value:o,attr:"font-size",handler:e}}))},{text:"文本装饰",children:_.map([["跟随上下文",""],["无装饰","none"],["下划线","underline"],["上划线","overline"],["贯穿线","line-through"]],(function(t){var n=l()(t,2),r=n[0],o=n[1];return{text:r,value:o,attr:"text-decoration",handler:e}}))},{text:"文本加粗",children:_.map([["跟随上下文",""],["正常","normal"],["加粗","bold"]],(function(t){var n=l()(t,2),r=n[0],o=n[1];return{text:r,value:o,attr:"font-weight",handler:e}}))},{text:"文本斜体",children:_.map([["跟随上下文",""],["正常","normal"],["斜体","italic"]],(function(t){var n=l()(t,2),r=n[0],o=n[1];return{text:r,value:o,attr:"font-style",handler:e}}))},{text:"字体颜色",children:_.map(["","#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","custom"],(function(t){return""===t?{text:"跟随上下文",value:"",attr:"color",handler:e}:"custom"===t?{text:"自定义",value:"custom",attr:"color",icon:"icon-zidingyi",handler:e}:{color:t,text:t,value:t,icon:"icon-ditu-yuan",attr:"color",handler:e}}))},{text:"背景填充",children:_.map(["","#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","custom"],(function(t){return""===t?{text:"跟随上下文",value:"",attr:"background-color",handler:e}:"custom"===t?{text:"自定义",value:"custom",attr:"background-color",icon:"icon-zidingyi",handler:e}:{color:t,text:t,value:t,icon:"icon-ditu-yuan",attr:"background-color",handler:e}}))},{text:"水平对齐",children:_.map([["跟随上下文",""],["靠左","left"],["居中","center"],["靠右","right"]],(function(t){var n=l()(t,2),r=n[0],o=n[1];return{text:r,value:o,attr:"align",handler:e}}))},{text:"垂直对齐",children:_.map([["跟随上下文",""],["靠上","top"],["居中","middle"],["靠下","bottom"],["基线对齐","baseline"]],(function(t){var n=l()(t,2),r=n[0],o=n[1];return{text:r,value:o,attr:"valign",handler:e}}))},{text:"边框样式",children:_.map([{text:"全部边框",children:[{text:"跟随上下文",value:"",attr:"all",handler:t},{text:"隐藏",value:"none",attr:"all,none",handler:t},{text:"颜色",children:_.map(["","#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","custom"],(function(e){return""===e?{text:"跟随上下文",value:"",attr:"all,color",handler:t}:"custom"===e?{text:"自定义",attr:"all,color",value:"custom",icon:"icon-zidingyi",handler:t}:{color:e,text:e,value:e,icon:"icon-ditu-yuan",attr:"all,color",handler:t}}))}]},{text:"上边框",children:[{text:"跟随上下文",value:"",attr:"top",handler:t},{text:"隐藏",value:"none",attr:"top,none",handler:t},{text:"颜色",children:_.map(["","#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","custom"],(function(e){return""===e?{text:"跟随上下文",value:"",attr:"top,color",handler:t}:"custom"===e?{text:"自定义",attr:"top,color",value:"custom",icon:"icon-zidingyi",handler:t}:{color:e,text:e,value:e,icon:"icon-ditu-yuan",attr:"top,color",handler:t}}))}]},{text:"下边框",children:[{text:"跟随上下文",value:"",attr:"bottom",handler:t},{text:"隐藏",value:"none",attr:"bottom,none",handler:t},{text:"颜色",children:_.map(["","#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","custom"],(function(e){return""===e?{text:"跟随上下文",value:"",attr:"bottom,color",handler:t}:"custom"===e?{text:"自定义",attr:"bottom,color",value:"custom",icon:"icon-zidingyi",handler:t}:{color:e,text:e,value:e,icon:"icon-ditu-yuan",attr:"bottom,color",handler:t}}))}]},{text:"左边框",children:[{text:"跟随上下文",value:"",attr:"left",handler:t},{text:"隐藏",value:"none",attr:"left,none",handler:t},{text:"颜色",children:_.map(["","#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","custom"],(function(e){return""===e?{text:"跟随上下文",value:"",attr:"left,color",handler:t}:"custom"===e?{text:"自定义",attr:"left,color",value:"custom",icon:"icon-zidingyi",handler:t}:{color:e,text:e,value:e,icon:"icon-ditu-yuan",attr:"left,color",handler:t}}))}]},{text:"右边框",children:[{text:"跟随上下文",value:"",attr:"right",handler:t},{text:"隐藏",value:"none",attr:"right,none",handler:t},{text:"颜色",children:_.map(["","#ffffff","#000000","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","custom"],(function(e){return""===e?{text:"跟随上下文",value:"",attr:"right,color",handler:t}:"custom"===e?{text:"自定义",attr:"right,color",value:"custom",icon:"icon-zidingyi",handler:t}:{color:e,text:e,value:e,icon:"icon-ditu-yuan",attr:"right,color",handler:t}}))}]}])}]}function q(e,t,n,r){var l=Math.min(e,n),o=Math.max(e,n),i=Math.min(t,r),a=Math.max(t,r);while(1){for(var s=l,c=o,d=i,u=a,f=d,h=u;f<=h;f++)for(var x=this.matrix[f],p=s,m=c;p<=m;p++){var v=x[p];if(v.isSpan){var g=v.mergeCell,w=g.rowIndex,b=g.cellIndex,y=g.colspan,I=g.rowspan;d=Math.min(d,w),u=Math.max(u,w+I-1),s=Math.min(s,b),c=Math.max(c,b+y-1)}else if(v.colspan>1||v.rowspan>1){var C=v.rowIndex,S=v.cellIndex,_=v.colspan,W=v.rowspan;d=Math.min(d,C),u=Math.max(u,C+W-1),s=Math.min(s,S),c=Math.max(c,S+_-1)}}if(s==l&&c==o&&d==i&&u==a)break;l=s,o=c,i=d,a=u}for(var R=[],N=i;N<=a;N++)for(var M=this.matrix[N],$=l;$<=o;$++){var A=M[$];A.isSpan||R.push(A)}return E.call(this,R),R}function U(){var e=this,t=[],n=this.getRows();if(n&&n.length){var r={};_.each(n,(function(){t.push([])}));for(var l=0;l<n.length;l++)for(var o=n[l],i=this.getCells(o),a=0,s=0;s<i.length;s++){var c=i[s];c.rowIndex=l,c.cellIndex=s;var d=c.rowspan||1,u=c.colspan||1;while(void 0!==t[l][a])a++;for(var f=l;f<l+d;f++)for(var h=a;h<a+u;h++)f===l&&h===a?(t[f][h]=c,c.rowIndex=l,c.cellIndex=h,r[c.rowIndex+","+c.cellIndex]=c):t[f][h]={isSpan:!0,rowIndex:f,cellIndex:h,mergeCell:c}}this.allCells=r}this.matrix=t;var x=this.matrix[0]?this.matrix[0].length:0;return _.eachRight(this.columnsInfo,(function(t,n){n>x-1&&dsf.array.remove(e.columnsInfo,t)})),t}function K(e){var t=this,n=e.attr,r=e.value,l=U.call(this),o=V.call(this),i=o.maxRowIndex,a=o.minRowIndex,s=o.maxCellIndex,c=o.minCellIndex,d=function(e){for(var r=a;r<=i;r++)for(var o=c;o<=s;o++){var d=l[r][o];d.isSpan||("align"===n||"valign"===n?t.$set(d.cellAttr,n,e):t.$set(d.cellStyle,n,e))}};"color"!==n&&"background-color"!==n||"custom"!==r?d(r):this.setCellCustomColor.call(this,l[a][c].cellStyle[n]||"#ffffff",d)}function j(e){var t=this,n=e.attr,r=e.value,o=U.call(this),i=V.call(this),a=i.maxRowIndex,s=i.minRowIndex,c=i.maxCellIndex,d=i.minCellIndex,u=n.split(","),f=l()(u,2),h=f[0],x=f[1],p=void 0===x?"":x,m=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)for(var n=d;n<=c;n++)y(o[s][n],"top",p,e);s>0&&_.each(o[s-1],(function(e,t){if(t<=c&&e.colspan+1+t-1>=d){var n=s-2;while(e.isSpan&&n>=0)e=o[n--][t];y(e,"bottom","none","none")}}))},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)for(var n=d;n<=c;n++){var r=a;while(o[r][n].isSpan&&r>s)r--;y(o[r][n],"bottom",p,e)}"none"==p&&a+1<o.length&&_.each(o[a+1],(function(e,t){if(t<=c&&e.colspan+1+t-1>=d){var n=a+2;while(e.isSpan&&n<o.length)e=o[n++][t];y(e,"top","none","none")}}))},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)for(var n=s;n<=a;n++)y(o[n][d],"left",p,e);d>0&&_.each(o,(function(e,t){var n=e[d-1];if(t<=a&&(n.rowspan||1)+t-1>=s){var r=d-2;while(n.isSpan&&r>0)n=e[r--];y(n,"right","none","none")}}))},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)for(var n=s;n<=a;n++){var r=c;while(o[n][r].isSpan&&r>d)r--;y(o[n][r],"right",p,e)}"none"==p&&c+1<o[s].length&&_.each(o,(function(e,t){var n=e[c+1];if(t<=a&&(n.rowspan||1)+t-1>=s){var r=c+2;while(n.isSpan&&r<o[s].length)n=e[r++];y(n,"left","none","none")}}))},b=function(e){switch(h){case"all":for(var t=s;t<=a;t++)for(var n=d;n<=c;n++){var r=o[t][n];y(r,"top",p,e),y(r,"bottom",p,e),y(r,"left",p,e),y(r,"right",p,e)}m(e,!0),v(e,!0),g(e,!0),w(e,!0);break;case"top":m(e);break;case"bottom":v(e);break;case"left":g(e);break;case"right":w(e);break}},y=function(e,n,r,l){if(!e.isSpan)switch(r){case"":t.$set(e,"cellBorderStyle",{});break;case"none":t.$set(e.cellBorderStyle,"border-".concat(n,"-style"),l);break;case"style":t.$set(e.cellBorderStyle,"border-".concat(n,"-style"),l);break;case"color":"none"===e.cellBorderStyle["border-".concat(n,"-style")]&&t.$set(e.cellBorderStyle,"border-".concat(n,"-style"),"solid"),t.$set(e.cellBorderStyle,"border-".concat(n,"-color"),l);break}};n.indexOf("color")>-1&&"custom"===r?Q.call(this,"#666666",b):b(r)}function Q(e,t){dsf.layer.openDialog({title:"选择颜色",content:"DsfColorSelect",width:"400px",params:{value:e},btns:[{text:"确定",handler:function(e){t(e.valueCopy)}},{text:"取消"}]})}function V(){var e=this.rangeWrap,t=e.startRowIndex,n=e.endRowIndex,r=e.startColIndex,l=e.endColIndex;return{maxRowIndex:n,minRowIndex:t,maxCellIndex:l,minCellIndex:r}}function Z(e){var t=e.target;if(t=$(e.target).closest("TD"),t=M.call(this,t),t&&t.length&&"TD"===t.get(0).tagName){var n;if(t=$(t),!t.attr("c-index"))return[];var r=t.attr("c-index").split(","),l=Number(r[0]),o=Number(r[1]),i=_.findIndex(this.rangeWrap.selected,(function(e){return e.rowIndex===l&&e.cellIndex===o}));i<0&&(this.downCell=t,this.rangeWrap.show=!0,b.call(this,this.downCell,null));var a=this.rangeWrap.selected,s=V.call(this),c=s.maxRowIndex,d=s.minRowIndex,u=s.maxCellIndex,f=s.minCellIndex,h=(c-d+1)*(u-f+1),x=this.setCellStyle,p=this.setCellBorder,m=[{text:"合并单元格",id:"mergeCells",disabled:h<2||1==a.length,handler:y},{text:"拆分单元格",id:"splitCell",disabled:h<2||a.length==h,handler:I},"-",{text:"插入行",children:[{text:"插入行(前)",id:"insertRowBefore",disabled:!1,handler:L},{text:"插入行(后)",id:"insertRowAfter",disabled:!1,handler:B}]},{text:"插入列",children:[{text:"插入列(前)",id:"insertColumnBefore",disabled:!1,handler:T},{text:"插入列(后)",id:"insertColumnAfter",disabled:!1,handler:k}]},"-",{text:"删除",children:[{text:"删除整行",id:"deleteRows",disabled:!1,handler:D},{text:"删除整列",id:"deleteColumns",disabled:!1,handler:z}]},"-",{text:"重置列宽",id:"resetColWidth",disabled:!1,handler:F},{text:"重置行高",id:"resetRowHeight",disabled:!1,handler:P},"-",{text:"单元格设置",id:"cellStyle",disabled:!1,children:J(x,p)},{text:"清除选中格式",id:"clearChooseCell",disabled:!1,handler:G},{text:"清除所有格式",id:"clearAllCell",disabled:!1,handler:O}];return null===(n=this.contextMenuInterceptors)||void 0===n||n.call(this,m),m}}function ee(){this.isDown=!1,N.call(this)}function te(e,t,n){this.isDesign&&0===e.button&&(this.isDown=!0,this.downCell=$(n),this.rangeWrap.show=!0,U.call(this),b.call(this,this.downCell,null),e.stopPropagation())}function ne(e){if(this.isDown){var t=$(e.target).closest("TD"),n=null;do{if(n=M.call(this,t),!n&&(t=t.parents("TD"),0===t.length))return}while(!n);t&&(b.call(this,this.downCell,t),e.stopPropagation())}}function re(){this.isDown=!1,U.call(this)}}}]);
//# sourceMappingURL=../../../smap/platform/dsf-platform.platform_pc_layout_tableFun.js.map