"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[75417],{46644:function(e,t,a){a.r(t);var n=a(8450),s=a.n(n),n=a(73473),f=a.n(n),m=a(90541),h=a(25108),n={};function p(e,t,o,r,a){m.Z.http.post(a).then(function(e){var t=s()({relationId:o.parameters.pk}),a="",n="";200==e.data.code&&e.data.data&&e.data.data.taskTitle&&(a=e.data.data.taskTitle,n="/commonForm/210604144527JntE2LI7dWrpBLsluZz/".concat(e.data.data.taskId,"?specialSaveObj=").concat(t,"&listId=210618141757PmEKNvvLIJQtgqyDW44&method=view&viewAttachUseSignMode=1")),r.extra.linkInfo=n,r.extra.linkName=a})}function v(e,t){t.show=2==e?1:0}n.initHandle=function(o,t,s){1==o.main["C-DB-0127"].value?(a=t.controls.find(function(e){return"controlMobileFl"==e.metaId&&"主办单位"==e.label}),l=t.controls.find(function(e){return"controlMobileFl"==e.metaId&&"协办单位"==e.label}),e=t.controls.find(function(e){return"220805122012mf8KIUf71sblliZGMQY"==e.metaId}),u=t.controls.find(function(e){return"220805122049uPzxdHtw9IUt6EjkuYg"==e.metaId}),a&&(a.show=0),l&&(l.show=0),e&&(e.show=0),u&&(u.show=0)):(a=t.controls.find(function(e){return"C-DB-0123"==e.metaId}),l=t.controls.find(function(e){return"C-DB-0124"==e.metaId}),a&&(a.show=0),l&&(l.show=0),0==o.multinfos["220805122012mf8KIUf71sblliZGMQY"].rows.length&&0==o.multinfos["220805122049uPzxdHtw9IUt6EjkuYg"].rows.length&&m.Z.http.post("ctrl/superviseV6/approval/getChbrs",{sourceId:s.pk}).then(function(e){if(e.data.data){for(var e=e.data.data,a=e.zbrs,n=0;n<a.length;n++)!function(){var t=a[n];h.log(t),s.$refs.formTab[0].$refs["220805122012mf8KIUf71sblliZGMQY"][0].$refs.subform.addCard(!1).then(function(e){e["C-DB-CBR-003"]={value:t.chbr,text:t.chbrText,schema:t.chbrSchema},e["C-DB-CBR-001"]={value:t.orgType,text:t.orgTypeText},e["C-DB-CBR-002"]={value:t.leader},e["C-DB-CBR-004"]={value:t.cbUnit,text:t.cbUnitText,schema:t.cbUnitSchema},e.action="Updated"})}();for(var o=e.xbrs,r=0;r<o.length;r++)!function(){var t=o[r];s.$refs.formTab[0].$refs["220805122049uPzxdHtw9IUt6EjkuYg"][0].$refs.subform.addCard(!1).then(function(e){e["C-DB-CBR-003"]={value:t.chbr,text:t.chbrText,schema:t.chbrSchema},e["C-DB-CBR-001"]={value:t.orgType,text:t.orgTypeText},e["C-DB-CBR-002"]={value:t.leader},e["C-DB-CBR-004"]={value:t.cbUnit,text:t.cbUnitText,schema:t.cbUnitSchema},e.action="Updated"})}()}}));var e,a,n,r,i,l,c=t.controls.filter(function(e){return"controlMobileAlink"==e.controlType}),u=(c.length&&(p(0,0,t,c[0],"fn/superviseV6/approvalTask/getTaskByLeafRelationId?infoId=".concat(t.parameters.pk)),p(0,0,t,c[1],"fn/superviseV6/approvalTask/hasTasks?relationId=".concat(t.parameters.pk))),null==(e=o.main["C-DB-0078"])?void 0:e.value),d=(u&&c.length&&v(u,c[0]),o.main["C-DB-0082"].value);d&&c.length&&v(d,c[1]),o.main["C-DB-0022"].value||(a=o.main["C-DB-0016"].value,n=o,r=s,i="C-DB-0022",m.Z.http.post("/fn/superviseV6/approval/getResponsibleMobile",{userId:a}).then(function(e){200==e.data.code&&(e=e.data.data.responsibleMobile,r.$set(n.main,i,{value:e}))})),"XVFQiYfrCLfubcN"===t.parameters.nodeId&&(l=t.controls.find(function(e){return"C-DB-0081"==e.metaId})).enumData.splice(1,l.enumData.length),s.$bus.$off("selectUserBus").on("selectUserBus",function(e){h.log("busObj.metaData",e.metaData),"C-DB-0001"===e.metaData.metaId&&(1<e.selectArr.length?(s.$set(o.main,"C-DB-0002",{value:"",text:""}),t.controls.find(function(e){return"C-DB-0002"==e.metaId}).privilege.editable=!1):t.controls.find(function(e){return"C-DB-0002"==e.metaId}).privilege.editable=!0)}),s.$bus.$off("userClickBus").on("userClickBus",function(e){var t,n,a;"C-DB-0002"!=e.metaId&&"C-DB-0001"!=e.metaId||(t="C-DB-0002"==e.metaId?o.main["C-DB-0001"]:o.main["C-DB-0002"],a=e.user,t.value.split(",").find(function(e){return e==a.id.slice(a.id.lastIndexOf("_")+1)})&&(a.checked=!1,m.Z.layer.toast("主办单位与协办单位不能重复")),e.user.checked&&(n=e.user,new(f())(function(t,a){m.Z.http.post("fn/superviseV6/approval/hasRolePersonByDept",{deptId:n.id.slice(n.id.lastIndexOf("_")+1),deptName:n.showName}).then(function(e){(200==e.data.code?t:(m.Z.layer.toast(e.data.message),a))()})}).catch(function(){e.user.checked=!1,e.callback(e.user)})))}),s.$bus.on("inputRadio",function(e){"C-DB-0078"==e.metaData.metaId?v(e.value,c[0]):"C-DB-0082"==e.metaData.metaId?v(e.value,c[1]):"C-DB-0081"==e.metaData.metaId&&("210607162654rncyrI8JWu5gQbYaVLh"!=e.value?c[1].show=0:v(d,c[1]))})},t.default=n}}]);