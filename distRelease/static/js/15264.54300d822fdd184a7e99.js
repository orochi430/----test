"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[15264],{15264:function(t,e,n){n.r(e),n.d(e,{default:function(){return s}});var d=n(66250),e=n(33453),o=n.n(e),e={props:["wdztParams"],data:function(){return{data:{},jssdk:null,wpsData:{}}},created:function(){this.data=this.wdztParams||this.$route.query},mounted:function(){var t=this;dsf.loadJs("static/js/webOffice/web-office-sdk-v1.1.19.umd.js").then(function(){t.getWpsUrl(),t.$nextTick(function(){1<document.getElementsByClassName("wps_office").length&&window.location.reload()})})},methods:{getWpsUrl:function(){var t="edit"==this.data.edit?"fn/sdtongSSO/getEditUrl":"fn/sdtongSSO/getPreviewUrl";this.getWdztUrl(this.data,t)},getWdztUrl:function(t,e){var n=this;dsf.http.post(e,{fileId:t.fileId,fileName:t.fileName,infoId:t.infoId,moduleId:t.moduleId,pnId:t.pnId,pId:t.pId}).then(function(t){"200"==t.data.code&&n.wpsOpens(t.data.data.url)})},wpsOpens:function(s){var i=this;return(0,d.Z)(o().mark(function t(){var e,n;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("wpsOffice"),i.jssdk=WebOfficeSDK.config({url:s,mount:e}),i.jssdk.iframe.style.height=document.body.clientHeight-document.querySelector("#appTop").clientHeight+"px",i.wpsData.isRevise)return t.next=6,i.jssdk.ready();t.next=9;break;case 6:e=i.jssdk.Application,n=!(!dsf.config.commonForm.wdzt||!dsf.config.commonForm.wdzt.trackRevisions)&&dsf.config.commonForm.wdzt.trackRevisions,e.ActiveDocument.TrackRevisions=n;case 9:case"end":return t.stop()}},t)}))()}}},s=(0,n(51900).Z)(e,function(){this._self._c;return this._m(0)},[function(){var t=this._self._c;return t("div",[t("div",{staticClass:"wps_office",attrs:{id:"wpsOffice"}})])}],!1,null,"390ee662",null).exports}}]);