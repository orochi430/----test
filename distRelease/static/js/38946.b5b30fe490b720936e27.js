"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[38946,16726],{16726:function(t,n,e){e.r(n),e.d(n,{default:function(){return a}});var i=e(5044),s=e(25108),n={filters:{dateFormat:function(t){return t?dsf.date.format(new Date(Number(t)),"hh:ii"):""}},data:function(){return{list:[],refreshing:!1,loading:!1,finished:!1,showPicker:!1,page:1,options:dsf.config.attendance.applications.forms}},computed:{showList:function(){return this.list.map(function(t){return t.title="".concat(t.state,"：").concat(dsf.date.format(t.signTime,"yyyy-mm-dd hh:ii")),t})}},created:function(){},mounted:function(){},methods:{onConfirm:function(t,n){this.showPicker=!1,this.$router.push(dsf.util.getReplaceUrl(t.url))},init:function(){0==this.list.length&&this.onLoad()},onLoad:function(){var e=this;e.refreshing&&(e.list=[],e.page=1,e.refreshing=!1),dsf.http.post("fn/attnd/getMyAbnormalRecords",{page:e.page,count:10}).done(function(t){var n;"success"==t.type?((n=e.list).push.apply(n,(0,i.Z)(t.data.list)),e.page++,e.list.length==t.data.total&&(e.finished=!0)):e.list=null}).error(function(t){e.list=null,s.log("getMyAbnormalRecords-error",t)}).always(function(){e.loading=!1})},onRefresh:function(){var t=this;t.finished=!1,t.loading=!0,t.onLoad()},applyClick:function(n){var e,t,i;1!=n.kqState&&(e=this,(t=null==(t=dsf.config.attendance.applications)||null==(t=t.forms)?void 0:t.find(function(t){return"考勤异常申请"==t.name}))?(i=t.url,dsf.http.get("fn/itas/leave/findUserExceCount",{exdate:n.signTime.split(" ")[0]}).done(function(t){"success"==t.type?t.data?e.$router.push(dsf.util.getReplaceUrl(i,n)):dsf.layer.toast("已超过该月申请次数",!1):dsf.layer.toast(t.message,!1)}).error(function(t){dsf.layer.toast("发生错误，请稍后重试",!1),s.log("findUserExceCount-err",t)})):e.showPicker=!0)}}},a=(0,e(51900).Z)(n,function(){var e=this,i=e._self._c;return i("div",{staticClass:"abnormalities-page"},[e.list?i("div",[i("div",{staticClass:"content"},[i("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[i("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.showList,function(n,t){return i("div",{key:t,staticClass:"flex",class:{done:1==n.kqState}},[i("span",[e._v(e._s(n.title))]),e._v(" "),i("span",{on:{click:function(t){return e.applyClick(n)}}},[e._v(e._s(1==n.kqState?"已申请":"申请"))])])}),0)],1)],1)]):i("commonempty",{attrs:{image:"error",description:"发生错误"}}),e._v(" "),i("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[i("van-picker",{attrs:{columns:e.options,"swipe-duration":300,title:"请选择你的异常处理单","show-toolbar":"","value-key":"name"},on:{cancel:function(t){e.showPicker=!1},confirm:e.onConfirm}})],1)],1)},[],!1,null,"184b640a",null).exports},38946:function(t,n,e){e.r(n),e.d(n,{default:function(){return s}});var n=e(16726),i=e(25108),n={components:{abnormalities:n.default},data:function(){return{loading:null,grids:dsf.config.attendance.applications.grids}},created:function(){},mounted:function(){},methods:{getRecords:function(){var n=this;n.loading=dsf.layer.loading(),dsf.http.get("fn/attnd/getMyAbnormalRecords").done(function(t){"success"==t.type&&(n.list=t.data)}).error(function(t){i.log("getMyAbnormalRecords-error",t)}).always(function(){dsf.layer.closeLoading(n.loading)})}}},s=(0,e(51900).Z)(n,function(){var e=this,i=e._self._c;return i("div",{staticClass:"applications-page"},[i("div",{staticClass:"head"},[i("van-cell",{attrs:{title:"我的申请","title-style":"font-size: var(--font_size_2)",center:""}}),e._v(" "),i("div",[i("van-grid",{attrs:{"column-num":e.dsf.config.attendance.applications.columnNum||4,border:!1,clickable:""}},e._l(e.grids,function(t,n){return i("van-grid-item",{key:n,attrs:{text:t.name,to:t.url},scopedSlots:e._u([{key:"icon",fn:function(){return[i("img",{attrs:{src:t.icon,alt:""}})]},proxy:!0}],null,!0)})}),1)],1)],1),e._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"list-title"},[i("van-cell",{attrs:{title:"异常记录",value:"更多","is-link":"",to:"attndAbnormalities",center:""}})],1),e._v(" "),i("abnormalities")],1)])},[],!1,null,"45ea05c2",null).exports}}]);