"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[41e3],{62705:function(t,e,s){s.r(e),s.d(e,{default:function(){return r}});var e=s(61941),n=s(52974),a=s(56773),o=s(74085),i=s(70423),e={name:"Home",components:{Schedule:e.Z,Squmenu:n.Z,HomeNotice:a.Z,TodoCenter:o.Z,NavSearch:i.Z},created:function(){},activated:function(){},methods:{},deactivated:function(){"commonForm"!=this.$route.name&&this.$destroy()}},r=(0,s(51900).Z)(e,function(){var t=this,e=t._self._c;return e("div",{staticClass:"ds-home"},[t.$store.state.homeTabs?e("div",{staticClass:"menuBox"},[e("nav-search"),t._v(" "),e("Home-notice"),t._v(" "),e("div",{staticClass:"sudokus"},[e("Squmenu")],1),t._v(" "),e("div",{staticClass:"schedule"},[e("Schedule")],1)],1):e("van-sticky",[e("div",{staticClass:"menuBox"},[e("nav-search"),t._v(" "),e("Home-notice"),t._v(" "),e("div",{staticClass:"sudokus"},[e("Squmenu")],1),t._v(" "),e("div",{staticClass:"schedule"},[e("Schedule")],1)],1)]),t._v(" "),e("div",{staticClass:"agency"},[e("TodoCenter")],1)],1)},[],!1,null,"759821de",null).exports},56773:function(t,e,s){s.d(e,{Z:function(){return n}});var e={props:["type"],data:function(){return{unread:!0,isScroll:!0,noticeText:"",noticeList:[]}},created:function(){this.getNoticeList()},methods:{getNoticeList:function(){var n=this;dsf.http.post("fn/mobileNotice/getList",{start:0,limit:6,key:"",homepage:!0}).then(function(t){var s;"200"==t.status?(n.noticeList=t.data.rows,dsf.util.loadLocalStore("noticeList")?(s=dsf.util.loadLocalStore("noticeList")).length===n.noticeList.length&&n.noticeList.some(function(t,e){return t.id===s[e].id})||(dsf.util.saveToLocalStore("isRead","1"),dsf.util.saveToLocalStore("noticeList",n.noticeList)):(dsf.util.saveToLocalStore("noticeList",n.noticeList),dsf.util.saveToLocalStore("isRead","1")),n.noticeList.forEach(function(t,e){e=e!==n.noticeList.length-1?"；":"";n.noticeText+=t.itemsContent+e})):n.dsf.layer.toast(t.message)}).error(function(t){n.dsf.layer.toast(t.message)}).always(function(){n.unread=Boolean(dsf.util.loadLocalStore("isRead"))})},goRoute:function(){this.$router.push({path:"/commonList?fileType=tzgg"}),dsf.util.saveToLocalStore("isRead","")},toForm:function(t){this.$router.push({path:"/commonForm/".concat(t.moduleId,"/").concat(t.info_id,"?method=").concat(t.method,"&listId=").concat(t.listId)})}}},n=(0,s(51900).Z)(e,function(){var s=this,n=s._self._c;return s.noticeList.length?n("div",{staticClass:"ds-notice"},["一条轮播式"==s.type||"轮播式"==s.type?n("div",{staticClass:"card"},[n("div",{staticClass:"top"},[n("span",{staticClass:"title"},[s._v("通知公告")]),s._v(" "),n("span",{staticClass:"more",on:{click:s.goRoute}},[s._v("更多")])]),s._v(" "),n("van-swipe",{attrs:{vertical:"","show-indicators":!1,autoplay:"3000"}},s._l(s.noticeList,function(e){return n("van-swipe-item",{key:e.id,staticClass:"clamp",on:{click:function(t){return s.toForm(e)}}},[s._v(s._s(e.itemsContent))])}),1)],1):"二条轮播式"==s.type?n("div",{staticClass:"card_2",on:{click:s.goRoute}},[n("img",{attrs:{src:"static/images/platform/notice.png",alt:""}}),s._v(" "),n("van-swipe",{attrs:{vertical:"","show-indicators":!1,loop:"",autoplay:"3000",height:48}},s._l(s.noticeList,function(t,e){return e%2==0?n("van-swipe-item",{key:t.id},[n("div",{staticClass:"ellipsis"},[n("span",{staticStyle:{"line-height":"0.48rem"}},[s._v(s._s(s.noticeList[e].itemsContent))])]),s._v(" "),s.noticeList[e+1]?n("div",{staticClass:"ellipsis"},[n("span",{staticStyle:{"line-height":"0.48rem"}},[s._v(s._s(s.noticeList[e+1].itemsContent))])]):s._e()]):s._e()}),1),s._v(" "),n("span",{staticClass:"more flex ac jc"},[n("van-icon",{attrs:{name:"arrow",color:"#fff"}})],1)],1):n("div",{staticClass:"notice"},[n("van-notice-bar",{attrs:{background:"#fff",scrollable:s.isScroll,mode:"link"},on:{click:s.goRoute},scopedSlots:s._u([{key:"left-icon",fn:function(){return[n("i",{staticClass:"iconfont icontongzhigonggao",staticStyle:{color:"var(--normal)","font-size":"0.36rem","margin-right":"0.12rem"}})]},proxy:!0}],null,!1,260246281)},[s._v("\n          "+s._s(s.noticeText)+"\n        ")])],1)]):s._e()},[],!1,null,"302283e6",null).exports},30819:function(t,e,s){s.d(e,{Z:function(){return d}});var e=s(26243),a=s.n(e),e=s(62680),o=s.n(e),e=s(95366),i=s.n(e),e=s(6919),n=s.n(e),r=s(77193),e=s(73473),c=s.n(e);function l(e,t){var s,n=a()(e);return o()&&(s=o()(e),t&&(s=s.filter(function(t){return i()(e,t).enumerable})),n.push.apply(n,s)),n}var e={name:"WorkFlowDialog",props:{formData:{type:Object,default:function(){return{}}},metaData:{type:Object,default:function(){return{}}}},data:function(){return{text:"退回",message:"",showDialog:!1,submitAfter:function(){},h:0,isNeedWrite:dsf.config.setting["SYS-FLOW-0038"]||0,personSelectData:[],secPeo:!1,columns:[],SendRequest:{}}},created:function(){},mounted:function(){},computed:{isShowUser:function(){return 1<this.columns.length||dsf.config.commonFlow.onePersonBackIsShow}},methods:{cancel:function(){this.showDialog=!1,this.h=0,this.$emit("close")},sendBack:function(){var e=this,t={pid:this.formData.pid||this.formData.pId,pnid:this.formData.pnid||this.formData.pnId,wfId:this.formData.flowId,backReason:this.message},s=dsf.layer.loading(this.text+"中");dsf.http.post("/fn/mobileFlow/sendBack",t).then(function(t){dsf.layer.closeLoading(s),e.dsf.layer.toast(e.text+"成功",!0),e.cancel(),setTimeout(function(){e.$emit("change")},100)})},sendBackNew:function(){var e,t,s=this,n=!0;s.metaData.buttons.mainButtons.some(function(t){"NoopinionBack"==t.action&&(n=!1)}),""==s.message.trim()&&1==s.isNeedWrite&&1==n?dsf.layer.toast("请输入退回原因"):s.personSelectData.length<1&&s.isShowUser?dsf.layer.toast("请选择退回人员"):(e=dsf.layer.loading(s.text+"中"),t={TPID:s.SendRequest.tpid,CurLinkID:s.personSelectData[0].LinkID,WFID:s.SendRequest.wfid,backType:1,Remark:s.message,inherit:"",MultSendBackMod:s.SendRequest.multSendBackMod,IsMergeTodo:s.SendRequest.isMergeTodo,NGR:0,SendBackTo:s.SendRequest.sendBackTo},dsf.http.post("/fn/flow/submitSendBackNode",t).then(function(t){dsf.layer.closeLoading(e),s.dsf.layer.toast(s.text+"成功",!0),s.cancel(),setTimeout(function(){s.$emit("change")},100)}))},show:function(t){var s=this,t=t.text,e=(this.personSelectData=[],{pId:this.metaData.parameters?this.metaData.parameters.pId:this.formData.pid||this.formData.pId,flowId:(this.metaData.parameters||this.formData).flowId,pk:this.metaData.parameters?this.metaData.parameters.pk:this.formData.info_d||this.formData.info_id,pnId:this.metaData.parameters?this.metaData.parameters.pnId:this.formData.pnid||this.formData.pnId});return dsf.http.get("fn/flow/getGPNodeProcess",e).then(function(t){var e,t=t.data;"200"==t.code&&(e=[],s.SendRequest=t.data.SendRequest,t.data.processArray.forEach(function(t){e.push(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach(function(t){(0,r.Z)(e,t,s[t])}):n()?Object.defineProperties(e,n()(s)):l(Object(s)).forEach(function(t){Object.defineProperty(e,t,i()(s,t))})}return e}({text:t.Sender.UserName+"(".concat(t.PARENT_NODENAME,")")},t))}),s.columns=e,1==s.columns.length&&(s.personSelectData=e),s.initHeight())}),this.text=t||"",this.message="退回"==t&&dsf.config.setting["SYS-MOBILE-FORM-0005"]||"",this.showDialog=!0,new(c())(function(t){s.submitAfter=t})},initHeight:function(){var t=this;this.$nextTick(function(){t.isShowUser?t.h=t.$refs.content.offsetHeight-270:t.h=t.$refs.content.offsetHeight-160})},close:function(){this.showDialog=!1,this.h=0},showPersonModel:function(){this.secPeo=!this.secPeo},onConfirm:function(t){this.personSelectData=[],this.personSelectData.push(t),this.showPersonModel()},closePerson:function(t,e){this.personSelectData.splice(e,1)},submitFun:function(){this.submitAfter(),this.text,this.sendBackNew()}}},d=(0,s(51900).Z)(e,function(){var n=this,t=n._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:n.showDialog,expression:"showDialog"}],staticClass:"ds-workflow_dialog"},[t("div",{staticClass:"header"},[t("van-nav-bar",{attrs:{title:n.text+"理由","left-text":"取消"},on:{"click-left":function(t){return n.cancel()}}})],1),n._v(" "),t("div",{ref:"content",staticClass:"content"},[n.isShowUser?t("div",{ref:"user",staticClass:"sheetBox"},[t("p",{staticClass:"reasonLabel"},[n._v("退回人员")]),n._v(" "),t("div",{staticClass:"disfr ac",staticStyle:{padding:"10px 0"}},[t("div",{staticClass:"peopleSec disfr ac flex1"},[n._l(n.personSelectData,function(e,s){return t("van-tag",{key:s,attrs:{closeable:"",size:"large",type:"primary"},on:{close:function(t){return n.closePerson(e,s)}}},[n._v("\n            "+n._s(e.text)+"\n          ")])}),n._v("\n            \n        ")],2),n._v(" "),t("van-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"default"},on:{click:n.showPersonModel}},[n._v("选择人员")])],1),n._v(" "),t("p",{staticClass:"reasonLabel",staticStyle:{"margin-bottom":"0.2rem"}},[n._v("退回原因")])]):n._e(),n._v(" "),t("van-field",{ref:"reason",staticClass:"reason",attrs:{rows:"5",type:"textarea",placeholder:"请输入"+n.text+"理由",border:""},model:{value:n.message,callback:function(t){n.message=t},expression:"message"}})],1),n._v(" "),t("div",{staticClass:"footer"},[t("van-button",{attrs:{type:"theme",block:""},on:{click:n.submitFun}},[n._v("确认"+n._s(n.text))])],1),n._v(" "),t("van-popup",{style:{height:"50vh"},attrs:{position:"bottom",round:""},model:{value:n.secPeo,callback:function(t){n.secPeo=t},expression:"secPeo"}},[t("div",{staticStyle:{width:"100%"}},[t("van-picker",{attrs:{title:"请选择退回人员","show-toolbar":"",columns:n.columns},on:{confirm:n.onConfirm,cancel:n.showPersonModel}})],1)])],1)},[],!1,null,"447cfcb4",null).exports},70423:function(t,e,s){s.d(e,{Z:function(){return a}});var e=s(8450),n=s.n(e),e={name:"NavSearch",data:function(){return{keyWords:""}},methods:{emptyEvent:function(){},usericonEvent:function(){},qrcodeEvent:function(){var e=this;dsf.dd.scan(function(t){e.dsf.layer.toast(n()(t))},function(t){alert(n()(t))})}}},a=(0,s(51900).Z)(e,function(){var t=this._self._c;return t("div",{staticClass:"search-wrap"},[t("router-link",{staticClass:"search",attrs:{to:"/commonList/200827143925vksrrlGEd1ZTyiwa7tm/200826154812jQpt0dBmNzZXaNnLhTR"}},[t("i",{staticClass:"iconfont iconsousuo i1"}),this._v(" "),t("span",[this._v("搜索文件")])])],1)},[],!1,null,null,null).exports},61941:function(t,e,s){s.d(e,{Z:function(){return n}});var i=s(5044),e={name:"Schedule",data:function(){return{hasSch:[],today:"5月4日",next:"5月8日",list:[],scheduleListUrl:dsf.config.homePage.schedule.scheduleList}},created:function(){this.initData()},methods:{clickBar:function(){dsf.config.homePage&&dsf.config.homePage.schedule&&dsf.config.homePage.schedule.scheduleDetailUrl?this.$router.push(dsf.config.homePage.schedule.scheduleDetailUrl):this.$router.push({name:"ScheduleCenter"})},initData:function(){var o=this,t={sdate:moment(new Date).format("YYYY-MM-DD"),edate:moment(new Date).format("YYYY-MM-DD"),count:3,type:"personal"};this.hasSch=[],this.list=[],this.dsf.http.get(this.scheduleListUrl,t).then(function(t){"success"===t.data.type&&t.data.data.forEach(function(t){if(t.schedule&&0<t.schedule.length){var e,s=moment(t.date).format("MM-DD");if(o.hasSch.push(s),3==o.hasSch.length)if(o.hasSch[0]==o.hasSch[1]&&o.hasSch[1]==o.hasSch[2])o.hasSch[1]=o.hasSch[2]="";else for(var n=0;n<o.hasSch.length;n++)for(var a=n+1;a<o.hasSch.length;a++)o.hasSch[n]==o.hasSch[a]&&(o.hasSch[a]="");else if(2==o.hasSch.length)for(n=0;n<o.hasSch.length;n++)for(a=n+1;a<o.hasSch.length;a++)o.hasSch[n]==o.hasSch[a]&&(o.hasSch[a]="");t.schedule.map(function(t){t.date=s}),(e=o.list).push.apply(e,(0,i.Z)(t.schedule))}})}).error(function(t){})}}},n=(0,s(51900).Z)(e,function(){var s=this,n=s._self._c;return n("div",{directives:[{name:"show",rawName:"v-show",value:s.list&&0<s.list.length,expression:"list && list.length > 0"}],staticClass:"box notice-bar",on:{click:s.clickBar}},[n("div",{staticClass:"dsf-info-panel ds_control"},[n("div",{staticClass:"dsf-info-panel-title-box"},[n("div",{staticClass:"dsf-info-panel-title ellipsis flex jb ac"},[n("div",{staticClass:"dsf-info-panel-title-line"}),s._v(" "),n("span",[s._v("日程中心")]),s._v(" "),n("van-icon",{staticClass:"dsf-right-icon",attrs:{name:"arrow"}})],1)]),s._v(" "),n("div",{staticClass:"notic_content flex jb ac"},[3==s.hasSch.length?n("div",{staticClass:"right ja ac dc"},s._l(s.hasSch,function(t,e){return n("p",{key:e,class:{today:0==e,next:0!=e,three:2==e}},[s._v(s._s(t))])}),0):2==s.hasSch.length?n("div",{staticClass:"right ja ac dc pd"},s._l(s.hasSch,function(t,e){return n("p",{key:e,class:{today:0==e,next:0!=e}},[s._v(s._s(t))])}),0):n("div",{staticClass:"right ja ac flex dc"},s._l(s.hasSch,function(t,e){return n("p",{key:e,class:{today:0==e,next:0!=e}},[s._v(s._s(t))])}),0),s._v(" "),n("div",{staticClass:"left"},s._l(s.list,function(t,e){return e<3?n("p",{key:e,staticClass:"van-ellipsis"},[n("span",{staticClass:"point"}),s._v(" "),n("span",[s._v(s._s(t.time)+" "+s._s(t.content))])]):s._e()}),0)])])])},[],!1,null,"449f2a3f",null).exports},46385:function(t,e,s){s.r(e),s.d(e,{default:function(){return r}});var n=s(66250),e=s(73473),c=s.n(e),e=s(8450),i=s.n(e),e=s(33453),l=s.n(e),e=s(70680),a=s(18868),o=s(63450),d=s(25108),e={name:"SeparateRead",components:{controlUserTree:e.default,DebounceClick:a.Z,controlUserList:o.default},props:{separateTabs:{type:Array,default:function(){return[]}},formParams:{type:Object,default:function(){return{}}},nowButtonParameters:{type:Object,default:function(){return{}}}},data:function(){return{result:[],resolve:function(){},reject:function(){},isShow1:!1,isShow2:!1,opinionList:[],message:"",optionValue:"",nowList:[],showList1:[],organizeList:[],userList:[],privateData:[],data:{},selectList:[],personSelectData:"",oldV:[],selectArr:[],selectParent:[],selectChild:[],type:0,extra:{multiple:!0,filterSelf:"-1"==dsf.config.setting["SYS-FY-0012"],tabs:[]},tab:"",defaultSelectArray:[],smsContent:""}},created:function(){var s=this;return(0,n.Z)(l().mark(function t(){var e;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.getTabs();case 2:e=dsf.config.setting["SYS-FY-0010"]||[],s.separateTabs&&s.separateTabs.length?s.extra.tabs=s.separateTabs:e.length?s.extra.tabs=JSON.parse(e).filter(function(t){return"角色"!=t.name}):s.extra.tabs={multiple:!0,filterSelf:"-1"==dsf.config.setting["SYS-FY-0012"],tabs:[{action:"fn/user/select/data?types=person&rootObject=1&action=self_dept&async=true",name:"本部门",subTabKey:"department"},{action:"fn/user/select/data?types=person&rootObject=1&action=self_org&async=true",name:"本机构",subTabKey:"department"},{name:"群组",action:"fn/user/select/data?types=person,department,post,privateGroup,own_group&rootObject=2&action=private_group&async=true&source=share",subTabKey:"department"}]};case 4:case"end":return t.stop()}},t)}))()},methods:{getTabs:function(){var o=this;return new(c())(function(a,t){try{dsf.http.post("/fn/mobileToRead/mobileShareInfo",{selectedTabs:o.nowButtonParameters.selectedTabs||"",pk:o.formParams.pk,moduleId:o.formParams.moduleId,distribId:o.formParams.distribId||""}).then(function(t){var e,s,n;200==t.data.code&&(dsf.config.setting["SYS-FY-0010"]=i()(t.data.data.tabs),e=/\[(.+?)\]/g,s=t.data.data.fySmsContent,n={"分阅用户":dsf.util.loadSessionStore("user").name,"分阅时间":moment().format("YYYY-MM-DD HH:mm:ss"),"模块名称":o.data.moduleName,"文件标题":o.data.bt,"分阅意见":o.optionValue},s.match(e)&&s.match(e).forEach(function(t){var e=t.replace("[","").replace("]","");n[e]&&(s=s.replace(t,n[e]))}),o.smsContent=s),a()})}catch(t){a()}})},show:function(t,e){var s=this;return this.data=t,this.defaultSelectArray=e,this.getAdvice(),1==this.nowButtonParameters.opinion?this.isShow1=!0:this.isShow2=!0,new(c())(function(t,e){s.resolve=t,s.reject=e})},cancel1:function(){this.isShow1=!1,this.reject("流程被中断")},cancel2:function(){this.isShow2=!1},send:function(){this.isShow2=!0},getAdvice:function(){var e=this;dsf.http.get("fn/mobileUsedOpinion/find").then(function(t){e.opinionList=t.data.rows})},addAdvice:function(){var t=this;""===this.optionValue?dsf.layer.toast("请输入内容"):dsf.http.post("fn/mobileUsedOpinion/add",{__DATA:i()({opinion:this.optionValue})}).then(function(){t.getAdvice()})},deleteAdvice:function(t){var e=this;this.$dialog.confirm({title:"提示",message:"确定要删除吗？"}).then(function(){dsf.http.get("fn/mobileUsedOpinion/delete?id="+t.id).then(function(){e.getAdvice()})})},writeAdvice:function(t){this.optionValue=this.optionValue+t,this.$forceUpdate()},addReadSure:function(i){var r=this;return(0,n.Z)(l().mark(function t(){var s,n,a,o,e;return l().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n=s="",o=[],i.forEach(function(t,e){e=e?",":"";s+="".concat(e).concat(t.type,"::").concat(t.id),n+=(5==t.type?"".concat(e):"".concat(e).concat(t.attrs.realDeptId||t.pid,"-")).concat(t.id),a+=(5==t.type?"".concat(e):"".concat(e).concat(t.attrs.orgNameLV2Text||t.attrs.orgNameLV1Text,"-")).concat(t.name),5==t.type&&o.push(t.name)}),o.length)return t.next=6,new(c())(function(t,e){dsf.layer.confirm({title:"提示",message:"是否确认分阅给【".concat(o.join(","),"】内所有人员？")},function(){t()})});t.next=6;break;case 6:if(e={infoId:r.data.info_id,userIds:n,userNames:a,schemaVals:s,distribId:r.data.distribId||"",canRedistrib:1,infoType:r.data.infoType||"",infoTypeText:r.data.infoTypeText||"",shareContent:r.optionValue,shareList:"",isSms:r.result.find(function(t){return"isSms"==t})?"1":"-1",smsContent:"",reShare:0,isEndSms:r.result.find(function(t){return"isEndSms"==t})?"1":"-1"},r.data.distribId&&"0"!=r.data.distribId&&(e.reShare=1),""===e.userIds)return dsf.layer.toast("请选择人员"),t.abrupt("return");t.next=11;break;case 11:r.isShow1=!1,r.isShow2=!1,d.log(e),dsf.layer.loading(),dsf.http.post("fn/mobileToReadOperation/toShare",e).then(function(e){dsf.layer.clear(),dsf.layer.toast(e.data.message,!0),r.data.distribId&&"0"!=r.data.distribId&&dsf.config.commonForm.toShareAndRead?dsf.http.post("fn/mobileToReadOperation/readed",{infoIds:r.data.info_id,distribIds:r.data.distribId}).then(function(t){r.resolve(e.data.message)}):r.resolve(e.data.message)});case 16:case"end":return t.stop()}},t)}))()},closePopup:function(){this.$emit("close")}}},r=(0,s(51900).Z)(e,function(){var n=this,t=n._self._c;return t("div",{staticClass:"ds-separate-read"},[t("van-popup",{attrs:{position:"bottom"},on:{closed:n.closePopup},model:{value:n.isShow1,callback:function(t){n.isShow1=t},expression:"isShow1"}},[t("div",{staticClass:"header"},[t("van-nav-bar",{attrs:{title:"分阅意见","left-text":"取消"},on:{"click-left":n.cancel1}})],1),n._v(" "),t("div",{staticClass:"body"},[t("van-field",{attrs:{rows:"4",type:"textarea",placeholder:"请输入分阅意见",autosize:""},model:{value:n.optionValue,callback:function(t){n.optionValue=t},expression:"optionValue"}}),n._v(" "),t("div",{staticClass:"tag-box"},[t("div",{staticClass:"tag-list"},n._l(n.opinionList,function(e,s){return t("div",{key:s,staticClass:"tag-item"},[t("div",{staticClass:"tag-item-text",on:{click:function(t){return n.writeAdvice(e.context)}}},[n._v("\n              "+n._s(e.context)+"\n            ")]),n._v(" "),t("div",{staticClass:"tag-item-bt",on:{click:function(t){return n.deleteAdvice(e,s)}}},[t("van-icon",{attrs:{name:"cross"}})],1)])}),0),n._v(" "),t("van-button",{attrs:{icon:"plus",size:"small",plain:""},on:{click:n.addAdvice}},[n._v("新增模板")])],1),n._v(" "),t("div",{staticClass:"sms-container"},[t("van-checkbox-group",{attrs:{direction:"horizontal"},model:{value:n.result,callback:function(t){n.result=t},expression:"result"}},[t("van-checkbox",{attrs:{name:"isSms"}},[n._v("是否提醒")]),n._v(" "),t("van-checkbox",{attrs:{name:"isEndSms"}},[n._v("阅闭是否提醒")])],1),n._v(" "),t("van-field",{directives:[{name:"show",rawName:"v-show",value:n.result.find(function(t){return"isSms"==t}),expression:"result.find(item => item == 'isSms')"}],attrs:{rows:"4",autosize:"",type:"textarea",placeholder:"请输入提醒内容"},model:{value:n.smsContent,callback:function(t){n.smsContent=t},expression:"smsContent"}})],1)],1),n._v(" "),t("div",{staticClass:"footer"},[t("van-button",{attrs:{type:"theme"},on:{click:n.send}},[n._v("选择人员")])],1)]),n._v(" "),t("van-popup",{ref:"container",style:{height:"100%"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:n.isShow2,callback:function(t){n.isShow2=t},expression:"isShow2"}},[t("control-user-list",{attrs:{extra:n.extra,"default-select-array":n.defaultSelectArray},on:{close:n.cancel2,getSelectUser:n.addReadSure}})],1)],1)},[],!1,null,"7e65ecea",null).exports},38496:function(t,e,s){s.r(e),s.d(e,{default:function(){return r}});var e=s(73473),n=s.n(e),e=s(63560),a=s(18868),o=s(88561),i=s(25108),e={name:"SignFile",components:{selectPerson:e.default,DebounceClick:a.Z},data:function(){return{isShow:!1,resolve:function(){},reject:function(){},data:{deptBaoming:!0},showPerson:!1,userInfo:{},joinPersons:[],joinPersonIds:"",joinPerson:"",congressPersons:[],congressPersonIds:"",congressPerson:"",leaveReason:"",isAttend:!0,isJoin:!0,attendMeetingUrl:dsf.config.meetingConfig.attendMeetingUrl,extra:{}}},watch:{isAttend:function(){this.isJoin=!this.isJoin,this.showPerson=!1}},methods:{init:function(){var t=o.Z.loadSessionStore("user"),t=(this.userInfo=t,[]),e=[];this.data=null,this.showPerson=!1,this.joinPersons=t,this.joinPersonIds=0<t.length?t[0].id:"",this.joinPerson=0<t.length?t[0].name:"",this.congressPersons=e,this.congressPersonIds=0<e.length?e[0].id:"",this.congressPerson=0<e.length?e[0].name:"",this.leaveReason="",this.isAttend=!0,this.isJoin=!0},show:function(t){var s=this;return this.init(),this.data=t,i.log(this.data),this.isShow=!0,new(n())(function(t,e){s.resolve=t,s.reject=e})},cancel:function(){this.isShow=!1,this.reject("流程被中断")},submit:function(){var e=this,t={meetingtzId:this.data.meetingtzId,pk:this.data.pk,pnId:this.data.pnId,attendance:this.isAttend?"1":"-1",leaveReason:this.leaveReason,"x-auth-token":o.Z.loadSessionStore("loginToken"),requestEnv:"mobile"};if(this.data.deptBaoming?t.attendType=2:t.attendType=1,this.isAttend){if(this.data.deptBaoming||(this.joinPersons=[this.userInfo.name],this.joinPerson=this.userInfo.name,this.joinPersonIds=this.userInfo.user_id),!this.joinPersons.length)return void dsf.layer.toast("请选择参会人员");t.userName=this.joinPerson,t.userId=this.joinPersonIds}else{if(!this.congressPersons.length&&this.data.deptBaoming)return void dsf.layer.toast("请选择代会人员");if(!this.leaveReason.length)return void dsf.layer.toast("请填写请假理由");t.userName=this.congressPerson,t.userId=this.congressPersonIds}var s=dsf.layer.loading();dsf.http.post(this.attendMeetingUrl,t).done(function(t){"200"===t.code?(e.isShow=!1,e.resolve(t),e.isAttend=!0,e.isJoin=!0):dsf.layer.toast("请求异常")}).error(function(){dsf.layer.toast("请求异常")}).always(function(){dsf.layer.closeLoading(s)})},getUserNames:function(t){var e=[],s=[],t=t.map(function(t){return e.push(t.name),s.push(t.attrs.idValue),{id:t.attrs.idValue,pid:t.attrs.pidValue,name:t.name}});return{names:e.join(","),ids:s.join(","),persons:t}},getSelectUser:function(s){var t,e,n;0<s.length?(s.forEach(function(t,e){t.children&&0<t.children.length&&s.splice(e,1)}),t=(n=this.getUserNames(s)).names,e=n.ids,n=n.persons,this.isAttend?(this.joinPerson=t,this.joinPersonIds=e,this.joinPersons=n):(this.congressPerson=t,this.congressPersonIds=e,this.congressPersons=n)):(this.joinPerson="",this.joinPersonIds="",this.joinPersons="",this.congressPerson="",this.congressPersonIds="",this.congressPersons="")}}},r=(0,s(51900).Z)(e,function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-sign-file"},[t("van-popup",{staticClass:"ds-sign-file-pop",attrs:{position:"bottom","get-container":"#app",round:""},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[t("div",{staticClass:"header"},[t("van-nav-bar",{attrs:{title:"报名","left-text":"取消"},on:{"click-left":e.cancel}})],1),e._v(" "),e.data.deptBaoming?t("div",{staticClass:"body"},[t("div",{staticClass:"join"},[t("label",{attrs:{for:""}},[e._v("是否出席:")]),e._v(" "),t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.isAttend,callback:function(t){e.isAttend=t},expression:"isAttend"}},[t("van-radio",{attrs:{name:!0,shape:"square"}},[e._v("出席")]),e._v(" "),t("van-radio",{attrs:{name:!1,shape:"square"}},[e._v(e._s("请假/委托"))])],1)],1),e._v(" "),e.isJoin?t("div",{staticClass:"confrence"},[t("van-field",{attrs:{readyonly:"","input-align":"left",label:"参会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(t){e.showPerson=!0}},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[t("label",{staticClass:"mast-input"}),e._v("参会人员:\n            ")])]},proxy:!0}],null,!1,1705578387),model:{value:e.joinPerson,callback:function(t){e.joinPerson=t},expression:"joinPerson"}})],1):t("div",{staticClass:"congressPerson"},[t("van-field",{attrs:{readonly:!0,"input-align":"left",label:"代会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(t){e.showPerson=!0}},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[t("label",{staticClass:"mast-input"}),e._v("代会人员：\n            ")])]},proxy:!0}],null,!1,3628413746),model:{value:e.congressPerson,callback:function(t){e.congressPerson=t},expression:"congressPerson"}})],1),e._v(" "),t("van-field",{directives:[{name:"show",rawName:"v-show",value:!e.isJoin,expression:"!isJoin"}],attrs:{rows:"4",autosize:"",label:"请假理由:",type:"textarea",placeholder:"请输入请假理由"},model:{value:e.leaveReason,callback:function(t){e.leaveReason=t},expression:"leaveReason"}})],1):t("div",{staticClass:"body"},[t("div",{staticClass:"join"},[t("label",{attrs:{for:""}},[e._v("是否出席:")]),e._v(" "),t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.isAttend,callback:function(t){e.isAttend=t},expression:"isAttend"}},[t("van-radio",{attrs:{name:!0,shape:"square"}},[e._v("出席")]),e._v(" "),t("van-radio",{attrs:{name:!1,shape:"square"}},[e._v(e._s("请假/委托"))])],1)],1),e._v(" "),e.isJoin?e._e():t("div",{staticClass:"confrence"},[t("van-field",{attrs:{readonly:!0,"input-align":"left",label:"代会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(t){e.showPerson=!0}},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[t("label",{staticClass:"mast-input"}),e._v("代会人员：\n            ")])]},proxy:!0}],null,!1,3628413746),model:{value:e.congressPerson,callback:function(t){e.congressPerson=t},expression:"congressPerson"}})],1),e._v(" "),t("van-field",{directives:[{name:"show",rawName:"v-show",value:!e.isJoin,expression:"!isJoin"}],attrs:{rows:"4",autosize:"",label:"请假理由:",type:"textarea",placeholder:"请输入请假理由"},model:{value:e.leaveReason,callback:function(t){e.leaveReason=t},expression:"leaveReason"}})],1),e._v(" "),t("div",{staticClass:"footer"},[t("debounce-click",[t("van-button",{attrs:{type:"theme"},on:{click:e.submit}},[e._v("提交")])],1)],1)]),e._v(" "),t("van-popup",{style:{height:"90%"},attrs:{"close-on-click-overlay":!1,position:"bottom","get-container":"#app",round:""},model:{value:e.showPerson,callback:function(t){e.showPerson=t},expression:"showPerson"}},[e.showPerson?t("selectPerson",{attrs:{extra:e.extra,type:0},on:{getSelectUser:e.getSelectUser,cancePerson:function(t){e.showPerson=!1}}}):e._e()],1)],1)},[],!1,null,null,null).exports},91369:function(t,e,s){s.r(e),s.d(e,{default:function(){return i}});var e=s(73473),n=s.n(e),e=s(63560),a=s(88561),o=s(25108),e={name:"SignFilePerson",components:{selectPerson:e.default},data:function(){return{isShow:!1,resolve:function(){},reject:function(){},data:{deptBaoming:!0},showPerson:!1,userInfo:{},joinPersons:[],joinPersonIds:"",joinPerson:"",congressPersons:[],congressPersonIds:"",congressPerson:"",leaveReason:"",isAttend:!0,attendance:1,isJoin:!0}},watch:{isAttend:function(){this.isJoin=!this.isJoin,this.showPerson=!1},attendance:function(t){}},methods:{init:function(){var t=a.Z.loadSessionStore("user"),t=(this.userInfo=t,[]),e=[];this.data=null,this.showPerson=!1,this.joinPersons=t,this.joinPersonIds=0<t.length?t[0].id:"",this.joinPerson=0<t.length?t[0].name:"",this.congressPersons=e,this.congressPersonIds=0<e.length?e[0].id:"",this.congressPerson=0<e.length?e[0].name:"",this.leaveReason="",this.isAttend=!0,this.isJoin=!0},show:function(t){var s=this;return this.init(),this.data=t,o.log(this.data),this.isShow=!0,new(n())(function(t,e){s.resolve=t,s.reject=e})},cancel:function(){this.isShow=!1,this.reject("流程被中断")},submit:function(){var e=this,t={meetingtzId:this.data.meetingtzId,pk:this.data.pk,pnId:this.data.pnId,attendance:this.attendance,leaveReason:this.leaveReason,"x-auth-token":a.Z.loadSessionStore("loginToken"),requestEnv:"mobile"};if(this.data.deptBaoming?t.attendType=2:t.attendType=1,-1!=this.attendance||this.leaveReason.length){if(2==this.attendance){if(!this.congressPersons.length)return void dsf.layer.toast("请选择代会人员");t.userName=this.congressPerson,t.userId=this.congressPersonIds}var s=dsf.layer.loading();dsf.http.post("fn/MeetingMobile/attendMeeting",t).done(function(t){"200"===t.code?(e.isShow=!1,e.resolve(t),e.isAttend=!0,e.isJoin=!0):dsf.layer.toast(t.message)}).error(function(){dsf.layer.toast(res.message)}).always(function(){dsf.layer.closeLoading(s)})}else dsf.layer.toast("请填写请假理由")},getUserNames:function(t){var e=[],s=[],t=t.map(function(t){return e.push(t.name),s.push(t.attrs.idValue),{id:t.attrs.idValue,pid:t.attrs.pidValue,name:t.name}});return{names:e.join(","),ids:s.join(","),persons:t}},getSelectUser:function(s){var t,e,n;0<s.length?(s.forEach(function(t,e){t.children&&0<t.children.length&&s.splice(e,1)}),t=(n=this.getUserNames(s)).names,e=n.ids,n=n.persons,this.congressPerson=t,this.congressPersonIds=e,this.congressPersons=n):(this.joinPerson="",this.joinPersonIds="",this.joinPersons="",this.congressPerson="",this.congressPersonIds="",this.congressPersons="")}}},i=(0,s(51900).Z)(e,function(){var e=this,t=e._self._c;return t("div",{staticClass:"ds-sign-file"},[t("van-popup",{staticClass:"ds-sign-file-pop",attrs:{position:"bottom","get-container":"#app",round:""},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}},[t("div",{staticClass:"header"},[t("van-nav-bar",{attrs:{title:"报名","left-text":"取消"},on:{"click-left":e.cancel}})],1),e._v(" "),t("div",{staticClass:"body"},[t("div",{staticClass:"join"},[t("label",{attrs:{for:""}},[e._v("是否出席:")]),e._v(" "),t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.attendance,callback:function(t){e.attendance=t},expression:"attendance"}},[t("van-radio",{attrs:{name:1,shape:"square"}},[e._v("出席")]),e._v(" "),t("van-radio",{attrs:{name:-1,shape:"square"}},[e._v(e._s("请假"))]),e._v(" "),t("van-radio",{attrs:{name:2,shape:"square"}},[e._v(e._s("委托"))])],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:2==e.attendance,expression:"attendance==2"}],staticClass:"confrence"},[t("van-field",{attrs:{readonly:!0,"input-align":"left",label:"代会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(t){e.showPerson=!0}},scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[t("label",{staticClass:"mast-input"}),e._v("代会人员：\n            ")])]},proxy:!0}]),model:{value:e.congressPerson,callback:function(t){e.congressPerson=t},expression:"congressPerson"}})],1),e._v(" "),t("van-field",{directives:[{name:"show",rawName:"v-show",value:-1==e.attendance,expression:"attendance==-1"}],attrs:{rows:"4",autosize:"",label:"请假理由:",type:"textarea",placeholder:"请输入请假理由"},model:{value:e.leaveReason,callback:function(t){e.leaveReason=t},expression:"leaveReason"}})],1),e._v(" "),t("div",{staticClass:"footer"},[t("van-button",{attrs:{type:"theme"},on:{click:e.submit}},[e._v("提交")])],1)]),e._v(" "),t("van-popup",{style:{height:"90%"},attrs:{"close-on-click-overlay":!1,position:"bottom","get-container":"#app",round:""},model:{value:e.showPerson,callback:function(t){e.showPerson=t},expression:"showPerson"}},[t("selectPerson",{attrs:{type:0},on:{getSelectUser:e.getSelectUser,cancePerson:function(t){e.showPerson=!1}}})],1)],1)},[],!1,null,null,null).exports}}]);