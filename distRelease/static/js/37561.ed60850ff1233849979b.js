"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[37561],{67509:function(t,e,n){n.r(e);var E=n(73473),s=n.n(E),E=n(62207),I=n.n(E),E=n(79529),r=n.n(E),o=n(25108),E={},i=[];E.handle=function(t,e){},E.initHandle=function(n,t,E){E.$bus.on("subFormTreeSelect",function(t){t.selectArr.forEach(function(e,t){n.multinfos["221108103007d7rD3D4x1CAoIt2YmCb"].rows.find(function(t){return t.B0003.value==e.attrs.wh&&"Deleted"!=t.action})?o.log("有重复"):E.$refs.formTab[0].$refs["221108103007d7rD3D4x1CAoIt2YmCb"][0].$refs.subform.addCard(!1).then(function(t){E.$set(t,"B0003",{value:e.attrs.wh}),E.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0001",{value:e.id,text:e.name}),E.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0002",{value:e.attrs.category,text:e.attrs.categoryText}),E.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0003",{value:e.attrs.goodsUnit}),E.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0005",{value:e.attrs.unitPrice}),E.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0007",{value:0}),E.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0006",{value:e.attrs.stockCount})})})}),E.$bus.on("blurBus",function(t){var e;o.log(t),"C-OFFICESUPPLIES-RECEIVE-GOODS-0007"==t.metaData.metaId&&"221108103007d7rD3D4x1CAoIt2YmCb"==t.subFormId&&(t=(e=n.multinfos["221108103007d7rD3D4x1CAoIt2YmCb"].rows[t.subFormIndex])["C-OFFICESUPPLIES-RECEIVE-GOODS-0005"].value*t.value,E.$set(e,"C-OFFICESUPPLIES-RECEIVE-GOODS-0008",{value:t.toFixed(2)}))})},E.custom1=function(t,e,n){var E,o,C,u;0!=t.main.A0009.value?n.btnAction("send"):(E=!0,o=[],i=[],0==t.multinfos["221108103007d7rD3D4x1CAoIt2YmCb"].rows.filter(function(t){return"Deleted"!=t.action}).length?dsf.layer.toast("请选择领用物品"):(t.multinfos["221108103007d7rD3D4x1CAoIt2YmCb"].rows.forEach(function(t){"Deleted"!=t.action&&(0==t["C-OFFICESUPPLIES-RECEIVE-GOODS-0007"].value?(E=!1,o.push(t["C-OFFICESUPPLIES-RECEIVE-GOODS-0001"].text)):i.push(t["C-OFFICESUPPLIES-RECEIVE-GOODS-0001"].value))}),E?(C=t,u=n,new(s())(function(e,n){var o=[],a=!1;dsf.http.post("ctrl/officeSupplies/getCurrentGoodsInfo",{goodsIds:i.join(",")}).then(function(t){var E=t.data.data;C.multinfos["221108103007d7rD3D4x1CAoIt2YmCb"].rows.forEach(function(t){var e,n;"Deleted"!=t.action&&((e=E[t["C-OFFICESUPPLIES-RECEIVE-GOODS-0001"].value])&&e.isValid&&"-1"!=e.isValid?(n=t["C-OFFICESUPPLIES-RECEIVE-GOODS-0005"].value,I()(n)!=I()(e.unitPrice)&&(a=!!1,u.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0005",{value:e.unitPrice})),n=t["C-OFFICESUPPLIES-RECEIVE-GOODS-0006"].value,r()(n)!=r()(e.stockCount)&&(a=!!1,u.$set(t,"C-OFFICESUPPLIES-RECEIVE-GOODS-0006",{value:e.stockCount}))):o.push(e.bt))}),0<o.length?n(o.join("、")+"领用受限，请领用其他物品"):a?n("单价或库存数量与实际不一致，请重新提交"):e()})}).then(function(){n.btnAction("send")}).catch(function(t){dsf.layer.toast(t)})):dsf.layer.toast(o.join(",")+"申请数量需要大于0")))},E.saveFilter=function(a,t,e){return new(s())(function(e,n){var E=!0,o=[];dsf.http.post("ctrl/officeSupplies/getNegativeNumberConfig").then(function(t){"success"==t.data.type&&0==t.data.data&&a.multinfos["221108103007d7rD3D4x1CAoIt2YmCb"].rows.forEach(function(t){var e=t["C-OFFICESUPPLIES-RECEIVE-GOODS-0006"].value,n=t["C-OFFICESUPPLIES-RECEIVE-GOODS-0007"].value,t=t["C-OFFICESUPPLIES-RECEIVE-GOODS-0001"].text;r()(n)>r()(e)&&(o.push(t),E=!1)}),E?e():n(o.join(",")+"的领用数量已超出库存数量")})})},E.saveAfterAsync=function(t,e,n){},e.default=E}}]);