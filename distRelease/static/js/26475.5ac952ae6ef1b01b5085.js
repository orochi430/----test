"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[26475],{26475:function(t,n,e){e.r(n),e.d(n,{default:function(){return a}});var n=e(27921),r=e.n(n),n=e(85579),l=e.n(n),n=e(22013),c=e.n(n),n=e(5453),i=e(59655),o=e(97084),s=e(25108);function u(t,n){var e,i,o,s,a=void 0!==l()&&t[c()]||t["@@iterator"];if(a)return i=!(e=!0),{s:function(){a=a.call(t)},n:function(){var t=a.next();return e=t.done,t},e:function(t){i=!0,o=t},f:function(){try{e||null==a.return||a.return()}finally{if(i)throw o}}};if(Array.isArray(t)||(a=function(t,n){var e;if(t)return"string"==typeof t?f(t,n):"Map"===(e="Object"===(e=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?r()(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?f(t,n):void 0}(t))||n&&t&&"number"==typeof t.length)return a&&(t=a),s=0,{s:n=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:n};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}var n={name:"ReceiptReadonly",components:{EnclosureButton:n.Z,EnclosureItem:i.Z,filepre:o.Z},data:function(){return{maininfo:{},attach:{}}},mounted:function(){this.load()},methods:{load:function(){var t="/fn/xform/data?pk="+this.$route.params.pk,r=this,l=[];dsf.http.get(t,{}).then(function(t){t&&t.data&&t.data.main&&(r.maininfo=t.data.main),dsf.http.get("fn/mobileAttachment/getFormAttachment",{info_id:r.$route.params.pk,infoId:r.$route.params.pk,start:0,limit:1e3}).then(function(t){if(0<t.data.rows.length){var n,e=u(t.data.rows);try{for(e.s();!(n=e.n()).done;){var i=n.value;if(i.document){var o,s=u(i.document);try{for(s.s();!(o=s.n()).done;){var a=o.value;l.push(a)}}catch(t){s.e(t)}finally{s.f()}}}}catch(t){e.e(t)}finally{e.f()}}r.attach=l}),s.log(r.maininfo)})},openFile:function(t){t=dsf.url.getServerUrl(t);this.docurl=dsf.url.openOffice(t),this.$router.push({name:"dsfIframe",params:{url:this.docurl}})}}},a=(0,e(51900).Z)(n,function(){var n=this,e=n._self._c;return e("div",{staticClass:"receipt-readonly"},[e("van-cell-group",[e("van-cell",{attrs:{value:n.maininfo["2003092135402UzHeOPIWnQXwpt4mig"]&&n.maininfo["2003092135402UzHeOPIWnQXwpt4mig"].value||"",title:"签发人"}}),n._v(" "),e("van-cell",{attrs:{value:n.maininfo["C-R-RCV-0030"]&&n.maininfo["C-R-RCV-0030"].value||"",title:"签发时间"}}),n._v(" "),e("van-cell",{attrs:{title:"意见"},scopedSlots:n._u([{key:"default",fn:function(){return[e("div",{domProps:{innerHTML:n._s(n.maininfo["200401165633xuXK6ujlrJxGj8Qpq4y"]&&n.maininfo["200401165633xuXK6ujlrJxGj8Qpq4y"].value||"")}})]},proxy:!0}])}),n._v(" "),e("van-cell",{attrs:{title:"附件"},scopedSlots:n._u([{key:"default",fn:function(){return n._l(n.attach,function(t){return e("filepre",{key:t.id,staticStyle:{height:"0.5rem"},attrs:{name:t.title,size:t.size,url:t.url},on:{open:n.openFile}})})},proxy:!0}])})],1)],1)},[],!1,null,null,null).exports},5453:function(t,n,e){e.d(n,{Z:function(){return f}});var n=e(26243),o=e.n(n),n=e(62680),s=e.n(n),n=e(95366),a=e.n(n),n=e(6919),i=e.n(n),r=e(77193),n=e(59655),l=e(25108);function c(n,t){var e,i=o()(n);return s()&&(e=s()(n),t&&(e=e.filter(function(t){return a()(n,t).enumerable})),i.push.apply(i,e)),i}function u(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?c(Object(e),!0).forEach(function(t){(0,r.Z)(n,t,e[t])}):i()?Object.defineProperties(n,i()(e)):c(Object(e)).forEach(function(t){Object.defineProperty(n,t,a()(e,t))})}return n}var n={name:"EnclosureButton",components:{EnclosureItem:n.Z},props:["fileData"],data:function(){return{dataValue:{info_id:"",moduleId:""},isShow:!1,overflow:document.body.style.overflow,typeConfig:{img:"iconpicture",text:"iconfile"},loading:!1,isLast:!1,isError:!1,params:{info_id:"",infoId:"",moduleId:"",nodeId:"",start:0,limit:10},list:[]}},watch:{isShow:function(t){document.body.style.overflow=t?"hidden":this.overflow}},mounted:function(){var t={},n="200517191343bubbMI4Pg5IyFs0BvPV"==(t=this.$route.params.formData?this.$route.params.formData.dataValue:this.fileData).masterId;this.params.info_id=this.params.infoId=n?t.masterId:t.info_id||t.fid||t.id||t.A0001||t["SW_XZD.A0001"],this.params.moduleId=n?t.masterModuleId:t.moduleId||t.A0004||t["SW_XZD.A0004"],this.postData()},destroyed:function(){document.body.style.overflow=this.overflow},methods:{emptyEvent:function(){},showBox:function(){this.isShow=!0},closeBox:function(){this.isShow=!1},openFile:function(t){this.$emit("open-file",t),this.isShow=!1},scrollEvent:function(t){var t=t.target,n=t.offsetHeight,e=t.scrollHeight,t=t.scrollTop;0===t?l.log("到顶了"):e<t+n+100&&this.postData()},postData:function(){var n=this;this.loading||this.isLast||(this.loading=!0,dsf.http.post("fn/mobileAttachment/getFormAttachment",u(u({},this.params),{},{start:this.params.start+1})).done(function(t){n.postDataSuccess(t)}).error(function(t){n.isError=!0,n.dsf.layer.toast("请求异常")}).always(function(){n.loading=!1}))},postDataSuccess:function(t){var r,l=this,t=t.rows;t.length?(t.length<this.params.limit&&(this.isLast=!0),this.$set(this.params,"start",this.params.start+1),r=(new Date).getTime(),t.map(function(t){t=t.document;return t&&t.forEach(function(t){var n=t.id,e=t.infoId,i=t.title,o=t.type,s=t.moduleId,t=t.size,a=dsf.util.loadSessionStore("loginToken");l.list.push({id:n,title:i,size:t||"",url:dsf.url.getServerUrl("fn/file/download?infoId=".concat(e,"&fileId=").concat(n,"&fileName=").concat(i,"&nrType=").concat(o,"&moduleId=").concat(s,"&x-auth-token=").concat(a,"&fullfilename=").concat(r).concat(i))})})}),this.$emit("fileList",this.list),1===this.params.start&&0<this.list.length&&this.$emit("open-file",this.list[0].url)):this.isLast=!0}}},f=(0,e(51900).Z)(n,function(){var n=this,e=n._self._c;return e("div",{staticClass:"ds-enclosure-button"},[e("div",{staticClass:"__e_button",on:{click:n.showBox}},[e("i",{staticClass:"iconfont iconqiehuanfujian"}),n._v(" 附件\n  ")]),n._v(" "),e("transition",{attrs:{name:"__e_box"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:n.isShow,expression:"isShow"}],staticClass:"__e_box",on:{click:n.closeBox}},[e("div",{ref:"main",staticClass:"__e_box_main",on:{scroll:n.scrollEvent,click:function(t){return t.stopPropagation(),n.emptyEvent.apply(null,arguments)}}},[n.isError&&!n.list.length?e("div",{staticClass:"__file_empty"},[e("commonempty",{attrs:{image:"network",description:"请求异常"}})],1):n._e(),n._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!n.list.length&&n.isLast,expression:"!list.length && isLast"}],staticClass:"__file_empty"},[e("commonempty",{attrs:{description:"暂无附件"}})],1),n._v(" "),e("div",{staticClass:"__file_list"},n._l(n.list,function(t){return e("enclosure-item",{key:t.id,attrs:{name:t.title,size:t.size,url:t.url},on:{open:n.openFile}})}),1),n._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:n.loading&&!n.isLast,expression:"loading && !isLast"}],staticClass:"__list_loading"},[e("van-loading",{attrs:{type:"spinner",size:"24px"}})],1)])])])],1)},[],!1,null,"6053d58c",null).exports},97084:function(t,n,e){e.d(n,{Z:function(){return i}});var n={name:"filepre",props:{name:{type:String,require:!0},size:{type:String,default:""},url:{type:Object,require:!0}},data:function(){return{typeConfig:{IMAGE:"iconIMAGE",TXT:"iconTXT",PDF:"iconPDF",WORD:"iconWORD",EXCEL:"iconEXCEL",PPT:"iconPPT",OTHER:"iconOTHER"},fileType:{IMAGE:["jpeg","bmp","webp","svgz","svg","gif","jpg","ico","png","tif"],PDF:["pdf"],TXT:["txt","sql","xml","html","css","js","java","php","bat","log"],WORD:["docx","docm","doc","dotx","dotm","dot"],EXCEL:["xlsx","xlsm","xlsb","xls","xltx","xltm","xlt","xlam","xla","ods"],PPT:["pptx","pptm","ppt","potx","potm","pot","ppsx","ppsm","pps","ppam","ppa"]}}},computed:{suffix:function(){var t=this.name.lastIndexOf(".");return-1!==t?this.name.substring(t+1,this.name.length).toLowerCase():""},type:function(){for(var t in this.fileType)if(-1<this.fileType[t].indexOf(this.suffix))return t;return"OTHER"}},methods:{openFile:function(){this.$emit("open",this.url)}}},i=(0,e(51900).Z)(n,function(){var t=this,n=t._self._c;return n("div",{staticClass:"ds-enclosure-item",on:{click:t.openFile}},[n("div",{staticClass:"__file_icon"},[n("i",{staticClass:"iconfont",class:[t.typeConfig[t.type]]})]),t._v(" "),n("div",{staticClass:"__file_body"},[n("div",{staticClass:"__file_title"},[n("div",{staticClass:"elps"},[t._v(t._s(t.name))])])])])},[],!1,null,"55181dfe",null).exports}}]);