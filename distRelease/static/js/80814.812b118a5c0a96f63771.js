(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[80814],{5287:function(e,t,i){"use strict";i.d(t,{Z:function(){return o}});var n=i(25108),t={components:{EnclosurePreview:function(){return Promise.all([i.e(97805),i.e(82060),i.e(31204)]).then(i.bind(i,82060))}},data:function(){return{imgPreview:!1,previewImg:[],popFile:{},showFile:!1,filename:"",isPreview:!0,currentFile:{},fileUrl:"",isSignature:null==dsf.util.loadSessionStore("meeting").allowComments||dsf.util.loadSessionStore("meeting").allowComments,appTopMenu:dsf.config.appTopMenu.value}},methods:{open:function(e){var t;dsf.util.isImage(e.fileName)?(t="",t="peopleCongressFile"==this.$route.name||"210902111649AhoKqvPNPCT90ktfWET"===e.officeModuleId?dsf.url.getWebPath("fn/conferenceFile/download?pk=".concat(e.fileId)):dsf.url.getWebPath("fn/mobileFileDownload/download?fileId=".concat(e.fileId,"&moduleId=").concat(e.moduleId,"&fileName=").concat(e.fileName)),n.log(t),this.imgPreview=!0,this.previewImg=[t]):navigator.userAgent.includes("DreamSoft")&&dsf.config.commonForm.nativeWps?this.wpsOpen(e):(dsf.config.commonForm.LocalDocPreview?this.popFile=e:(t=dsf.url.getServerUrl("fn/office/openMobileOffice?fileId=".concat(e.fileId,"&moduleId=").concat(e.moduleId,"&nodeId=").concat(e.nodeId,"&flowId=").concat(e.flowId,"&filename=").concat(e.fileName,"&x-auth-token=").concat(dsf.util.loadSessionStore("loginToken"),"&handwriting=1&screenWidth=").concat(document.body.clientWidth)),e.officeModuleId&&(t+="&officeModuleId=".concat(e.officeModuleId)),this.fileUrl=t),this.filename=e.fileName,this.showFile=!0)},goPreview:function(){this.isPreview=!0},goHandWrite:function(){this.isPreview=!1},closeFile:function(){this.showFile=!1,dsf.config.commonForm.LocalDocPreview&&this.$refs.enclosurePreview.destroyInterval()},wpsOpen:function(e){var t=dsf.url.getRootPath(),i=dsf.util.loadSessionStore("loginToken"),t={keepCallback:!0,downUrl:t+"fn/file/download?infoId=".concat(e.id,"&fileId=").concat(e.fileId,"&fileName=").concat(e.fileName,"&moduleId=").concat(e.moduleId,"&x-auth-token=").concat(i,"&fullfilename=").concat(e.fileName),saveUrl:"",fileName:e.fileName,openWithWPS:!0,uploadFile:!0,openMode:"readOnly",enterReviseMode:!1,showReviewingPaneRightDefault:!1,userName:dsf.util.loadSessionStore("user").name};n.log(t),$WPS.downAndOpen(t,function(e){n.log(e)},function(e){n.log("错误回调",e)})}}},o=(0,i(51900).Z)(t,function(){var t=this,e=t._self._c;return e("div",{staticClass:"enclosurePop"},[e("van-image-preview",{attrs:{images:t.previewImg,closeable:""},model:{value:t.imgPreview,callback:function(e){t.imgPreview=e},expression:"imgPreview"}}),t._v(" "),e("van-popup",{staticClass:"file-preview",staticStyle:{height:"100vh"},attrs:{"close-on-click-overlay":!0,"lock-scroll":"",position:"bottom"},model:{value:t.showFile,callback:function(e){t.showFile=e},expression:"showFile"}},[e("van-nav-bar",{attrs:{title:t.filename,fixed:"",placeholder:""},on:{"click-left":t.closeFile,"click-right":t.closeFile},scopedSlots:t._u([t.appTopMenu?{key:"left",fn:function(){return[e("van-icon",{attrs:{name:"arrow-left"}}),t._v("返回\n        ")]},proxy:!0}:{key:"right",fn:function(){return[e("span",[t._v("关闭文件")])]},proxy:!0}],null,!0)}),t._v(" "),t.dsf.config.commonForm.LocalDocPreview?e("enclosure-preview",{ref:"enclosurePreview",attrs:{file:t.popFile,"is-preview":t.isPreview,"is-signature":t.isSignature,isShowCurPerson:!0,officeModuleId:t.popFile.officeModuleId||""},on:{goPreview:t.goPreview,goHandWrite:t.goHandWrite}}):e("div",{staticClass:"content"},[e("iframe",{attrs:{src:t.fileUrl,frameborder:"0"}})])],1)],1)},[],!1,null,"dfeb2380",null).exports},80814:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return r}});var t=o(18428),s=o.n(t),t=o(77193),i=(o(41762),o(41956)),t={components:(0,t.Z)({},i.Z.name,i.Z),props:{file:{type:Object,default:function(){}},meetingId:{type:String},isShowCount:{type:Boolean,default:!0}},data:function(){return{fileType:{pdf:["pdf"],img:["jpeg","bmp","webp","svgz","svg","gif","jpg","ico","png","tif"],txt:["txt","sql","xml","html","css","js","java","php","bat","log"],word:["docx","docm","doc","dotx","dotm","dot"],xls:["xlsx","xlsm","xlsb","xls","xltx","xltm","xlt","xlam","xla","ods"],ppt:["pptx","pptm","ppt","potx","potm","pot","ppsx","ppsm","pps","ppam","ppa"]},hasFilePng:["ai","cloud","html","img","jpg","mp3","mp4","pdf","png","ppt","psd","rar","txt","word","wps","xls","zip","folder"],imgPreview:!1,previewImg:[],popFile:{},showFile:!1,filename:"",isPreview:!0}},computed:{typeClass:function(){var e,t=this.file.type.toLowerCase();if(this.hasFilePng.includes(t))return o(83887)("./".concat(t,".png"));for(e in this.fileType)if(this.fileType[e].includes(t))return o(83887)("./".concat(e,".png"))}},methods:{goPreview:function(){this.isPreview=!0},goHandWrite:function(){this.isPreview=!1},link:function(){this.$emit("openFile",this.file)},closeFile:function(){this.showFile=!1,this.$refs.enclosurePreview.destroyInterval()}}},i=o(51900),t=(0,i.Z)(t,function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"file",on:{click:e.link}},[t("div",{staticClass:"typeIcon"},[t("img",{attrs:{src:e.typeClass,alt:""}}),e._v(" "),e.file.isNew?t("van-badge",{attrs:{dot:""}}):e._e()],1),e._v(" "),t("div",{staticClass:"info"},["folder"==e.file.type?t("div",[t("div",{staticClass:"title"},[e._v(e._s(e.file.folderName))]),e._v(" "),e.isShowCount?t("div",{staticClass:"num"},[e._v(e._s(e.file.filesCount)+"个文件")]):e._e()]):t("div",[t("div",{staticClass:"title"},[e._v(e._s(e.file.fileName))])])])])])},[],!1,null,"45507282",null).exports,n=o(5287),l=o(25108),t={components:{fileItem:t,enclosurePopup:n.Z},data:function(){return{files:[],loading:null,meetingId:"",folderid:"",folderModuleId:"",errored:!1,isFirstLoad:!1,imgPreview:!1,previewImg:[],popFile:{},showFile:!1,filename:"",isPreview:!0,currentFile:{}}},created:function(){var e=this;e.loading=dsf.layer.loading(),e.isFirstLoad=!0,e.meetingId=e.$route.params.meetingId,e.folderid=e.$route.params.folderid,e.folderModuleId="1"==e.$route.params.folderModuleId?"":e.$route.params.folderModuleId,e.getFiles()},activated:function(){this.isFirstLoad||(this.loading=dsf.layer.loading(),this.getFiles()),this.isFirstLoad=!1},mounted:function(){},methods:{getFiles:function(){var o=this,e="fn/conferenceMobile/files";dsf.config.staticJson.enable&&o.folderid&&(e+="/".concat(o.folderid)),l.log(e),dsf.http.post(e,{meetingId:o.meetingId,folderId:o.folderid||o.meetingId,folderModuleId:o.folderModuleId||""}).done(function(e){var t,i,n;200==e.code&&e.data?(o.files=[],dsf.url.setTitle(e.data.currFolderName),e.data.folders&&0<e.data.folders.length&&(t=[],e.data.folders.map(function(e){t.push(s()({},e,{type:"folder"}))}),(i=o.files).push.apply(i,t)),e.data.files&&0<e.data.files.length&&(n=[],e.data.files.map(function(e){n.push(s()({},e,{type:e.fileName.substr(e.fileName.lastIndexOf(".")+1),isHandwrite:"1",id:e.fileId}))}),(i=o.files).push.apply(i,n))):o.errored=!0}).error(function(e){o.errored=!0}).always(function(){dsf.layer.closeLoading(o.loading)})},openFile:function(t){var i=this;"folder"==(this.currentFile=t).type?this.$router.push({name:"conferenceDir",params:{meetingId:this.meetingId,folderid:t.folderId,folderModuleId:t.folderModuleId}}):dsf.http.post("fn/conferenceMobile/setRead",{pk:t.fileId,moduleId:t.moduleId}).done(function(e){i.$refs.enclosurePopup.open(t)}).error(function(e){dsf.layer.toast("操作失败！")})},closeFile:function(){this.showFile=!1,this.$refs.enclosurePreview.destroyInterval()}}},r=(0,i.Z)(t,function(){var i=this,n=i._self._c;return n("div",[i.errored?n("div",[i._v("\n        数据获取失败！\n    ")]):0<i.files.length?n("div",i._l(i.files,function(e,t){return n("div",{key:t},[n("file-item",{attrs:{file:e,"meeting-id":i.meetingId},on:{openFile:i.openFile}}),i._v(" "),t<i.files.length-1?n("van-divider"):i._e()],1)}),0):n("div",{staticClass:"flex"},[n("commonempty",{staticClass:"file-empty",attrs:{image:o(89436),description:"暂无文件"}})],1),i._v(" "),n("enclosurePopup",{ref:"enclosurePopup"})],1)},[],!1,null,"0a1b993e",null).exports},83887:function(e,t,i){var n={"./ai.png":44936,"./cloud.png":54073,"./doc.png":39636,"./docx.png":70071,"./folder-team.png":36556,"./folder.png":7818,"./html.png":97744,"./img.png":32954,"./jpeg.png":90699,"./jpg.png":84693,"./mp3.png":77957,"./mp4.png":96128,"./ofd.png":88825,"./pdf.png":46616,"./png.png":95742,"./ppt.png":68985,"./psd.png":89041,"./rar.png":45074,"./txt.png":48339,"./word.png":26206,"./wps.png":83392,"./xls.png":49472,"./xlsx.png":81682,"./xml.png":66874,"./zip.png":99021};function o(e){e=s(e);return i(e)}function s(e){if(i.o(n,e))return n[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}o.keys=function(){return Object.keys(n)},o.resolve=s,(e.exports=o).id=83887},44936:function(e,t,i){"use strict";e.exports=i.p+"static/img/ai.692fadd..png"},54073:function(e,t,i){"use strict";e.exports=i.p+"static/img/cloud.e0e5c0c..png"},39636:function(e,t,i){"use strict";e.exports=i.p+"static/img/doc.178d734..png"},70071:function(e,t,i){"use strict";e.exports=i.p+"static/img/docx.178d734..png"},36556:function(e,t,i){"use strict";e.exports=i.p+"static/img/folder-team.256a132..png"},7818:function(e,t,i){"use strict";e.exports=i.p+"static/img/folder.b74dd1f..png"},97744:function(e,t,i){"use strict";e.exports=i.p+"static/img/html.aed4382..png"},32954:function(e,t,i){"use strict";e.exports=i.p+"static/img/img.1e66416..png"},90699:function(e,t,i){"use strict";e.exports=i.p+"static/img/jpeg.6690b6f..png"},84693:function(e,t,i){"use strict";e.exports=i.p+"static/img/jpg.6690b6f..png"},77957:function(e,t,i){"use strict";e.exports=i.p+"static/img/mp3.11779e9..png"},96128:function(e,t,i){"use strict";e.exports=i.p+"static/img/mp4.bf3626d..png"},88825:function(e,t,i){"use strict";e.exports=i.p+"static/img/ofd.aa35dda..png"},46616:function(e,t,i){"use strict";e.exports=i.p+"static/img/pdf.0431c10..png"},95742:function(e,t,i){"use strict";e.exports=i.p+"static/img/png.99cbe3b..png"},68985:function(e,t,i){"use strict";e.exports=i.p+"static/img/ppt.2dcd0da..png"},89041:function(e,t,i){"use strict";e.exports=i.p+"static/img/psd.10d45f5..png"},45074:function(e,t,i){"use strict";e.exports=i.p+"static/img/rar.5ca3e88..png"},48339:function(e,t,i){"use strict";e.exports=i.p+"static/img/txt.9b1d964..png"},26206:function(e,t,i){"use strict";e.exports=i.p+"static/img/word.178d734..png"},83392:function(e,t,i){"use strict";e.exports=i.p+"static/img/wps.d841695..png"},49472:function(e,t,i){"use strict";e.exports=i.p+"static/img/xls.e136da2..png"},81682:function(e,t,i){"use strict";e.exports=i.p+"static/img/xlsx.e136da2..png"},66874:function(e,t,i){"use strict";e.exports=i.p+"static/img/xml.aed4382..png"},99021:function(e,t,i){"use strict";e.exports=i.p+"static/img/zip.4b7a304..png"},89436:function(e,t,i){"use strict";e.exports=i.p+"static/img/img_zwwj.5906452..png"}}]);