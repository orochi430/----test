"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[74611],{74611:function(t,a,s){s.r(a),s.d(a,{default:function(){return n}});var a=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"com-tit"},[a("img",{attrs:{src:s(36468),alt:""}}),t._v(" "),a("span",[t._v("表决详情")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"com-tit"},[a("img",{attrs:{src:s(33120),alt:""}}),t._v(" "),a("span",[t._v("结果分析")])])},function(){var t=this,a=t._self._c;return a("div",{staticClass:"com-tit"},[a("img",{attrs:{src:s(1020),alt:""}}),t._v(" "),a("span",[t._v("投票详情")])])}],i=s(73473),e=s.n(i),r=s(70596),i={name:"meetingcast",props:[],data:function(){return{userName:"",tabId:"",topicId:this.$route.query.topicId,meetingId:this.$route.query.meetingId,default_avatar:'this.src="'+s(11727)+'"',chart:[],allDate:[],tabData:[],List:[]}},created:function(){},mounted:function(){var t=dsf.layer.loading();e().all([this.getTab(),this.getDate(),this.getAllDate()]).then(function(){dsf.layer.closeLoading(t)}).catch(function(t){dsf.layer.toast("数据获取失败，请稍后重试！",!1)})},watch:{},methods:{tabClick:function(t){this.tabId=t,this.getDate()},getTab:function(){var i=this;return dsf.http.post("ctrl/meetingVote/getYtAndOption",{topicId:this.topicId}).done(function(t){var a;"200"==t.code?(a=[{optionValue:"全部",bt:"全部",id:""}],t.data.optionList.forEach(function(t){a.push({optionValue:t.optionValue,bt:t.bt,id:t.id})}),a.push({optionValue:["A","B","C","D","E","F","G"][t.data.optionList.length],bt:"未表决",id:"-1"}),i.tabData=a):dsf.layer.toast(t.message)})},getAllDate:function(){var i=this;return dsf.http.post("ctrl/meetingVote/getVoteStatisticsV2",{topicId:this.topicId}).done(function(t){var a;"200"==t.code?(i.allDate=t.data,a=[],t.data.voteList.forEach(function(t){a.push({optionValue:t.optionValue,optionText:t.optionText,num:t.num})}),a.push({optionValue:["A","B","C","D","E","F","G"][t.data.voteList.length],optionText:"未表决",num:t.data.notVoteUserNum}),i.chart=a,i.initChart(i.chart,"chart")):dsf.layer.toast(t.message)})},getDate:function(){var a=this,i=dsf.layer.loading();dsf.http.post("ctrl/meetingVote/getAllOptionUserList",{topicId:this.topicId,meetingId:this.meetingId,optionId:this.tabId,userName:this.userName}).done(function(t){dsf.layer.closeLoading(i),a.List=[],"200"==t.code?(a.List=t.data,a.List.forEach(function(t){t.optionText=t.optionText||"未表决",t.voteResults=t.voteResults||"未表决"})):dsf.layer.toast(t.message)})},initChart:function(t,a){var i=[],e=[],s=[],n=0,o=(t.forEach(function(t){i.push(t.optionValue),e.push(t.optionText),s.push(t.num)}),s.forEach(function(t){n+=t}),r.init(this.$refs[a])),t={grid:{left:"5%",right:"5%",bottom:"-5%",top:"10%",containLabel:!0},xAxis:{show:!1,type:"value"},yAxis:[{type:"category",inverse:!0,axisLabel:{show:!0,textStyle:{color:"#333",fontSize:"14"}},splitLine:{show:!1},axisTick:{show:!1},axisLine:{show:!1},data:i},{type:"category",inverse:!0,axisTick:"none",axisLine:"none",show:!0,axisLabel:{textStyle:{color:"#333",fontSize:"14"},formatter:function(t){return(0<n?(100*t/n).toFixed(2):0)+"%"}},data:s}],series:[{name:"金额",type:"bar",zlevel:1,itemStyle:{normal:{barBorderRadius:40,color:function(t){return["#0091FF","#FFB27F","#44D7B6","#E790FF"][t.dataIndex]}}},label:{show:!0,position:"insideLeft",formatter:function(t){return e[t.dataIndex]+": "+t.data+"票"}},barWidth:20,data:s},{name:"背景",type:"bar",barWidth:20,barGap:"-100%",data:[n,n,n,n],itemStyle:{normal:{color:"#EEEEEE",barBorderRadius:40}}}]};o.clear(),o.setOption(t),window.addEventListener("resize",function(){o.resize()})}}},n=(0,s(51900).Z)(i,function(){var i=this,e=i._self._c;return e("div",{staticClass:"meetingvote flex dc",style:{height:"calc(100vh - ".concat(i.dsf.util.getOffsetTop(),")")}},[e("div",{staticClass:"main"},[i._m(0),i._v(" "),e("div",{staticClass:"box"},[e("div",{ref:"chart",staticClass:"chart"}),i._v(" "),e("p",[i._v(i._s(i.allDate.voteModeMsg))])])]),i._v(" "),e("div",{staticClass:"main"},[i._m(1),i._v(" "),e("div",{staticClass:"box box1"},[e("ul",{staticClass:"box-ul"},[e("li",[e("img",{attrs:{src:s(775),alt:""}}),i._v(" "),e("div",[e("span",[i._v("应参人员")]),i._v(" "),e("div",[i._v(i._s(i.allDate.voteUserNum))])])]),i._v(" "),e("li",[e("img",{attrs:{src:s(70898),alt:""}}),i._v(" "),e("div",[e("span",[i._v("实参人员")]),i._v(" "),e("div",[i._v(i._s(i.allDate.goVoteUserNum))])])]),i._v(" "),e("li",[e("img",{attrs:{src:s(22740),alt:""}}),i._v(" "),e("div",[e("span",[i._v("有效票数")]),i._v(" "),e("div",[i._v(i._s(i.allDate.voteNum))])])]),i._v(" "),e("li",[e("img",{attrs:{src:s(30506),alt:""}}),i._v(" "),e("div",[e("span",[i._v("未投票人数")]),i._v(" "),e("div",[i._v(i._s(i.allDate.giveUpNum))])])])])])]),i._v(" "),e("div",{staticClass:"main"},[i._m(2),i._v(" "),e("div",{staticClass:"box2"},[e("ol",i._l(i.tabData,function(a,t){return e("li",{key:t,class:{active:i.tabId==a.id},on:{click:function(t){return i.tabClick(a.id)}}},[i._v(i._s(a.optionValue))])}),0),i._v(" "),e("van-search",{attrs:{placeholder:"搜索","input-align":"left"},on:{search:i.getDate},model:{value:i.userName,callback:function(t){i.userName=t},expression:"userName"}})],1),i._v(" "),e("div",{staticClass:"box3"},[0<i.List.length?e("ul",{staticClass:"list"},i._l(i.List,function(t,a){return e("li",{key:a},[e("img",{attrs:{src:i.dsf.url.getWebPath(t.img),onerror:i.default_avatar}}),i._v(" "),e("span",[i._v(i._s(t.userName)+"（"+i._s(t.deptName)+"）")]),i._v(" "),t.optionText?e("div",i._l(t.optionText.split(","),function(t,a){return e("i",{key:a,class:{state1:"支持"==t,state2:"反对"==t,state3:"弃权"==t,state4:"未表决"==t}},[i._v(i._s(t||"未表决"))])}),0):i._e()])}),0):e("commonempty",{staticClass:"opinion-empty",attrs:{image:s(46290),description:"暂无数据"}})],1)])])},a,!1,null,"6015a646",null).exports},775:function(t,a,i){t.exports=i.p+"static/img/icon1.bf05528..png"},70898:function(t,a,i){t.exports=i.p+"static/img/icon2.7dd4dac..png"},22740:function(t,a,i){t.exports=i.p+"static/img/icon3.0ff8ae6..png"},30506:function(t,a,i){t.exports=i.p+"static/img/icon4.f8c074f..png"},36468:function(t,a,i){t.exports=i.p+"static/img/title1.b5b084b..png"},33120:function(t,a,i){t.exports=i.p+"static/img/title2.facca50..png"},1020:function(t,a,i){t.exports=i.p+"static/img/title3.9da271f..png"},11727:function(t,a,i){t.exports=i.p+"static/img/default-avatar.ad3a581..png"},46290:function(t,a,i){t.exports=i.p+"static/img/img_zwfk.26c4673..png"}}]);