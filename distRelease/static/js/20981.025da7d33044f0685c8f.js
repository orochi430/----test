"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[20981],{20981:function(t,a,e){e.r(a),e.d(a,{default:function(){return i}});var s=e(5044),a={data:function(){return{comments:[],data:{icon:"",appName:"",applicationProfile:"",tags:[],supplier:"",useNum:"",appScore:5,introduce:"",evaluateNum:0},isApply:!1,isEvaluate:!1,evaluateContent:"",star:5,show:!1,evaluateStatus:0,applyStatus:0,page:1,limit:5,loading:!1,finished:!1,total:0}},created:function(){this.getData()},methods:{getData:function(){var a=this;dsf.http.get("fn/application/store/info",{pk:this.$route.params.pk}).then(function(t){200==t.data.code&&(t=t.data.data,a.data={icon:dsf.url.getWebPath(t.icon),appName:t.appName,applicationProfile:t.applicationProfile,tags:t.labelIndustryText?t.labelIndustryText.split(","):[],supplier:t.supplier,useNum:t.useNum,appScore:t.appScore,introduce:t.introduce,evaluateNum:t.evaluateNum},a.evaluateStatus=t.evaluateStatus,a.applyStatus=t.applyStatus)})},getEvaluateList:function(){var a=this;dsf.http.post("fn/application/store/230519141848vhUIc6fw3rCmJG5IB7a/mobile/q",{moduleId:"2305181733278mFvPjQ16UBEBTgwZUV",appId:this.$route.params.pk,page:this.page,limit:this.limit,formId:"230519141848vhUIc6fw3rCmJG5IB7a"}).then(function(t){a.total=t.data.total||0;t=t.data.datas.map(function(t){return{id:t.dataValue["evaluate.S-BASE-0001"],img:dsf.url.getWebPath(t.dataValue.useIconUrl),name:t.dataValue["evaluate.S-APP-EVALUATE-0001"],userid:t.dataValue["evaluate.S-APP-EVALUATE-0002"],appScore:Number(t.dataValue["evaluate.S-APP-EVALUATE-0005"]),text:t.dataValue["evaluate.S-APP-EVALUATE-0004"],time:t.dataValue["evaluate.S-APP-EVALUATE-0006"]}});a.comments=[].concat((0,s.Z)(a.comments),(0,s.Z)(t)),a.comments.length===a.total&&(a.finished=!0)}).finally(function(){a.loading=!1})},onLoad:function(){this.getEvaluateList()},onRefresh:function(){this.finished=!1,this.loading=!0,this.page=1,this.comments=[],this.getEvaluateList()},submit:function(){var a=this;dsf.http.post("fn/application/store/evaluate",{appId:this.$route.params.pk,star:this.star,content:this.evaluateContent}).then(function(t){200==t.data.code&&(a.show=!1,a.evaluateStatus=1,a.onRefresh())})},delEvaluate:function(t){var a=this;dsf.layer.confirm({message:"是否确认删除",confirmButtonText:"确认"},function(){dsf.http.post("fn/application/store/evaluate/del",{evaId:t}).then(function(t){200==t.data.code&&(a.onRefresh(),a.getData())})})},apply:function(){this.$router.push({path:"/commonForm/2305181732545eWpU6ESTFnvts0srPh",query:{appid:this.$route.params.pk,appName:this.data.appName,title:"应用申请"}})}}},i=(0,e(51900).Z)(a,function(){var e=this,s=e._self._c;return s("div",{staticClass:"container flex dc"},[s("div",{staticClass:"content flex dc"},[s("div",{staticClass:"top flex ac"},[s("img",{attrs:{src:e.data.icon,alt:""}}),e._v(" "),s("div",{staticClass:"flex1"},[s("div",{},[e._v(e._s(e.data.appName))]),e._v(" "),s("div",{staticClass:"sub1",staticStyle:{padding:"0.08rem 0"}},[e._v(e._s(e.data.applicationProfile))]),e._v(" "),s("div",e._l(e.data.tags,function(t){return s("span",{staticClass:"tag"},[e._v(e._s(t))])}),0)]),e._v(" "),s("van-rate",{attrs:{size:12,color:"#F19927","void-icon":"star",readonly:"","void-color":"#eee"},model:{value:e.data.appScore,callback:function(t){e.$set(e.data,"appScore",t)},expression:"data.appScore"}})],1),e._v(" "),s("div",{staticStyle:{"padding-top":"0.2rem"}},[s("span",{staticClass:"sub2"},[e._v("开发商："+e._s(e.data.supplier))]),e._v(" "),s("span",{staticClass:"sub2"},[e._v("使用量："+e._s(e.data.useNum))])]),e._v(" "),s("div",{staticClass:"tabs"},[s("van-tabs",[s("van-tab",{attrs:{title:"应用介绍"}},[s("div",{staticStyle:{"padding-top":"0.2rem"},domProps:{innerHTML:e._s(e.data.introduce)}})]),e._v(" "),s("van-tab",{attrs:{title:"应用评价"}},[s("div",{staticClass:"tab-top"},[s("span",[e._v("应用评价("+e._s(e.data.evaluateNum)+")")]),e._v(" "),9==e.applyStatus&&0==e.evaluateStatus?s("van-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.show=!0}}},[e._v("发表评论")]):e._e()],1),e._v(" "),s("van-list",{attrs:{finished:e.finished,"finished-text":""},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.comments,function(a){return s("div",{staticClass:"comment"},[s("div",{staticClass:"comment-top flex ac"},[s("img",{attrs:{src:a.img,alt:""}}),e._v(" "),s("span",{staticClass:"elps name"},[e._v(e._s(a.name))]),e._v(" "),s("van-rate",{attrs:{size:12,color:"#F19927",readonly:"","void-icon":"star","void-color":"#eee"},model:{value:a.appScore,callback:function(t){e.$set(a,"appScore",t)},expression:"item.appScore"}}),e._v(" "),a.userid==e.dsf.util.loadSessionStore("user").user_id?s("span",{staticClass:"del",on:{click:function(t){return e.delEvaluate(a.id)}}},[e._v("删除")]):e._e()],1),e._v(" "),s("div",{staticClass:"comment-text"},[e._v(e._s(a.text))]),e._v(" "),s("div",{staticClass:"sub3"},[e._v(e._s(a.time))])])}),0),e._v(" "),e.comments.length||e.loading?e._e():s("commonempty")],1)],1)],1)]),e._v(" "),s("div",{staticClass:"footer"},[s("van-button",{attrs:{type:"primary",disabled:9==e.applyStatus||1==e.applyStatus,color:9==e.applyStatus||1==e.applyStatus?"#b8b8b8":""},on:{click:e.apply}},[e._v("\n      "+e._s(9==e.applyStatus?"已开通":1==e.applyStatus?"申请中":"申请应用")+"\n    ")])],1),e._v(" "),s("van-popup",{staticClass:"pop",attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[s("van-nav-bar",{attrs:{title:"发表评价","left-arrow":"",placeholder:""},on:{"click-left":function(t){e.show=!e.show}}}),e._v(" "),s("van-field",{attrs:{rows:"5",autosize:"",type:"textarea",placeholder:"请输入您的评价"},model:{value:e.evaluateContent,callback:function(t){e.evaluateContent=t},expression:"evaluateContent"}}),e._v(" "),s("div",{staticClass:"rate"},[s("van-rate",{attrs:{size:"22",color:"#F19927","void-color":"#eee"},model:{value:e.star,callback:function(t){e.star=t},expression:"star"}})],1),e._v(" "),s("van-button",{attrs:{type:"primary",block:""},on:{click:e.submit}},[e._v("提交")])],1)],1)},[],!1,null,"904ed8ca",null).exports}}]);