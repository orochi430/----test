"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[4658,27010],{61645:function(e,t,a){a.d(t,{Z:function(){return i}});var o=a(90541),l=a(25108),t={name:"addFile",components:{},props:{show:{type:Boolean,default:!1},fid:{type:String,default:""},listType:{type:String|Number,default:4}},data:function(){return{maxSize:0,list:[{icon:a(63769),title:"上传图片",type:"image",accept:"image/*"},{icon:a(66121),title:"上传视频",type:"video",accept:"video/*"},{icon:a(55905),title:"上传文件",type:"document",accept:"*"},{icon:a(90203),title:"新建文件夹",type:"folder",accept:""}],addFolder:!1,folderName:""}},computed:{},watch:{},created:function(){},mounted:function(){this.getMaxFileSize()},methods:{close:function(){this.$emit("closeAddFile")},addNew:function(e){"folder"==e.type&&(this.folderName="",this.addFolder=!0)},closeAddFolder:function(){this.addFolder=!1,this.close()},doAddFolder:function(){var t=this;this.folderName?o.Z.http.post("/fn/cloud/file/addDirectory",{fid:this.fid,name:this.folderName,listType:this.listType},{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&t.closeAddFolder()}).catch(function(e){}).finally(function(){}):o.Z.layer.toast("请输入文件夹名称")},getMaxFileSize:function(){var t=this;o.Z.http.get("/fn/cloud/file/getMaxFileSize").then(function(e){e.data&&"200"==e.data.code&&(t.maxSize=e.data.data)}).catch(function(e){}).finally(function(){})},afterRead:function(e){for(var t=this,i=(l.log(e),[]),s=(Array.isArray(e)?e.forEach(function(e){i.push(e.file)}):i=[e.file],0),a=new FormData,n=0;n<i.length;n++)s+=i[n].size,a.append("files",i[n]);a.append("fid",this.fid),a.append("listType",this.listType),0!=this.maxSize&&this.maxSize<s?(e=this.maxSize/1048576,o.Z.layer.toast("文件不能超过".concat(e,"M"))):(this.$toast.loading({message:"上传中...",forbidClick:!0,duration:0,overlay:!0}),o.Z.http.post("fn/cloud/file/uploadFile",a,{headers:{"Content-Type":"multipart/form-data"},timeout:2e6}).then(function(e){t.$toast.clear(),e.data&&"200"==e.data.code?(o.Z.layer.toast(e.data.message),t.$emit("closeAddFile")):o.Z.layer.toast(e.data.message)}).finally(function(e){t.$toast.clear()}))}}},i=(0,a(51900).Z)(t,function(){var i=this,s=i._self._c;return s("div",[s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app","close-on-click-overlay":!1},on:{"click-overlay":i.close},model:{value:i.show,callback:function(e){i.show=e},expression:"show"}},[s("div",{staticClass:"addFile"},[s("p",{staticClass:"addtitle"},[i._v("新建")]),i._v(" "),s("ul",i._l(i.list,function(t,e){return s("li",{key:e,staticClass:"items"},["folder"!=t.type?s("van-uploader",{attrs:{multiple:!0,accept:t.accept,"after-read":i.afterRead}},[s("img",{attrs:{src:t.icon,alt:""}}),i._v(" "),s("span",[i._v(i._s(t.title))])]):i._e(),i._v(" "),"folder"==t.type?s("div",{on:{click:function(e){return i.addNew(t)}}},[s("img",{attrs:{src:t.icon,alt:""}}),i._v(" "),s("span",[i._v(i._s(t.title))])]):i._e()],1)}),0)])]),i._v(" "),s("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},model:{value:i.addFolder,callback:function(e){i.addFolder=e},expression:"addFolder"}},[s("div",{staticClass:"addFolder"},[s("div",{staticClass:"header"},[s("van-icon",{attrs:{name:"cross"},on:{click:i.closeAddFolder}}),i._v(" "),s("p",[i._v("新建文件夹")]),i._v(" "),s("span",{on:{click:i.doAddFolder}},[i._v("完成")])],1),i._v(" "),s("div",{staticClass:"inputs"},[s("img",{attrs:{src:a(2793),alt:"",srcset:""}}),i._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:i.folderName,expression:"folderName",modifiers:{trim:!0}}],attrs:{type:"text",maxlength:"20",placeholder:"输入文件夹名称"},domProps:{value:i.folderName},on:{input:function(e){e.target.composing||(i.folderName=e.target.value.trim())},blur:function(e){return i.$forceUpdate()}}})])])])],1)},[],!1,null,"5ec5c9c8",null).exports},34527:function(e,t,i){i.d(t,{Z:function(){return a}});var s=i(25108),t={name:"commonHead",components:{},props:{},data:function(){return{tabIndex:0,type:0,option:[],keyword:"",showDialog:!1,showSelect:!1,selected:0,selectList:[{name:"按名称",term:[{name:"从A到Z",orderType:1,reversed:!1,value:1},{name:"从Z到A",orderType:1,reversed:!0,value:2}]},{name:"更新时间",term:[{name:"从近到远",orderType:3,reversed:!1,value:3},{name:"从远到近",orderType:3,reversed:!0,value:4}]},{name:"创建时间",term:[{name:"从近到远",orderType:2,reversed:!1,value:5},{name:"从远到近",orderType:2,reversed:!0,value:6}]},{name:"文件大小",term:[{name:"从小到大",orderType:4,reversed:!1,value:7},{name:"从大到小",orderType:4,reversed:!0,value:8}]}]}},computed:{},watch:{},created:function(){},mounted:function(){this.getMenus()},methods:{showSearchBox:function(){this.$router.push({name:"diskSearch"})},getMenus:function(){var i=this;dsf.http.post("fn/cloud/file/getMenu",{},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;s.log(e,t),200===t&&(e.data.forEach(function(e){e.text=e.name,e.value=e.type}),i.type=e.data[0].value,i.$store.commit("setMenuType",i.type),i.option=e.data)}).catch(function(e){e.message})},change:function(e){this.$store.commit("setMenuType",this.option[e].type)},closeSelect:function(){this.showSelect=!1},changeSelect:function(e){this.selected=e},resetSelect:function(){this.selected=2}}},a=(0,i(51900).Z)(t,function(){var i=this,s=i._self._c;return s("div",{staticClass:"commonHead"},[s("van-search",{attrs:{placeholder:"在全部文件中搜索","left-icon":"",readonly:"",clearable:!1},on:{click:i.showSearchBox},scopedSlots:i._u([{key:"left-icon",fn:function(){return[s("i",{staticClass:"iconfont iconsousuo i1",staticStyle:{color:"#989A9F"}})]},proxy:!0}]),model:{value:i.keyword,callback:function(e){i.keyword=e},expression:"keyword"}}),i._v(" "),s("div",[s("van-tabs",{attrs:{ellipsis:!1},on:{change:i.change},model:{value:i.tabIndex,callback:function(e){i.tabIndex=e},expression:"tabIndex"}},i._l(i.option,function(e,t){return s("van-tab",{key:t,attrs:{title:e.name}})}),1)],1),i._v(" "),s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:i.showSelect,callback:function(e){i.showSelect=e},expression:"showSelect"}},[s("div",{staticClass:"select-contain"},[s("div",{staticClass:"checkbox"},[i._v("多选")]),i._v(" "),i._l(i.selectList,function(e,t){return s("div",{key:t,staticClass:"select-box"},[s("span",[i._v(i._s(e.name))]),i._v(" "),s("div",i._l(e.term,function(t,e){return s("p",{key:e,class:{active:i.selected==t.value},on:{click:function(e){return i.changeSelect(t.value)}}},[i._v(i._s(t.name))])}),0)])}),i._v(" "),s("div",{staticClass:"btn"},[s("div",{class:{reset:2!=i.selected},on:{click:i.resetSelect}},[i._v("重置")]),i._v(" "),s("div",{staticClass:"finish",on:{click:i.closeSelect}},[i._v("完成")])])],2)])],1)},[],!1,null,"74ae117e",null).exports},3645:function(e,t,i){i.d(t,{Z:function(){return a}});var t=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"fileGrid"},[t("div",{staticClass:"file-icon"},[t("img",{staticClass:"fileIcon",attrs:{src:i(15146),alt:""}})]),e._v(" "),t("div",{staticClass:"file-title"},[e._v("DJLog-2023-05-03IMG-5003.MOVIMG-5003.MOV")]),e._v(" "),t("div",{staticClass:"file-size"},[e._v("10.8MB")]),e._v(" "),t("div",{staticClass:"file-more"},[t("img",{attrs:{src:i(3145),alt:""}})])])}],s={name:"fileGrid",components:{},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},a=(0,i(51900).Z)(s,function(){this._self._c;return this._m(0)},t,!1,null,"65ad4ed6",null).exports},43175:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var t=a(26243),n=a.n(t),t=a(62680),o=a.n(t),t=a(95366),l=a.n(t),t=a(6919),s=a.n(t),c=a(77193),t=a(2319),i=a(3645),r=a(61645),d=a(90541),h=a(25108),u={name:"recentlyFile",components:{FileItem:t.Z,FileGrid:i.Z,AddFile:r.Z},props:{},data:function(){return{list:[],finished:!1,loading:!1,refreshing:!1,start:1,limit:15,curTab:0,showShare:!1,shareName:"分享给我",actions:[{name:"分享给我"},{name:"我分享的"}],addFile:!1,showSelect:!1,selected:5,selectList:[{name:"按名称",term:[{name:"从A到Z",orderType:1,reversed:!1,value:1},{name:"从Z到A",orderType:1,reversed:!0,value:2}]},{name:"更新时间",term:[{name:"从近到远",orderType:3,reversed:!1,value:3},{name:"从远到近",orderType:3,reversed:!0,value:4}]},{name:"创建时间",term:[{name:"从近到远",orderType:2,reversed:!1,value:5},{name:"从远到近",orderType:2,reversed:!0,value:6}]},{name:"文件大小",term:[{name:"从小到大",orderType:4,reversed:!1,value:7},{name:"从大到小",orderType:4,reversed:!0,value:8}]}],orderType:2,reversed:!1,nodata:!1,showBatch:!1,result:[],isCheckAll:!0}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{getIconClass:function(e){},onLoad:function(){var i=this,s=this;s.nodata=!1,d.Z.http.post("ctrl/cloud/file/recentList",{pageNo:this.start,pageSize:this.limit},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;h.log(e,t),200===t?(0==e.data.length&&1==s.start&&(s.nodata=!0),e&&e.data&&0<e.data.length&&(e.data.forEach(function(e){e.lastUpdateTime=e.lastUpdateTime?moment(new Date(e.lastUpdateTime)).calendar():""}),s.list=s.list.concat(e.data)),e.data.length<s.limit?i.finished=!0:s.start+=1):(i.finished=!0,s.nodata=!0)}).catch(function(e){e.message;i.finished=!0,s.nodata=!0}).finally(function(){i.loading=!1,i.refreshing=!1})},doRefresh:function(e){this.start=1,this.list=[],this.finished=!1,this.loading=!0,this.onLoad()},changeTab:function(e){this.curTab=e},onSelect:function(e){this.shareName=e.name,this.showShare=!1},closeAddFile:function(){this.addFile=!1},closeSelect:function(){this.showSelect=!1},changeSelect:function(e){this.selected=e.value,this.orderType=e.orderType,this.reversed=e.reversed,this.showSelect=!1,this.doRefresh()},resetSelect:function(){this.selected=0,this.orderType=2,this.reversed=!1,this.showSelect=!1,this.doRefresh()},handleLongPress:function(){this.showBatch=!0},clearHis:function(){var t=this;0==this.result.length?d.Z.layer.toast("请选择需要删除的记录！"):d.Z.http.post("/fn/cloud/file/deleteRecent",this.result,{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&(d.Z.layer.toast("操作成功!"),t.doRefresh())}).catch(function(e){}).finally(function(){})},complete:function(){this.showBatch=!1,this.result=[]},selectAll:function(){var t=this;this.isCheckAll?(this.result=[],this.list.forEach(function(e){t.result.push(e.id)})):this.result=[],this.isCheckAll=!this.isCheckAll},resultChange:function(){this.result.length==this.list.length?this.isCheckAll=!1:this.isCheckAll=!0}}},f=a(51900),u=(0,f.Z)(u,function(){var i=this,s=i._self._c;return s("div",{staticClass:"teamFile",class:{batch:i.showBatch}},[i._m(0),i._v(" "),0!=i.list.length||i.loading?i._e():s("commonempty",{attrs:{description:"暂无文件"}}),i._v(" "),s("div",{staticClass:"disk-file-list"},[s("van-pull-refresh",{attrs:{disabled:i.finished},on:{refresh:i.doRefresh},model:{value:i.refreshing,callback:function(e){i.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{finished:i.finished,"finished-text":""},on:{load:i.onLoad},model:{value:i.loading,callback:function(e){i.loading=e},expression:"loading"}},[s("van-checkbox-group",{on:{change:i.resultChange},model:{value:i.result,callback:function(e){i.result=e},expression:"result"}},i._l(i.list,function(e,t){return s("div",{key:t,staticClass:"itembox"},[i.showBatch?s("van-checkbox",{attrs:{name:e.id}}):i._e(),i._v(" "),s("file-item",{directives:[{name:"long-press",rawName:"v-long-press",value:i.handleLongPress,expression:"handleLongPress"}],attrs:{item:e},on:{doRefresh:i.doRefresh}})],1)}),0)],1)],1)],1),i._v(" "),s("add-file",{attrs:{listType:4,show:i.addFile},on:{closeAddFile:i.closeAddFile}}),i._v(" "),s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:i.showSelect,callback:function(e){i.showSelect=e},expression:"showSelect"}},[s("div",{staticClass:"select-contain"},[i._l(i.selectList,function(e,t){return s("div",{key:t,staticClass:"select-box"},[s("span",[i._v(i._s(e.name))]),i._v(" "),s("div",i._l(e.term,function(t,e){return s("p",{key:e,class:{active:i.selected==t.value},on:{click:function(e){return i.changeSelect(t)}}},[i._v(i._s(t.name))])}),0)])}),i._v(" "),s("div",{staticClass:"btn"},[s("div",{class:{reset:2!=i.selected},on:{click:i.resetSelect}},[i._v("重置")]),i._v(" "),s("div",{staticClass:"finish",on:{click:i.closeSelect}},[i._v("完成")])])],2)]),i._v(" "),i.showBatch?s("div",{staticClass:"batchTop"},[s("span",[i._v("已选"+i._s(i.result.length)+"项")]),i._v(" "),s("p",[s("span",{on:{click:i.selectAll}},[i._v(i._s(i.isCheckAll?"全选":"取消全选"))]),i._v(" "),s("span",{on:{click:i.complete}},[i._v("完成")])])]):i._e(),i._v(" "),i.showBatch?s("div",{staticClass:"batchBottom",on:{click:i.clearHis}},[s("img",{attrs:{src:a(52577),alt:""}}),i._v(" "),s("span",[i._v("删除记录")])]):i._e()],1)},[function(){var e=this._self._c;return e("div",{staticClass:"order"},[e("p",{staticClass:"title"},[this._v("文件列表")]),this._v(" "),e("p",{staticClass:"icons"})])}],!1,null,"4b554be6",null).exports,v=a(25108),p={name:"myCollect",components:{FileItem:t.Z,FileGrid:i.Z,AddFile:r.Z},props:{},data:function(){return{list:[],finished:!1,loading:!1,refreshing:!1,start:1,limit:15,curTab:0,showShare:!1,addFile:!1,showSelect:!1,selected:2,selectList:[{name:"按名称",term:[{name:"从A到Z",value:0},{name:"从Z到A",value:1}]},{name:"更新时间",term:[{name:"从近到远",value:2},{name:"从远到近",value:3}]},{name:"创建时间",term:[{name:"从近到远",value:4},{name:"从远到近",value:5}]}],nodata:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{getIconClass:function(e){},onLoad:function(){var i=this,s=this;s.nodata=!1,dsf.http.post("ctrl/cloud/file/favoriteList",{pageNo:this.start,pageSize:this.limit},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;v.log(e,t),200===t?(0==e.data.length&&1==s.start&&(s.nodata=!0),e&&e.data&&0<e.data.length&&(e.data.forEach(function(e){e.lastUpdateTime=e.lastUpdateTime?moment(new Date(e.lastUpdateTime)).calendar():""}),s.list=s.list.concat(e.data)),e.data.length<s.limit?i.finished=!0:s.start+=1):(i.finished=!0,s.nodata=!0)}).catch(function(e){e.message;i.finished=!0,s.nodata=!0}).finally(function(){i.loading=!1,i.refreshing=!1})},doRefresh:function(){this.start=1,this.list=[],this.finished=!1,this.loading=!0,this.onLoad()},changeTab:function(e){this.curTab=e},onSelect:function(e){this.shareName=e.name,this.showShare=!1},closeAddFile:function(){this.addFile=!1},closeSelect:function(){this.showSelect=!1},changeSelect:function(e){this.selected=e},resetSelect:function(){this.selected=2}}},p=(0,f.Z)(p,function(){var i=this,s=i._self._c;return s("div",{staticClass:"teamFile"},[0!=i.list.length||i.loading?i._e():s("commonempty",{attrs:{description:"暂无文件"}}),i._v(" "),s("div",{staticClass:"disk-file-list"},[s("van-pull-refresh",{attrs:{disabled:i.finished},on:{refresh:i.doRefresh},model:{value:i.refreshing,callback:function(e){i.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{finished:i.finished,"finished-text":""},on:{load:i.onLoad},model:{value:i.loading,callback:function(e){i.loading=e},expression:"loading"}},i._l(i.list,function(e,t){return s("file-item",{key:t,attrs:{item:e},on:{doRefresh:i.doRefresh}})}),1)],1)],1),i._v(" "),s("add-file",{attrs:{listType:1,show:i.addFile},on:{closeAddFile:i.closeAddFile}}),i._v(" "),s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:i.showSelect,callback:function(e){i.showSelect=e},expression:"showSelect"}},[s("div",{staticClass:"select-contain"},[s("div",{staticClass:"checkbox"},[i._v("多选")]),i._v(" "),i._l(i.selectList,function(e,t){return s("div",{key:t,staticClass:"select-box"},[s("span",[i._v(i._s(e.name))]),i._v(" "),s("div",i._l(e.term,function(t,e){return s("p",{key:e,class:{active:i.selected==t.value},on:{click:function(e){return i.changeSelect(t.value)}}},[i._v(i._s(t.name))])}),0)])}),i._v(" "),s("div",{staticClass:"btn"},[s("div",{class:{reset:2!=i.selected},on:{click:i.resetSelect}},[i._v("重置")]),i._v(" "),s("div",{staticClass:"finish",on:{click:i.closeSelect}},[i._v("完成")])])],2)])],1)},[],!1,null,"799af432",null).exports,m=a(69273),g=a(20629),_=a(25108);function y(t,e){var i,s=n()(t);return o()&&(i=o()(t),e&&(i=i.filter(function(e){return l()(t,e).enumerable})),s.push.apply(s,i)),s}var T={name:"teamFile",components:{FileItem:t.Z,FileGrid:i.Z,AddFile:r.Z,fileTypeIcon:m.Z},props:{},data:function(){var e={list:[],finished:!1,loading:!1,refreshing:!1,start:1,limit:15,curTab:0,allowAddFile:!1,nodata:!1,showBatch:!1,result:[],isCheckAll:!0,addFolder:!1,folderName:"",direList:[],direFid:"",curFid:"",moveFolder:!1,actionType:"",canUpload:!1,showSelect:!1,selected:5,selectList:[{name:"按名称",term:[{name:"从A到Z",orderType:1,reversed:!1,value:1},{name:"从Z到A",orderType:1,reversed:!0,value:2}]},{name:"更新时间",term:[{name:"从近到远",orderType:3,reversed:!0,value:3},{name:"从远到近",orderType:3,reversed:!1,value:4}]},{name:"创建时间",term:[{name:"从近到远",orderType:2,reversed:!0,value:5},{name:"从远到近",orderType:2,reversed:!1,value:6}]},{name:"文件大小",term:[{name:"从小到大",orderType:4,reversed:!1,value:7},{name:"从大到小",orderType:4,reversed:!0,value:8}]}],orderType:2,reversed:!0};return(0,c.Z)(e,"orderType",2),(0,c.Z)(e,"reversed",!0),(0,c.Z)(e,"topDireList",[]),(0,c.Z)(e,"listType",""),e},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach(function(e){(0,c.Z)(t,e,i[e])}):s()?Object.defineProperties(t,s()(i)):y(Object(i)).forEach(function(e){Object.defineProperty(t,e,l()(i,e))})}return t}({},(0,g.rn)({diskMenuType:function(e){return e.diskMenuType}})),watch:{diskMenuType:function(){this.doRefresh()}},created:function(){},mounted:function(){this.checkFolderUpload(),this.getTopDireList()},methods:{getIconClass:function(e){},onLoad:function(){var i=this,s=this;s.nodata=!1,dsf.http.post("fn/cloud/file/list",{fid:0,listType:this.diskMenuType,pageNo:this.start,pageSize:this.limit,orderType:this.orderType,reversed:this.reversed},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;_.log(e,t),200===t?(0==e.data.length&&1==s.start&&(s.nodata=!0),e&&e.data&&0<e.data.length&&(e.data.forEach(function(e){e.lastUpdateTime=e.lastUpdateTime?moment(new Date(e.lastUpdateTime)).calendar():""}),s.list=s.list.concat(e.data)),e.data.length<s.limit?i.finished=!0:s.start+=1):(i.finished=!0,s.nodata=!0)}).catch(function(e){e.message;i.finished=!0,s.nodata=!0}).finally(function(){i.loading=!1,i.refreshing=!1})},doRefresh:function(e){this.keyword=e,this.start=1,this.list=[],this.finished=!1,this.loading=!0,this.onLoad()},changeTab:function(e){this.curTab=e},onSelect:function(e){this.shareName=e.name,this.showShare=!1},closeAddFile:function(){this.allowAddFile=!1,this.doRefresh()},closeSelect:function(){this.showSelect=!1},changeSelect:function(e){this.selected=e.value,this.orderType=e.orderType,this.reversed=e.reversed,this.doRefresh(),this.showSelect=!1},resetSelect:function(){this.selected=0,this.orderType=2,this.reversed=!1,this.showSelect=!1,this.doRefresh()},checkFolderUpload:function(){var i=this;dsf.http.post("ctrl/cloud/privilege/checkFolderUpload",{fileId:"0",listType:this.diskMenuType},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;_.log(e,t),200===t&&e.data&&(i.canUpload=!0)}).catch(function(e){e.message}).finally(function(){})},handleLongPress:function(){this.showBatch=!0,this.result=[]},complete:function(){this.showBatch=!1,this.result=[]},selectAll:function(){var t=this;this.isCheckAll?(this.result=[],this.list.forEach(function(e){t.result.push(e.id)})):this.result=[],this.isCheckAll=!this.isCheckAll},resultChange:function(){this.result.length==this.list.length?this.isCheckAll=!1:this.isCheckAll=!0},doRealFadeIn:function(){var e=this;this.$toast.loading({forbidClick:!0,message:"正在检查相关权限..."}),dsf.http.post("/fn/cloud/privilege/checkBatchMenuRight",{itemType:"move",fileIdList:this.result},{headers:{"Content-Type":"application/json"}}).then(function(t){var i;t.data&&"200"==t.data.code&&(t.data.data.forbidList&&0<t.data.data.forbidList.length?(i="",e.list.forEach(function(e){t.data.data.forbidList.includes(e.id)&&(i?i+="[".concat(e.name,"]、"):i="[".concat(e.name,"]"))}),dsf.layer.toast("所选文件："+i+"无权或不支持")):e.moveFolder=!0)}).catch(function(e){}).finally(function(){e.$toast.clear()})},batchAdd:function(){0==this.result.length?dsf.layer.toast("请选择需要操作的记录！"):(this.curFid="",this.actionType="addTo",this.doRealFadeIn())},batchMove:function(){0==this.result.length?dsf.layer.toast("请选择需要操作的记录！"):(this.curFid="",this.actionType="move",this.doRealFadeIn())},batchDelete:function(){var t=this;0==this.result.length?dsf.layer.toast("请选择需要操作的记录！"):(this.$toast.loading({forbidClick:!0,message:"文件操作中..."}),dsf.http.post("/fn/cloud/recyclebin/delete",{fileIds:this.result.join(",")}).then(function(e){t.$toast.clear(),e.data&&"200"==e.data.code?(dsf.layer.toast("操作成功"),t.showBatch=!1,t.moveFolder=!1,t.doRefresh()):dsf.layer.toast(e.data.message)}).catch(function(e){t.$toast.clear()}).finally(function(){}))},closePopup:function(){this.showItem=!1},goDireTop:function(e){this.listType=e.value,this.curFid="0",this.getDireList()},getDireList:function(){var t=this;dsf.http.post("/fn/cloud/file/getDirectoryTree",{fid:this.curFid||0,listType:this.listType,excludeIds:this.result},{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&(t.direList=e.data.data)}).catch(function(e){}).finally(function(){})},goBackUp:function(){var e;""==this.curFid?(this.moveFolder=!1,this.closePopup()):"0"==this.curFid?this.curFid="":(""==this.direFid?this.curFid="0":this.curFid==this.direFid?(this.curFid="0",this.direFid=""):(e=this.direFid.split(","),this.curFid=e[e.length-2],this.direFid=e.slice(0,-1).join(",")),this.getDireList())},goDire:function(e){this.direFid?this.direFid+=","+e.id:this.direFid=e.id,this.curFid=e.id,this.getDireList()},fadeinThis:function(){var t=this;this.$toast.loading({forbidClick:!0,message:"文件操作中..."}),"move"==this.actionType?dsf.http.post("/fn/cloud/file/move",{fileIds:this.result,listType:this.listType,targetId:this.curFid||0},{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&(dsf.layer.toast("操作成功"),t.showBatch=!1,t.moveFolder=!1,t.doRefresh())}).catch(function(e){}).finally(function(){t.$toast.clear()}):"addTo"==this.actionType&&dsf.http.post("/fn/cloud/file/copy",{fileIds:this.result,listType:this.listType,targetId:this.curFid||0,excludeId:this.result},{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&(dsf.layer.toast("操作成功"),t.showBatch=!1,t.moveFolder=!1)}).catch(function(e){}).finally(function(){t.$toast.clear()})},getTopDireList:function(){var t=this;dsf.http.post("/fn/cloud/privilege/getLeftCopyItem",{}).then(function(e){e.data&&"200"==e.data.code&&(t.topDireList=e.data.data)}).catch(function(e){}).finally(function(){})}}},T=(0,f.Z)(T,function(){var i=this,s=i._self._c;return s("div",{staticClass:"teamFile"},[s("div",{staticClass:"order"},[s("p",{staticClass:"title"},[i._v("文件列表")]),i._v(" "),s("p",{staticClass:"icons"},[s("img",{attrs:{src:a(40297),alt:""},on:{click:function(e){i.showSelect=!0}}})])]),i._v(" "),0!=i.list.length||i.loading?i._e():s("commonempty",{attrs:{description:"暂无文件"}}),i._v(" "),s("div",{staticClass:"disk-file-list"},[s("van-pull-refresh",{attrs:{disabled:i.finished},on:{refresh:i.doRefresh},model:{value:i.refreshing,callback:function(e){i.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{finished:i.finished,"finished-text":""},on:{load:i.onLoad},model:{value:i.loading,callback:function(e){i.loading=e},expression:"loading"}},[s("van-checkbox-group",{on:{change:i.resultChange},model:{value:i.result,callback:function(e){i.result=e},expression:"result"}},i._l(i.list,function(e,t){return s("div",{key:t,staticClass:"itembox"},[i.showBatch?s("van-checkbox",{attrs:{name:e.id}}):i._e(),i._v(" "),s("file-item",{directives:[{name:"long-press",rawName:"v-long-press",value:i.handleLongPress,expression:"handleLongPress"}],attrs:{item:e},on:{doRefresh:i.doRefresh}})],1)}),0)],1)],1)],1),i._v(" "),s("div",{staticClass:"file-grid",staticStyle:{display:"none"}},i._l(5,function(e,t){return s("div",{key:t,staticClass:"grid-box"},[s("file-grid")],1)}),0),i._v(" "),i.canUpload?s("div",{staticClass:"addBtn",on:{click:function(e){i.allowAddFile=!0}}},[s("img",{attrs:{src:a(14294),alt:""}})]):i._e(),i._v(" "),s("add-file",{attrs:{listType:i.diskMenuType,show:i.allowAddFile},on:{closeAddFile:i.closeAddFile}}),i._v(" "),s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:i.showSelect,callback:function(e){i.showSelect=e},expression:"showSelect"}},[s("div",{staticClass:"select-contain"},[i._l(i.selectList,function(e,t){return s("div",{key:t,staticClass:"select-box"},[s("span",[i._v(i._s(e.name))]),i._v(" "),s("div",i._l(e.term,function(t,e){return s("p",{key:e,class:{active:i.selected==t.value},on:{click:function(e){return i.changeSelect(t)}}},[i._v(i._s(t.name))])}),0)])}),i._v(" "),s("div",{staticClass:"btn"},[s("div",{class:{reset:2!=i.selected},on:{click:i.resetSelect}},[i._v("重置")]),i._v(" "),s("div",{staticClass:"finish",on:{click:i.closeSelect}},[i._v("完成")])])],2)]),i._v(" "),i.showBatch?s("div",{staticClass:"batchTop"},[s("span",[i._v("已选"+i._s(i.result.length)+"项")]),i._v(" "),s("p",[s("span",{on:{click:i.selectAll}},[i._v(i._s(i.isCheckAll?"全选":"取消全选"))]),i._v(" "),s("span",{on:{click:i.complete}},[i._v("完成")])])]):i._e(),i._v(" "),i.showBatch?s("div",{staticClass:"batchBottom"},[s("p",{on:{click:i.batchAdd}},[s("img",{attrs:{src:a(66340),alt:""}}),i._v(" "),s("span",[i._v("添加到")])]),i._v(" "),s("p",{on:{click:i.batchMove}},[s("img",{attrs:{src:a(66340),alt:""}}),i._v(" "),s("span",[i._v("移动到")])]),i._v(" "),s("p",{on:{click:i.batchDelete}},[s("img",{attrs:{src:a(79158),alt:""}}),i._v(" "),s("span",[i._v("删除")])])]):i._e(),i._v(" "),s("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},on:{close:i.closePopup},model:{value:i.moveFolder,callback:function(e){i.moveFolder=e},expression:"moveFolder"}},[s("div",{staticClass:"directory"},[s("van-nav-bar",{attrs:{title:"云盘","left-text":"返回","left-arrow":""},on:{"click-left":i.goBackUp}}),i._v(" "),""!=i.curFid?s("div",{staticClass:"direList"},i._l(i.direList,function(t,e){return s("div",{key:e,staticClass:"dire",on:{click:function(e){return i.goDire(t)}}},[s("div",{staticClass:"fileIcon"},[s("fileTypeIcon",{attrs:{"file-name":t.name,width:32,height:38,isDirectory:t.isDirectory}})],1),i._v(" "),s("div",{staticClass:"fileBody"},[s("div",{staticClass:"fileTitle"},[i._v(i._s(t.name))]),i._v(" "),s("div",{staticClass:"filePath"},[s("label",[i._v(i._s(t.fileSizeText))]),i._v(" "),s("label",[i._v(i._s(t.ownerName))]),i._v(" "),s("label",[i._v(i._s(t.lastUpdateTime)+" 更新")])])]),i._v(" "),s("div",{staticClass:"moreIcon"},[s("img",{attrs:{src:a(12547),alt:""}})])])}),0):i._e(),i._v(" "),""==i.curFid?s("div",{staticClass:"direList"},i._l(i.topDireList,function(t,e){return s("div",{key:e,staticClass:"dire",on:{click:function(e){return i.goDireTop(t)}}},[s("div",{staticClass:"fileIcon"},[s("fileTypeIcon",{attrs:{"file-name":t.name,width:32,height:38,isDirectory:1}})],1),i._v(" "),s("div",{staticClass:"fileBody"},[s("div",{staticClass:"fileTitle"},[i._v(i._s(t.name))])]),i._v(" "),s("div",{staticClass:"moreIcon"},[s("img",{attrs:{src:a(12547),alt:""}})])])}),0):i._e(),i._v(" "),""!=i.curFid?s("div",{staticClass:"direButton"},[s("van-button",{attrs:{type:"info"},on:{click:i.fadeinThis}},[i._v(i._s("move"==i.actionType?"移动到这里":"添加到这里"))])],1):i._e()],1)])],1)},[],!1,null,"2e65698b",null).exports,k=a(25108),C={name:"myCollect",components:{FileItem:t.Z,FileGrid:i.Z,AddFile:r.Z},props:{},data:function(){return{list:[],finished:!1,loading:!1,refreshing:!1,start:1,limit:15,curTab:1,showShare:!1,addFile:!1,showSelect:!1,selected:5,selectList:[{name:"按名称",term:[{name:"从A到Z",orderType:1,reversed:!1,value:1},{name:"从Z到A",orderType:1,reversed:!0,value:2}]},{name:"更新时间",term:[{name:"从近到远",orderType:3,reversed:!1,value:3},{name:"从远到近",orderType:3,reversed:!0,value:4}]},{name:"创建时间",term:[{name:"从近到远",orderType:2,reversed:!1,value:5},{name:"从远到近",orderType:2,reversed:!0,value:6}]},{name:"文件大小",term:[{name:"从小到大",orderType:4,reversed:!1,value:7},{name:"从大到小",orderType:4,reversed:!0,value:8}]}],orderType:2,reversed:!1,nodata:!1,tab:1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{getIconClass:function(e){},onLoad:function(){var i=this,s=this,e=(s.nodata=!1,1==this.curTab?"fn/cloud/file/shareList":"fn/cloud/file/myShare");dsf.http.post(e,{pageNo:this.start,pageSize:this.limit,orderType:this.orderType,reversed:this.reversed},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;k.log(e,t),200===t?(0==e.data.length&&1==s.start&&(s.nodata=!0),e&&e.data&&0<e.data.length&&(e.data.forEach(function(e){e.lastUpdateTime=e.lastUpdateTime?moment(new Date(e.lastUpdateTime)).calendar():""}),s.list=s.list.concat(e.data)),e.data.length<s.limit?i.finished=!0:s.start+=1):(i.finished=!0,s.nodata=!0)}).catch(function(e){e.message;i.finished=!0,s.nodata=!0}).finally(function(){i.loading=!1,i.refreshing=!1})},doRefresh:function(){this.start=1,this.list=[],this.finished=!1,this.loading=!0,this.onLoad()},changeTab:function(e){this.curTab=e,this.doRefresh()},onSelect:function(e){this.shareName=e.name,this.showShare=!1},closeAddFile:function(){this.addFile=!1},closeSelect:function(){this.showSelect=!1},changeSelect:function(e){this.selected=e.value,this.orderType=e.orderType,this.reversed=e.reversed,this.doRefresh(),this.showSelect=!1},resetSelect:function(){this.selected=0,this.orderType=2,this.reversed=!1,this.showSelect=!1,this.doRefresh()}}},C=(0,f.Z)(C,function(){var i=this,s=i._self._c;return s("div",{staticClass:"teamFile"},[s("div",{staticClass:"shareTab"},[s("p",{staticClass:"tab"},[s("span",{class:{active:1==i.curTab},on:{click:function(e){return i.changeTab(1)}}},[i._v("分享给我")]),i._v(" "),s("span",{class:{active:2==i.curTab},on:{click:function(e){return i.changeTab(2)}}},[i._v("我的分享")])]),i._v(" "),s("p",{staticClass:"icons"},[s("img",{attrs:{src:a(40297),alt:""},on:{click:function(e){i.showSelect=!0}}})])]),i._v(" "),0!=i.list.length||i.loading?i._e():s("commonempty",{attrs:{description:"暂无文件"}}),i._v(" "),s("div",{staticClass:"disk-file-list"},[s("van-pull-refresh",{attrs:{disabled:i.finished},on:{refresh:i.doRefresh},model:{value:i.refreshing,callback:function(e){i.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{finished:i.finished,"finished-text":""},on:{load:i.onLoad},model:{value:i.loading,callback:function(e){i.loading=e},expression:"loading"}},i._l(i.list,function(e,t){return s("file-item",{key:t,attrs:{item:e},on:{doRefresh:i.doRefresh}})}),1)],1)],1),i._v(" "),s("add-file",{attrs:{listType:1,show:i.addFile},on:{closeAddFile:i.closeAddFile}}),i._v(" "),s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:i.showSelect,callback:function(e){i.showSelect=e},expression:"showSelect"}},[s("div",{staticClass:"select-contain"},[i._l(i.selectList,function(e,t){return s("div",{key:t,staticClass:"select-box"},[s("span",[i._v(i._s(e.name))]),i._v(" "),s("div",i._l(e.term,function(t,e){return s("p",{key:e,class:{active:i.selected==t.value},on:{click:function(e){return i.changeSelect(t)}}},[i._v(i._s(t.name))])}),0)])}),i._v(" "),s("div",{staticClass:"btn"},[s("div",{class:{reset:2!=i.selected},on:{click:i.resetSelect}},[i._v("重置")]),i._v(" "),s("div",{staticClass:"finish",on:{click:i.closeSelect}},[i._v("完成")])])],2)])],1)},[],!1,null,"1a9ff219",null).exports,b=a(71763),w=a(34527),F=a(25108),S={name:"commonFileList",components:{FileItem:t.Z,FileGrid:i.Z,AddFile:r.Z},props:{},data:function(){return{list:[],finished:!1,loading:!1,refreshing:!1,start:1,limit:15,curTab:0,showShare:!1,shareName:"分享给我",actions:[{name:"分享给我"},{name:"我分享的"}],addFile:!1,showSelect:!1,selected:2,selectList:[{name:"按名称",term:[{name:"从A到Z",value:0},{name:"从Z到A",value:1}]},{name:"更新时间",term:[{name:"从近到远",value:2},{name:"从远到近",value:3}]},{name:"创建时间",term:[{name:"从近到远",value:4},{name:"从远到近",value:5}]}],nodata:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{getIconClass:function(e){},onLoad:function(){var i=this,s=this;s.nodata=!1,dsf.http.post("ctrl/cloud/file/getDirectoryTree",{listType:1,fid:0},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;F.log(e,t),200===t?(0==e.data.length&&1==s.start&&(s.nodata=!0),e&&e.data&&0<e.data.length&&(e.data.forEach(function(e){e.lastUpdateTime=e.lastUpdateTime?moment(new Date(e.lastUpdateTime)).calendar():""}),s.list=s.list.concat(e.data)),e.data.length<s.limit?i.finished=!0:s.start+=1):(i.finished=!0,s.nodata=!0)}).catch(function(e){e.message;i.finished=!0,s.nodata=!0}).finally(function(){i.loading=!1,i.refreshing=!1})},doRefresh:function(e){this.keyword=e,this.start=1,this.list=[],this.finished=!1,this.loading=!0,this.onLoad()},changeTab:function(e){this.curTab=e},onSelect:function(e){this.shareName=e.name,this.showShare=!1},closeAddFile:function(){this.addFile=!1},closeSelect:function(){this.showSelect=!1},changeSelect:function(e){this.selected=e},resetSelect:function(){this.selected=2}}},S=(0,f.Z)(S,function(){var i=this,s=i._self._c;return s("div",{staticClass:"teamFile"},[s("div",{staticClass:"disk-file-list"},[s("van-pull-refresh",{attrs:{disabled:i.finished},on:{refresh:i.doRefresh},model:{value:i.refreshing,callback:function(e){i.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{finished:i.finished,"finished-text":""},on:{load:i.onLoad},model:{value:i.loading,callback:function(e){i.loading=e},expression:"loading"}},i._l(i.list,function(e,t){return s("file-item",{key:t,attrs:{item:e}})}),1)],1)],1),i._v(" "),s("div",{staticClass:"addBtn",on:{click:function(e){i.addFile=!0}}},[s("img",{attrs:{src:a(14294),alt:""}})]),i._v(" "),s("add-file",{attrs:{listType:1,show:i.addFile},on:{closeAddFile:i.closeAddFile}}),i._v(" "),s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:i.showSelect,callback:function(e){i.showSelect=e},expression:"showSelect"}},[s("div",{staticClass:"select-contain"},[s("div",{staticClass:"checkbox"},[i._v("多选")]),i._v(" "),i._l(i.selectList,function(e,t){return s("div",{key:t,staticClass:"select-box"},[s("span",[i._v(i._s(e.name))]),i._v(" "),s("div",i._l(e.term,function(t,e){return s("p",{key:e,class:{active:i.selected==t.value},on:{click:function(e){return i.changeSelect(t.value)}}},[i._v(i._s(t.name))])}),0)])}),i._v(" "),s("div",{staticClass:"btn"},[s("div",{class:{reset:2!=i.selected},on:{click:i.resetSelect}},[i._v("重置")]),i._v(" "),s("div",{staticClass:"finish",on:{click:i.closeSelect}},[i._v("完成")])])],2)])],1)},[],!1,null,"a007bb0e",null).exports,x=a(25108);function L(t,e){var i,s=n()(t);return o()&&(i=o()(t),e&&(i=i.filter(function(e){return l()(t,e).enumerable})),s.push.apply(s,i)),s}var t={name:"teamFile",components:{FileItem:t.Z,FileGrid:i.Z,AddFile:r.Z,fileTypeIcon:m.Z},props:{},data:function(){return{list:[],finished:!1,loading:!1,refreshing:!1,start:1,limit:15,curTab:0,allowAddFile:!1,nodata:!1,showBatch:!1,result:[],isCheckAll:!0,addFolder:!1,folderName:"",direList:[],direFid:"",curFid:"",moveFolder:!1,actionType:"",canUpload:!1,showSelect:!1,selected:5,selectList:[{name:"按名称",term:[{name:"从A到Z",orderType:1,reversed:!1,value:1},{name:"从Z到A",orderType:1,reversed:!0,value:2}]},{name:"更新时间",term:[{name:"从近到远",orderType:3,reversed:!0,value:3},{name:"从远到近",orderType:3,reversed:!1,value:4}]},{name:"创建时间",term:[{name:"从近到远",orderType:2,reversed:!0,value:5},{name:"从远到近",orderType:2,reversed:!1,value:6}]},{name:"文件大小",term:[{name:"从小到大",orderType:4,reversed:!1,value:7},{name:"从大到小",orderType:4,reversed:!0,value:8}]}],orderType:2,reversed:!0,topDireList:[],listType:""}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?L(Object(i),!0).forEach(function(e){(0,c.Z)(t,e,i[e])}):s()?Object.defineProperties(t,s()(i)):L(Object(i)).forEach(function(e){Object.defineProperty(t,e,l()(i,e))})}return t}({},(0,g.rn)({diskMenuType:function(e){return e.diskMenuType}})),watch:{diskMenuType:function(){this.doRefresh()}},created:function(){},mounted:function(){this.checkFolderUpload(),this.getTopDireList()},methods:{getIconClass:function(e){},onLoad:function(){var i=this,s=this;s.nodata=!1,dsf.http.post("fn/cloud/file/list",{fid:0,listType:this.diskMenuType,pageNo:this.start,pageSize:this.limit,orderType:this.orderType,reversed:this.reversed},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;x.log(e,t),200===t?(0==e.data.length&&1==s.start&&(s.nodata=!0),e&&e.data&&0<e.data.length&&(e.data.forEach(function(e){e.lastUpdateTime=e.lastUpdateTime?moment(new Date(e.lastUpdateTime)).calendar():""}),s.list=s.list.concat(e.data)),e.data.length<s.limit?i.finished=!0:s.start+=1):(i.finished=!0,s.nodata=!0)}).catch(function(e){e.message;i.finished=!0,s.nodata=!0}).finally(function(){i.loading=!1,i.refreshing=!1})},doRefresh:function(){this.start=1,this.list=[],this.finished=!1,this.loading=!0,this.onLoad()},changeTab:function(e){this.curTab=e},onSelect:function(e){this.shareName=e.name,this.showShare=!1},closeAddFile:function(){this.allowAddFile=!1,this.doRefresh()},closeSelect:function(){this.showSelect=!1},changeSelect:function(e){this.selected=e.value,this.orderType=e.orderType,this.reversed=e.reversed,this.doRefresh(),this.showSelect=!1},resetSelect:function(){this.selected=0,this.orderType=2,this.reversed=!1,this.showSelect=!1,this.doRefresh()},handleLongPress:function(){this.showBatch=!0,this.result=[]},complete:function(){this.showBatch=!1,this.result=[]},selectAll:function(){var t=this;this.isCheckAll?(this.result=[],this.list.forEach(function(e){t.result.push(e.id)})):this.result=[],this.isCheckAll=!this.isCheckAll},resultChange:function(){this.result.length==this.list.length?this.isCheckAll=!1:this.isCheckAll=!0},doRealFadeIn:function(){var e=this;this.$toast.loading({forbidClick:!0,message:"正在检查相关权限..."}),dsf.http.post("/fn/cloud/privilege/checkBatchMenuRight",{itemType:"move",fileIdList:this.result},{headers:{"Content-Type":"application/json"}}).then(function(t){var i;t.data&&"200"==t.data.code&&(t.data.data.forbidList&&0<t.data.data.forbidList.length?(i="",e.list.forEach(function(e){t.data.data.forbidList.includes(e.id)&&(i?i+="[".concat(e.name,"]、"):i="[".concat(e.name,"]"))}),dsf.layer.toast("所选文件："+i+"无权或不支持")):e.moveFolder=!0)}).catch(function(e){}).finally(function(){e.$toast.clear()})},batchAdd:function(){0==this.result.length?dsf.layer.toast("请选择需要操作的记录！"):(this.curFid="",this.actionType="addTo",this.doRealFadeIn())},batchMove:function(){0==this.result.length?dsf.layer.toast("请选择需要操作的记录！"):(this.curFid="",this.actionType="move",this.doRealFadeIn())},batchDelete:function(){var t=this;0==this.result.length?dsf.layer.toast("请选择需要操作的记录！"):(this.$toast.loading({forbidClick:!0,message:"文件操作中..."}),dsf.http.post("/fn/cloud/recyclebin/delete",{fileIds:this.result.join(",")}).then(function(e){e.data&&"200"==e.data.code&&(dsf.layer.toast("操作成功"),t.showBatch=!1,t.moveFolder=!1,t.doRefresh())}).catch(function(e){}).finally(function(){t.$toast.clear()}))},closePopup:function(){this.showItem=!1},goDireTop:function(e){this.listType=e.value,this.curFid="0",this.getDireList()},getDireList:function(){var t=this;dsf.http.post("/fn/cloud/file/getDirectoryTree",{fid:this.curFid||0,listType:this.listType,excludeIds:this.result},{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&(t.direList=e.data.data)}).catch(function(e){}).finally(function(){})},goBackUp:function(){var e;""==this.curFid?(this.moveFolder=!1,this.closePopup()):"0"==this.curFid?this.curFid="":(""==this.direFid?this.curFid="0":this.curFid==this.direFid?(this.curFid="0",this.direFid=""):(e=this.direFid.split(","),this.curFid=e[e.length-2],this.direFid=e.slice(0,-1).join(",")),this.getDireList())},goDire:function(e){this.direFid?this.direFid+=","+e.id:this.direFid=e.id,this.curFid=e.id,this.getDireList()},fadeinThis:function(){var t=this;this.$toast.loading({forbidClick:!0,message:"文件操作中..."}),"move"==this.actionType?dsf.http.post("/fn/cloud/file/move",{fileIds:this.result,listType:this.listType,targetId:this.curFid||0},{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&(dsf.layer.toast("操作成功"),t.showBatch=!1,t.moveFolder=!1,t.doRefresh())}).catch(function(e){}).finally(function(){t.$toast.clear()}):"addTo"==this.actionType&&dsf.http.post("/fn/cloud/file/copy",{fileIds:this.result,listType:this.listType,targetId:this.curFid||0,excludeId:this.result},{headers:{"Content-Type":"application/json"}}).then(function(e){e.data&&"200"==e.data.code&&(dsf.layer.toast("操作成功"),t.showBatch=!1,t.moveFolder=!1,t.doRefresh())}).catch(function(e){}).finally(function(){t.$toast.clear()})},checkFolderUpload:function(){var i=this;dsf.http.post("ctrl/cloud/privilege/checkFolderUpload",{fileId:"0",listType:this.diskMenuType},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;x.log(e,t),200===t&&e.data&&(i.canUpload=!0)}).catch(function(e){e.message}).finally(function(){})},getTopDireList:function(){var t=this;dsf.http.post("/fn/cloud/privilege/getLeftCopyItem",{}).then(function(e){e.data&&"200"==e.data.code&&(t.topDireList=e.data.data)}).catch(function(e){}).finally(function(){})}}},i=(0,f.Z)(t,function(){var i=this,s=i._self._c;return s("div",{staticClass:"teamFile",class:{batch:i.showBatch}},[s("div",{staticClass:"order"},[s("p",{staticClass:"title"},[i._v("文件列表")]),i._v(" "),s("p",{staticClass:"icons"},[s("img",{attrs:{src:a(40297),alt:""},on:{click:function(e){i.showSelect=!0}}})])]),i._v(" "),0!=i.list.length||i.loading?i._e():s("commonempty",{attrs:{description:"暂无文件"}}),i._v(" "),s("div",{staticClass:"disk-file-list"},[s("van-pull-refresh",{attrs:{disabled:i.finished},on:{refresh:i.doRefresh},model:{value:i.refreshing,callback:function(e){i.refreshing=e},expression:"refreshing"}},[s("van-list",{attrs:{finished:i.finished,"finished-text":""},on:{load:i.onLoad},model:{value:i.loading,callback:function(e){i.loading=e},expression:"loading"}},[s("van-checkbox-group",{on:{change:i.resultChange},model:{value:i.result,callback:function(e){i.result=e},expression:"result"}},i._l(i.list,function(e,t){return s("div",{key:t,staticClass:"itembox"},[i.showBatch?s("van-checkbox",{attrs:{name:e.id}}):i._e(),i._v(" "),s("file-item",{directives:[{name:"long-press",rawName:"v-long-press",value:i.handleLongPress,expression:"handleLongPress"}],attrs:{item:e},on:{doRefresh:i.doRefresh}})],1)}),0)],1)],1)],1),i._v(" "),s("div",{staticClass:"file-grid",staticStyle:{display:"none"}},i._l(5,function(e,t){return s("div",{key:t,staticClass:"grid-box"},[s("file-grid")],1)}),0),i._v(" "),i.canUpload?s("div",{staticClass:"addBtn",on:{click:function(e){i.allowAddFile=!0}}},[s("img",{attrs:{src:a(14294),alt:""}})]):i._e(),i._v(" "),s("add-file",{attrs:{listType:4,show:i.allowAddFile,fid:"0"},on:{closeAddFile:i.closeAddFile}}),i._v(" "),s("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:i.showSelect,callback:function(e){i.showSelect=e},expression:"showSelect"}},[s("div",{staticClass:"select-contain"},[i._l(i.selectList,function(e,t){return s("div",{key:t,staticClass:"select-box"},[s("span",[i._v(i._s(e.name))]),i._v(" "),s("div",i._l(e.term,function(t,e){return s("p",{key:e,class:{active:i.selected==t.value},on:{click:function(e){return i.changeSelect(t)}}},[i._v(i._s(t.name))])}),0)])}),i._v(" "),s("div",{staticClass:"btn"},[s("div",{class:{reset:2!=i.selected},on:{click:i.resetSelect}},[i._v("重置")]),i._v(" "),s("div",{staticClass:"finish",on:{click:i.closeSelect}},[i._v("完成")])])],2)]),i._v(" "),i.showBatch?s("div",{staticClass:"batchTop"},[s("span",[i._v("已选"+i._s(i.result.length)+"项")]),i._v(" "),s("p",[s("span",{on:{click:i.selectAll}},[i._v(i._s(i.isCheckAll?"全选":"取消全选"))]),i._v(" "),s("span",{on:{click:i.complete}},[i._v("完成")])])]):i._e(),i._v(" "),i.showBatch?s("div",{staticClass:"batchBottom"},[s("p",{on:{click:i.batchAdd}},[s("img",{attrs:{src:a(66340),alt:""}}),i._v(" "),s("span",[i._v("添加到")])]),i._v(" "),s("p",{on:{click:i.batchMove}},[s("img",{attrs:{src:a(66340),alt:""}}),i._v(" "),s("span",[i._v("移动到")])]),i._v(" "),s("p",{on:{click:i.batchDelete}},[s("img",{attrs:{src:a(79158),alt:""}}),i._v(" "),s("span",[i._v("删除")])])]):i._e(),i._v(" "),s("van-popup",{style:{height:"100%"},attrs:{position:"bottom"},on:{close:i.closePopup},model:{value:i.moveFolder,callback:function(e){i.moveFolder=e},expression:"moveFolder"}},[s("div",{staticClass:"directory"},[s("van-nav-bar",{attrs:{title:"云盘","left-text":"返回","left-arrow":""},on:{"click-left":i.goBackUp}}),i._v(" "),""!=i.curFid?s("div",{staticClass:"direList"},i._l(i.direList,function(t,e){return s("div",{key:e,staticClass:"dire",on:{click:function(e){return i.goDire(t)}}},[s("div",{staticClass:"fileIcon"},[s("fileTypeIcon",{attrs:{"file-name":t.name,width:32,height:38,isDirectory:t.isDirectory}})],1),i._v(" "),s("div",{staticClass:"fileBody"},[s("div",{staticClass:"fileTitle"},[i._v(i._s(t.name))]),i._v(" "),s("div",{staticClass:"filePath"},[s("label",[i._v(i._s(t.fileSizeText))]),i._v(" "),s("label",[i._v(i._s(t.ownerName))]),i._v(" "),s("label",[i._v(i._s(t.lastUpdateTime)+" 更新")])])]),i._v(" "),s("div",{staticClass:"moreIcon"},[s("img",{attrs:{src:a(12547),alt:""}})])])}),0):i._e(),i._v(" "),""==i.curFid?s("div",{staticClass:"direList"},i._l(i.topDireList,function(t,e){return s("div",{key:e,staticClass:"dire",on:{click:function(e){return i.goDireTop(t)}}},[s("div",{staticClass:"fileIcon"},[s("fileTypeIcon",{attrs:{"file-name":t.name,width:32,height:38,isDirectory:1}})],1),i._v(" "),s("div",{staticClass:"fileBody"},[s("div",{staticClass:"fileTitle"},[i._v(i._s(t.name))])]),i._v(" "),s("div",{staticClass:"moreIcon"},[s("img",{attrs:{src:a(12547),alt:""}})])])}),0):i._e(),i._v(" "),""!=i.curFid?s("div",{staticClass:"direButton"},[s("van-button",{attrs:{type:"info"},on:{click:i.fadeinThis}},[i._v(i._s("move"==i.actionType?"移动到这里":"添加到这里"))])],1):i._e()],1)])],1)},[],!1,null,"2d6cdc62",null).exports,A=a(25108);function I(t,e){var i,s=n()(t);return o()&&(i=o()(t),e&&(i=i.filter(function(e){return l()(t,e).enumerable})),s.push.apply(s,i)),s}var r={name:"cloudDisk",components:{recentlyFile:u,myCollect:p,teamFile:T,myShare:C,searchList:b.default,CommonHead:w.Z,commonFileList:S,myFile:i},data:function(){return{diskSvg:a(31703),more:a(38922),fankui:a(75762),showSearch:!1,showPopover:!1,showBack:dsf.config.appTopMenu&&dsf.config.appTopMenu.value}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(Object(i),!0).forEach(function(e){(0,c.Z)(t,e,i[e])}):s()?Object.defineProperties(t,s()(i)):I(Object(i)).forEach(function(e){Object.defineProperty(t,e,l()(i,e))})}return t}({},(0,g.rn)({active:function(e){return A.log(e.diskMenuType),e.diskMenuType}})),watch:{},methods:{onClickLeft:function(){this.$router.go(-1)},showSearchBox:function(){this.showSearch=!0},closeSearchBox:function(){this.showSearch=!1},goUpload:function(){this.$router.push({name:"uploadList"})},gofileTrends:function(){var e=this;this.showPopover=!1,setTimeout(function(){e.$router.push({name:"fileTrends"})},50)},goOutsideLink:function(){var e=this;this.showPopover=!1,setTimeout(function(){e.$router.push({name:"outsideLink"})},50)},goRecycle:function(){var e=this;this.showPopover=!1,setTimeout(function(){e.$router.push({name:"recycle"})},50)},changeType:function(e){this.active=e}},created:function(){var e=this;this.$bus.on("showSearchBox",function(){e.showSearchBox()}),this.$bus.on("closeSearchBox",function(){e.closeSearchBox()})},mounted:function(){},destroyed:function(){}},Z=(0,f.Z)(r,function(){var t=this,e=t._self._c;return e("div",{staticClass:"cloudDisk"},[e("van-nav-bar",{attrs:{title:"钉盘","left-text":t.showBack?"返回":"","left-arrow":t.showBack},on:{"click-left":t.onClickLeft},scopedSlots:t._u([{key:"right",fn:function(){return[e("van-popover",{attrs:{trigger:"click",offset:[-70,8]},scopedSlots:t._u([{key:"reference",fn:function(){return[e("van-image",{staticStyle:{"margin-left":"5px"},attrs:{width:"24",height:"24",src:t.more}})]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[e("div",{staticClass:"menus"},[e("p",{staticClass:"iconText",on:{click:t.gofileTrends}},[e("img",{attrs:{src:a(50719)}}),t._v(" "),e("span",[t._v("文件动态")])]),t._v(" "),e("p",{staticClass:"iconText",on:{click:t.goRecycle}},[e("img",{attrs:{src:a(35985)}}),t._v(" "),e("span",[t._v("回收站")])])])])]},proxy:!0}])}),t._v(" "),e("common-head"),t._v(" "),e("div",{staticClass:"content"},[100==t.active?e("recentlyFile"):101==t.active?e("myCollect"):0==t.active?e("myShare"):4==t.active?e("myFile"):e("teamFile")],1),t._v(" "),e("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"right"},model:{value:t.showSearch,callback:function(e){t.showSearch=e},expression:"showSearch"}},[t.showSearch?e("searchList",{attrs:{active:t.active}}):t._e()],1)],1)},[],!1,null,"7dc32dc0",null).exports},71763:function(e,t,i){i.r(t),i.d(t,{default:function(){return o}});var t=[function(){var e=this._self._c;return e("div",{staticClass:"fileIcon"},[e("img",{attrs:{src:i(15146),alt:""}})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"fileBody"},[t("div",{staticClass:"fileTitle"},[e._v("共性办公应用功能清单.xlsx")]),e._v(" "),t("div",{staticClass:"filePath"},[t("span",[e._v("群聊：")]),e._v(" "),t("label",[e._v("梦创双杨 /")]),e._v(" "),t("label",[e._v("团队文件 /")]),e._v(" "),t("label",[e._v("测试 /")]),e._v(" "),t("label",[e._v("一体化办公平台开发群")])])])}],s={name:"rencentItem",components:{},props:{},data:function(){return{showItem:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},a=i(51900),s=(0,a.Z)(s,function(){var t=this,e=t._self._c;return e("div",{staticClass:"rencent-item"},[t._m(0),t._v(" "),t._m(1),t._v(" "),e("div",{staticClass:"moreIcon",on:{click:function(e){t.showItem=!0}}},[e("img",{attrs:{src:i(3145),alt:""}})]),t._v(" "),e("van-popup",{attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:t.showItem,callback:function(e){t.showItem=e},expression:"showItem"}},[e("div",{staticClass:"handle-contain"},[e("div",{staticClass:"file-box"},[e("div",{staticClass:"fileIcon"},[e("img",{attrs:{src:i(15146),alt:""}})]),t._v(" "),e("div",{staticClass:"fileBody"},[e("div",{staticClass:"fileTitle"},[t._v("共性办公应用功能清单.xlsx")]),t._v(" "),e("div",{staticClass:"filePath"},[e("span",[t._v("20.6KB · 17:09")])])]),t._v(" "),e("div",{staticClass:"closeIcon",on:{click:function(e){t.showItem=!1}}},[e("img",{attrs:{src:i(63397),alt:""}})])]),t._v(" "),e("div",{staticClass:"handle-list"},[e("div",{staticClass:"handle-box"},[e("div",[e("img",{attrs:{src:i(87294),alt:""}}),t._v(" "),e("p",[e("span",[t._v("转发副本")]),t._v(" "),e("img",{attrs:{src:i(12547),alt:""}})])]),t._v(" "),e("div",[e("img",{attrs:{src:i(62228),alt:""}}),t._v(" "),e("p",[e("span",[t._v("详细信息")]),t._v(" "),e("img",{attrs:{src:i(12547),alt:""}})])]),t._v(" "),e("div",[e("img",{attrs:{src:i(94024),alt:""}}),t._v(" "),e("p",[e("span",[t._v("打开目录")]),t._v(" "),e("img",{attrs:{src:i(12547),alt:""}})])]),t._v(" "),e("div",[e("img",{attrs:{src:i(81203),alt:""}}),t._v(" "),e("p",[e("span",[t._v("清除记录")]),t._v(" "),e("img",{attrs:{src:i(12547),alt:""}})])])])])])])],1)},t,!1,null,"cfc50c42",null).exports,t=i(2319),n=i(25108),s={name:"searchList",components:{RecentItem:s,FileItem:t.Z},data:function(){return{keyword:"",hisList:[],list:[],finished:!1,loading:!1,refreshing:!1,start:1,limit:15,typeList:[],range:0,showSelect:!1,showHis:!0,nodata:!1,fileType:""}},computed:{},watch:{},methods:{getFileTypeList:function(){var i=this;dsf.http.get("fn/cloud/file/getFileSuffixSelect").then(function(e){var t=e.status,e=e.data;n.log(e.data,t),200===t&&e.data&&(e.data.forEach(function(e){e.isSelect=!1}),i.typeList=e.data)}).catch(function(e){e.message}).finally(function(){})},onClickLeft:function(){this.$bus.emit("closeSearchBox")},clearText:function(){this.keyword=""},onSearch:function(){var e;this.keyword&&((e=dsf.util.loadLocalStore("searchHis"))?e.split(",").includes(this.keyword)||(e=this.keyword+","+e,dsf.util.saveToLocalStore("searchHis",e)):dsf.util.saveToLocalStore("searchHis",this.keyword),this.showHis=!1,this.doRefresh())},removeStorage:function(){window.localStorage.removeItem("searchHis"),this.hisList=[]},initSearchList:function(){var e=dsf.util.loadLocalStore("searchHis");e&&(this.hisList=e.split(","))},onLoad:function(){this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0});var i=this;i.nodata=!1,dsf.http.post("fn/cloud/file/fileSearch",{fileName:this.keyword,fileType:this.fileType,pageNo:this.start,pageSize:this.limit},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.status,e=e.data;n.log(e,t),200===t?(e.data||(e.data=[]),0==e.data.length&&1==i.start&&(i.nodata=!0),e&&e.data&&0<e.data.length&&(e.data.forEach(function(e){e.lastUpdateTime=e.lastUpdateTime?moment(new Date(e.lastUpdateTime)).calendar():""}),i.list=i.list.concat(e.data)),e.data.length<i.limit?i.finished=!0:i.start+=1):(i.finished=!0,i.nodata=!0)}).catch(function(e){e.message;i.finished=!0,i.nodata=!0}).finally(function(){i.loading=!1,i.refreshing=!1,i.$toast.clear()})},doRefresh:function(e){e&&(this.keyword=e),this.start=1,this.list=[],this.finished=!1,this.loading=!0,this.showHis=!1,this.onLoad()},selectItem:function(e){var i=this;this.timer&&(dsf.layer.toast("请勿重复操作！"),window.clearInterval(this.timer),this.timer=null),this.timer=setTimeout(function(){i.$set(e,"isSelect",!e.isSelect);var t=[];i.typeList.map(function(e){e.isSelect&&t.push(e.value)}),i.fileType=0<t.length?t.join(","):"",i.doRefresh(),window.clearInterval(i.timer),i.timer=null},1e3)},setRange:function(e){this.range=e}},created:function(){},mounted:function(){this.initSearchList(),this.getFileTypeList()},destroyed:function(){}},o=(0,a.Z)(s,function(){var s=this,a=s._self._c;return a("div",{staticClass:"searchList"},[a("van-search",{attrs:{placeholder:"在当前企业中搜索"},on:{search:s.doRefresh,clear:s.clearText},model:{value:s.keyword,callback:function(e){s.keyword=e},expression:"keyword"}}),s._v(" "),s.showHis?a("div",{staticClass:"his"},[0<s.hisList.length?a("div",{staticClass:"recentSearch"},[a("div",{staticClass:"rs_title"},[a("span",[s._v("最近搜索")]),s._v(" "),a("van-icon",{attrs:{name:"delete-o"},on:{click:s.removeStorage}})],1),s._v(" "),0<s.hisList.length?a("div",{staticClass:"rs_list"},s._l(s.hisList,function(t,e){return a("span",{key:e,on:{click:function(e){return s.doRefresh(t)}}},[s._v(s._s(t))])}),0):s._e()]):s._e(),s._v(" "),0==s.hisList.length?a("div",{staticClass:"noData"},[a("img",{attrs:{src:i(17370)}}),s._v(" "),a("span",[s._v("输入关键词快速搜索")])]):s._e()]):s._e(),s._v(" "),s.showHis?s._e():a("div",{staticClass:"fileList"},[a("div",{staticClass:"listType"},[a("div",{staticClass:"types"},[a("div",{staticClass:"items"},[a("label",[s._v("类型：")]),s._v(" "),a("p",s._l(s.typeList,function(t,i){return a("span",{key:"file"+i,class:{active:t.isSelect},on:{click:function(e){return s.selectItem(t,i)}}},[s._v(s._s(t.name))])}),0)])])])]),s._v(" "),s.showHis?s._e():a("div",{staticClass:"lists"},[0!=s.list.length||s.loading?s._e():a("commonempty",{attrs:{description:"暂无文件"}}),s._v(" "),a("van-pull-refresh",{attrs:{disabled:s.finished},on:{refresh:s.doRefresh},model:{value:s.refreshing,callback:function(e){s.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:s.finished,"finished-text":""},on:{load:s.onLoad},model:{value:s.loading,callback:function(e){s.loading=e},expression:"loading"}},s._l(s.list,function(e,t){return a("file-item",{key:t,attrs:{item:e},on:{doRefresh:s.doRefresh}})}),1)],1)],1)],1)},[],!1,null,"0b3d991e",null).exports},14294:function(e,t,i){e.exports=i.p+"static/img/add.62676de..svg"},79158:function(e,t,i){e.exports=i.p+"static/img/delete.9d0e774..png"},31703:function(e,t,i){e.exports=i.p+"static/img/disk.ab3b130..svg"},75762:function(e,t,i){e.exports=i.p+"static/img/fankui.91580b0..svg"},2793:function(e,t,i){e.exports=i.p+"static/img/folder.c7d8d49..png"},17370:function(e,t,i){e.exports=i.p+"static/img/img_nodata.55b7d39..png"},38922:function(e,t,i){e.exports=i.p+"static/img/more.c306a04..svg"},40297:function(e,t,i){e.exports=i.p+"static/img/order.9261dbe..png"},55905:function(e,t,i){e.exports=i.p+"static/img/upload-file.a6581d8..svg"},90203:function(e,t,i){e.exports=i.p+"static/img/upload-folder.c7d8d49..png"},63769:function(e,t,i){e.exports=i.p+"static/img/upload-img.d85c0b2..png"},66121:function(e,t,i){e.exports=i.p+"static/img/upload-video.039ad74..png"}}]);