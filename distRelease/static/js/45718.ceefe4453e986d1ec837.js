"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[45718],{81075:function(e,t,a){a.r(t);var o=a(73473),d=a.n(o),u=a(90541),n=a(2728),l=a(25108),o={beforeInitAsync:function(e,t,a){t.parameters.todoId&&(a.isShowForm=!1,n.Z.setTitle("会议通知"),u.Z.http.post("/fn/meetingNotice/getNoticeDataByInbox",{pk:e.main.A0001.value,pnId:t.parameters.pId}).then(function(e){e&&e.data&&"200"==e.data.code&&e.data.data&&"190121161348OthBI4s3sEhvfuDJ5FD"==e.data.data.noticeModuleId&&t.parameters.todoId?(l.log("跳转到通知单"),a.$router.replace({path:"/commonForm/".concat(e.data.data.noticeModuleId,"/").concat(e.data.data.noticeId,"?listId=MeetingList&method=viewTzD&validateByList=1&bmStatus=1"),query:{signUpPk:e.data.data.id,signUpModuleId:e.data.data.moduleId,sendStatus:e.data.data.sendStatus?1:-1,noticeType:e.data.data.noticeType,hyTzlx:e.data.data.noticeType,hytzStatus:e.data.data.hytzStatus}}),a.isShowForm=!0):l.log("不用跳转")}))}};o.initHandle=function(s,n,c){l.log("个人报名"),c.$bus.on("getUser",function(e){"c-meetingtz-071"==e.metaData.metaId&&c.$bus.emit("codeSelect","&excludeIds=".concat(u.Z.util.loadSessionStore("user").user_id))}),c.formTabs&&0<=(e=c.formTabs.findIndex(function(e){return"流转情况"==e.title}))&&c.formTabs.splice(e,1);var e,i="";function m(){var e,o=["c-meetingchry-003","c-meetingchry-004","c-meetingchry-002","c-meetingchry-0010"];for(e in s&&s.main["c-meetingtz-057"].value&&(o=s.main["c-meetingtz-057"].value.split(",")),c.$set(n.subform["200820104728nFPSM393YR9lLLDqjVy"].controls[0].privilege,"editable",!1),n.subform)"210812180520LFh4HCmmYKhau77Bubo"!=e&&n.subform[e].controls.forEach(function(e){e.privilege.visible=!!o.includes(e.metaId)});for(var t in n.subform)!function(a){c.formData.multinfos[a]&&c.$watch(function(){return c.formData.multinfos[a].rows},function(e,t){l.log(e),"210812180520LFh4HCmmYKhau77Bubo"!=(i=a)&&s.multinfos[a].rows.forEach(function(e){e.structControl.forEach(function(e){e.show=o.includes(e.metaId)?1:0})})},{deep:!0,immediate:!0})}(t);"15"==c.formMeta.parameters.nodeId&&c.$set(n.subform["22072016505548iml1jHscuhcmr562k"].controls[0].privilege,"editable",!1)}function r(e,t){l.log(e),c.$set(e,"c-meetingchry-002",{value:t.userId,text:t.userName,schema:"1::"+t.deptId}),c.$set(e,"c-meetingchry-004",{value:t.deptId,text:t.deptName,schema:"5::"+t.deptId}),c.$set(e,"c-meetingchry-003",{value:t.unitId,text:t.unitName,schema:"5::"+t.unitId}),c.$set(e,"c-meetingchry-0010",{value:t.userMobile}),c.$set(e,"c-meetingchry-0011",{value:t.deptUserOrder}),c.$set(e,"c-meetingchry-0017",{value:t.deptGlobalShoworder}),c.$set(e,"B0001",{value:t.zw||""}),t.orgIdLV1&&c.$set(e,"c-meetingchry-0012",{value:t.orgIdLV1,text:t.orgNameLV1,schema:"5::"+t.orgIdLV1}),t.orgIdLV2&&c.$set(e,"c-meetingchry-0013",{value:t.orgIdLV2,text:t.orgNameLV2,schema:"5::"+t.orgIdLV2}),t.orgIdLV3&&c.$set(e,"c-meetingchry-0014",{value:t.orgIdLV3,text:t.orgNameLV3,schema:"5::"+t.orgIdLV3}),t.orgIdLV4&&c.$set(e,"c-meetingchry-0015",{value:t.orgIdLV4,text:t.orgNameLV4,schema:"5::"+t.orgIdLV4}),t.orgIdLV5&&c.$set(e,"c-meetingchry-0016",{value:t.orgIdLV5,text:t.orgNameLV5,schema:"5::"+t.orgIdLV5})}function t(e){1==e?n.controls.forEach(function(e){"c-meetingtz-029"==e.metaId&&c.$set(e,"label","说明"),"c-meetingtz-071"==e.metaId&&c.$set(e,"label","参会人"),"委托人"==e.label&&c.$set(e,"label","参会人"),"c-meetingtz-018"==e.metaId&&c.$set(e,"show",1),"attach-3"==e.metaId&&c.$set(e,"show",1),"c-meetingtz-015"==e.metaId&&c.$set(e,"show",1),"c-meetingtz-070"==e.metaId&&c.$set(e,"show",0),"c-meetingtz-071"==e.metaId&&c.$set(e,"show",0),"200820104728nFPSM393YR9lLLDqjVy"==e.metaId&&c.$set(e,"show",1),"controlMobileFl"==e.metaId&&c.$set(e,"show",1),"22072016505548iml1jHscuhcmr562k"==e.metaId&&c.$set(e,"show",1),"c-meetingtz-015"==e.metaId&&c.$set(e,"show",1),"210812180520LFh4HCmmYKhau77Bubo"==e.metaId&&c.$set(e,"show",1)}):2==e?n.controls.forEach(function(e){"c-meetingtz-029"==e.metaId&&c.$set(e,"label","请假理由"),"c-meetingtz-018"==e.metaId&&c.$set(e,"show",0),"attach-3"==e.metaId&&c.$set(e,"show",0),"c-meetingtz-015"==e.metaId&&c.$set(e,"show",0),"c-meetingtz-070"==e.metaId&&c.$set(e,"show",0),"c-meetingtz-071"==e.metaId&&c.$set(e,"show",0),"200820104728nFPSM393YR9lLLDqjVy"==e.metaId&&c.$set(e,"show",0),"controlMobileFl"==e.metaId&&c.$set(e,"show",0),"22072016505548iml1jHscuhcmr562k"==e.metaId&&c.$set(e,"show",0),"c-meetingtz-015"==e.metaId&&c.$set(e,"show",0),"210812180520LFh4HCmmYKhau77Bubo"==e.metaId&&c.$set(e,"show",0)}):n.controls.forEach(function(e){"c-meetingtz-029"==e.metaId&&c.$set(e,"label","委托原因"),"c-meetingtz-071"==e.metaId&&c.$set(e,"label","委托人"),"c-meetingtz-018"==e.metaId&&c.$set(e,"show",0),"attach-3"==e.metaId&&c.$set(e,"show",1),"c-meetingtz-015"==e.metaId&&c.$set(e,"show",0),"c-meetingtz-070"==e.metaId&&c.$set(e,"show",0),"c-meetingtz-071"==e.metaId&&c.$set(e,"show",1),"200820104728nFPSM393YR9lLLDqjVy"==e.metaId&&c.$set(e,"show",0),"controlMobileFl"==e.metaId&&c.$set(e,"show",1),"参会人"==e.label&&c.$set(e,"label","委托人"),"22072016505548iml1jHscuhcmr562k"==e.metaId&&c.$set(e,"show",1),"c-meetingtz-015"==e.metaId&&c.$set(e,"show",1),"210812180520LFh4HCmmYKhau77Bubo"==e.metaId&&c.$set(e,"show",1)})}c&&c.$route.query&&(1==c.$route.query.type?(c.$set(s.main["c-meetingtz-070"],"value",1),c.$set(s.main["c-meetingtz-070"],"text","参会"),t(1)):2==c.$route.query.type?(c.$set(s.main["c-meetingtz-070"],"value",2),c.$set(s.main["c-meetingtz-070"],"text","请假"),t(2)):3==c.$route.query.type&&(c.$set(s.main["c-meetingtz-070"],"value",3),c.$set(s.main["c-meetingtz-070"],"text","委托他人"),t(3))),"-2"==s.main["C-MEETINGTZ-044"].value&&c.$set(s.main["c-meetingtz-070"],"text","参会"),m(),c.$bus.on("selectUserBus",function(e){var t;"c-meetingchry-002"==e.metaData.metaId&&(t=e.value,u.Z.http.post("fn/meetingNotice/getUserDept",{userId:t}).then(function(a){s.multinfos[i].rows.forEach(function(e,t){e["c-meetingchry-002"].value==a.data.data.userId&&s.multinfos[i].rows.splice(t,1)}),r(s.multinfos[i].rows[e.subFormIndex],a.data.data)}))}),c.$bus.on("subFormTreeSelect",function(a){var e,t=[],o=[];for(e in s.multinfos)s.multinfos[e].rows.forEach(function(e){t.push(e["c-meetingchry-002"].value)});a.selectArr.forEach(function(e){t.includes(e.id)||o.push(e)});var n=o.map(function(e){return t=e.id,e=e.attrs.deptId,u.Z.http.post("fn/meetingNotice/getUserDept",{userId:t,deptId:e}).then(function(e){return e.data.data});var t});d().all(n).then(function(e){var t;null!=(t=c.$refs)&&null!=(t=t.formTab[0])&&t.$refs[a.subFormId][0]&&c.$refs.formTab[0].$refs[a.subFormId][0].$refs.subform.addMultipleCard(n.length).then(function(a){l.log(a),e.forEach(function(e,t){r(a[t],e)})}).then(function(){m()})})}),c.$bus.on("getSelectUser",function(e){l.log(e)}),c.$bus.on("selectUserBus",function(e,t){var a;"c-meetingtz-071"==e.metaData.metaId&&((a=u.Z.util.loadLocalStore("user").user_id)==e.value?(c.$set(s.main,"c-meetingtz-071",{value:"",text:"",schema:""}),u.Z.layer.toast("委托人员不可选择自己，请重新选择"),n.controls.forEach(function(e){"200820104728nFPSM393YR9lLLDqjVy"==e.metaId&&c.$set(e,"show",0)})):(n.controls.forEach(function(e){"200820104728nFPSM393YR9lLLDqjVy"==e.metaId&&c.$set(e,"show",1)}),l.log(a),u.Z.http.post("fn/meetingNotice/getUserDept",{userId:e.selectArr[0].id,deptId:e.selectArr[0].attrs.deptId}).then(function(e){"200"==e.data.code&&r(s.multinfos["200820104728nFPSM393YR9lLLDqjVy"].rows[0],e.data.data)})))})},o.saveFilter=function(e,t,a){if(0!=e.multinfos["200820104728nFPSM393YR9lLLDqjVy"].rows.length)return new(d())(function(t,e){try{t()}catch(e){t()}});u.Z.layer.toast("请选择参会人员！")},t.default=o}}]);