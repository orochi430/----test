"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[11177],{24185:function(a,t,e){e.r(t);var n=e(73473),o=e.n(n),s=e(25108),r=!1,n={};function i(t,e){(new BMap.Geocoder).getLocation(new BMap.Point(t.lon,t.lat),function(a){s.log(a.addressComponents),dsf.config.listJson.find(function(a){return"getLocationShop"==a.fileType}).params={lon:t.lon,lat:t.lat,cityName:a.addressComponents.city},e.commonPopParam.params.fileType="getLocationShop",e.commonPopParam.params.showSearch=!1,e.commonPop=!0})}function c(a,t,e){return dsf.http.post("ctrl/saveRetailInfo/saveOtherData",{pk:t.parameters.pk,cuStatusNm:a?"":e.main["C-ENTRY-014"].value,orgDeptCd:a?"":e.main["C-ENTRY-016"].value,orgDeptSnm:a?"":e.main["C-ENTRY-015"].value,credentialNum:e.main["C-ENTRY-005"].value})}n.initHandle=function(t,a,e){var n;r||((n=document.createElement("script")).type="text/javascript",n.src="https://api.map.baidu.com/api?v=2.0&ak=3gqRCzNgHHe1uMHGkrYzfv0o&callback=init",document.head.appendChild(n),r=!0),e.commonPopParam={params:{fileType:"dpxkz",showFilterIcon:!0,showSearch:!0}},dsf.http.post("ctrl/informAtionEntry/getOrganizeNumber",{orgId:dsf.util.loadSessionStore("user").unitId}).then(function(a){200==a.data.code&&e.$set(t.main,"C-ENTRY-013",{value:a.data.data.dyldbm+a.data.data.year+a.data.data.number})}),e.$bus.on("focusBus",function(a){"C-ENTRY-005"==a.metaData.metaId&&e.$refs.ckDialog.show([{value:"1",name:"自动定位"},{value:"2",name:"手动搜索"}],"","value","name",[],!1,!1).then(function(a){2==a[0]?(e.commonPopParam.params.fileType="dpxkz",e.commonPopParam.params.showSearch=!0,e.commonPop=!0):window.wx?wx.getLocation({type:"wgs84",success:function(a){i({lon:a.longitude,lat:a.latitude},e)}}):i({lon:118.78962,lat:32.03193},e)}).catch(function(){dsf.layer.toast("请重试")})}),e.$bus.on("selectUserBus",function(a){"C-ENTRY-002"==a.metaData.metaId&&a.value&&(e.$set(e.formData.main,"B0001",{value:"反馈".concat(t.main["C-ENTRY-003"].value).concat(t.main["C-ENTRY-002"].text)}),-1!=a.value.indexOf("17"))&&e.$set(e.formData.main,"C-ENTRY-005",{value:"999999999999"})})},n.choose=function(a,t){s.log("choose",a),t.commonPop=!1,t.$set(t.formData.main,"C-ENTRY-014",{value:a[0].dataValue.cuStatusNm}),t.$set(t.formData.main,"C-ENTRY-015",{value:a[0].dataValue.orgDeptSnm}),t.$set(t.formData.main,"C-ENTRY-005",{value:a[0].dataValue.licNo}),t.$set(t.formData.main,"C-ENTRY-003",{value:a[0].dataValue.companyName}),t.$set(t.formData.main,"C-ENTRY-004",{value:a[0].dataValue.managerName}),t.$set(t.formData.main,"C-ENTRY-006",{value:a[0].dataValue.retailTel}),t.$set(t.formData.main,"C-ENTRY-007",{value:a[0].dataValue.businessAddr}),t.$set(t.formData.main,"C-ENTRY-016",{value:a[0].dataValue.orgDeptCd}),t.$set(t.formData.main,"B0001",{value:"反馈".concat(a[0].dataValue.companyName).concat(t.formData.main["C-ENTRY-002"].text||"")})},n.custom1=function(e,n,o){o.buttonHandle.save(o.$route.params,o.formMeta,o.formData,o,o.$refs,function(){dsf.http.post("ctrl/informAtionEntry/addInformVerfication",{pk:n.parameters.pk,orgDeptCdVal:e.main["C-ENTRY-010"].value,callSyb:1}).then(function(a){var t;200==a.data.code?"专卖管理"==a.data.message||"客户服务"==a.data.message?((t=a.data.data.find(function(a){return a.ids})).id=t.ids,a.data.data.forEach(function(t){0<t.data.length&&t.data.forEach(function(a){return t.ORG_NAME=t.ORG_NAME+"\n"+a})}),o.$refs.ckDialog.show(a.data.data,"选择发送机构","id","ORG_NAME",[t.ids],!1).then(function(t){c(0,n,e).then(function(a){a=a.data;if(200==a.code)return s.log(a),dsf.http.post("ctrl/informAtionEntry/addInformVerfication",{pk:n.parameters.pk,callSyb:2,orgId:t[0]});dsf.layer.toast(a.message),reject()}).then(function(a){if(200==a.data.code)return dsf.http.post("ctrl/informAtionEntry/addginbox",{pk:n.parameters.pk});dsf.layer.toast(a.data.message),reject()}).then(function(a){200==a.data.code?dsf.layer.toast("提交成功","",o.backSucces()):dsf.layer.toast(a.data.message)})}).catch(function(){dsf.layer.toast("请选择发送机构")})):c(0,n,e).then(function(a){a=a.data;if(200==a.code)return dsf.http.post("ctrl/informAtionEntry/addginbox",{pk:n.parameters.pk});dsf.layer.toast(a.message),reject()}).then(function(a){200==a.data.code?dsf.layer.toast("提交成功","",o.backSucces()):dsf.layer.toast(a.data.message)}):dsf.layer.toast(a.data.message)})})},n.saveFilter=function(e,n,a,t){return new(o())(function(a,t){c(1,n,e),a()})},t.default=n}}]);