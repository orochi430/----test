"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[32795],{15839:function(e,t,a){a.r(t);var o=a(66250),n=a(33453),T=a.n(n),n=a(79529),v=a.n(n),n=a(73473),s=a.n(n),E=a(90541),w=(a(88561),a(25108)),n={};n.initHandle=function(){var n=(0,o.Z)(T().mark(function e(i,r,c){var t,n,o,s,a,m,u,l,d,f,h,g,I;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I=function(e){return e=v()(e)<10?"0"+e:e},g=function(e){var t,a,n,o;return e?(t=(e=new Date(e)).getFullYear(),a=e.getMonth()+1,n=e.getDate(),o=e.getHours(),e=e.getMinutes(),t+"-"+I(a)+"-"+I(n)+" "+I(o)+":"+I(e)):""},h=function(e,t){e=new Date(e).getTime()+6e4*t;return g(e)},f=function(e){var t=0,a=e.cxUnit+","+e.lxUnit+","+e.chr+","+e.lxUser+","+e.tyUser+","+e.workUser+","+e.wdwUser;e.arrangeRangeValue.includes("1")&&(a+=e.nonvotingLeader),e.arrangeRangeValue.includes("2")&&(a+=e.lxLeader),e.arrangeRangeValue.includes("3")&&(a+=e.chbm),e.arrangeRangeValue.includes("4")&&(a+=e.lxbm),a=(a=a.replace(new RegExp(",+","gm"),",")).substring(0,a.lastIndexOf(",")),i.main["c-meetingsq-007"].value&&i.main["c-meetingsq-008"].value&&a&&E.Z.http.post("ctrl/meetingUser/verifyArrangeByUserId",{userIds:a,startTime:i.main["c-meetingsq-007"].value,endTime:i.main["c-meetingsq-008"].value}).then(function(e){t="200"==e.status&&"1"==e.data.data?(c.refreshListKey=Math.random(),c.commonPopParam={listId:"2306140947171y006ycpXfIBORLJxol",moduleId:"190111184257QgSNR8cW92akDpqeWMA",params:{userIds:a,startTime:i.main["c-meetingsq-007"].value,endTime:i.main["c-meetingsq-008"].value,title:"冲突人员信息"}},c.checkType="checkBox",c.commonPop=!0,1):0,r.controls.forEach(function(e){"2306131516053U1mdIcjAHX9w2wThOG"==e.metaId&&c.$set(e,"show",t)})})},d=function(e){E.Z.http.post("fn/filecode/docType",{element:"ctx8zlMCjIPpboY6",targetRuleId:e,moduleId:r.parameters.moduleId,moduleName:"会议申请",flowId:r.parameters.flowId,formId:r.parameters.formId,formType:r.parameters.formType,pk:r.parameters.pk,nodeId:r.parameters.nodeId,__VALUE:r.parameters.formId,mid:r.parameters.moduleId,mId:r.parameters.moduleId}).then(function(e){var t;w.log(e.data),200==e.data.code&&e.data.data.rules&&(t=c.formMeta.controls.find(function(e){return"ctx8zlMCjIPpboY6"==e.controlId}),c.$set(t.extra.rules,0,e.data.data.rules[0]),c.$eventBus.emitRefreshFilecode(c,{}))})},l=function(e,o,s){var t=["出席领导","列席领导","出席部门","列席部门","出席单位","出席人员","列席人员","特邀人员","外单位人员","列席单位","工作人员"];r.controls.forEach(function(e){t.includes(e.label)&&(e.show=0)}),e&&E.Z.http.post("/fn/meetingType/getMeetingType",{meetingTypeId:e}).then(function(e){var t,a,n;200==e.data.code&&e.data.data&&((t=e.data.data).chdxText&&(t.chdxText+="参会人员",r.controls.forEach(function(e){t.chdxText.includes(e.label)&&(e.show=1)})),t.isYtLx&&"1"==t.isYtLx?c.formMeta.controls.forEach(function(e){"4PheCMgUGJoh5do8"==e.controlId&&c.$set(e,"show",1),"vyOGRsirWy2juycU"==e.controlId&&c.$set(e,"show",1)}):c.formMeta.controls.forEach(function(e){"4PheCMgUGJoh5do8"==e.controlId&&c.$set(e,"show",0),"vyOGRsirWy2juycU"==e.controlId&&c.$set(e,"show",0)}),0!=r.parameters.nodeId&&-2!=r.parameters.nodeId||(a=c.formButtons.mainButtons.findIndex(function(e){return"DSF.Meeting.Action.issueNotice"==e.action}),n=c.formButtons.mainButtons.findIndex(function(e){return"DSF.Meeting.Action.meetingNgSend"==e.action}),t.lcxz?0<=a&&(c.formButtons.mainButtons.splice(a,1),u)&&u[0]&&n<0&&c.formButtons.mainButtons.splice(n,0,u[0]):(0<=n&&(c.formButtons.mainButtons.splice(n,1),m)&&m[0]&&a<0&&c.formButtons.mainButtons.splice(a,0,m[0]),c.formButtons.mainButtons.forEach(function(e){"DSF.Meeting.Action.issueNotice"==e.action&&(w.log(e),e.name="确认")})),t.sfxyhzyValue&&1==t.sfxyhzyValue?c.formMeta.controls.find(function(e){"4fcSEOAxsJ9aoZvH"==e.controlId&&c.$set(e,"show",1),"4L71kg2bshyuCCiV"==e.controlId&&c.$set(e,"show",1),"cRbjNY98jjIXqTTu"==e.controlId&&c.$set(e,"show",1)}):c.formMeta.controls.find(function(e){"4fcSEOAxsJ9aoZvH"==e.controlId&&c.$set(e,"show",0),"4L71kg2bshyuCCiV"==e.controlId&&c.$set(e,"show",0),"cRbjNY98jjIXqTTu"==e.controlId&&c.$set(e,"show",0)})),t.hyjcValue?c.formMeta.controls.find(function(e){"B0003"==e.metaId&&c.$set(e,"show",1)}):c.formMeta.controls.find(function(e){"B0003"==e.metaId&&c.$set(e,"show",0)}),t.isYtLx&&"1"==t.isYtLx?c.formMeta.controls.forEach(function(e){"4PheCMgUGJoh5do8"==e.controlId&&c.$set(e,"show",1),"vyOGRsirWy2juycU"==e.controlId&&c.$set(e,"show",1)}):c.formMeta.controls.forEach(function(e){"4PheCMgUGJoh5do8"==e.controlId&&c.$set(e,"show",0),"vyOGRsirWy2juycU"==e.controlId&&c.$set(e,"show",0)}),o||("1"!=t.sqztzValue&&"-1"!=t.sqztzValue||c.$set(i.main,"c-meetingsq-126",{value:t.sqztzValue,text:t.sqztzText}),"1"==t.verifyArrangeValue?f(t):r.controls.forEach(function(e){"2306131516053U1mdIcjAHX9w2wThOG"==e.metaId&&c.$set(e,"show",0)}),t.lcxz&&(c.$set(r.parameters,"flowId",t.lcxz),w.log(r.parameters)),t.zcrValue?c.$set(i.main,"c-meetingsq-011",{value:t.zcrValue,text:t.zcrText,schema:t.zcrSchema}):c.$set(i.main,"c-meetingsq-011",{value:"",text:"",schema:""}),t.hyjcValue&&(d(t.hyjcValue),c.$bus.on("changeFileCode",function(){c.$set(i.main,"B0001",{value:i.main.B0003.value?i.main.B0003.value+s:""})})),e.data.data.duration&&0!=e.data.data.duration&&i&&!i.main["c-meetingsq-008"].value&&c.$set(i.main,"c-meetingsq-008",{value:g(Number(36e5*e.data.data.duration)+Number(new Date(i.main["c-meetingsq-007"].value).getTime()))}),c.$set(i.main,"c-meetingsq-052",{value:t.nonvotingLeader,text:t.nonvotingLeaderText,schema:t.nonvotingLeaderSchema}),c.$set(i.main,"c-meetingsq-115",{value:t.lxLeader,text:t.lxLeaderText,schema:t.lxLeaderSchema}),c.$set(i.main,"c-meetingsq-042",{value:t.chbm,text:t.chbmText,schema:t.chbmSchema}),c.$set(i.main,"c-meetingsq-043",{value:t.lxbm,text:t.lxbmText,schema:t.lxbmSchema}),c.$set(i.main,"c-meetingsq-116",{value:t.cxUnit,text:t.cxUnitText,schema:t.cxUnitSchema}),c.$set(i.main,"c-meetingsq-117",{value:t.lxUnit,text:t.lxUnitText,schema:t.lxUnitSchema}),c.$set(i.main,"c-meetingsq-013",{value:t.chr,text:t.chrText,schema:t.chrSchema}),c.$set(i.main,"c-meetingsq-053",{value:t.lxUser,text:t.lxUserText,schema:t.lxUserSchema}),c.$set(i.main,"c-meetingsq-118",{value:t.tyUser,text:t.tyUserText,schema:t.tyUserSchema}),c.$set(i.main,"c-meetingsq-112",{value:t.workUser,text:t.workUserText,schema:t.workUserSchema}),c.$set(i.main,"c-meetingsq-119",{value:t.wdwUser,text:t.wdwUserText,schema:t.wdwUserSchema}),c.$set(i.main,"c-meetingsq-080",{value:t.isYtLx})))})},a=function(e){E.Z.http.post("/fn/meetingRoom/getMeetingRoomDefaultResource",{roomId:e}).then(function(e){w.log(e),e&&e.data&&e.data.data&&e.data.data.dzValue&&(c.$set(i.main,"c-meetingsq-122",{value:e.data.data.dzValue,text:e.data.data.hymrzyText}),c.$set(i.main,"c-meetingsq-090",{value:e.data.data.dzValue}))})},s=function(){for(var t in i.multinfos)if(0<i.multinfos[t].rows.length)for(var e=function(n){for(var e in r.subform)!function(a){c.formData.multinfos[a]&&c.$watch(function(){return c.formData.multinfos[a].rows},function(e,t){i.multinfos[a].rows[n]&&i.multinfos[a].rows[n].structControl&&i.multinfos[a].rows[n].structControl.forEach(function(e){"资源分类id"==e.label&&(e.show=0),"资源id"==e.label&&(e.show=0),"是否填写数量"==e.label&&(e.show=0)})},{deep:!0,immediate:!0})}(e);i.multinfos[t].rows.forEach(function(e){e["C-MEETING-RESOURCE-006"]&&"-1"==e["C-MEETING-RESOURCE-006"].value&&e.structControl.forEach(function(e){"数量"==e.label&&(e.show=0)})})},a=0;a<i.multinfos[t].rows.length;a++)e(a)},o=function(){var t=i.main["c-meetingsq-007"].value;c.formData.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.forEach(function(e){e["C-MEETING-TOPIC-0062"].value=t,e["C-MEETING-TOPIC-0063"].value=h(t,e["C-MEETING-TOPIC-0006"].value||0),t=h(t,e["C-MEETING-TOPIC-0006"].value||0),w.log(t)})},E.Z.http.post("/fn/meetingNotice/getTopic",{pk:c.formData.main.A0001.value}).then(function(e){200==e.data.code&&0==e.data.data.length&&"1"==i.main["c-meetingsq-080"].value||c.formMeta.controls.forEach(function(e){"7zRDIRpwlpMdiDmU"==e.controlId&&c.$set(e,"show",0),"9hYHr70GtPPOZtu0"==e.controlId&&c.$set(e,"show",0),"4HnK6jjs8Wfilq6Y"==e.controlId&&c.$set(e,"show",0)})}),s(),0==r.parameters.nodeId?setTimeout(function(){l(i.main["c-meetingsq-075"].value,0,i.main["c-meetingsq-075"].text),a(i.main["c-meetingsq-009"].value)},500):c.$route.query.renderType&&l(i.main["c-meetingsq-075"].value||"",0,i.main["c-meetingsq-075"].text),l(i.main["c-meetingsq-075"].value||"",1,i.main["c-meetingsq-075"].text),w.log(r),(t=E.Z.util.loadSessionStore("checkedMettingRoom")?E.Z.util.loadSessionStore("checkedMettingRoom"):null)&&(i.main["c-meetingsq-009"].value=t.value,i.main["c-meetingsq-009"].text=t.text),t&&E.Z.util.loadSessionStore("checkedMettingStime")&&(c.$set(c.formData.main,"c-meetingsq-007",{value:E.Z.util.loadSessionStore("checkedMettingStime").value}),c.$set(c.formData.main,"c-meetingsq-008",{value:moment(new Date(E.Z.util.loadSessionStore("checkedMettingStime").value)).add(2,"hours").format("YYYY-MM-DD HH:mm")})),c.$bus.on("blurBus",function(t){var a;w.log(t),"C-MEETING-RESOURCE-005"==t.metaData.metaId&&(a=i.multinfos[t.subFormId].rows[t.subFormIndex]["C-MEETING-RESOURCE-004"].value,n.forEach(function(e){e.id==a&&e.maxVal&&Number(t.value)>Number(e.maxVal)&&(E.Z.layer.toast("".concat(e.name,"的最大数量为").concat(e.maxVal,",请重新填写")),c.$set(i.multinfos[t.subFormId].rows[t.subFormIndex],"C-MEETING-RESOURCE-005",{value:""}))})),"C-MEETING-TOPIC-0006"==t.metaData.metaId&&o()}),n=[],c.$bus.on("subFormTreeSelect",function(a){a.selectArr.forEach(function(t,e){"2207211022396tdrTOsshP5lQlAErld"!=a.subFormId||i.multinfos["2207211022396tdrTOsshP5lQlAErld"].rows.find(function(e){return e["2207211022396tdrTOsshP5lQlAErld"].value==t.id})||(n.find(function(e){return e.id==t.id})||n.push({id:t.id,name:t.name,maxVal:t.attrs.limitMaxNum}),c.$refs.formTab[0]&&c.$refs.formTab[0].$refs["2207211022396tdrTOsshP5lQlAErld"][0].$refs.subform.addCard(!1).then(function(e){c.$set(e,"C-MEETING-RESOURCE-001",{value:t.attrs.resourceTypeText}),c.$set(e,"C-MEETING-RESOURCE-003",{value:t.name}),c.$set(e,"C-MEETING-RESOURCE-002",{value:t.attrs.resourceTypeId}),c.$set(e,"C-MEETING-RESOURCE-004",{value:t.id}),c.$set(e,"C-MEETING-RESOURCE-006",{value:t.attrs.isWirteNum,text:0<t.attrs.isWirteNum?"是":"否"}),t.attrs.isWirteNum<0&&(e.structControl.find(function(e){return"C-MEETING-RESOURCE-005"==e.metaId}).show=!1)}).then(function(){s()}))})}),c.$watch(function(){return c.formData.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows},function(e,t){w.log(),o();var a=["C-MEETING-TOPIC-0062","C-MEETING-TOPIC-0063"];c.formData.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.forEach(function(e){e&&e.structControl&&0<e.structControl.length&&e.structControl.forEach(function(e){e.privilege.editable=!a.includes(e.metaId)&&e.privilege.editable,"办结日期"==e.label&&(e.show=0)})});for(var n=c.formData.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.length-1;0<=n;n--)"Deleted"==c.formData.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows[n].action&&c.formData.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.splice(n,1)},{deep:!0,immediate:!0}),c.$watch(function(){return c.formData.multinfos["2306131516053U1mdIcjAHX9w2wThOG"].rows},function(e,t){0<(null==e?void 0:e.length)?r.controls.forEach(function(e){"2306131516053U1mdIcjAHX9w2wThOG"==e.metaId&&c.$set(e,"show",1)}):0==e.length&&r.controls.forEach(function(e){"2306131516053U1mdIcjAHX9w2wThOG"==e.metaId&&c.$set(e,"show",0)})},{deep:!0,immediate:!0}),c.$watch(function(){return c.formData.main["c-meetingsq-007"].value},function(e,t){o()},{deep:!0,immediate:!0}),c.$bus.on("subFormSelect",function(e){var t="";e.checkItems.forEach(function(e){t+=e.dataValue.A0001+","}),E.Z.http.post("fn/meetingTopic/getTpoicData",{topicIds:t}).then(function(e){w.log(e);var a={};e.data.data=e.data.data.reduce(function(e,t){return a[t.id]||(a[t.id]=e.push(t)),e},[]),e.data.data.forEach(function(t){if(c.$refs.formTab[0]){var a=[];if(0<i.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.length&&i.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.find(function(e){return e["210618155422Xgcs9ChmODWRV36fMHJ"]&&e["210618155422Xgcs9ChmODWRV36fMHJ"].value==t.id}))return E.Z.layer.toast("重复选择，请重新选择"),!0;c.$refs.formTab[0].$refs["210618155422Xgcs9ChmODWRV36fMHJ"][0].$refs.subform.addCard(!1).then(function(e){c.$set(e,"210618155422Xgcs9ChmODWRV36fMHJ",{value:t.id,foreign:r.parameters.pk}),c.$set(e,"B0001",{value:t.title}),c.$set(e,"C-MEETING-TOPIC-0048",{value:t.tag,text:t.tagText}),c.$set(e,"C-MEETING-TOPIC-0004",{value:t.dwhbrValue,text:t.dwhbrValue}),c.$set(e,"C-MEETING-TOPIC-0003",{value:t.hbdwValue,schema:t.hbdwSchema,text:t.hbdwText}),c.$set(e,"C-MEETING-TOPIC-0006",{value:t.reportTime}),c.$set(e,"C-MEETING-TOPIC-0008",{value:t.attendDept,schema:t.attendDeptSchema,text:t.attendDeptText}),c.$set(e,"C-MEETING-TOPIC-0044",{value:t.nonSystemPerson,schema:t.nonSystemPersonSchema,text:t.nonSystemPersonText}),t.files.forEach(function(e){a.push({id:e.id,fileName:e.fileName,infoId:e.infoId,filePath:e.filePath,showFileSize:(e.showFileSize/1e3).toFixed(1)+"kb"})}),c.$set(e,"attach",{"attach-1":a}),c.$set(e,"action","Updated"),e.structControl.forEach(function(e){"1"==t.ytlyValue?("C-MEETING-TOPIC-0004"==e.metaId&&c.$set(e,"show",0),"C-MEETING-TOPIC-0003"==e.metaId&&c.$set(e,"show",0)):("C-MEETING-TOPIC-0004"==e.metaId&&c.$set(e,"show",1),"C-MEETING-TOPIC-0003"==e.metaId&&c.$set(e,"show",1))})})}})})}),c.$bus.on("selectUserBus",function(e){"c-meetingsq-009"==e.metaData.metaId&&a(e.value)}),c.$bus.on("selectDateTime",function(e){"c-meetingsq-007"==e.metaData.metaId&&E.Z.http.post("/fn/meetingType/getMeetingType",{meetingTypeId:i.main["c-meetingsq-075"].value}).then(function(e){var t;200==e.data.code&&e.data.data&&(t=e.data.data,e.data.data.duration&&0!=e.data.data.duration?c.$set(i.main,"c-meetingsq-008",{value:g(Number(36e5*e.data.data.duration)+Number(new Date(i.main["c-meetingsq-007"].value).getTime()))}):c.$set(i.main,"c-meetingsq-008",{value:""}),"1"==t.verifyArrangeValue)&&f(t)}),"c-meetingsq-008"==e.metaData.metaId&&E.Z.http.post("/fn/meetingType/getMeetingType",{meetingTypeId:i.main["c-meetingsq-075"].value}).then(function(e){200==e.data.code&&e.data.data&&"1"==(e=e.data.data).verifyArrangeValue&&f(e)})}),c.$bus.on("checkVal",function(e){w.log(e),"c-meetingsq-075"==e.metaData.metaId&&l(e.value,0,e.text),"c-meetingsq-009"==e.metaData.metaId&&a(e.value)}),m=r.buttons.mainButtons.filter(function(e){return"DSF.Meeting.Action.issueNotice"==e.action}),u=r.buttons.mainButtons.filter(function(e){return"DSF.Meeting.Action.meetingNgSend"==e.action});case 29:case"end":return e.stop()}},e)}));return function(e,t,a){return n.apply(this,arguments)}}(),n.choose=function(e,a){a.commonPop=!1,a.formData.multinfos["2306131516053U1mdIcjAHX9w2wThOG"].rows=[],e.forEach(function(t,e){a.$refs.formTab[0].$refs["2306131516053U1mdIcjAHX9w2wThOG"][0].$refs.subform.addCard(!1).then(function(e){a.$set(e,"C-MEETING-CONFLICT-0001",{value:t.dataValue["230614094812YhP69ADJYsE9Q2LKCG4"]}),a.$set(e,"C-MEETING-CONFLICT-0002",{value:t.dataValue["230614094848ySvgua9gpvJO5cnPLCS"]}),a.$set(e,"B0060",{value:t.dataValue["2306140949364qP6bSdRMBvQr6lcoSC"]})})})},n.saveFilter=function(a,e,n,t){return new(s())(function(e,t){a.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.find(function(e){return 60<e["C-MEETING-TOPIC-0006"].value})?t("议题汇报时长不能超过60分钟，请重新输入"):(0<a.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.length&&a.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.forEach(function(e){n.$set(e.B0019,"value",formatTime2())}),w.log(a),e())})},t.default=n}}]);