"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[96674],{96674:function(t,e,n){n.r(e),n.d(e,{default:function(){return d}});var s=n(5044),a=n(66250),e=n(79529),r=n.n(e),e=n(8450),i=n.n(e),e=n(33453),o=n.n(e),c=n(25108),e={name:"nyncbindex",data:function(){return{isHideTitle:!1,user:dsf.util.loadSessionStore("user")||{},default_img:'this.src="static/squMenu/tatj.png"',mainMenu:[],showSubmenu:!1,submenu:{name:"",child:[]},officeMenu:{name:"",child:[]},showMenu:!1,todo:[],personal:[],userName:"",deptName:"",direction:!0}},watch:{direction:{handler:function(t,e){var n=document.documentElement.clientHeight,i=document.documentElement.clientWidth;null==e&&n<i&&(c.log("第一次进去为横屏"),this.direction=!1)},immediate:!0}},filters:{badgeCount:function(t){return 100<t?"99+":t<1?"":t}},methods:{getMenu:function(){var i=this;return(0,a.Z)(o().mark(function t(){var e,n;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=i,n=[],dsf.http.post("fn/newFile/shortcutDing",{}).then(function(t){(function n(t,i){t.forEach(function(t){if(!(t.displayPosition.indexOf("work")<0)){var e=t.agentid;try{e=e&&JSON.parse(e)}catch(t){e={}}e={name:t.shortcutName,badge:t.tip,router:t.actUrl?t.actUrl.trim():"",img:t.shortcutIcon,props:e,type:t.shortcutType,showClickTip:t.gntsyText,child:[],style:dsf.config.homePage.menuSetting&&dsf.config.homePage.menuSetting.itemStyle?dsf.config.homePage.menuSetting.itemStyle:"{}"};i.push(e),0<t.children.length&&n(t.children,e.child)}})})(t.data.data,n),e.getBadge(n),(t=e.officeMenu.child).push.apply(t,(0,s.Z)(n[0].child.slice(0,5))),e.officeMenu.name=n[0].name,e.officeMenu.child.push({name:"更多",router:"showMainMenu",img:"static/images/project/nyncb/更多.png",type:1,child:[],style:{fontWeight:"bold"},isshow:!0}),e.mainMenu=n,e.isHideTitle=1==e.mainMenu.length&&dsf.config.appSelect.isHideTitle});case 3:case"end":return t.stop()}},t)}))()},getBadge:function(t){t.forEach(function(t){t.child.forEach(function(o){o.badgeNum=0,o.isshow=!0,o.badge&&""!=o.badge&&dsf.http.postUrls(o.badge,{}).then(function(t){t=Array.isArray(t)?t:[t];if(0<t.filter(Boolean).length)for(var e=o,n=t,i=0;i<n.length;i++){var s,a=n[i].data;a.hasOwnProperty("total")&&!isNaN(a.total)?e.badgeNum+=r()(a.total):a.hasOwnProperty("badge")&&!isNaN(a.badge)?e.badgeNum+=r()(a.badge):a.hasOwnProperty("data")&&!isNaN(a.data)?e.badgeNum+=r()(a.data):null!=(s=a.data)&&s.hasOwnProperty("badge")&&!isNaN(a.data.badge)&&(e.badgeNum+=r()(a.data.badge))}})})})},openDDApp:function(t){dd.biz.microApp.openApp({agentId:t,onSuccess:function(t){},onFail:function(t){}})},goRoute:function(t){var e,n;0<t.child.length?(this.showSubmenu=!0,this.submenu=t):"showMainMenu"==t.router?this.showMenu=!0:""==t.router||null==t.router?t.showClickTip?dsf.layer.alert({message:t.showClickTip}):dsf.layer.alert({message:"当前菜单配置错误，请联系管理员！"}):t.type&&3==t.type?this.openDDApp(t.router):2==t.type?(n=dsf.util.getReplaceUrl(t.router),dsf.config.ddSetting.isDing?dd.biz?dd.biz.util.openLink({url:t.router,onSuccess:function(t){},onFail:function(t){}}):dd.openLink({url:t.router}):"1"==(null==(e=t.props)?void 0:e.OpenWebView)?xsfWindow.openWebView({title:t.name,url:n,colorString:"#111111"}):"1"==(null==(e=t.props)?void 0:e.OpenLocationHref)?location.href=n:this.$router.push({name:"dsfIframe",params:{url:n,title:t.name},query:{url:n,title:t.name}})):t.props?t.props.props?this.$router.push({path:t.router,query:JSON.parse(i()(t.props))}):(t.router.indexOf("ssoToOther"),this.$router.push({name:t.router,params:JSON.parse(i()(t.props))})):this.$router.push({path:dsf.util.getReplaceUrl(t.router),query:{title:t.name}})},getList:function(){var e=this,n=(dsf.http.post("fn/mobileToDoAndRead/getToDoAndReadList2",{limit:3,page:1,showTotal:!0,fileType:"gw",start:1}).then(function(t){t=t.data;t.datas&&(e.todo=t.datas)}),moment(new Date).format("YYYY-MM-DD"));dsf.http.post("fn/ldrc/org/getMobileWeekData",{sdate:n,edate:n,type:"leader"}).then(function(t){var t=t.data;e.personal=null==t||null==(t=t.data[0])?void 0:t.schedule.slice(0,3),e.personal.forEach(function(t){t.time=n+" "+t.time})})},goTodoList:function(t){1==t?this.$router.push({name:"commonList",query:{fileType:"gw"}}):2==t&&this.$router.push({path:"commonSchedule/default"})},goForm:function(t){var e="",n={};t.dataValue?(e="".concat(t.dataValue.moduleId,"/").concat(t.dataValue.info_id),n={todoId:t.dataValue.todoId,type:"gw"}):e="".concat(t.moduleId,"/").concat(t.agendaId),this.$router.push({path:"/commonForm/"+e,query:n})},isPortrait:function(){180!==window.orientation&&0!==window.orientation||(this.direction=!0),90!==window.orientation&&-90!==window.orientation||(this.direction=!1)}},created:function(){var t;window.addEventListener("onorientationchange"in window?"orientationchange":"resize",this.isPortrait,!1),this.getMenu(),this.getList(),this.deptName=null==(t=dsf.util.loadSessionStore("user"))?void 0:t.deptName,this.userName="".concat(null==(t=dsf.util.loadSessionStore("user"))?void 0:t.name,"（").concat(this.deptName,"）")},activated:function(){this.getBadge(this.mainMenu),this.getList()},beforeDestroy:function(){window.removeEventListener("onorientationchange"in window?"orientationchange":"resize",this.isPortrait,!1)}},d=(0,n(51900).Z)(e,function(){var n=this,i=n._self._c;return i("div",{staticClass:"ds-moduleIndex"},[i("div",{staticClass:"information flex ac jb"},[n._m(0),n._v(" "),i("div",{staticClass:"right flex ac"},[i("img",{attrs:{src:"static/images/project/nyncb/user.png"}}),n._v(" "),i("span",{staticClass:"elps"},[n._v(n._s(n.userName))])])]),n._v(" "),i("transition",{attrs:{name:"bounce"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:n.showMenu,expression:"showMenu"}],staticClass:"popup"},[i("div",{staticClass:"mainMenu"},[i("div",{staticClass:"title flex ac jb"},[i("span",[n._v("全部应用")]),n._v(" "),i("van-icon",{staticStyle:{"font-weight":"900"},attrs:{name:"cross",color:"#333",size:"30px"},on:{click:function(t){n.showMenu=!1}}})],1),n._v(" "),0<n.mainMenu.length?i("div",{class:[n.direction?"directionMenu2":"","dsf-list"]},n._l(n.mainMenu[0].child,function(e,t){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"subItem.isshow"}],key:t,staticClass:"menu menu_6",on:{click:function(t){return n.goRoute(e)}}},[i("img",{attrs:{src:e.img}}),n._v(" "),i("p",{style:e.style,domProps:{innerHTML:n._s(e.name)}}),n._v(" "),e.badgeNum?i("div",{staticClass:"badge"},[n._v("\n                                "+n._s(n._f("badgeCount")(e.badgeNum))+"\n                            ")]):n._e()])}),0):n._e()])])]),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:n.showMenu,expression:"showMenu"}],staticClass:"overlay",on:{click:function(t){n.showMenu=!1}}}),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!n.showMenu,expression:"!showMenu"}],class:[n.direction?"direction":"","officeMenu"],style:{padding:n.direction?"0 .4rem":"0 .6rem"}},[i("div",{staticClass:"title"},[i("span",[n._v(n._s(n.officeMenu.name))])]),n._v(" "),0<n.officeMenu.child.length?i("div",{class:[n.direction?"directionMenu":"","dsf-list"]},n._l(n.officeMenu.child,function(e,t){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"subItem.isshow"}],key:t,staticClass:"menu menu_6",on:{click:function(t){return n.goRoute(e)}}},[i("img",{attrs:{src:e.img}}),n._v(" "),i("p",{style:e.style,domProps:{innerHTML:n._s(e.name)}}),n._v(" "),e.badgeNum?i("div",{staticClass:"badge"},[n._v("\n                        "+n._s(n._f("badgeCount")(e.badgeNum))+"\n                    ")]):n._e()])}),0):n._e(),n._v(" "),i("div",{staticClass:"list"},[i("div",{staticClass:"todo"},[i("div",{staticClass:"title"},[i("span",[n._v("待办中心")]),n._v(" "),i("img",{attrs:{src:"static/images/project/nyncb/more.png"},on:{click:function(t){return n.goTodoList(1)}}})]),n._v(" "),n.todo&&0==n.todo.length?i("commonempty",{staticClass:"empty",attrs:{description:"暂无待办数据"}}):i("div",{staticClass:"todoFlex"},n._l(n.todo,function(e,t){return i("div",{key:t,staticClass:"todoList flex ac",style:{borderBottom:2==t?"none":"1px solid #d8d8d8"},on:{click:function(t){return n.goForm(e)}}},[i("img",{attrs:{src:"static/images/project/nyncb/".concat(e.dataValue.isRead?"item1":"item",".png"),alt:""}}),n._v(" "),i("div",{staticClass:"todoRight"},[i("div",{staticClass:"todoTitle flex ac"},[0!=e.dataValue.jjcd&&e.dataValue.jjcd?i("img",{attrs:{src:"static/images/project/nyncb/te.png"}}):n._e(),n._v(" "),0!=e.dataValue.mj&&e.dataValue.mj?i("img",{attrs:{src:"static/images/project/nyncb/mi.png"}}):n._e(),n._v(" "),i("span",{staticClass:"elps"},[n._v(n._s(e.dataValue.bt))])]),n._v(" "),i("div",{staticClass:"todoContent flex jb ac"},[i("span",[i("img",{attrs:{src:"static/images/project/nyncb/个人.png",alt:""}}),n._v(n._s(e.dataValue.userAndNode))]),i("span",[i("img",{attrs:{src:"static/images/project/nyncb/时间.png",alt:""}}),n._v(n._s(e.dataValue.time))])])])])}),0)],1),n._v(" "),i("div",{staticClass:"todo"},[i("div",{staticClass:"title"},[i("span",[n._v("领导日程")]),n._v(" "),i("img",{attrs:{src:"static/images/project/nyncb/more.png"},on:{click:function(t){return n.goTodoList(2)}}})]),n._v(" "),n.personal&&0==n.personal.length?i("commonempty",{staticClass:"empty",attrs:{description:"暂无日程数据"}}):i("div",{staticClass:"todoFlex"},n._l(n.personal,function(e,t){return i("div",{key:t,staticClass:"todoList flex ac",style:{borderBottom:2==t?"none":"1px solid #d8d8d8"},on:{click:function(t){return n.goForm(e)}}},[i("div",{staticClass:"todoRight"},[i("div",{staticClass:"todoContent flex jb ac"},[i("span",{staticStyle:{color:"#409CF8"}},[i("img",{attrs:{src:"static/images/project/nyncb/time.png",alt:""}}),n._v(n._s(e.time))]),n._v(" "),i("span",[i("img",{attrs:{src:"static/images/project/nyncb/个人.png"}}),n._v(n._s(e.attendant))])]),n._v(" "),i("div",{staticClass:"todoTitle elps marginAuto"},[n._v(n._s(e.content))])])])}),0)],1)])]),n._v(" "),i("van-overlay",{attrs:{show:n.showSubmenu,"class-name":"submenuOverlay","lock-scroll":!1},on:{click:function(t){n.showSubmenu=!1}}},[i("div",{staticClass:"mainMenu submenuBox"},[i("div",{staticClass:"submenuTitle"},[i("span",[n._v(n._s(n.submenu.name))])]),n._v(" "),i("div",{class:[n.direction?"directionMenu2":"","dsf-list","submenuMain"]},n._l(n.submenu.child,function(e,t){return i("div",{key:t,staticClass:"menu menu_6",on:{click:function(t){n.showSubmenu=!1,n.goRoute(e)}}},[i("img",{attrs:{src:e.img}}),n._v(" "),i("p",[n._v(n._s(e.name))])])}),0)])])],1)},[function(){var t=this._self._c;return t("div",{staticClass:"left"},[t("img",{attrs:{src:"static/images/project/nyncb/logo01.png"}})])}],!1,null,"1ee9eb97",null).exports}}]);