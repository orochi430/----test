"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[86306],{41775:function(t,n,i){i.d(n,{Z:function(){return c}});i(23307);var n=i(81392),e=i(26243),o=i.n(e),e=i(79529),l=i.n(e),e=i(46297),s=i(84628),a=i(50856),u=i(25108),e={components:{DsCard:e.Z,DsButtonGroup:s.Z,DsButtonToolbox:a.Z,Icon:n.Z},props:{tabObj:{type:Object},data:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},type:{type:String},keyColumn:{type:String},formMethod:{type:String},isHiddenBtn:{type:Boolean,default:function(){}}},data:function(){return{}},created:function(){},computed:{aSubTitles:function(){return u.log(this.columns.filter(function(t){return/^subTitle\w?$/i.test(t.showCategory)})),this.columns.filter(function(t){return/^subTitle\w?$/i.test(t.showCategory)})},bSubTitles:function(){return this.columns.filter(function(t){return/^content$/i.test(t.showCategory)})},needTitles:function(){return this.columns.filter(function(t){return/^needTitle\w?$/i.test(t.showCategory)})},titleIcon:function(){return this.columns.filter(function(t){return/^titleIcon\w?$/i.test(t.showCategory)})}},mounted:function(){u.log(this.bSubTitles)},methods:{isShowColumn:function(t,n){return n.dataValue[t.showMetaColumn]||0===n.dataValue[t.showMetaColumn]},isShowListBtn:function(t){var n=null==this.isHiddenBtn,i=!1,i=!(!t.buttons||!(t.buttons.commonButtons&&0<t.buttons.commonButtons.length||t.buttons.mainButtons&&0<t.buttons.mainButtons.length));return n&&i},link:function(t){var n,i,e,o;t.dataValue.allowMobile&&1!=t.dataValue.allowMobile?dsf.layer.toast("该文件只能在电脑端处理"):("isRead"in t.dataValue&&!t.dataValue.isRead&&(t.dataValue.isRead=!0),n=(t=t.dataValue)[this.keyColumn]||t.info_id||t.id||t.A0001||t.fid||t["SW_XZD.A0001"],i=this.keyColumn?this.keyColumn.split(".")[0]+".A0004":"",i=t.moduleId||t.A0004||t["SW_XZD.A0004"]||t[i],"db"==this.type&&(i=t.masterModuleId||t.moduleId||t.A0004),o=t.masterId||"",i=i+"/"+n,e={},"gw"==this.type&&(i+="/1",e.todoId=t.todoId),this.type&&(i+="?type=".concat(this.type)),"SigninList"==this.$route.name&&(i+="?&listId=1903161124289nXBk8iVSmTMGYxn9bi&exchangeList=signedList"),"db"==this.type&&(o&&(i+="&masterId=".concat(o)),u.log(this.formMethod),this.formMethod)&&(i+="&formMethod=info"),"dy"==this.type&&(i+="&distribId=".concat(t.distribId),dsf.http.post("fn/mobileToRead/markRead",{pks:t.distribId}).then(function(t){u.log(t)})),this.tabObj&&this.tabObj.targetUrl?(o=this.tabObj.targetUrl.replace("[pk]",n),this.$router.push({path:o})):this.$router.push({path:"/commonForm/"+i,query:e}))},getTitle:function(){return this.columns.find(function(t){return"mainTitle"===t.showCategory})||{}},handleCommonClick:function(t,n,i){n.dataValue.allowMobile&&1!=n.dataValue.allowMobile?dsf.layer.toast("该文件只能在电脑端处理"):this.$emit("commonClick",t,n,i)},handleMainClick:function(t,n,i){n.dataValue.allowMobile&&1!=n.dataValue.allowMobile?dsf.layer.toast("该文件只能在电脑端处理"):this.$emit("mainClick",t,n,i)},titleIconColor:function(t,n){t=t.dataValue[n.showMetaColumn].substr(0,1);return dsf.config.listTitleIcon&&-1<o()(dsf.config.listTitleIcon).indexOf(t)?(n=dsf.config.listTitleIcon[t],{backgroundColor:this.colorRgba(n,.12),color:n,borderColor:n}):""},colorRgba:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=t.toLowerCase();if(i&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(i)){if(4===i.length){for(var e="#",o=1;o<4;o+=1)e+=i.slice(o,o+1).concat(i.slice(o,o+1));i=e}for(var s=[],a=1;a<7;a+=2)s.push(l()("0x"+i.slice(a,a+2)));return"rgba("+s.join(",")+","+n+")"}return i}}},c=(0,i(51900).Z)(e,function(){var e=this,o=e._self._c;return o("div",{staticClass:"ds-list"},[e._l(e.data,function(i,n){return o("div",{key:i.id||"item-".concat(n),staticClass:"ds-item"},[o("DsCard",["isRead"in i.dataValue&&!i.dataValue.isRead?o("span",{staticClass:"isStatus"}):e._e(),e._v(" "),"readStatus"in i.dataValue&&"2"!=i.dataValue.readStatus?o("span",{staticClass:"isStatus"}):e._e(),e._v(" "),i.dataValue[e.getTitle().showMetaColumn]?o("div",{class:{ellipsis:e.dsf.config.commonList&&e.dsf.config.commonList.titleEllipsis},attrs:{slot:"header"},on:{click:function(t){return e.link(i)}},slot:"header"},[o("span",{class:{"col-title":"isRead"in i.dataValue&&!i.dataValue.isRead||"readStatus"in i.dataValue&&"2"!=i.dataValue.readStatus},style:{color:e.getTitle().color||"","word-wrap":"break-word","word-break":"break-all"}},[e._v("\n                "+e._s(i.dataValue[e.getTitle().showMetaColumn]))])]):e._e(),e._v(" "),o("div",{staticClass:"content",attrs:{slot:"content"},on:{click:function(t){return e.link(i)}},slot:"content"},[e._t("item-content",function(){return[o("div",{staticClass:"flex1"},[0<e.aSubTitles.length?o("div",{staticClass:"aSubTitles"},[e._l(e.aSubTitles,function(t,n){return[e.isShowColumn(t,i)?o("div",{key:"aSubTitles-".concat(n),staticClass:"subTitle"},[t.icon?o("Icon",{class:["iconfont",t.icon]}):e._e(),e._v(" "),o("span",{staticClass:"label",style:{color:t.color}},[e._v(e._s(i.dataValue[t.showMetaColumn]))])],1):e._e()]})],2):e._e(),e._v(" "),0<e.bSubTitles.length?o("div",{staticClass:"bSubTitles"},[e._l(e.bSubTitles,function(t,n){return[e.isShowColumn(t,i)?o("div",{key:"bSubTitles-".concat(n),staticClass:"subTitle"},[t.icon?o("Icon",{class:["iconfont",t.icon]}):e._e(),e._v(" "),o("span",{class:["label","ds-elips-".concat(t.showRows||1)],style:{color:t.color}},[e._v(e._s(i.dataValue[t.showMetaColumn]))])],1):e._e()]})],2):e._e(),e._v(" "),0<e.needTitles.length?o("div",{staticClass:"needTitles"},[e._l(e.needTitles,function(t,n){return[e.isShowColumn(t,i)?o("div",{key:"needTitles-".concat(n),staticClass:"subTitle"},[o("span",{staticClass:"name label ellipsis"},[e._v(e._s(t.showName))]),e._v(" "),o("span",{staticClass:"label val elips",style:{color:t.color}},[e._v(e._s(i.dataValue[t.showMetaColumn]))])]):e._e()]})],2):e._e()]),e._v(" "),0<e.titleIcon.length?o("div",[e._l(e.titleIcon,function(t,n){return[e.isShowColumn(t,i)?o("div",{key:"titleIcon-".concat(n),staticClass:"moduleIcon",style:e.titleIconColor(i,t)},[o("span",[e._v(e._s(i.dataValue[t.showMetaColumn].substr(0,1)))])]):e._e()]})],2):e._e()]},{item:i}),e._v(" "),e._t("item-extend",null,{item:i})],2),e._v(" "),e.isShowListBtn(i)?o("div",{attrs:{slot:"footer"},slot:"footer"},[e._t("item-footer",function(){return[o("DsButtonToolbox",{attrs:{buttons:i.buttons||{},more:!0,size:"small"},on:{commonClick:function(t){e.handleCommonClick(t,i,n)},mainClick:function(t){e.handleMainClick(t,i,n)}}})]},{item:{}})],2):e._e()])],1)}),e._v(" "),e.data.length||e.$parent.loading?e._e():o("commonempty")],2)},[],!1,null,"7d9709ac",null).exports},46297:function(t,n,i){i.d(n,{Z:function(){return e}});var e=(0,i(51900).Z)({},function(t,n){return t("div",{staticClass:"ds-card"},[n._t("default"),n._v(" "),t("div",{staticClass:"tabspage"},[n.$slots.tabspageCheck?t("div",{staticClass:"tabspageCheck"},[n._t("tabspageCheck")],2):n._e(),n._v(" "),t("div",{staticStyle:{flex:"1",overflow:"hidden"}},[n.$slots.header?t("div",{staticClass:"ds-card-header"},[n._t("header")],2):n._e(),n._v(" "),n.$slots.content?t("div",{staticClass:"ds-card-content"},[n._t("content")],2):n._e()]),n._v(" "),n.$slots.rightIcon?t("div",{staticClass:"rightIcon"},[n._t("rightIcon")],2):n._e()]),n._v(" "),n.$slots.footer?t("div",{staticClass:"ds-card-footer"},[n._t("footer")],2):n._e(),n._v(" "),n.$slots.footermin?t("div",{staticClass:"ds-card-footer ds-card-footer2"},[n._t("footermin")],2):n._e()],2)},[],!0,null,"1b02e7ea",null).exports},86306:function(t,n,i){i.r(n),i.d(n,{default:function(){return s}});var e=i(5044),n=i(41775),o=i(9303),n={name:"MeetingManage",components:{DsList:n.Z},mixins:[o.Z],data:function(){return{tab:"hy",firstLoading:!0,loading:!0,list:[],columns:[{color:null,format:null,icon:"",showCategory:"mainTitle",showMetaColumn:"bt",showName:"标题",showRows:null},{color:null,format:null,icon:"iconwenjianleixing",showCategory:"subTitle",showMetaColumn:"wjzl",showName:"文件类型",showRows:null},{color:null,format:null,icon:"iconshijian",showCategory:"Content",showMetaColumn:"time",showName:"会议时间",showRows:null},{color:null,format:null,icon:"icondidian",showCategory:"Content",showMetaColumn:"hydd",showName:"会议地点",showRows:null}],pageIndex:1,pagelimit:60,finished:!1,finishedTips:"",allCount:null,url:dsf.config.meetingConfig.meetingManageUrl}},created:function(){this.init()},methods:{handleActionClick:function(){this.tab="hy",(this["action-".concat(arguments[0])]||function(){}).apply(void 0,(0,e.Z)(Array.prototype.slice.call(arguments,1)))},post:function(t,n,i){var e=!(3<arguments.length&&void 0!==arguments[3])||arguments[3]?dsf.layer.loading():null;n["x-auth-token"]=dsf.util.loadSessionStore("loginToken"),dsf.http.post(t,n).done(i).error(function(){dsf.layer.toast("请求异常")}).always(function(){e&&dsf.layer.closeLoading(e)})},init:function(){this.onLoad()},onRefresh:function(){var n=this;this.post(this.url,{type:"join",page:1,limit:this.pagelimit},function(t){n.pageIndex=2,n.finished=!1,n.finishedTips="",n.allCount=t.count,Math.ceil(n.allCount/n.pagelimit)<n.pageIndex&&(n.finishedTips="暂无更多数据",n.finished=!0),n.list=[],n.list=n.postSuccess(t.rows),0==n.list.length&&(n.finishedTips="")})},onLoad:function(){var n=this;dsf.http.post(this.url,{type:"join",page:n.pageIndex,limit:n.pagelimit}).then(function(t){t=t.data,n.allCount=t.count,t=t.rows;n.list=[].concat((0,e.Z)(n.list),(0,e.Z)(n.postSuccess(t))),n.pageIndex++,Math.ceil(n.allCount/n.pagelimit)<n.pageIndex&&(n.finishedTips="暂无更多数据",n.finished=!0),0==n.list.length&&(n.finishedTips="")})},postSuccess:function(t){t=t.map(function(t){var n=t.isFavorite,i=(t.isTop,t.meetingStatus),e=t.shenhe,o=[],n=(0<dsf.config.setting["SYS-MOBILE-LIST-0004"]&&o.push({action:1===n?"quXiaoGuanZhu":"guanZhu",icon:1===n?"iconai-mark":"iconshoucang",name:1===n?"已关注":"关注"}),0<dsf.config.setting["SYS-MOBILE-LIST-0002"]&&o.push({action:"huiYiShiPin",icon:"iconshipin",name:"视频"}),[{action:"baoMingQingKuang",icon:"",name:"报名情况"}]),s=(n=(n=n.map(function(t,n){return t.showIndex=n+"",t})).map(function(t,n){return t.showIndex=n+"",t}),{id:t.id,moduleId:t.moduleId,todoId:t.todoId||t.id,bt:t.bt,hydd:t.hydd,hyjssj:t.hyjssj,hykssj:t.hykssj,isFavorite:t.isFavorite,isTop:t.isTop,meetingStatus:t.meetingStatus,time:t.hykssj+" 到 "+t.hyjssj,qianDaoStatus:t.qianDaoStatus,shenhe:t.shenhe,ngbm:t.ngbm,status:t.status,zcr:t.zcr});return"1"===e?(s.wjzl=t.wjzl,s.meetingStatusText=t.meetingStatusText,s.day=t.day):"0"===i?(s.unread=t.unread,s.baomin=t.baomin,s.qinjia=t.qinjia):(s.yingdao=t.yingdao,s.yidao=t.yidao,s.weidao=t.weidao),{buttons:{commonButton:o,mainButtons:n},dataValue:s}});return this.firstLoading=!1,this.loading=!1,t}}},s=(0,i(51900).Z)(n,function(){var n=this,t=n._self._c;return t("div",{staticClass:"ds-meeting-manage ds-meeting-center"},[t("van-pull-refresh",{attrs:{"success-text":"刷新成功"},on:{refresh:function(t){return n.onRefresh(!1)}},model:{value:n.loading,callback:function(t){n.loading=t},expression:"loading"}},[n.firstLoading?t("div",{staticClass:"center-loading"},[t("van-loading")],1):n._e(),n._v(" "),t("van-list",{attrs:{finished:n.finished,"finished-text":n.finishedTips,offset:10,"immediate-check":!1},on:{load:n.onLoad},model:{value:n.loading,callback:function(t){n.loading=t},expression:"loading"}},[t("ds-list",{attrs:{data:n.list,columns:n.columns,type:"hy"},on:{mainClick:n.handleActionClick,commonClick:n.handleActionClick}})],1)],1)],1)},[],!1,null,"16b93df6",null).exports}}]);