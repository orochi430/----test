"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[84407,18868,31204],{8449:function(e,t,n){var i=n(8167),a=n(31314),o=n(77193),s=n(8450),c=n.n(s),l=n(25108),s=function(){function s(){(0,i.Z)(this,s),(0,o.Z)(this,"ws",null),(0,o.Z)(this,"userid",""),(0,o.Z)(this,"ponReceivedTodo",null),(0,o.Z)(this,"ponScanCodeAfter",null),(0,o.Z)(this,"setIntervalWesocketPush",null)}return(0,a.Z)(s,[{key:"open",value:function(e){var t=dsf.url.getRootPath(),n=dsf.util.loadSessionStore("user").user_id||dsf.util.loadSessionStore("user").userId;t.startsWith("http:")?t=t.replace("http","ws")+"servletWebsocket/"+n:t.startsWith("https:")&&(t=t.replace("https","wss")+"servletWebsocket/"+n),this.ws=new WebSocket(t),this.ws.onopen=function(){e&&e()},this.ws.onmessage=function(e){var t;"pong"!=e.data&&(l.log(e),e=JSON.parse(e.data),t=s.getInstance(),-1<e.badgeType.indexOf("inbox")&&0<e.userIds.filter(function(e){return e==t.userid}).length?null!=t.ponReceivedTodo&&t.ponReceivedTodo({badgeType:e.badgeType,refresh:!0}):"qrCodeMessag"==e.badgeType&&e.userIds==t.userid?null!=t.ponScanCodeAfter&&t.ponScanCodeAfter({data:e.data}):"sameScreenMessage"==e.badgeType&&e.userIds.includes(t.userid)&&null!=t.ponmeettingSameScreen&&t.ponmeettingSameScreen({data:e.data}))},this.ws.onerror=function(e){l.log(e)},this.ws.onclose=function(){s.getInstance()}}},{key:"sendMessage",value:function(e){this.ws.send(c()(e))}},{key:"onReceivedTodo",value:function(e,t){this.userid=e,this.ponReceivedTodo=t}},{key:"onScanCodeAfter",value:function(e,t){this.userid=e,this.ponScanCodeAfter=t}},{key:"onmeettingSameScreen",value:function(e,t){this.userid=e,this.ponmeettingSameScreen=t}},{key:"clearFunction",value:function(){this.ponReceivedTodo=null,this.ponScanCodeAfter=null}},{key:"sendPing",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:6e4,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"ping";clearInterval(this.setIntervalWesocketPush),this.ws&&1==this.ws.readyState&&this.ws.send(n),this.setIntervalWesocketPush=setInterval(function(){e.ws&&1==e.ws.readyState?e.ws.send(n):clearInterval(e.setIntervalWesocketPush)},t)}},{key:"getWsReadyState",value:function(){return s.instance.ws.readyState}}],[{key:"getInstance",value:function(e,t,n){return s.instance||(s.instance=new s).open(function(){s.instance.sendPing(),t&&n&&s.instance[t](n)}),s.instance}},{key:"close",value:function(e){s.instance&&s.instance.ws&&(clearInterval(s.instance.setIntervalWesocketPush),1==s.instance.ws.readyState&&s.instance.ws.close(),s.instance=null,e)&&e()}}]),s}();t.Z=s},84407:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var s=n(5044),i=n(77193),a=n(88561),o=n(8449),t={components:{DebounceClick:n(18868).Z},props:{},data:function(){var e={isLoading:!1,finished:!1,finishedTips:"",loading:!1,start:1,list:[],showFlowSend:!1,selected:{},movingInfoId:"",canOpen:!1,showMoving:!1};return(0,i.Z)(e,"canOpen",!1),(0,i.Z)(e,"checkall",!1),(0,i.Z)(e,"showCheckAll",!1),(0,i.Z)(e,"checkedArr",[]),(0,i.Z)(e,"oaScoket",{}),e},created:function(){},mounted:function(){var t=this;o.Z.close(),this.oaScoket=o.Z.getInstance(this),this.oaScoket.onReceivedTodo(a.Z.loadSessionStore("user").user_id,function(e){t.onRefresh()})},methods:{activated:function(){this.onRefresh()},openSwipe:function(e){e.canOpen=!1},showJinJi:function(e){var t="static/squMenu/jinji.png";return 2==e.urgent||3==e.urgent||1==e.isUrgent||2==e.isUrgent||10==e.isUrgent?t:3==e.isUrgent||4==e.isUrgent?"static/squMenu/teji.png":""},onRefresh:function(){this.finishedTips="",this.finished=!1,this.loading=!0,this.list=[],this.start=1,this.getList()},onLoad:function(){this.getList()},getList:function(){var n=this,e={limit:15,page:this.start,fileType:"gw",showTotal:!0};dsf.http.get("fn/mobileToDoAndRead/getToDoAndReadList2",e).then(function(e){var t=e.data.total,e=e.data.datas?e.data.datas.map(function(e){return e.dataValue.bt=e.dataValue.bt.replace("[公文运转]",""),e.dataValue.canOpen=!0,e.dataValue}):[];n.start+=1,n.total=t||0,n.list=[].concat((0,s.Z)(n.list),(0,s.Z)(e)),n.list.length===t&&(n.finished=!0)}).finally(function(){n.loading=!1,n.isLoading=!1})},goForm:function(e){this.$router.push({name:"commonForm",params:{pk:e.info_id,moduleId:e.moduleId},query:{type:"gw",todoId:e.todoId}})}}},c=(0,n(51900).Z)(t,function(){var n=this,s=n._self._c;return s("div",{staticClass:"container"},[s("div",{staticClass:"list-content"},[s("van-list",{attrs:{finished:n.finished,"finished-text":n.finishedTips},on:{load:n.onLoad},model:{value:n.loading,callback:function(e){n.loading=e},expression:"loading"}},n._l(n.list,function(t,e){return s("debounce-click",{key:e},[s("div",{class:["flex","ac","list-item"],on:{click:function(e){return n.goForm(t)}}},[n.showCheckAll?s("van-checkbox",{attrs:{shape:"square","icon-size":"16px"},model:{value:t.checked,callback:function(e){n.$set(t,"checked",e)},expression:"item.checked"}}):n._e(),n._v(" "),s("span",{staticClass:"icon iconfont iconfawen",staticStyle:{"font-size":"38px",margin:"0px 10px",color:"#087FE3"}}),n._v(" "),s("div",{staticClass:"main"},[s("div",{staticClass:"ellipsis title",class:{bold:!t.isRead},staticStyle:{"font-weight":"700"}},[n.showJinJi(t)?s("img",{staticClass:"jinji",attrs:{src:n.showJinJi(t)}}):n._e(),n._v(" "),s("span",[n._v(n._s(t.bt))])]),n._v(" "),s("div",{staticClass:"flex jb sub-title"},[t.opinion?s("span",{staticStyle:{width:"10rem"}},[s("span",{staticStyle:{overflow:"hidden"}},[n._v(n._s(t.opinion))])]):n._e(),n._v(" "),t.name?s("span",{staticStyle:{flex:"1"}},[s("img",{attrs:{src:"static/images/project/fgwPad/person.png",alt:""}}),n._v("\n                                "+n._s(t.name)+"\n                            ")]):n._e(),n._v(" "),t.time?s("span",[s("img",{attrs:{src:"static/images/project/fgwPad/timer.png",alt:""}}),n._v("\n                                "+n._s(t.time)+"\n                            ")]):n._e()])])],1)])}),1),n._v(" "),s("commonempty",{directives:[{name:"show",rawName:"v-show",value:!n.list.length&&!n.loading,expression:"!list.length && !loading"}]})],1)])},[],!1,null,"12e8d2a4",null).exports},18868:function(e,t,n){var a=n(25108);const o=(s,i=500,a=!0)=>{let o,c=0,l,r,d=n=>{o=setTimeout(()=>{var e=(new Date).getTime(),t=e-c;t<n?(c=e,d(i-t)):(a||s.apply(l,r),clearTimeout(o),o=null)},n)};return function(){l=this,r=arguments;var e=(new Date).getTime();c=e,o||(a&&s.apply(l,r),d(i))}};t.Z={name:"DebounceClick",functional:!0,render(e,t){var n,s=t.props.time,i=t.props.immediate,t=t.slots().default;return void 0===t?(a.warn("<debounce> 组件必须要有子元素"),null):((t=t[0]||null).data.on&&t.data.on.click?(n=t.data.on.click,n=o(n,s,i),t.data.on.click=n):t.componentOptions&&t.componentOptions.listeners.click&&(n=t.componentOptions.listeners.click,n=o(n,s,i),t.componentOptions.listeners.click=n),t)}}},8167:function(e,t,n){function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return s}})},31314:function(e,t,n){n.d(t,{Z:function(){return o}});var i=n(26771),a=n(44660);function s(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),i(e,(0,a.Z)(s.key),s)}}function o(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),i(e,"prototype",{writable:!1}),e}}}]);