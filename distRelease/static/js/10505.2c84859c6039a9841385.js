"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[10505],{10505:function(e,t,n){n.r(t),n.d(t,{default:function(){return d}});var o=n(66250),t=n(33453),r=n.n(t),i=n(25108),t={filters:{dateFormat:function(e){return e?dsf.date.format(e,"yyyy-mm-dd hh:ii"):""}},props:{memos:{type:Array,default:function(){return[]}}},data:function(){return{meeting:dsf.util.loadSessionStore("meeting")}},methods:{to:function(e){this.$router.push({name:"dsfIframe",params:{url:"./static/signatureMobile/mindex_meeting.html?fileId=".concat(e.id,"&meetingId=").concat(this.meeting.id,"&type=edit"),title:"编辑备忘录"}})},delClick:function(e){var t=this;dsf.http.post("fn/conferenceMemorandum/delMemorandum",{id:e.id}).done(function(e){"200"===e.code&&(dsf.layer.toast("删除成功！",!0),t.$emit("reload"))}).error(function(e){i.log("error",e)})}}},a=n(51900),t=(0,a.Z)(t,function(){var n=this,o=n._self._c;return o("div",{staticClass:"container"},n._l(n.memos,function(t,e){return o("van-swipe-cell",{key:e,scopedSlots:n._u([{key:"right",fn:function(){return[o("van-button",{attrs:{square:"",type:"danger",text:"删除"},on:{click:function(e){return n.delClick(t)}}})]},proxy:!0}],null,!0)},[o("van-cell",{attrs:{title:t.title,value:n._f("dateFormat")(t.time),center:""},on:{click:function(e){return n.to(t)}},scopedSlots:n._u([{key:"icon",fn:function(){return[o("img",{staticClass:"left-icon",attrs:{src:"static/images/meetingPad/llq.png",alt:""}})]},proxy:!0}],null,!0)})],1)}),1)},[],!1,null,"587fd685",null).exports,l=n(14355),s=n(25108),n={components:{memoList:t,commonList:l.default},data:function(){return{memoList:[],user:dsf.util.loadSessionStore("user"),meeting:dsf.util.loadSessionStore("meeting"),params:{name:"备忘录",icon:"",goRoute:"defaultList",url:"",params:{moduleId:"220120172125U35lYA3kpFwxWs3L9JX",listId:"220120174253Rn2TPlSK5oF8arUiv9B",fid:dsf.util.loadSessionStore("meeting").id},moduleId:"220120172125U35lYA3kpFwxWs3L9JX",listId:"220120174253Rn2TPlSK5oF8arUiv9B"}}},created:function(){this.getData()},mounted:function(){},methods:{add:function(){var t=this;dsf.http.post("fn/conferenceMemorandum/addMemorandum",{meetingId:dsf.util.loadSessionStore("meeting").id}).done(function(e){e.data&&t.$router.push({name:"dsfIframe",params:{url:"./static/signatureMobile/mindex_meeting.html?fileId=".concat(e.data.id,"&meetingId=").concat(t.meeting.id,"&type=add"),title:"新增备忘录"}})}).error(function(e){s.log("error",e)})},reload:function(){this.getData()},getData:function(){var t=this;return(0,o.Z)(r().mark(function e(){return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:dsf.http.get("fn/list/220824182854XIvX8qp2dlqO8LQwBQ9/mobile/q",{moduleId:"220120172125U35lYA3kpFwxWs3L9JX",fid:t.meeting.id}).done(function(e){e.datas&&(t.memoList=[],e.datas.forEach(function(e){t.memoList.push({title:e.dataValue.B0001,time:e.dataValue.A0019,id:e.dataValue.A0001})}))}).error(function(e){s.log("error",e)});case 1:case"end":return e.stop()}},e)}))()},downFile:function(e){var t=new FileTransfer,n=encodeURI(e.url),e=e.title.substr(0,e.title.indexOf("."))+dsf.date.format(new Date,"yyyymmddiiss")+e.title.substr(e.title.indexOf(".")),o=cordova.file.externalRootDirectory+"/Download/item/"+e;t.download(n,o,function(e){s.log(e),dsf.layer.alert({message:"文件已下载到 "+o})},function(e){s.log("download error source ="+e.source),s.log("download error target ="+e.target),s.log("upload error code ="+e.code)},!1,{headers:{Authorization:"Basic dGVzdHVzZXJuYW1lOnRlc3RwYXNzd29yZA=="}})},funDownload:function(e,t){var n=document.createElement("a");n.download=t,n.style.display="none",new Blob([e]);document.body.appendChild(n),n.click(),document.body.removeChild(n)},createAndWriteFile:function(t,n){var o=this;window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(e){s.log("打开的文件系统: "+e.name),e.root.getDirectory("Download",{create:!0},function(e){e.getDirectory("item",{create:!0},function(e){e.getFile(n,{create:!0,exclusive:!1},function(e){e.name,e.fullPath,"Download/item/".concat(n),o.writeFile(e,t)},o.onErrorCreateFile)},o.onErrorGetDir)},o.onErrorGetDir)},o.onErrorLoadFs)},getAndReadFile:function(){var t=this;window.requestFileSystem(LocalFileSystem.PERSISTENT,0,function(e){s.log("打开的文件系统: "+e.name),e.root.getDirectory("xbrother",{create:!1},function(e){e.getDirectory("assets",{create:!1},function(e){e.getFile("task.json",{create:!1,exclusive:!1},function(e){s.log("是否是个文件？"+e.isFile.toString()),e.name,e.fullPath,t.readFile(e)},t.onErrorCreateFile)},t.onErrorGetDir)},t.onErrorGetDir)},t.onErrorLoadFs)},writeFile:function(t,n){t.createWriter(function(e){e.onwriteend=function(){s.log("Successful file write..."),dsf.layer.alert({message:"".concat(t.fullPath,"下载成功！")})},e.onerror=function(e){s.log("Failed file write: "+e.toString())},e.write(n)})},readFile:function(e){e.file(function(e){var t=new FileReader;t.onloadend=function(){$("#file_content_info").html(this.result),s.log("file read success:"+this.result)},t.readAsText(e)},onErrorReadFile)},onErrorLoadFs:function(e){s.log("onErrorLoadFs =",e),s.log("文件系统加载失败！")},onErrorGetDir:function(e){s.log("文件夹创建失败！")},onErrorCreateFile:function(e){s.log("文件创建失败！")},onErrorReadFile:function(){s.log("文件读取失败!")}}},d=(0,a.Z)(n,function(){var t=this,e=t._self._c;return e("div",{staticClass:"memo-container"},[e("div",{staticClass:"top"},[e("van-cell",{attrs:{title:"备忘录",icon:"arrow-left",center:""},on:{click:function(e){return t.$router.back()}},scopedSlots:t._u([{key:"default",fn:function(){return[e("van-button",{attrs:{icon:"plus",type:"primary"},on:{click:function(e){return e.stopPropagation(),t.add()}}},[t._v("新增")])]},proxy:!0}])})],1),t._v(" "),e("div",{staticClass:"content"},[e("memoList",{attrs:{memos:t.memoList},on:{reload:t.reload}})],1)])},[],!1,null,null,null).exports}}]);