"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[74319],{74319:function(t,s,e){e.r(s),e.d(s,{default:function(){return n}});var s=e(18428),i=e.n(s),s=e(73473),a=e.n(s),s=e(8450),o=e.n(s),c=e(25108),s={name:"questionOnline",data:function(){return{show:!1,match_quest:[{wtbt:"容积率1"},{wtbt:"容积率2"}],keyword:"",match_show:!1,question_answer:[],guess_page_size:6,guess_page:1,guess_question_list:[],catalogue_list:[],count:0,opinion_word:"",wtid:"",question_index:"",can_search:!0,feedback_num:""}},watch:{keyword:function(t,s){var e=this;t&&this.can_search&&(this.can_search=!1,setTimeout(function(){e.searchKeyword()},300))}},created:function(){this.getFeedBackNum(),this.getCatalogue(),this.guessQuestionData()},methods:{getFeedBackNum:function(){var s=this;dsf.http.post("fn/flfgyd/conutfk?yhid=".concat(dsf.util.loadSessionStore("user").user_id)).then(function(t){s.feedback_num=t.data.data.length})},searchKeyword:function(){var s=this;this.can_search=!0,dsf.http.post("fn/flfgyd/querygjzjs?gjzname=".concat(this.keyword)).then(function(t){t.data.data.length?(s.match_quest=t.data.data,s.handleMatch()):(s.match_quest=[{wtbt:"暂无数据",wtid:"-1",new:"<span>暂无数据</span>"}],s.match_show=!0),s.can_search=!0})},guessQuestionData:function(){var s=this;dsf.http.post("fn/flfgyd/queryznzxwdsy?limit=".concat(this.guess_page_size,"&page=").concat(this.guess_page,"&yhid=").concat(dsf.util.loadSessionStore("user").user_id)).then(function(t){s.guess_question_list=t.data.data,s.count=t.count,t.data.data.length<s.guess_page_size&&(s.guess_page=0)})},getCatalogue:function(){var s=this;dsf.http.post("fn/flfgyd/flfgquerylmfl").then(function(t){s.catalogue_list=i()([],t.data.data)})},skipToSearch:function(t,s,e){this.$router.push({path:"/catalogSearch",query:{index_obj:{type_value:t,wjjbvalue:e,gjzname:s}}})},handleMatch:function(){var e=this;this.match_quest.forEach(function(t,s){t.wtbt.includes(e.keyword)&&(t=t.wtbt.split(e.keyword),t="<span>".concat(t[0],'</span><span style="color: #ff7070;">').concat(e.keyword,"</span><span>").concat(t[1],"</span>"),e.match_quest[s].new=t)}),c.log(this.match_quest),this.match_show=!0},notMatchShow:function(){var t=this;setTimeout(function(){t.match_show=!1},200)},raiseQuestion:function(e){var s,n,i=this;setTimeout(function(){i.match_show=!1},200),"-1"!==e.wtid&&(this.keyword="",(s={}).question=e.wtbt,s.wait="获取问题答案中...",this.question_answer.push(s),n=new(a())(function(s){dsf.http.post("fn/flfgyd/queryxgtj?gjzname=".concat(i.keyword,"&wtid=").concat(e.wtid)).then(function(t){s(t)})}),new(a())(function(s){dsf.http.post("fn/flfgyd/querynrByid?wtid=".concat(e.wtid)).then(function(t){s(t)})}).then(function(t){return s.nrbt=t.data.nrbt,s.nrtext=t.data.nrtext,s.wait="",s.wtid=e.wtid,s.use_check=!1,s.use_click=!1,s.notuse_click=!1,n}).then(function(t){s.related_list=t.data.data,i.question_answer.pop(),i.question_answer.push(s),c.log(i.question_answer),i.$nextTick(function(){var t=i.$refs.scrollerBox.offsetHeight;i.$refs.contents.scrollTo(0,t,!0)})}))},useQuestion:function(t,s,e){var n=this;this.question_index=e,s.use_check||(t?dsf.http.post("fn/flfgyd/countyy?wjid=".concat(s.wtid)).then(function(t){n.question_answer[n.question_index].use_check=!0,n.question_answer[n.question_index].use_click=!0}):(this.opinion_word="",this.show=!0,this.wtid=s.wtid),e=o()(this.question_answer),this.question_answer="",this.question_answer=JSON.parse(e),this.question_answer=i()([],this.question_answer),c.log(this.question_answer))},sureSubmit:function(){var t,s,e,n=this;this.opinion_word?(e=(new Date).getFullYear(),t=9<(t=(new Date).getMonth()+1)?t:"0"+t,s=9<(s=(new Date).getDate())?s:"0"+s,dsf.http.post("fn/flfgyd/countmy",{wjid:this.wtid,fkr:dsf.util.loadSessionStore("user").name,fkrq:e+"-"+t+"-"+s,fknr:this.opinion_word,fkrid:dsf.util.loadSessionStore("user").user_id}).then(function(t){c.log(t),n.question_answer[n.question_index].use_check=!0,n.question_answer[n.question_index].notuse_click=!0,n.show=!1}),e=o()(this.question_answer),this.question_answer="",this.question_answer=JSON.parse(e),this.question_answer=i()([],this.question_answer)):dsf.layer.toast("请填写意见")},skipToDetail:function(t){c.log(t),this.$router.push({path:"/contentDetail",query:{wjid:t.wtid,title:t.nrbt,from:"other"}})}}},n=(0,e(51900).Z)(s,function(){var n=this,i=n._self._c;return i("div",{staticClass:"question_online"},[i("div",{ref:"contents",staticClass:"contents",on:{click:function(t){return n.notMatchShow()}}},[i("div",{ref:"scrollerBox",staticClass:"scroller_box"},[i("div",{staticClass:"question"},[i("div",{staticClass:"left"},[i("img",{staticStyle:{width:"50%"},attrs:{src:"static/images/ghjoa/qa.png"}}),n._v(" "),i("span",{staticClass:"text_color",staticStyle:{width:"20px",margin:"10px 0"}},[n._v("猜你想问")]),n._v(" "),i("img",{staticStyle:{width:"30%"},attrs:{src:"static/images/ghjoa/change.png"},on:{click:function(t){n.guess_page++,n.guessQuestionData()}}})]),n._v(" "),i("div",{staticClass:"right"},n._l(n.guess_question_list,function(s){return i("p",{key:s.wtid,staticClass:"fs-14",on:{click:function(t){return n.raiseQuestion(s)}}},[n._v("\n                        "+n._s(s.wtbt)+"\n                    ")])}),0)]),n._v(" "),i("div",{staticClass:"catalog"},[n._m(0),n._v(" "),i("div",{staticClass:"right"},[i("p",[n._v("按效力级别：")]),n._v(" "),n._l(n.catalogue_list,function(s,t){return i("span",{key:t,staticClass:"text_color2",on:{click:function(t){return n.skipToSearch(s.fjlxname,"",s.fjlxvalue)}}},[n._v("\n                        "+n._s(s.fjlxname))])})],2)]),n._v(" "),n.feedback_num?i("p",{staticClass:"feedback"},[n._v("\n                您有"),i("span",{staticClass:"text_color"},[n._v(n._s(n.count))]),n._v("条新反馈，请"),i("span",{staticClass:"text_color",on:{click:function(t){return n.$router.push({path:"/feedback"})}}},[n._v("点击查看")])]):n._e(),n._v(" "),n._l(n.question_answer,function(s,e){return i("div",{key:e,staticClass:"question_answer"},[i("p",{staticClass:"text-right",staticStyle:{"box-sizing":"border-box"}},[i("span",{staticClass:"question2"},[n._v(n._s(s.question))])]),n._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:s.wait,expression:"items.wait"}],staticClass:"wait text-center"},[n._v("\n                    "+n._s(s.wait)+"\n                ")]),n._v(" "),s.nrbt?i("div",{staticClass:"answer"},[i("p",{staticStyle:{margin:"0"}},[n._v(n._s(s.nrbt))]),n._v(" "),i("p",{domProps:{innerHTML:n._s(s.nrtext)}}),n._v(" "),i("p",{staticClass:"text-center fs-16",staticStyle:{color:"#4da6ff",margin:"1em 0"},on:{click:function(t){return n.skipToDetail(s)}}},[n._v("\n                        点击进入查看详情\n                    ")]),n._v(" "),i("p",{staticClass:"whether_use"},[i("span",{staticClass:"use_item",on:{click:function(t){return n.useQuestion(!0,s,e)}}},[i("img",{attrs:{src:s.use_click?"static/images/ghjoa/check_good.png":"static/images/ghjoa/good.png",alt:""}}),n._v(" "),i("span",{style:{color:s.use_click?"red":""}},[n._v("有用")])]),n._v(" "),i("span",{on:{click:function(t){return n.useQuestion(!1,s,e)}}},[i("img",{attrs:{src:s.notuse_click?"static/images/ghjoa/check_notgood.png":"static/images/ghjoa/not_good.png",alt:""}}),n._v(" "),i("span",{style:{color:s.notuse_click?"red":""}},[n._v("没用")])])])]):n._e(),n._v(" "),s.related_list&&s.related_list.length?i("div",{staticClass:"related_question"},[n._m(1,!0),n._v(" "),i("div",{staticClass:"relateds"},n._l(s.related_list,function(s){return i("p",{key:s.wtid,on:{click:function(t){return n.raiseQuestion(s)}}},[i("img",{attrs:{src:"static/images/ghjoa/tip.png",alt:""}}),n._v(" "),i("span",[n._v(n._s(s.wtbt))])])}),0)]):n._e()])})],2)]),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:n.match_show,expression:"match_show"}],staticClass:"match_keyword"},n._l(n.match_quest,function(s,t){return i("p",{key:t,domProps:{innerHTML:n._s(s.new)},on:{click:function(t){return n.raiseQuestion(s)}}})}),0),n._v(" "),i("div",{staticClass:"bottom"},[i("img",{attrs:{src:"static/images/ghjoa/shutu_icon.png"}}),n._v(" "),i("van-search",{attrs:{"left-icon":"",placeholder:"请输入搜索关键词","action-text":"搜索","show-action":""},on:{search:function(t){return n.searchKeyword()},cancel:function(t){return n.searchKeyword()}},model:{value:n.keyword,callback:function(t){n.keyword=t},expression:"keyword"}})],1),n._v(" "),i("van-popup",{style:{height:"30%"},attrs:{round:!0,position:"bottom"},model:{value:n.show,callback:function(t){n.show=t},expression:"show"}},[i("van-nav-bar",{attrs:{title:"意见输入","left-text":"返回","right-text":"确定"},on:{"click-left":function(t){n.show=!1},"click-right":function(t){return n.sureSubmit()}}}),n._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model",value:n.opinion_word,expression:"opinion_word"}],attrs:{placeholder:"为系统更完善，请填写建议，我们在收到建议后的一个工作日内回复，感谢！"},domProps:{value:n.opinion_word},on:{input:function(t){t.target.composing||(n.opinion_word=t.target.value)}}})],1)],1)},[function(){var t=this._self._c;return t("div",{staticClass:"left"},[t("img",{staticStyle:{width:"50%"},attrs:{src:"static/images/ghjoa/classify.png"}}),this._v(" "),t("span",{staticStyle:{width:"20px",margin:"20px 0"}},[this._v("分类查询")])])},function(){var t=this._self._c;return t("p",{staticStyle:{"margin-top":"0"}},[t("img",{attrs:{src:"static/images/ghjoa/link.png",alt:""}}),this._v(" "),t("span",[this._v("相关推荐问题")])])}],!1,null,"57b128ca",null).exports}}]);