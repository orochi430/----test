"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[80304],{27918:function(e,t,n){n.r(t);var a=n(73473),i=n.n(a),n={};n.initHandle=function(e,t,n){var a,d,o;1<e.main["C-DB-CHANGE-0008"].value.split(",").length&&(t.controls.find(function(e){return"C-DB-CHANGE-0003"==e.metaId}).privilege.editable=!1),n.relationList[0]&&n.relationList[0].document.length||(a=n,d="文件关联",o=2,new(i())(function(t,n){dsf.http.post("ctrl/filerelation/select/checkedJson",{pks:a.$route.query.relationId,infoId:a.pk,relaType:o,relaName:d}).then(function(e){200==e.data.code?t(e.data.data):n()})}).then(function(e){dsf.http.post("fn/mobileRelationFile/save",{relaMode:e[0].relaMode,relaIds:e[0].relaId,pk:n.pk,moduleId:n.moduleId,fileRelaId:n.relationList[0].fileRelaId}).then(function(e){200==e.data.code&&dsf.http.get("fn/mobileRelationFile/getFormRelationFiles",{pk:n.pk,moduleId:n.moduleId,nodeId:t.parameters.nodeId,flowId:t.parameters.flowId}).then(function(e){n.$set(n,"relationList",e.data.rows)})})})),n.$bus.$off("userClickBus").on("userClickBus",function(e){var a;"C-DB-CHANGE-0005"==e.metaId&&e.user.checked&&(a=e.user,new(i())(function(t,n){dsf.http.post("fn/superviseV6/approval/hasRolePersonByDept",{deptId:a.id.slice(a.id.lastIndexOf("_")+1),deptName:a.showName}).then(function(e){(200==e.data.code?t:(dsf.layer.toast(e.data.message),n))()})}).catch(function(){e.user.checked=!1,e.callback(e.user)}))})},t.default=n}}]);