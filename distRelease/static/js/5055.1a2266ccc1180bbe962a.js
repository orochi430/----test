"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[5055],{5055:function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var a=s(77193),i=s(5044),t=s(8450),_=s.n(t),n=s(25108),t={name:"message_survey",data:function(){return{date:(new Date).toLocaleDateString().replace(/\//g,"-"),no_submit:!1,radio:"",show_select_picker:!1,picker_column:[],health_message:[],travel_message:[],user_message:[]}},created:function(){this.getData()},methods:{getData:function(){var s=this;dsf.http.get("action?EpidemicAppAction=7",{userId:dsf.util.loadSessionStore("user").user_id}).then(function(e){var t,e=e.data;200==e.code&&(s.health_message=[],s.travel_message=[],s.user_message=JSON.parse(_()(e.data)),delete s.user_message.question,s.no_submit=s.user_message.flag,s.user_message.date||(t=new Date,s.user_message.date="".concat(t.getFullYear(),"-").concat(9<t.getMonth()+1?t.getMonth()+1:"0"+(t.getMonth()+1),"-").concat(9<t.getDate()?t.getDate():"0"+t.getDate())),e.data.question.forEach(function(t){switch(t.type){case"drop_down":t.select_value&&(t.select_value=t.select_list.filter(function(e){return e.value==t.select_value})[0].word);break;case"checkbox":t.select_value?t.select_value=t.select_value.split(","):t.select_value=[]}("健康信息"==t.sort?s.health_message:s.travel_message).push(t)}))})},showSelectPicker:function(e,t){var s=this;n.log(e),this.drop_down_index=t,this.picker_column=[],this.sort=e.sort,e.select_list.forEach(function(e){s.picker_column.push(e.word)}),this.show_select_picker=!0},onConfirm:function(e){"健康信息"==this.sort?this.health_message[this.drop_down_index].select_value=e:this.travel_message[this.drop_down_index].select_value=e,this.show_select_picker=!1},submitMessage:function(){for(var t=this,s=(n.log(this.health_message,this.travel_message),[]),a=!1,l=[].concat((0,i.Z)(this.health_message),(0,i.Z)(this.travel_message)),e=(n.log(l),l.length),c=0;c<e&&"break"!==function(){var t=l[c];if(n.log(t.select_value,t.select_value.length,!t.select_value||!t.select_value.length),!t.select_value||!t.select_value.length)return a=!0,"break";var e={question:t.id,value:t.select_value};switch(t.type){case"drop_down":e.value=t.select_list.filter(function(e){return e.word==t.select_value})[0].value;break;case"checkbox":e.value=t.select_value.toString()}s.push(e)}();c++);a?dsf.layer.toast("请将健康信息或出行信息填写完整"):dsf.http.get("action?EpidemicAppAction=8",{userId:dsf.util.loadSessionStore("user").user_id,id:this.user_message.id,name:this.user_message.name,phone:this.user_message.phone,identity:this.user_message.identity,date:this.user_message.date,question:_()(s)}).then(function(e){200==e.data.code&&dsf.layer.alert({title:"温馨提示",message:e.data.message},function(){t.$router.back()})})}}},l=(0,s(51900).Z)(t,function(){var _=this,e=_._self._c;return e("div",{staticClass:"message_survey"},[e("div",{staticClass:"content_body"},[e("div",{staticClass:"base"},[e("p",{staticClass:"title"},[_._v("基础信息")]),_._v(" "),e("div",{staticClass:"content"},[e("p",[e("span",[_._v("姓名")]),_._v(" "),e("span",[_._v(_._s(_.user_message.name))])]),_._v(" "),e("p",{staticClass:"identity"},[e("span",[_._v("身份证")]),_._v(" "),e("van-field",{attrs:{placeholder:"请输入身份证号",clearable:""},model:{value:_.user_message.identity,callback:function(e){_.$set(_.user_message,"identity",e)},expression:"user_message.identity"}})],1),_._v(" "),e("p",[e("span",[_._v("手机号")]),_._v(" "),e("span",[_._v(_._s(_.user_message.phone))])]),_._v(" "),e("p",[e("span",[_._v("上传日期")]),_._v(" "),e("span",[_._v(_._s(_.user_message.date))])])])]),_._v(" "),e("div",{staticClass:"health"},[e("p",{staticClass:"title"},[_._v("健康信息")]),_._v(" "),e("div",{staticClass:"content"},_._l(_.health_message,function(i,t){return e("div",{key:t},["radio"==i.type?e("div",{staticClass:"type_radio"},[e("span",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("div",{staticClass:"radio_group"},_._l(i.select_list,function(t){return e("div",{key:t.value,staticClass:"radio_select"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.select_value,expression:"items.select_value"}],attrs:{name:i.id,id:t.value,type:"radio"},domProps:(0,a.Z)({checked:i.select_value,value:t.value},"checked",_._q(i.select_value,t.value)),on:{change:function(e){return _.$set(i,"select_value",t.value)}}}),_._v(" "),e("label",{staticClass:"radio_test",attrs:{for:t.value}},[e("span",{staticClass:"icon"}),_._v(" "),e("span",{staticClass:"word"},[_._v("\n                    "+_._s(t.word)+"\n                  ")])])])}),0)]):_._e(),_._v(" "),"checkbox"==i.type?e("div",{staticClass:"type_checkbox"},[e("p",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("div",{staticClass:"check_group"},_._l(i.select_list,function(c){return e("div",{key:c.value,staticClass:"check_select"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.select_value,expression:"items.select_value"}],attrs:{name:i.id,id:c.value,type:"checkbox"},domProps:(0,a.Z)({value:c.value,checked:i.select_value},"checked",Array.isArray(i.select_value)?-1<_._i(i.select_value,c.value):i.select_value),on:{change:function(e){var t,s,a=i.select_value,e=e.target,l=!!e.checked;Array.isArray(a)?(t=c.value,s=_._i(a,t),e.checked?s<0&&_.$set(i,"select_value",a.concat([t])):-1<s&&_.$set(i,"select_value",a.slice(0,s).concat(a.slice(s+1)))):_.$set(i,"select_value",l)}}}),_._v(" "),e("label",{staticClass:"check_test",attrs:{for:c.value}},[e("span",{staticClass:"icon"}),_._v(" "),e("span",{staticClass:"word"},[_._v("\n                    "+_._s(c.word)+"\n                  ")])])])}),0)]):_._e(),_._v(" "),"drop_down"==i.type?e("div",{staticClass:"type_drop_down"},[e("span",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("div",{on:{click:function(e){return _.showSelectPicker(i,t)}}},[e("span",[_._v(_._s(i.select_value||"请选择"))]),_._v(" "),e("van-icon",{attrs:{name:"arrow-down"}})],1)]):_._e(),_._v(" "),"textarea"==i.type?e("div",{staticClass:"type_textarea"},[e("p",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("van-field",{attrs:{placeholder:i.select_list[0].word,rows:"3",autosize:"",type:"textarea",clearable:""},model:{value:i.select_value,callback:function(e){_.$set(i,"select_value",e)},expression:"items.select_value"}})],1):_._e()])}),0)]),_._v(" "),e("div",{staticClass:"go"},[e("p",{staticClass:"title"},[_._v("出行信息")]),_._v(" "),e("div",{staticClass:"content"},_._l(_.travel_message,function(i,t){return e("div",{key:t},["radio"==i.type?e("div",{staticClass:"type_radio"},[e("span",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("div",{staticClass:"radio_group"},_._l(i.select_list,function(t){return e("div",{key:t.value,staticClass:"radio_select"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.select_value,expression:"items.select_value"}],attrs:{name:i.id,id:t.value,type:"radio"},domProps:(0,a.Z)({value:t.value,checked:i.select_value},"checked",_._q(i.select_value,t.value)),on:{change:function(e){return _.$set(i,"select_value",t.value)}}}),_._v(" "),e("label",{staticClass:"radio_test",attrs:{for:t.value}},[e("span",{staticClass:"icon"}),_._v(" "),e("span",{staticClass:"word"},[_._v("\n                    "+_._s(t.word)+"\n                  ")])])])}),0)]):_._e(),_._v(" "),"checkbox"==i.type?e("div",{staticClass:"type_checkbox"},[e("p",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("div",{staticClass:"check_group"},_._l(i.select_list,function(c){return e("div",{key:c.value,staticClass:"check_select"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.select_value,expression:"items.select_value"}],attrs:{name:i.id,id:c.value,type:"checkbox"},domProps:(0,a.Z)({value:c.value,checked:i.select_value},"checked",Array.isArray(i.select_value)?-1<_._i(i.select_value,c.value):i.select_value),on:{change:function(e){var t,s,a=i.select_value,e=e.target,l=!!e.checked;Array.isArray(a)?(t=c.value,s=_._i(a,t),e.checked?s<0&&_.$set(i,"select_value",a.concat([t])):-1<s&&_.$set(i,"select_value",a.slice(0,s).concat(a.slice(s+1)))):_.$set(i,"select_value",l)}}}),_._v(" "),e("label",{staticClass:"check_test",attrs:{for:c.value}},[e("span",{staticClass:"icon"}),_._v(" "),e("span",{staticClass:"word"},[_._v("\n                    "+_._s(c.word)+"\n                  ")])])])}),0)]):_._e(),_._v(" "),"drop_down"==i.type?e("div",{staticClass:"type_drop_down"},[e("span",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("div",{on:{click:function(e){return _.showSelectPicker(i,t)}}},[e("span",[_._v(_._s(i.select_value||"请选择"))]),_._v(" "),e("van-icon",{attrs:{name:"arrow-down"}})],1)]):_._e(),_._v(" "),"textarea"==i.type?e("div",{staticClass:"type_textarea"},[e("p",[_._v(_._s(t+1)+"."+_._s(i.title))]),_._v(" "),e("van-field",{attrs:{placeholder:i.select_list[0].word,rows:"3",autosize:"",type:"textarea",clearable:""},model:{value:i.select_value,callback:function(e){_.$set(i,"select_value",e)},expression:"items.select_value"}})],1):_._e()])}),0)])]),_._v(" "),e("div",{staticClass:"operate"},[e("van-button",{attrs:{disabled:_.no_submit,type:"info"},on:{click:_.submitMessage}},[_._v("\n      提交\n    ")])],1),_._v(" "),e("van-popup",{attrs:{round:"",position:"bottom"},model:{value:_.show_select_picker,callback:function(e){_.show_select_picker=e},expression:"show_select_picker"}},[e("van-picker",{attrs:{columns:_.picker_column,"show-toolbar":""},on:{cancel:function(e){_.show_select_picker=!1},confirm:_.onConfirm}})],1)],1)},[],!1,null,"f9c504f2",null).exports}}]);