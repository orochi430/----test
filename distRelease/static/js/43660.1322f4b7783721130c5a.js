"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[43660],{43660:function(t,e,n){n.r(e),n.d(e,{default:function(){return l}});var e=n(26243),i=n.n(e),e=n(62680),s=n.n(e),e=n(95366),d=n.n(e),e=n(6919),a=n.n(e),o=n(77193);function r(e,t){var n,a=i()(e);return s()&&(n=s()(e),t&&(n=n.filter(function(t){return d()(e,t).enumerable})),a.push.apply(a,n)),a}var e={name:"weekDutyPlan",data:function(){return{navBtnActiveIndex:0,timelineList:[],weekType:"now",user:dsf.util.loadSessionStore("user"),begindate:"",enddate:"",dateNow:new Date}},mounted:function(){},created:function(){this.loadData()},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):a()?Object.defineProperties(e,a()(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,d()(n,t))})}return e}({},(0,n(20629).rn)({isShowAppFooter:function(t){return t.isShowAppFooter},isShowAppHeader:function(t){return t.isShowAppHeader}})),methods:{getWeekay:function(t){return["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][t.getDay()]},loadData:function(){for(var i=this,t=dsf.date.getMonthWeekDate(this.dateNow.getFullYear(),this.dateNow.getMonth(),this.dateNow.getDate()),t=(i.begindate=dsf.date.format(t.list[0].date,"yyyy-mm-dd"),i.enddate=dsf.date.format(t.list[t.list.length-1].date,"yyyy-mm-dd"),{begindate:i.begindate,enddate:i.enddate}),e=(i.timelineList=[],new Date(i.begindate)),n=new Date(i.enddate),a=e;a<=n;a.setDate(e.getDate()+1)){var s=dsf.date.format(a,"yyyy-mm-dd");i.timelineList.push({id:"",date:s,dateshow:s.substring(5),title:"",content:"",weekday:i.getWeekay(a),isweekend:"星期六"==i.getWeekay(a)||"星期日"==i.getWeekay(a),istoday:!1})}dsf.http.post("/fn/sx/schedule/showSchedule",t).then(function(t){var a;"200"==(t=t.data).code?t.data.length?(a=null,t.data.forEach(function(e,t){"1"!=e.istoday||a||((a=e).index=t);var n=i.timelineList.find(function(t){return t.date==e.start});if(n)if(n.id)switch(e.personType){case"ld":n.title+=(n.title.length?"、":"")+e.person.replace(/,/g,"、");break;case"zb":n.content+=(n.content.length?"、":"")+e.person.replace(/,/g,"、")}else n.id=e.id,n.title="ld"==e.personType?e.person:"",n.content="zb"==e.personType?e.person:"",n.istoday=0<e.istoday}),a&&i.$nextTick(function(){document.getElementById("".concat(a.index,"_").concat(a.start)).scrollIntoView({behavior:"smooth",block:"center"})})):dsf.layer.toast("暂无数据"):dsf.layer.toast("获取数据失败！")})},onClickLeft:function(){this.navBtnActiveIndex=1,this.dateNow=dsf.date.getBeforDate(this.dateNow.getFullYear(),this.dateNow.getMonth(),this.dateNow.getDate(),7),this.loadData()},onClickRight:function(){this.navBtnActiveIndex=2,this.dateNow=dsf.date.getBeforDate(this.dateNow.getFullYear(),this.dateNow.getMonth(),this.dateNow.getDate(),-7),this.loadData()},onClickCenter:function(){this.navBtnActiveIndex=0,this.dateNow=new Date,this.loadData()}}},l=(0,n(51900).Z)(e,function(){var n=this,a=n._self._c;return a("div",[a("van-sticky",{attrs:{"offset-top":n.dsf.util.getOffsetTop()}},[a("div",{staticClass:"van-nav-bar van-hairline--bottom",attrs:{"data-v-6d90827a":""}},[a("div",{staticClass:"van-nav-bar__content"},[a("div",{staticClass:"van-nav-bar__left"},[a("span",{class:{true:"van-nav-bar__text nav-bar-active",false:"van-nav-bar__text"}[1==n.navBtnActiveIndex],on:{click:function(t){return n.onClickLeft()}}},[n._v("上一周")])]),n._v(" "),a("div",{class:{true:"van-nav-bar__title van-ellipsis nav-bar-active",false:"van-nav-bar__title van-ellipsis"}[0==n.navBtnActiveIndex],on:{click:function(t){return n.onClickCenter()}}},[n._v("本周")]),n._v(" "),a("div",{staticClass:"van-nav-bar__right"},[a("span",{class:{true:"van-nav-bar__text nav-bar-active",false:"van-nav-bar__text"}[2==n.navBtnActiveIndex],on:{click:function(t){return n.onClickRight()}}},[n._v("下一周")])])])])]),n._v(" "),n._l(n.timelineList,function(t,e){return a("div",{key:e,staticClass:"time-line",attrs:{id:e+"_"+t.date}},[a("div",{staticClass:"time-line-div"},[a("p",{staticClass:"time-line-date"},[n._v(n._s(t.dateshow))]),n._v(" "),a("p",{ref:"circular",refInFor:!0,class:t.istoday?"time-line-circular-active":"time-line-circular"}),n._v(" "),a("div",{staticClass:"rightContainer"},[a("div",{staticClass:"line-inner-box"},[a("span",{class:t.isweekend?"time-line-calendar-active":"time-line-calendar"},[a("van-icon",{staticClass:"iconCalendar",attrs:{name:"calendar-o"}})],1),n._v(" "),a("span",{class:t.isweekend?"time-line-title active":"time-line-title"},[n._v(n._s(t.weekday))]),n._v(" "),n._m(0,!0)]),n._v(" "),a("div",{staticClass:"time-line-content"},[a("div",{staticClass:"time-line-item"},[n._v("带班领导："+n._s(t.title))]),n._v(" "),a("div",{staticClass:"time-line-item"},[n._v("值班人员："+n._s(t.content))])])])]),n._v(" "),a("div",{ref:"dotted",refInFor:!0,staticClass:"img-dotted"})])})],2)},[function(){var t=this._self._c;return t("span",{staticClass:"time-line-rightline"},[t("hr")])}],!1,null,"4446f182",null).exports}}]);