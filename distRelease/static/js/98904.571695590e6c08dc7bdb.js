(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[98904,31204],{42206:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return v}});var i=s(522),e=(s(84832),s(59978)),n=(s(16779),s(67763)),o=(s(73474),s(74755)),a=(s(23307),s(81392)),r=s(73473),l=s.n(r),r=s(8450),c=s.n(r),r=s(87929),d=s(63560),u=s(63450),f=s(50856),p=s(62689),m=s(2728),h=s(82060),g=s(25108),f={name:"TabCommonForm",components:{DsfButtonToolbox:f.Z,textareEdit:r.Z,selectPerson:d.default,file:p.default,Icon:a.Z,Popup:o.Z,Grid:n.Z,GridItem:e.Z,controlUserList:u.default,EnclosurePreview:h.default},data:function(){return{title:"",titledisabled:!(!this.$route.params.pk||2==this.$route.params.tabIndex),tures:!0,fileUrl:"",filename:"",fileType:"",showFile:!1,imgPreview:!1,previewImg:[],users:"",usersid:"",personDate:[],maintitle:"",textareaContent:"",showPerson:!1,radioVal:"",radioText:"",SendStatus:"-1",sendObj:{},smsContent:"",moduleId:this.$route.params.moduleId,attach_1:[],fileObj:{attach:[]},initDate:{},isCreatForm:!this.$route.params.pk,userSchema:"",textareaTextVal:"",TabIndex:this.$route.params.tabIndex,forwardIds:this.$route.params.forwardIds||"",replyId:this.$route.params.replyId||"",pk:this.$route.params.pk||"",routeKey:this.$route.params.key,hf:"",buttons:{commonButtons:[],mainButtons:[]},historyMsg:[],isSave:!1,isAddSend:!1,isback:!1,isdisabled:!(!this.$route.params.pk||2==this.$route.params.tabIndex),selectUsersName:[],imgType:["jpeg","bmp","webp","svgz","svg","gif","jpg","ico","png","tif"],showBtnNames:dsf.config.setting["SYS-MOBILE-FORM-0006"]||"发送,保存,删除",isShowSmsSend:dsf.config.setting["SYS-MOBILE-FORM-0007"]||-1,isShowHistoryMsg:dsf.config.setting["SYS-MOBILE-FORM-0008"]||-1,isShowUrgency:dsf.config.setting["SYS-MOBILE-FORM-0010"]||1,isShowContent:dsf.config.setting["SYS-MOBILE-FORM-0020"]||1,accept:"ios"==dsf.util.checkSystem()||dsf.util.getClientName().includes("ding")?"*":"image/*, application/*",isShowDownBtn:!1,extra:{multiple:!0,tabs:[{name:"本机构",action:"fn/user/select/data?types=person,department,post,privateGroup,own_group&rootObject=2&action=self_org&async=true&source=share",subTabKey:"department"}]},fileTypes:{pdf:["pdf"],img:["jpeg","bmp","webp","svgz","svg","gif","jpg","ico","png","tif"],txt:["txt","sql","xml","html","css","js","java","php","bat","log"],word:["docx","docm","doc","dotx","dotm","dot"],xls:["xlsx","xlsm","xlsb","xls","xltx","xltm","xlt","xlam","xla","ods"],ppt:["pptx","pptm","ppt","potx","potm","pot","ppsx","ppsm","pps","ppam","ppa"]},hasFilePng:["ai","cloud","html","img","jpg","mp3","mp4","pdf","png","ppt","psd","rar","txt","word","wps","xls","zip","ofd"],popFile:{},fileData:{}}},watch:{$route:function(t,e){(t.params.replyId||t.params.forwardIds)&&(this.titledisabled=!!t.params.pk,this.isdisabled=!t.params.pk&&2!=t.params.tabIndex,this.replyId="0"==t.params.replyId?"":t.params.replyId,this.forwardIds="0"==t.params.forwardIds?"":t.params.forwardIds,this.pk="",this.tures=!this.replyId&&!this.forwardIds,this.textareaTextVal="",this.hf=this.replyId?"(回复)":"",this.buttons.mainButtons.forEach(function(t){t.show=!1,"send"==t.type&&(t.show=!0)}),this.initForm())}},created:function(){"ios"==dsf.util.checkSystem()||"app"!=dsf.util.getClientName()&&!dsf.config.ddSetting.isDing||dsf.config.commonForm.NoDownload||(this.isShowDownBtn=!0),dsf.config.setting.hasOwnProperty("SYS-MOBILE-FORM-0014")&&""!=dsf.config.setting["SYS-MOBILE-FORM-0014"]&&(this.extra.tabs=JSON.parse(dsf.config.setting["SYS-MOBILE-FORM-0014"])),this.initForm(),"fileTask"==this.$route.query.formType&&this.getTaskDetailAndInitPersonAndTitle()},methods:{initButtons:function(){var e=this;this.isCreatForm?this.buttons.mainButtons.push({name:"发送",action:"send",icon:"iconsend"},{name:"保存",action:"save",icon:"iconbaocun"}):(2==this.TabIndex?(this.buttons.mainButtons.push({name:"发送",action:"send",icon:"iconsend"},{name:"保存",action:"save",icon:"iconbaocun"}),this.buttons.commonButtons.push({name:"删除",action:"del",icon:"icondelete"})):1==this.TabIndex?(this.buttons.mainButtons.push({name:"转发",action:"forward",icon:"iconshare"},{name:"增发",action:"addsend",icon:"iconshare"}),this.buttons.commonButtons.push({name:"删除",action:"del",icon:"icondelete"},{name:"讨论",action:"discuss",icon:"iconcomment-processing-outline"})):(this.buttons.mainButtons.push({name:"回复",action:"replay",icon:"iconreply"},{name:"转发",action:"forward",icon:"iconshare"},{name:"阅读情况",action:"readStatus",icon:"iconemail-open"},{name:"转发情况",action:"forwardStatus",icon:"iconcontact-mail"}),this.buttons.commonButtons.push({name:"删除",action:"del",icon:"icondelete"})),(this.forwardIds||this.replyId)&&(this.isdisabled=!1,this.buttons.mainButtons=[],this.buttons.commonButtons=[],this.buttons.mainButtons.push({name:"发送",action:"send",icon:"iconsend"},{name:"保存",action:"save",icon:"iconbaocun"})),dsf.config.ddSetting.isDing||this.removeDiscussBtn(),this.getHistoryMsg()),this.buttons.commonButtons=this.buttons.commonButtons.filter(function(t){return(","+e.showBtnNames+",").includes(","+t.name+",")}),this.buttons.mainButtons=this.buttons.mainButtons.filter(function(t){return(","+e.showBtnNames+",").includes(","+t.name+",")})},removeDiscussBtn:function(){var i=this;this.buttons.mainButtons.forEach(function(t,e){"discuss"==t.action&&i.buttons.mainButtons.splice(e,1)}),this.buttons.commonButtons.forEach(function(t,e){"discuss"==t.action&&i.buttons.commonButtons.splice(e,1)})},delUser:function(t,i){var e=this;e.usersid=e.usersid.split(",").filter(function(t,e){return e!=i}).join(","),e.users=e.users.split(",").filter(function(t,e){return e!=i}).join(","),e.selectUsersName.splice(i,1),e.userSchema=e.userSchema.split(",").filter(function(t,e){return e!=i}).join(",")},initForm:function(){var e=this,t={moduleId:e.moduleId,pk:e.pk};1<e.forwardIds.length&&(delete t.pk,t.forwardIds=e.forwardIds),1<e.replyId.length&&(delete t.pk,t.replyId=e.replyId),this.$route.query.formType&&(t.formType=this.$route.query.formType),this.$route.query.formPk&&(t.formPk=this.$route.query.formPk),dsf.http.post("fn/mobileNote/getNotepaperById",t).then(function(t){e.title=t.data.title||"便笺",m.Z.setTitle(e.title),e.initDate=t.data,e.users=e.isCreatForm?"":e.initDate.rangeName,e.usersid=e.initDate.range||"",e.users=e.initDate.rangeName||"",e.selectUsersName=e.users.split(","),e.userSchema=e.initDate.rangeSchema||"",e.maintitle=e.initDate.noteTitle||"",null!=e.initDate.jjcd?(e.radioVal=e.isCreatForm?"":String(e.initDate.jjcd),e.radioText=e.isCreatForm?"":String(e.initDate.jjcdText)):e.radioVal="",e.textareaTextVal=e.isCreatForm?"":e.initDate.content?String(e.initDate.content):" ",e.textareaContent=e.textareaTextVal,e.attach_1=e.initDate.file?e.initDate.file.attach:[],e.attach_1.sort(function(t,e){return Date.parse(e.time)-Date.parse(t.time)}),e.pk&&(e.SendStatus=!e.isCreatForm&&e.initDate.isSms?String(e.initDate.isSms):""),e.initButtons(),e.$eventBus.refreshBadge(e,0)})},getHistoryMsg:function(){var e=this,t={moduleId:this.moduleId,pk:this.pk};dsf.http.post("fn/mobileNote/getToAndGo",t).then(function(t){e.historyMsg=t.data.data})},handlerBtn:function(t){switch(t){case"send":this.handlerSend(t);break;case"save":this.handlerSave(t);break;case"del":this.handlerDel(t);break;case"forward":this.handlerForward(t);break;case"addsend":this.handlerAddSend();break;case"replay":this.handlerReplay(t);break;case"discuss":this.createChatGroup(t);break;case"readStatus":this.readStatus();break;case"forwardStatus":this.forwardStatus()}},readStatus:function(){this.$router.push({path:"/commontabs/ydqk",query:{sourceId:this.initDate.sourceId}})},forwardStatus:function(){this.$router.push({path:"/commonList",query:{fileType:"zfqk",id:this.initDate.id}})},createChatGroup:function(){dsf.http.get("fn/mobileNote/getMeetingUsersByNotepaper",{pk:this.pk}).then(function(t){t=t.data;"200"==t.code&&dsf.dd.createChatGroup(t.data).catch(function(t){g.log(t)})})},Ding:function(){var t=dsf.http.get("fn/common/getFileInfo?pk=".concat(this.pk)),e=dsf.http.get("fn/mobileNote/getMeetingUsersByNotepaper?pk=".concat(this.pk));l().all([t,e]).then(function(t){var t=(0,i.Z)(t,2),e=t[0].data,t=t[1].data.data,e="您有一份标题为【".concat(e.bt,"】的文件未处理，请及时处理！");dsf.dd.Ding({users:t,type:2,alertType:2,text:e,attachment:{images:[""]},bizType:0,confInfo:{bizSubType:0,location:"会议室",remindMinutes:30,remindType:2},taskInfo:{taskRemind:30},onSuccess:function(){g.log("Ding:success")},onFail:function(){g.log("Ding:onFail")}})}).catch(function(t){g.log(t)})},handlerReplay:function(t){this.$router.push({path:"/TabCommonForm/"+this.routeKey+"/1/"+this.moduleId+"/"+this.pk+"/0/"+this.pk,query:this.$route.query})},handlerForward:function(t){this.$router.push({path:"/TabCommonForm/"+this.routeKey+"/1/"+this.moduleId+"/"+this.pk+"/"+this.pk+"/0",query:this.$route.query})},handlerAddSend:function(){this.isAddSend=!0,this.selectPerson()},addSendSelUserBack:function(t){var e=this,t=(t.forEach(function(t){t.userSchemaId="1::"+t.id}),{notePaperIds:this.pk,receiveUserIds:t.map(function(t){return t.id}).join(","),receiveUserNames:t.map(function(t){return t.name}).join(","),receiveUserSchemas:t.map(function(t){return t.userSchemaId}).join(","),moduleId:this.moduleId});dsf.http.post("fn/notepaper/batchCreate",t).then(function(t){200==t.data.code&&dsf.layer.toast("发送成功",!0,function(){e.$router.back()})})},handlerDel:function(){var e=this,t=[{pk:this.$route.params.pk,moduleId:this.$route.params.moduleId}],i={data:c()(t),moduleId:this.$route.params.moduleId};this.$dialog.confirm({title:"提示",message:"确定要删除吗？"}).then(function(){var t=dsf.config.setting["SYS-MOBILE-FORM-0017"]||"fn/recycle/logic";dsf.http.post(t,i).then(function(t){e.bandlerBack("back")})}).catch(function(){})},handlerSend:function(t){this.onSubmit(t)},handlerSave:function(t){this.isback=!0,this.onSubmit(t)},onSubmit:function(i){var t,n=this,s=dsf.layer.loading("加载中...");this.users?this.maintitle?1!=this.isShowUrgency||this.radioVal||"undefined"==this.radioVal?1!=this.isShowContent||this.textareaContent?(this.sendObj={id:this.initDate.id,noteTitle:this.maintitle,content:this.textareaContent,range:this.usersid,rangeName:this.users,rangeSchema:this.userSchema,jccd:this.radioVal,jccdText:this.radioText,isSms:this.SendStatus||"-1",isSmsText:"-1"==this.initDate.bjIsSms?"":"-1"==this.SendStatus?"否":"是",smsContent:this.smsContent,file:{attach:this.attach_1}},1<this.replyId.length&&this.$set(this.sendObj,"replyId",this.replyId),1<this.forwardIds.length&&this.$set(this.sendObj,"forwardIds",this.forwardIds),c()(this.sendObj),t={__DATA:c()(this.sendObj),moduleId:this.moduleId},dsf.http.post("save"==i?"fn/mobileNote/save":"fn/mobileNote/send",t).then(function(t){var e;t.data.result?(dsf.layer.closeLoading(s),e=n,dsf.layer.toast("send"==i?"发送成功":"保存至草稿箱",!0,function(){"save"!=i||n.isback?e.bandlerBack("back"):e.isSave=!0})):dsf.layer.toast(t.data.message)})):this.$toast.fail("请输入内容"):this.$toast.fail("请选择紧急程度"):this.$toast.fail("请输入主题"):this.$toast.fail("请选择接收人")},bandlerBack:function(t){var e=this;this.isCreatForm&&"back"!=t&&!this.isSave?this.$dialog.confirm({title:"提示",message:"填写内容还未保存，是否将内容保存为草稿"}).then(function(){e.handlerSave("save")}).catch(function(){window.dd?(window.dd.biz,e.$router.back()):window.wx&&1==e.$route.query.closePage?window.wx.closeWindow():e.$router.back()}):(this.$eventBus.refreshBadge(this,0),this.$eventBus.refresh(this),window.dd?(window.dd.biz,this.$router.back()):window.wx&&1==this.$route.query.closePage?window.wx.closeWindow():this.$router.back())},doFileRead:function(t,e){var i=this,e="/fn/mobileAttachment/upload?fileId=&moduleId="+this.moduleId+"&mid="+this.moduleId+"&pId=0&pnId=0&nodeName="+encodeURI("拟稿")+"&nrType="+e+"&pk="+this.initDate.id+"&newFileFlag=0";dsf.http.upload(e,{},t).then(function(t){t.data.data?(i.fileObj.attach.unshift(t.data.data),i.$toast.clear(),i.attach_1.unshift(t.data.data)):dsf.layer.toast(t.data.message)})},afterRead:function(t){this.$toast.loading({message:"上传中...",forbidClick:!0,duration:0,overlay:!0}),this.doFileRead(t,1)},closeFile:function(){var t;this.showFile=!1,null!=(t=this.$refs.enclosurePreview)&&t.destroyInterval()},openFile:function(t){var e,i,n=this;this.$route.params.forwardIds&&this.$route.params.forwardIds==this.$route.params.pk||(this.popFile={id:t.fileId,name:t.fileName},this.filename=t.fileName,this.fileType=t.fileName.substr(t.fileName.lastIndexOf(".")+1),(new Date).getTime(),e=dsf.util.loadSessionStore("loginToken"),dsf.url.getServerUrl("fn/file/download?infoId=".concat(this.pk,"&fileId=").concat(t.fileId,"&fileName=").concat(t.fileName,"&nrType=1&moduleId=").concat(this.moduleId,"&x-auth-token=").concat(e,"&fullfilename=").concat(t.fileName)),i="",-1<this.imgType.indexOf(this.fileType)?(i=dsf.url.getServerUrl("fn/mobileFileDownload/download?fileId=".concat(t.fileId,"&moduleId=").concat(this.moduleId,"&fileName=").concat(t.fileName)),this.imgPreview=!0,this.previewImg=[i]):(i=dsf.url.getServerUrl("fn/office/openMobileOffice?fileId=".concat(t.fileId,"&fileName=").concat(t.fileName,"&moduleId=").concat(this.moduleId,"&x-auth-token=").concat(e)),4==dsf.config.previewSetting.previewType?dsf.http.post("fn/office/mobile/wpsPreview",{fileId:t.fileId,readOnly:0<t.canEdit}).then(function(t){t=t.data;n.showFile=!0,n.fileUrl=t.data}):dsf.config.commonForm.webViewPreview?(e=dsf.url.getRootPath()+i.replace("../",""),g.log(e),xsfWindow.openWebView({title:t.fileName,url:e,colorString:"#111111"})):(this.showFile=!0,this.fileUrl=i)))},downFile:function(t){var e,i,n,s=dsf.util.loadSessionStore("loginToken"),s=dsf.url.getRootPath()+"fn/file/download?infoId=".concat(this.pk,"&fileId=").concat(t.fileId,"&fileName=").concat(t.fileName,"&nrType=1&moduleId=").concat(this.moduleId,"&x-auth-token=").concat(s,"&fullfilename=").concat(t.fileName);"app"==dsf.util.getClientName()?(e=new FileTransfer,i=encodeURI(s),n=t.showName.substr(0,t.showName.indexOf("."))+moment(new Date).format("YYYYMMDDHHss")+t.showName.substr(t.showName.indexOf(".")),t=cordova.file.externalRootDirectory+"/Download/item/"+n,e.download(i,t,function(t){dsf.layer.alert({message:"文件已下载到 /Download/item/"+n})},function(t){g.log("download error source "+t.source),g.log("download error target "+t.target),g.log("upload error code"+t.code)},!1,{headers:{Authorization:"Basic dGVzdHVzZXJuYW1lOnRlc3RwYXNzd29yZA=="}})):window.open(s)},removeFile:function(i,n){var s=this;dsf.layer.confirm({message:"是否确认删除",confirmButtonText:"确认"},function(){var e=s,t=(s.$toast.loading({message:"删除中...",forbidClick:!0,duration:0,overlay:!0}),{pk:s.$route.params.pk,fileId:i.fileId,moduleId:s.moduleId,mid:s.moduleId,nrType:1,fileName:i.fileName});dsf.http.post("/fn/mobileFileUpload/delete",t).then(function(t){e.$toast.clear(),e.attach_1.splice(n,1)})})},handleActionClick:function(){},getRadioVal:function(t){this.radioText=t.codeName},selectPerson:function(){this.isAddSend||2==this.TabIndex||this.isCreatForm||this.forwardIds||this.replyId?this.showPerson=!0:(this.showPerson=!1,this.replyId?this.showPerson=!1:this.forwardIds&&(this.showPerson=!0))},cancePerson:function(){this.showPerson=!1},getSelectUser:function(t){this.isAddSend?(this.addSendSelUserBack(t),this.isAddSend=!1):(this.personDate=t,this.selectUsersName=t.map(function(t){return t.name}),this.users=t.map(function(t){return t.name}).join(","),this.usersid=t.map(function(t){return t.id}).join(","),t.forEach(function(t){t.userSchemaId=t.type+"::"+t.id}),this.userSchema=t.map(function(t){return t.userSchemaId}).join(",")),this.cancePerson()},getTextValue:function(t){this.textareaContent=t},getIconClass:function(t){var e,i=t.lastIndexOf("."),n=-1<i?t.substring(i+1,t.length).toLowerCase():"";if(-1<this.hasFilePng.indexOf(n))return s(83887)("./".concat(n,".png"));for(e in this.fileTypes)if(-1<this.fileTypes[e].indexOf(n))return s(83887)("./".concat(e,".png"));return s(26206)},getTaskDetailAndInitPersonAndTitle:function(){var s=this;dsf.http.get("/fn/xform/getInfo?moduleId=230103192045EncoYZoaQ9Zee0afJmh&pk=".concat(this.$route.query.formPk,"&listId=230105153446TgUC3NjwR3polqywEQp&validateByList=1&method=privilege&timer=")+(new Date).getTime()).then(function(t){var e,i,n;g.log(t),t.data.data&&(e=t.data.data,t.data.struct,t=e.main,g.log(t),t["C-TASKMAN-TASK-0001"]&&t["C-TASKMAN-TASK-0002"]&&(n=i=e="",n=t["C-TASKMAN-TASK-0002"].value.includes(t["C-TASKMAN-TASK-0001"].value)?(e=t["C-TASKMAN-TASK-0002"].text,i=t["C-TASKMAN-TASK-0002"].value,t["C-TASKMAN-TASK-0002"].schema):(e=t["C-TASKMAN-TASK-0001"].text+","+t["C-TASKMAN-TASK-0002"].text,i=t["C-TASKMAN-TASK-0001"].value+","+t["C-TASKMAN-TASK-0002"].value,t["C-TASKMAN-TASK-0001"].schema+","+t["C-TASKMAN-TASK-0002"].schema),s.selectUsersName=e.split(","),s.users=e,s.usersid=i,s.userSchema=n),s.maintitle=t["C-TASKMAN-TASK-0006"].value)})}}},v=(0,s(51900).Z)(f,function(){var n=this,s=n._self._c;return s("div",{staticClass:"tabForm bianjianbox"},[s("van-form",{staticClass:"form",on:{click:n.onSubmit}},[s("van-cell-group",[s("van-field",{attrs:{label:"主题".concat(n.hf,"："),readonly:n.isdisabled||n.titledisabled,"label-width":"1.6rem",rows:"1",autosize:"",type:"textarea",placeholder:"请输入"},model:{value:n.maintitle,callback:function(t){n.maintitle=t},expression:"maintitle"}}),n._v(" "),n.isCreatForm||0!=n.TabIndex?n._e():s("van-field",{attrs:{label:"发送人：","label-width":"1.6rem",rows:"1",autosize:"",type:"textarea",placeholder:"",readonly:""},model:{value:n.initDate.sendUserName,callback:function(t){n.$set(n.initDate,"sendUserName",t)},expression:"initDate.sendUserName"}}),n._v(" "),n.isCreatForm||0!=n.TabIndex?n._e():s("van-field",{attrs:{label:"发送时间：","label-width":"1.6rem",rows:"1",autosize:"",type:"textarea",placeholder:"",readonly:""},model:{value:n.initDate.sendTime,callback:function(t){n.$set(n.initDate,"sendTime",t)},expression:"initDate.sendTime"}}),n._v(" "),s("van-field",{attrs:{label:"收件人：","label-width":"1.6rem","right-icon":"contact"},on:{"click-right-icon":n.selectPerson},scopedSlots:n._u([{key:"input",fn:function(){return[s("div",{staticClass:"selectUser"},[n.userSchema.length?n._l(n.selectUsersName,function(e,i){return e?s("span",{key:i},[n._v(n._s(e)+"\n\t\t\t\t\t\t\t\t\t"),n.isdisabled?n._e():s("van-icon",{attrs:{name:"cross",size:"0.28rem",color:"red"},on:{click:function(t){return n.delUser(e,i)}}})],1):n._e()}):s("div",{staticStyle:{color:"#cdcdcd"}},[n._v("请选择")])],2)]},proxy:!0}])}),n._v(" "),1==n.isShowUrgency?s("van-field",{attrs:{label:"紧急程度：",name:"radio","label-width":"1.6rem",center:""},scopedSlots:n._u([{key:"input",fn:function(){return[n.isdisabled&&n.tures?s("span",[n._v(n._s(n.initDate.jjcdText))]):s("van-radio-group",{attrs:{direction:"horizontal"},model:{value:n.radioVal,callback:function(t){n.radioVal=t},expression:"radioVal"}},n._l(n.initDate.jjcdDataList,function(e,t){return s("van-radio",{key:t,staticClass:"radioItem",attrs:{disabled:n.isdisabled&&n.tures,name:e.codeValue,checked:"true"},on:{click:function(t){return n.getRadioVal(e)}}},[n._v(n._s(e.codeName)+"\n\t\t\t\t\t\t\t")])}),1)]},proxy:!0}],null,!1,1015285338)}):n._e(),n._v(" "),n.isShowContent?s("div",{staticClass:"edit"},[s("div",{staticStyle:{padding:"0.32rem 0"}},[n._v("内容：")]),n._v(" "),s("div",[!n.textareaTextVal&&!n.isCreatForm||n.isdisabled?s("div",{staticClass:"bandhtml"},[s("div",{domProps:{innerHTML:n._s(n.textareaTextVal)}})]):s("textare-edit",{attrs:{"textarea-text-val":n.textareaTextVal},on:{textareaText:n.getTextValue}})],1)]):n._e(),n._v(" "),s("div",{staticClass:"flex jb",staticStyle:{padding:"0.32rem"}},[s("span",[n._v("附件：")]),n._v(" "),n.isdisabled?n._e():s("van-uploader",{staticClass:"upload-btn",attrs:{"after-read":n.afterRead,accept:n.accept,"result-type":"file"}},[s("i",{staticClass:"iconfont iconattachment",staticStyle:{display:"inline-block",transform:"rotate(-45deg)","font-size":"var(--font_size_0)"}})])],1),n._v(" "),n._l(n.attach_1,function(e,i){return s("div",{key:i,staticClass:"fileList"},[s("div",{staticClass:"file"},[n.dsf.config.commonForm.enclosureStyle&&"complex"!=n.dsf.config.commonForm.enclosureStyle?n._e():s("div",{staticClass:"fileIcon",on:{click:function(t){return n.openFile(e)}}},[s("img",{attrs:{src:n.getIconClass(e.fileName),alt:""}})]),n._v(" "),s("div",{staticClass:"fileBody",on:{click:function(t){return n.openFile(e)}}},[s("div",{staticClass:"fileTitle",class:{ellipsis:"noIcon"!=n.dsf.config.commonForm.enclosureStyle},style:{width:"90%"}},["simple"==n.dsf.config.commonForm.enclosureStyle?s("img",{staticStyle:{width:"0.3rem",display:"inline-block","vertical-align":"sub"},attrs:{src:n.getIconClass(e.fileName),alt:""}}):n._e(),n._v("\n\t\t\t\t\t\t\t\t"+n._s(e.fileName)+"\n\t\t\t\t\t\t\t")]),n._v(" "),n.dsf.config.commonForm.enclosureStyle&&"simple"==n.dsf.config.commonForm.enclosureStyle?n._e():s("div",{staticClass:"fileSize"},[s("span",[n._v(n._s(e.showFileSize||"默认尺寸"))])])]),n._v(" "),s("div",{staticClass:"fileBtn"},[!n.isCreatForm&&n.isShowDownBtn?s("div",{staticClass:"fileButton",on:{click:function(t){return t.stopPropagation(),n.downFile(e)}}},[n._v("\n\t\t\t\t\t\t\t\t下载\n\t\t\t\t\t\t\t")]):n._e(),n._v(" "),n.isdisabled?n._e():s("div",{staticClass:"fileButton",on:{click:function(t){return t.stopPropagation(),n.removeFile(e,i)}}},[n._v("\n\t\t\t\t\t\t\t\t删除\n\t\t\t\t\t\t\t")])])])])}),n._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==n.isShowSmsSend,expression:"isShowSmsSend == 1"}],staticClass:"van-field van-cell"},[s("div",{staticClass:"van-cell__title van-field__label"},[s("span",[n._v("发送短信")])]),n._v(" "),s("div",[s("van-radio-group",{attrs:{disabled:n.isdisabled,direction:"horizontal"},model:{value:n.SendStatus,callback:function(t){n.SendStatus=t},expression:"SendStatus"}},[s("van-radio",{attrs:{name:"-1"}},[n._v("否")]),n._v(" "),s("van-radio",{attrs:{name:"1"}},[n._v("是")])],1)],1)]),n._v(" "),1==n.SendStatus&&1==n.isShowSmsSend?s("van-field",{attrs:{rows:"3",autosize:"",type:"textarea",placeholder:"请输入内容"},scopedSlots:n._u([{key:"label",fn:function(){return[s("span",[n._v("短信内容")])]},proxy:!0}],null,!1,271749360),model:{value:n.smsContent,callback:function(t){n.smsContent=t},expression:"smsContent"}}):n._e(),n._v(" "),2==n.TabIndex||n.isCreatForm||n.forwardIds||n.replyId||1!=n.isShowHistoryMsg?n._e():s("div",{staticClass:"historyBox"},[s("van-divider",{staticClass:"fgx",attrs:{dashed:""}},[n._v("往来"+n._s(n.title))]),n._v(" "),n._l(n.historyMsg,function(t,e){return s("div",{key:e,staticClass:"historyItem"},[s("div",{staticClass:"line"},[s("span",[n._v("发件人："+n._s(t.sendUserName))])]),n._v(" "),s("div",{staticClass:"line"},[s("span",[n._v("发送时间："+n._s(t.sendTime))])]),n._v(" "),s("div",{staticClass:"line"},[s("span",[n._v("主题："+n._s(t.bt))])]),n._v(" "),s("div",{staticClass:"line"},[s("span",[n._v("内容："),s("span",{domProps:{innerHTML:n._s(t.content)}})])]),n._v(" "),t.attachInfos&&0<t.attachInfos.length?s("div",{staticClass:"line"},[s("span",[n._v("附件："),n._l(t.attachInfos,function(e,t){return s("span",{key:t,on:{click:function(t){return n.openFile(e)}}},[n._v(n._s(e.showName))])})],2)]):n._e()])})],2)],2)],1),n._v(" "),s("div",{staticStyle:{height:"1.2rem"}},[s("div",{staticClass:"footer"},[s("DsfButtonToolbox",{attrs:{more:!0,"is-form-btn":!0,buttons:n.buttons,size:"small"},on:{mainClick:n.handlerBtn,commonClick:n.handlerBtn}})],1)]),n._v(" "),s("van-image-preview",{attrs:{images:n.previewImg,closeable:""},model:{value:n.imgPreview,callback:function(t){n.imgPreview=t},expression:"imgPreview"}}),n._v(" "),s("van-popup",{style:{height:"100%"},attrs:{"close-on-click-overlay":!0,"get-container":"#app","lock-scroll":"",position:"bottom"},model:{value:n.showPerson,callback:function(t){n.showPerson=t},expression:"showPerson"}},[s("control-user-list",{attrs:{extra:n.extra},on:{getSelectUser:n.getSelectUser,close:n.cancePerson}})],1),n._v(" "),s("van-popup",{staticClass:"file-preview",staticStyle:{height:"100vh"},attrs:{"close-on-click-overlay":!0,"lock-scroll":"",position:"bottom"},model:{value:n.showFile,callback:function(t){n.showFile=t},expression:"showFile"}},[s("van-nav-bar",{attrs:{title:n.filename,"left-text":"返回","left-arrow":"",fixed:"",placeholder:""},on:{"click-left":n.closeFile}}),n._v(" "),n.dsf.config.commonForm.LocalDocPreview?s("enclosure-preview",{ref:"enclosurePreview",attrs:{file:n.popFile,"form-info":n.fileData}}):s("file",{style:{height:"calc(100vh - ".concat(n.dsf.util.getOffsetTop("0.92rem"),")")},attrs:{"file-url":n.fileUrl}})],1)],1)},[],!1,null,"3187d325",null).exports},87929:function(t,e,i){"use strict";i.d(e,{Z:function(){return s}});var n=i(25108);i.e(90006).then(i.bind(i,90006));var e={components:{quillEditor:function(){return Promise.all([i.e(76095),i.e(91629)]).then(i.t.bind(i,91629,23)).then(function(t){return t.quillEditor})}},props:["textareaTextVal","isdisabled"],data:function(){return{editorOption:{placeholder:"请输入编辑内容",modules:{toolbar:dsf.config.commonForm.editorToolbar||[["bold","italic","underline"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}],["clean"]],syntax:{highlight:function(t){return hljs.highlightAuto(t).value}}}},content:this.textareaTextVal}},created:function(){this.$nextTick(function(){this.$refs.myQuillEditor.quill.blur()})},methods:{save:function(){n.log("content",this.content)},onEditorFocus:function(t){this.isdisabled&&t.enable(!1)},onEditorBlur:function(){},onEditorChange:function(){this.$emit("textareaText",this.content)}}},s=(0,i(51900).Z)(e,function(){var e=this,t=e._self._c;return t("div",[t("quill-editor",{ref:"myQuillEditor",attrs:{options:e.editorOption},on:{focus:function(t){return e.onEditorFocus(t)},blur:function(t){return e.onEditorBlur(t)},change:function(t){return e.onEditorChange(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)},[],!1,null,null,null).exports},83887:function(t,e,i){var n={"./ai.png":44936,"./cloud.png":54073,"./doc.png":39636,"./docx.png":70071,"./folder-team.png":36556,"./folder.png":7818,"./html.png":97744,"./img.png":32954,"./jpeg.png":90699,"./jpg.png":84693,"./mp3.png":77957,"./mp4.png":96128,"./ofd.png":88825,"./pdf.png":46616,"./png.png":95742,"./ppt.png":68985,"./psd.png":89041,"./rar.png":45074,"./txt.png":48339,"./word.png":26206,"./wps.png":83392,"./xls.png":49472,"./xlsx.png":81682,"./xml.png":66874,"./zip.png":99021};function s(t){t=o(t);return i(t)}function o(t){if(i.o(n,t))return n[t];throw(t=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",t}s.keys=function(){return Object.keys(n)},s.resolve=o,(t.exports=s).id=83887},44936:function(t,e,i){"use strict";t.exports=i.p+"static/img/ai.692fadd..png"},54073:function(t,e,i){"use strict";t.exports=i.p+"static/img/cloud.e0e5c0c..png"},39636:function(t,e,i){"use strict";t.exports=i.p+"static/img/doc.178d734..png"},70071:function(t,e,i){"use strict";t.exports=i.p+"static/img/docx.178d734..png"},36556:function(t,e,i){"use strict";t.exports=i.p+"static/img/folder-team.256a132..png"},7818:function(t,e,i){"use strict";t.exports=i.p+"static/img/folder.b74dd1f..png"},97744:function(t,e,i){"use strict";t.exports=i.p+"static/img/html.aed4382..png"},32954:function(t,e,i){"use strict";t.exports=i.p+"static/img/img.1e66416..png"},90699:function(t,e,i){"use strict";t.exports=i.p+"static/img/jpeg.6690b6f..png"},84693:function(t,e,i){"use strict";t.exports=i.p+"static/img/jpg.6690b6f..png"},77957:function(t,e,i){"use strict";t.exports=i.p+"static/img/mp3.11779e9..png"},96128:function(t,e,i){"use strict";t.exports=i.p+"static/img/mp4.bf3626d..png"},88825:function(t,e,i){"use strict";t.exports=i.p+"static/img/ofd.aa35dda..png"},46616:function(t,e,i){"use strict";t.exports=i.p+"static/img/pdf.0431c10..png"},95742:function(t,e,i){"use strict";t.exports=i.p+"static/img/png.99cbe3b..png"},68985:function(t,e,i){"use strict";t.exports=i.p+"static/img/ppt.2dcd0da..png"},89041:function(t,e,i){"use strict";t.exports=i.p+"static/img/psd.10d45f5..png"},45074:function(t,e,i){"use strict";t.exports=i.p+"static/img/rar.5ca3e88..png"},48339:function(t,e,i){"use strict";t.exports=i.p+"static/img/txt.9b1d964..png"},26206:function(t,e,i){"use strict";t.exports=i.p+"static/img/word.178d734..png"},83392:function(t,e,i){"use strict";t.exports=i.p+"static/img/wps.d841695..png"},49472:function(t,e,i){"use strict";t.exports=i.p+"static/img/xls.e136da2..png"},81682:function(t,e,i){"use strict";t.exports=i.p+"static/img/xlsx.e136da2..png"},66874:function(t,e,i){"use strict";t.exports=i.p+"static/img/xml.aed4382..png"},99021:function(t,e,i){"use strict";t.exports=i.p+"static/img/zip.4b7a304..png"},79156:function(t,e,i){"use strict";i.d(e,{Z:function(){return s}});var n=i(78149);function s(t){if(n(t))return t}},8167:function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i.d(e,{Z:function(){return n}})},31314:function(t,e,i){"use strict";i.d(e,{Z:function(){return a}});var s=i(26771),o=i(44660);function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),s(t,(0,o.Z)(n.key),n)}}function a(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),s(t,"prototype",{writable:!1}),t}},26511:function(t,e,i){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}i.d(e,{Z:function(){return n}})},522:function(t,e,i){"use strict";i.d(e,{Z:function(){return a}});var n=i(79156),d=i(85579),u=i(22013);var s=i(33422),o=i(26511);function a(t,e){return(0,n.Z)(t)||function(t,e){var i=null==t?null:void 0!==d&&t[u]||t["@@iterator"];if(null!=i){var n,s,o,a,r=[],l=!0,c=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(r.push(n.value),r.length!==e);l=!0);}catch(t){c=!0,s=t}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(c)throw s}}return r}}(t,e)||(0,s.Z)(t,e)||(0,o.Z)()}}}]);