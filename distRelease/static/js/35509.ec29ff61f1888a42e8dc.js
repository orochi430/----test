"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[35509],{35509:function(t,e,n){n.r(e),n.d(e,{default:function(){return s}});var a=n(25108);moment.locale("zh-cn");var e={name:"SDYCMeeting",components:{},data:function(){return{id:this.$route.params.id,showId:this.$route.query.showId,show:!1,data:[],currentIndex:0,curItem:{},second:5,timer:null,meeting:dsf.util.loadSessionStore("meeting")}},computed:{},watch:{},methods:{goBack:function(){this.$router.go(-1)},formatDate:function(t,e){return t=new Date(t.replace(/-/g,"/")),dsf.date.format(t,e)},compareDate:function(t,e){t=t.replace(/-/g,"/"),e=e.replace(/-/g,"/");t=moment(new Date(t));return moment(new Date(e)).diff(t,"hour",!0)+"小时"},showMySeat:function(){var t=this,e="../seatDesign/index.html#/mobileView/hw/".concat(this.curItem.seatId,"/").concat(this.curItem.userid);this.$router.push({name:"dsfIframe",params:{url:e,title:"我的位置"}}),t.meeting.myMeetingIdx=t.currentIndex,dsf.util.saveToSessionStore("meeting",t.meeting)},scanSuccess:function(){var t=this;this.second=5,this.show=!0,this.timer=setInterval(function(){t.second--,t.second<=0&&(clearInterval(t.timer),t.show=!1)},1e3),this.curItem.isSign=1,this.$set(this.data[this.currentIndex],"isSign",1),this.$set(this.data[this.currentIndex],"signTimeText","已签到")},doSign:function(t){var e=this;dsf.http.post("/fn/sdycMeeting/doSign",{scheduleId:t}).done(function(t){a.log(t),"success"==t.type?e.scanSuccess():dsf.layer.toast(t.message)}).error(function(t){a.log("doSign-error",t),dsf.layer.toast("签到失败！")})},isCanScan:function(){this.curItem.sign_start_time=this.curItem.sign_start_time.replace(/-/g,"/");var t=new Date(this.curItem.sign_start_time).getTime(),e=(new Date).getTime(),s=new Date(this.curItem.sign_end_time).getTime();return!(e<t||s<e)},scanQrcode:function(){var e=this,t=new Date(this.curItem.sign_start_time).getTime(),s=(new Date).getTime(),i=new Date(this.curItem.sign_end_time).getTime();s<t||i<s?dsf.layer.toast("未在签到时间段，无法签到"):"app"==dsf.util.getClientName()?xsfBarcode.scan(function(t){a.log(t),t.text&&e.doSign(t.text)},function(t){dsf.layer.toast("扫码失败")}):dsf.layer.toast("需在app中进行扫码")},closePopup:function(){clearInterval(this.timer),this.show=!1},changeItem:function(t){this.currentIndex=t,this.curItem=this.data[t];var t=new Date(this.curItem.sign_start_time).getTime(),e=(new Date).getTime(),s=new Date(this.curItem.sign_end_time).getTime();e<t||s<e?(this.curItem.signTime=!1,this.$set(this.data[this.currentIndex],"signTime",!1)):(this.curItem.signTime=!0,this.$set(this.data[this.currentIndex],"signTime",!0)),this.curItem.signTimeText="",e<t&&(this.curItem.signTimeText="未开启签到",this.$set(this.data[this.currentIndex],"signTimeText","未开启签到")),s<e&&1!=this.curItem.isSign&&(this.curItem.signTimeText="未签到",this.$set(this.data[this.currentIndex],"signTimeText","未签到")),1==this.curItem.isSign&&(this.curItem.signTimeText="已签到",this.$set(this.data[this.currentIndex],"signTimeText","已签到"))},loadData:function(){dsf.util.loadSessionStore("user");var s=this;this.data=[],this.$toast.loading("加载中"),dsf.http.post("/fn/sdycMeeting/myMeeting",{meetingId:this.id}).done(function(t){var e;s.$toast.clear(),"success"==t.type&&(t.data.forEach(function(t){t.sign_start_time=t.sign_start_time.replace(/-/g,"/"),t.sign_end_time=t.sign_end_time.replace(/-/g,"/"),t.start_time=t.start_time.replace(/-/g,"/"),t.end_time=t.end_time.replace(/-/g,"/");var e=new Date(t.sign_start_time).getTime(),s=(new Date).getTime(),i=new Date(t.sign_end_time).getTime();t.signTime=!(s<e||i<s),t.signTimeText="",s<e&&(t.signTimeText="未开启签到"),i<s&&1!=t.isSign&&(t.signTimeText="未签到"),1==t.isSign&&(t.signTimeText="已签到")}),s.data=t.data,s.showId?(e=s.data.findIndex(function(t){return t.id==s.showId}))<0&&(e=0):-1<s.meeting.myMeetingIdx?e=s.meeting.myMeetingIdx:(e=s.data.findIndex(function(t){return 0==t.passDate}))<0&&(e=0),s.currentIndex=e,s.curItem=s.data[e],s.$nextTick(function(){var t=document.getElementById("tab-".concat(s.currentIndex));t&&t.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})}),s.meeting.myMeetingIdx=-1,dsf.util.saveToSessionStore("meeting",s.meeting),a.log(t))})}},created:function(){this.loadData()},mounted:function(){},destroyed:function(){},activated:function(){a.log("meeting-activated")}},s=(0,n(51900).Z)(e,function(){var s=this,i=s._self._c;return i("div",{staticClass:"meeting"},[0<s.data.length?i("div",{staticClass:"content"},[i("div",{staticClass:"schedules"},s._l(s.data,function(t,e){return i("div",{key:e,class:{active:s.currentIndex==e,over:t.passDate},attrs:{id:"tab-".concat(e)},on:{click:function(t){return s.changeItem(e)}}},[i("span",[s._v(s._s(s.formatDate(t.start_time,"mm/dd")))]),s._v(" "),i("p",[s._v(s._s(s.formatDate(t.start_time,"hh:ii")))])])}),0),s._v(" "),s.curItem.id?i("div",{staticClass:"meet"},[i("div",{staticClass:"meet_title"},[s._v(s._s(s.curItem.title))]),s._v(" "),i("div",{staticClass:"meet_time"},[s._v("\n                "+s._s(s.formatDate(s.curItem.start_time,"yyyy年mm月dd日 DD"))+"\n            ")]),s._v(" "),i("div",{staticClass:"meet_info"},[i("div",{staticClass:"meet_hour"},[i("div",{class:["meet_start",{over:s.curItem.passDate}]},[i("span",[s._v(s._s(s.formatDate(s.curItem.start_time,"hh:ii")))]),s._v(" "),i("p",[s._v("开始时间")])]),s._v(" "),i("div",{staticClass:"meet_yuji"},[i("p",{staticClass:"line"}),s._v(" "),i("span",[s._v("预计"+s._s(s.compareDate(s.curItem.start_time,s.curItem.end_time)))])]),s._v(" "),i("div",{class:["meet_start",{over:s.curItem.passDate}]},[i("span",[s._v(s._s(s.formatDate(s.curItem.end_time,"hh:ii")))]),s._v(" "),i("p",[s._v("结束时间")])])]),s._v(" "),i("div",{staticClass:"meet_mgs"},[i("div",{staticClass:"inputs"},[i("span",[s._v("会议地点")]),s._v(" "),i("p",[s._v(s._s(s.curItem.address))])]),s._v(" "),i("div",{staticClass:"inputs"},[i("span",[s._v("主持人")]),s._v(" "),i("p",[s._v(s._s(s.curItem.compere))])]),s._v(" "),s.curItem.seat_row?i("div",{class:["inputs1",{over:s.curItem.passDate}]},[i("span",{staticClass:"left"},[s._v("位置")]),s._v(" "),i("p",[s._v(s._s(s.curItem.seat_row)+"排"+s._s(s.curItem.seat_col)+"座")]),s._v(" "),i("span",{staticClass:"right",on:{click:function(t){return s.showMySeat()}}},[s._v("查看座次")])]):s._e(),s._v(" "),1==s.curItem.needSign?i("div",{class:["inputs2",{over:s.curItem.passDate}]},[i("span",{staticClass:"left"},[s._v("签到情况")]),s._v(" "),1==s.curItem.isSign?i("p",[s._v("已签到")]):s._e(),s._v(" "),1!=s.curItem.isSign?i("p",[s._v(s._s(s.curItem.signTimeText))]):s._e(),s._v(" "),s.curItem.signTime&&1!=s.curItem.isSign?i("div",{staticClass:"sign"},[s.curItem.signType.includes("2")?i("p",{on:{click:s.scanQrcode}},[i("span",[s._v("扫码签到")]),s._v(" "),i("van-image",{attrs:{src:n(56519)}})],1):s._e(),s._v(" "),s.curItem.signType.includes("1")?i("span",{staticClass:"right",on:{click:function(t){return s.doSign(s.curItem.id)}}},[s._v("签到")]):s._e()]):s._e()]):s._e()])]),s._v(" "),s.curItem.remind?i("div",{staticClass:"wxts"},[i("img",{attrs:{src:n(62773),alt:"",srcset:""}}),s._v(" "),i("span",[s._v(s._s(s.curItem.remind))])]):s._e(),s._v(" "),s._m(0),s._v(" "),i("div",{staticClass:"jieshao",domProps:{innerHTML:s._s(s.curItem.content)}})]):s._e()]):s._e(),s._v(" "),i("van-popup",{model:{value:s.show,callback:function(t){s.show=t},expression:"show"}},[i("div",{staticClass:"poups"},[i("div",{staticClass:"success"},[s._v("签到成功")]),s._v(" "),i("div",{staticClass:"iknow",on:{click:s.closePopup}},[s._v("我知道了")]),s._v(" "),i("span",{staticClass:"tips"},[s._v(s._s(s.second)+"s后自动关闭弹窗")])])]),s._v(" "),0==s.data.length?i("div",{staticClass:"nodata"},[i("img",{attrs:{src:n(32322),alt:"",srcset:""}}),s._v(" "),i("span",[s._v("暂无数据")])]):s._e()],1)},[function(){var t=this._self._c;return t("div",{staticClass:"yicheng"},[t("span",[this._v("会议议程")])])}],!1,null,"5ae10f52",null).exports},32322:function(t,e,s){t.exports=s.p+"static/img/wait.a522949..png"},56519:function(t,e,s){t.exports=s.p+"static/img/saoma.9ca84ef..svg"},62773:function(t,e,s){t.exports=s.p+"static/img/tips.0e5b368..png"}}]);