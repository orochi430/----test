"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[55892],{30819:function(e,t,s){s.d(t,{Z:function(){return d}});var t=s(26243),a=s.n(t),t=s(62680),o=s.n(t),t=s(95366),i=s.n(t),t=s(6919),n=s.n(t),r=s(77193),t=s(73473),c=s.n(t);function l(t,e){var s,n=a()(t);return o()&&(s=o()(t),e&&(s=s.filter(function(e){return i()(t,e).enumerable})),n.push.apply(n,s)),n}var t={name:"WorkFlowDialog",props:{formData:{type:Object,default:function(){return{}}},metaData:{type:Object,default:function(){return{}}}},data:function(){return{text:"退回",message:"",showDialog:!1,submitAfter:function(){},h:0,isNeedWrite:dsf.config.setting["SYS-FLOW-0038"]||0,personSelectData:[],secPeo:!1,columns:[],SendRequest:{}}},created:function(){},mounted:function(){},computed:{isShowUser:function(){return 1<this.columns.length||dsf.config.commonFlow.onePersonBackIsShow}},methods:{cancel:function(){this.showDialog=!1,this.h=0,this.$emit("close")},sendBack:function(){var t=this,e={pid:this.formData.pid||this.formData.pId,pnid:this.formData.pnid||this.formData.pnId,wfId:this.formData.flowId,backReason:this.message},s=dsf.layer.loading(this.text+"中");dsf.http.post("/fn/mobileFlow/sendBack",e).then(function(e){dsf.layer.closeLoading(s),t.dsf.layer.toast(t.text+"成功",!0),t.cancel(),setTimeout(function(){t.$emit("change")},100)})},sendBackNew:function(){var t,e,s=this,n=!0;s.metaData.buttons.mainButtons.some(function(e){"NoopinionBack"==e.action&&(n=!1)}),""==s.message.trim()&&1==s.isNeedWrite&&1==n?dsf.layer.toast("请输入退回原因"):s.personSelectData.length<1&&s.isShowUser?dsf.layer.toast("请选择退回人员"):(t=dsf.layer.loading(s.text+"中"),e={TPID:s.SendRequest.tpid,CurLinkID:s.personSelectData[0].LinkID,WFID:s.SendRequest.wfid,backType:1,Remark:s.message,inherit:"",MultSendBackMod:s.SendRequest.multSendBackMod,IsMergeTodo:s.SendRequest.isMergeTodo,NGR:0,SendBackTo:s.SendRequest.sendBackTo},dsf.http.post("/fn/flow/submitSendBackNode",e).then(function(e){dsf.layer.closeLoading(t),s.dsf.layer.toast(s.text+"成功",!0),s.cancel(),setTimeout(function(){s.$emit("change")},100)}))},show:function(e){var s=this,e=e.text,t=(this.personSelectData=[],{pId:this.metaData.parameters?this.metaData.parameters.pId:this.formData.pid||this.formData.pId,flowId:(this.metaData.parameters||this.formData).flowId,pk:this.metaData.parameters?this.metaData.parameters.pk:this.formData.info_d||this.formData.info_id,pnId:this.metaData.parameters?this.metaData.parameters.pnId:this.formData.pnid||this.formData.pnId});return dsf.http.get("fn/flow/getGPNodeProcess",t).then(function(e){var t,e=e.data;"200"==e.code&&(t=[],s.SendRequest=e.data.SendRequest,e.data.processArray.forEach(function(e){t.push(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach(function(e){(0,r.Z)(t,e,s[e])}):n()?Object.defineProperties(t,n()(s)):l(Object(s)).forEach(function(e){Object.defineProperty(t,e,i()(s,e))})}return t}({text:e.Sender.UserName+"(".concat(e.PARENT_NODENAME,")")},e))}),s.columns=t,1==s.columns.length&&(s.personSelectData=t),s.initHeight())}),this.text=e||"",this.message="退回"==e&&dsf.config.setting["SYS-MOBILE-FORM-0005"]||"",this.showDialog=!0,new(c())(function(e){s.submitAfter=e})},initHeight:function(){var e=this;this.$nextTick(function(){e.isShowUser?e.h=e.$refs.content.offsetHeight-270:e.h=e.$refs.content.offsetHeight-160})},close:function(){this.showDialog=!1,this.h=0},showPersonModel:function(){this.secPeo=!this.secPeo},onConfirm:function(e){this.personSelectData=[],this.personSelectData.push(e),this.showPersonModel()},closePerson:function(e,t){this.personSelectData.splice(t,1)},submitFun:function(){this.submitAfter(),this.text,this.sendBackNew()}}},d=(0,s(51900).Z)(t,function(){var n=this,e=n._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:n.showDialog,expression:"showDialog"}],staticClass:"ds-workflow_dialog"},[e("div",{staticClass:"header"},[e("van-nav-bar",{attrs:{title:n.text+"理由","left-text":"取消"},on:{"click-left":function(e){return n.cancel()}}})],1),n._v(" "),e("div",{ref:"content",staticClass:"content"},[n.isShowUser?e("div",{ref:"user",staticClass:"sheetBox"},[e("p",{staticClass:"reasonLabel"},[n._v("退回人员")]),n._v(" "),e("div",{staticClass:"disfr ac",staticStyle:{padding:"10px 0"}},[e("div",{staticClass:"peopleSec disfr ac flex1"},[n._l(n.personSelectData,function(t,s){return e("van-tag",{key:s,attrs:{closeable:"",size:"large",type:"primary"},on:{close:function(e){return n.closePerson(t,s)}}},[n._v("\n            "+n._s(t.text)+"\n          ")])}),n._v("\n            \n        ")],2),n._v(" "),e("van-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"default"},on:{click:n.showPersonModel}},[n._v("选择人员")])],1),n._v(" "),e("p",{staticClass:"reasonLabel",staticStyle:{"margin-bottom":"0.2rem"}},[n._v("退回原因")])]):n._e(),n._v(" "),e("van-field",{ref:"reason",staticClass:"reason",attrs:{rows:"5",type:"textarea",placeholder:"请输入"+n.text+"理由",border:""},model:{value:n.message,callback:function(e){n.message=e},expression:"message"}})],1),n._v(" "),e("div",{staticClass:"footer"},[e("van-button",{attrs:{type:"theme",block:""},on:{click:n.submitFun}},[n._v("确认"+n._s(n.text))])],1),n._v(" "),e("van-popup",{style:{height:"50vh"},attrs:{position:"bottom",round:""},model:{value:n.secPeo,callback:function(e){n.secPeo=e},expression:"secPeo"}},[e("div",{staticStyle:{width:"100%"}},[e("van-picker",{attrs:{title:"请选择退回人员","show-toolbar":"",columns:n.columns},on:{confirm:n.onConfirm,cancel:n.showPersonModel}})],1)])],1)},[],!1,null,"447cfcb4",null).exports},18412:function(e,t,s){s.r(t),s.d(t,{default:function(){return a}});var t=s(52974),n=s(74085),t={name:"Home",components:{Squmenu:t.Z,TodoCenter:n.Z},created:function(){},activated:function(){},methods:{},deactivated:function(){"commonForm"!=this.$route.name&&this.$deleteCache(this)}},a=(0,s(51900).Z)(t,function(){var e=this._self._c;return e("div",{staticClass:"ds-home"},[e("div",{staticClass:"menuBox"},[e("div",{staticClass:"sudokus"},[e("Squmenu")],1)]),this._v(" "),e("div",{staticClass:"agency"},[e("TodoCenter")],1)])},[],!1,null,"3fea3451",null).exports},46385:function(e,t,s){s.r(t),s.d(t,{default:function(){return r}});var n=s(66250),t=s(73473),c=s.n(t),t=s(8450),i=s.n(t),t=s(33453),l=s.n(t),t=s(70680),a=s(18868),o=s(63450),d=s(25108),t={name:"SeparateRead",components:{controlUserTree:t.default,DebounceClick:a.Z,controlUserList:o.default},props:{separateTabs:{type:Array,default:function(){return[]}},formParams:{type:Object,default:function(){return{}}},nowButtonParameters:{type:Object,default:function(){return{}}}},data:function(){return{result:[],resolve:function(){},reject:function(){},isShow1:!1,isShow2:!1,opinionList:[],message:"",optionValue:"",nowList:[],showList1:[],organizeList:[],userList:[],privateData:[],data:{},selectList:[],personSelectData:"",oldV:[],selectArr:[],selectParent:[],selectChild:[],type:0,extra:{multiple:!0,filterSelf:"-1"==dsf.config.setting["SYS-FY-0012"],tabs:[]},tab:"",defaultSelectArray:[],smsContent:""}},created:function(){var s=this;return(0,n.Z)(l().mark(function e(){var t;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getTabs();case 2:t=dsf.config.setting["SYS-FY-0010"]||[],s.separateTabs&&s.separateTabs.length?s.extra.tabs=s.separateTabs:t.length?s.extra.tabs=JSON.parse(t).filter(function(e){return"角色"!=e.name}):s.extra.tabs={multiple:!0,filterSelf:"-1"==dsf.config.setting["SYS-FY-0012"],tabs:[{action:"fn/user/select/data?types=person&rootObject=1&action=self_dept&async=true",name:"本部门",subTabKey:"department"},{action:"fn/user/select/data?types=person&rootObject=1&action=self_org&async=true",name:"本机构",subTabKey:"department"},{name:"群组",action:"fn/user/select/data?types=person,department,post,privateGroup,own_group&rootObject=2&action=private_group&async=true&source=share",subTabKey:"department"}]};case 4:case"end":return e.stop()}},e)}))()},methods:{getTabs:function(){var o=this;return new(c())(function(a,e){try{dsf.http.post("/fn/mobileToRead/mobileShareInfo",{selectedTabs:o.nowButtonParameters.selectedTabs||"",pk:o.formParams.pk,moduleId:o.formParams.moduleId,distribId:o.formParams.distribId||""}).then(function(e){var t,s,n;200==e.data.code&&(dsf.config.setting["SYS-FY-0010"]=i()(e.data.data.tabs),t=/\[(.+?)\]/g,s=e.data.data.fySmsContent,n={"分阅用户":dsf.util.loadSessionStore("user").name,"分阅时间":moment().format("YYYY-MM-DD HH:mm:ss"),"模块名称":o.data.moduleName,"文件标题":o.data.bt,"分阅意见":o.optionValue},s.match(t)&&s.match(t).forEach(function(e){var t=e.replace("[","").replace("]","");n[t]&&(s=s.replace(e,n[t]))}),o.smsContent=s),a()})}catch(e){a()}})},show:function(e,t){var s=this;return this.data=e,this.defaultSelectArray=t,this.getAdvice(),1==this.nowButtonParameters.opinion?this.isShow1=!0:this.isShow2=!0,new(c())(function(e,t){s.resolve=e,s.reject=t})},cancel1:function(){this.isShow1=!1,this.reject("流程被中断")},cancel2:function(){this.isShow2=!1},send:function(){this.isShow2=!0},getAdvice:function(){var t=this;dsf.http.get("fn/mobileUsedOpinion/find").then(function(e){t.opinionList=e.data.rows})},addAdvice:function(){var e=this;""===this.optionValue?dsf.layer.toast("请输入内容"):dsf.http.post("fn/mobileUsedOpinion/add",{__DATA:i()({opinion:this.optionValue})}).then(function(){e.getAdvice()})},deleteAdvice:function(e){var t=this;this.$dialog.confirm({title:"提示",message:"确定要删除吗？"}).then(function(){dsf.http.get("fn/mobileUsedOpinion/delete?id="+e.id).then(function(){t.getAdvice()})})},writeAdvice:function(e){this.optionValue=this.optionValue+e,this.$forceUpdate()},addReadSure:function(i){var r=this;return(0,n.Z)(l().mark(function e(){var s,n,a,o,t;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n=s="",o=[],i.forEach(function(e,t){t=t?",":"";s+="".concat(t).concat(e.type,"::").concat(e.id),n+=(5==e.type?"".concat(t):"".concat(t).concat(e.attrs.realDeptId||e.pid,"-")).concat(e.id),a+=(5==e.type?"".concat(t):"".concat(t).concat(e.attrs.orgNameLV2Text||e.attrs.orgNameLV1Text,"-")).concat(e.name),5==e.type&&o.push(e.name)}),o.length)return e.next=6,new(c())(function(e,t){dsf.layer.confirm({title:"提示",message:"是否确认分阅给【".concat(o.join(","),"】内所有人员？")},function(){e()})});e.next=6;break;case 6:if(t={infoId:r.data.info_id,userIds:n,userNames:a,schemaVals:s,distribId:r.data.distribId||"",canRedistrib:1,infoType:r.data.infoType||"",infoTypeText:r.data.infoTypeText||"",shareContent:r.optionValue,shareList:"",isSms:r.result.find(function(e){return"isSms"==e})?"1":"-1",smsContent:"",reShare:0,isEndSms:r.result.find(function(e){return"isEndSms"==e})?"1":"-1"},r.data.distribId&&"0"!=r.data.distribId&&(t.reShare=1),""===t.userIds)return dsf.layer.toast("请选择人员"),e.abrupt("return");e.next=11;break;case 11:r.isShow1=!1,r.isShow2=!1,d.log(t),dsf.layer.loading(),dsf.http.post("fn/mobileToReadOperation/toShare",t).then(function(t){dsf.layer.clear(),dsf.layer.toast(t.data.message,!0),r.data.distribId&&"0"!=r.data.distribId&&dsf.config.commonForm.toShareAndRead?dsf.http.post("fn/mobileToReadOperation/readed",{infoIds:r.data.info_id,distribIds:r.data.distribId}).then(function(e){r.resolve(t.data.message)}):r.resolve(t.data.message)});case 16:case"end":return e.stop()}},e)}))()},closePopup:function(){this.$emit("close")}}},r=(0,s(51900).Z)(t,function(){var n=this,e=n._self._c;return e("div",{staticClass:"ds-separate-read"},[e("van-popup",{attrs:{position:"bottom"},on:{closed:n.closePopup},model:{value:n.isShow1,callback:function(e){n.isShow1=e},expression:"isShow1"}},[e("div",{staticClass:"header"},[e("van-nav-bar",{attrs:{title:"分阅意见","left-text":"取消"},on:{"click-left":n.cancel1}})],1),n._v(" "),e("div",{staticClass:"body"},[e("van-field",{attrs:{rows:"4",type:"textarea",placeholder:"请输入分阅意见",autosize:""},model:{value:n.optionValue,callback:function(e){n.optionValue=e},expression:"optionValue"}}),n._v(" "),e("div",{staticClass:"tag-box"},[e("div",{staticClass:"tag-list"},n._l(n.opinionList,function(t,s){return e("div",{key:s,staticClass:"tag-item"},[e("div",{staticClass:"tag-item-text",on:{click:function(e){return n.writeAdvice(t.context)}}},[n._v("\n              "+n._s(t.context)+"\n            ")]),n._v(" "),e("div",{staticClass:"tag-item-bt",on:{click:function(e){return n.deleteAdvice(t,s)}}},[e("van-icon",{attrs:{name:"cross"}})],1)])}),0),n._v(" "),e("van-button",{attrs:{icon:"plus",size:"small",plain:""},on:{click:n.addAdvice}},[n._v("新增模板")])],1),n._v(" "),e("div",{staticClass:"sms-container"},[e("van-checkbox-group",{attrs:{direction:"horizontal"},model:{value:n.result,callback:function(e){n.result=e},expression:"result"}},[e("van-checkbox",{attrs:{name:"isSms"}},[n._v("是否提醒")]),n._v(" "),e("van-checkbox",{attrs:{name:"isEndSms"}},[n._v("阅闭是否提醒")])],1),n._v(" "),e("van-field",{directives:[{name:"show",rawName:"v-show",value:n.result.find(function(e){return"isSms"==e}),expression:"result.find(item => item == 'isSms')"}],attrs:{rows:"4",autosize:"",type:"textarea",placeholder:"请输入提醒内容"},model:{value:n.smsContent,callback:function(e){n.smsContent=e},expression:"smsContent"}})],1)],1),n._v(" "),e("div",{staticClass:"footer"},[e("van-button",{attrs:{type:"theme"},on:{click:n.send}},[n._v("选择人员")])],1)]),n._v(" "),e("van-popup",{ref:"container",style:{height:"100%"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:n.isShow2,callback:function(e){n.isShow2=e},expression:"isShow2"}},[e("control-user-list",{attrs:{extra:n.extra,"default-select-array":n.defaultSelectArray},on:{close:n.cancel2,getSelectUser:n.addReadSure}})],1)],1)},[],!1,null,"7e65ecea",null).exports},38496:function(e,t,s){s.r(t),s.d(t,{default:function(){return r}});var t=s(73473),n=s.n(t),t=s(63560),a=s(18868),o=s(88561),i=s(25108),t={name:"SignFile",components:{selectPerson:t.default,DebounceClick:a.Z},data:function(){return{isShow:!1,resolve:function(){},reject:function(){},data:{deptBaoming:!0},showPerson:!1,userInfo:{},joinPersons:[],joinPersonIds:"",joinPerson:"",congressPersons:[],congressPersonIds:"",congressPerson:"",leaveReason:"",isAttend:!0,isJoin:!0,attendMeetingUrl:dsf.config.meetingConfig.attendMeetingUrl,extra:{}}},watch:{isAttend:function(){this.isJoin=!this.isJoin,this.showPerson=!1}},methods:{init:function(){var e=o.Z.loadSessionStore("user"),e=(this.userInfo=e,[]),t=[];this.data=null,this.showPerson=!1,this.joinPersons=e,this.joinPersonIds=0<e.length?e[0].id:"",this.joinPerson=0<e.length?e[0].name:"",this.congressPersons=t,this.congressPersonIds=0<t.length?t[0].id:"",this.congressPerson=0<t.length?t[0].name:"",this.leaveReason="",this.isAttend=!0,this.isJoin=!0},show:function(e){var s=this;return this.init(),this.data=e,i.log(this.data),this.isShow=!0,new(n())(function(e,t){s.resolve=e,s.reject=t})},cancel:function(){this.isShow=!1,this.reject("流程被中断")},submit:function(){var t=this,e={meetingtzId:this.data.meetingtzId,pk:this.data.pk,pnId:this.data.pnId,attendance:this.isAttend?"1":"-1",leaveReason:this.leaveReason,"x-auth-token":o.Z.loadSessionStore("loginToken"),requestEnv:"mobile"};if(this.data.deptBaoming?e.attendType=2:e.attendType=1,this.isAttend){if(this.data.deptBaoming||(this.joinPersons=[this.userInfo.name],this.joinPerson=this.userInfo.name,this.joinPersonIds=this.userInfo.user_id),!this.joinPersons.length)return void dsf.layer.toast("请选择参会人员");e.userName=this.joinPerson,e.userId=this.joinPersonIds}else{if(!this.congressPersons.length&&this.data.deptBaoming)return void dsf.layer.toast("请选择代会人员");if(!this.leaveReason.length)return void dsf.layer.toast("请填写请假理由");e.userName=this.congressPerson,e.userId=this.congressPersonIds}var s=dsf.layer.loading();dsf.http.post(this.attendMeetingUrl,e).done(function(e){"200"===e.code?(t.isShow=!1,t.resolve(e),t.isAttend=!0,t.isJoin=!0):dsf.layer.toast("请求异常")}).error(function(){dsf.layer.toast("请求异常")}).always(function(){dsf.layer.closeLoading(s)})},getUserNames:function(e){var t=[],s=[],e=e.map(function(e){return t.push(e.name),s.push(e.attrs.idValue),{id:e.attrs.idValue,pid:e.attrs.pidValue,name:e.name}});return{names:t.join(","),ids:s.join(","),persons:e}},getSelectUser:function(s){var e,t,n;0<s.length?(s.forEach(function(e,t){e.children&&0<e.children.length&&s.splice(t,1)}),e=(n=this.getUserNames(s)).names,t=n.ids,n=n.persons,this.isAttend?(this.joinPerson=e,this.joinPersonIds=t,this.joinPersons=n):(this.congressPerson=e,this.congressPersonIds=t,this.congressPersons=n)):(this.joinPerson="",this.joinPersonIds="",this.joinPersons="",this.congressPerson="",this.congressPersonIds="",this.congressPersons="")}}},r=(0,s(51900).Z)(t,function(){var t=this,e=t._self._c;return e("div",{staticClass:"ds-sign-file"},[e("van-popup",{staticClass:"ds-sign-file-pop",attrs:{position:"bottom","get-container":"#app",round:""},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[e("div",{staticClass:"header"},[e("van-nav-bar",{attrs:{title:"报名","left-text":"取消"},on:{"click-left":t.cancel}})],1),t._v(" "),t.data.deptBaoming?e("div",{staticClass:"body"},[e("div",{staticClass:"join"},[e("label",{attrs:{for:""}},[t._v("是否出席:")]),t._v(" "),e("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.isAttend,callback:function(e){t.isAttend=e},expression:"isAttend"}},[e("van-radio",{attrs:{name:!0,shape:"square"}},[t._v("出席")]),t._v(" "),e("van-radio",{attrs:{name:!1,shape:"square"}},[t._v(t._s("请假/委托"))])],1)],1),t._v(" "),t.isJoin?e("div",{staticClass:"confrence"},[e("van-field",{attrs:{readyonly:"","input-align":"left",label:"参会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(e){t.showPerson=!0}},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",[e("label",{staticClass:"mast-input"}),t._v("参会人员:\n            ")])]},proxy:!0}],null,!1,1705578387),model:{value:t.joinPerson,callback:function(e){t.joinPerson=e},expression:"joinPerson"}})],1):e("div",{staticClass:"congressPerson"},[e("van-field",{attrs:{readonly:!0,"input-align":"left",label:"代会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(e){t.showPerson=!0}},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",[e("label",{staticClass:"mast-input"}),t._v("代会人员：\n            ")])]},proxy:!0}],null,!1,3628413746),model:{value:t.congressPerson,callback:function(e){t.congressPerson=e},expression:"congressPerson"}})],1),t._v(" "),e("van-field",{directives:[{name:"show",rawName:"v-show",value:!t.isJoin,expression:"!isJoin"}],attrs:{rows:"4",autosize:"",label:"请假理由:",type:"textarea",placeholder:"请输入请假理由"},model:{value:t.leaveReason,callback:function(e){t.leaveReason=e},expression:"leaveReason"}})],1):e("div",{staticClass:"body"},[e("div",{staticClass:"join"},[e("label",{attrs:{for:""}},[t._v("是否出席:")]),t._v(" "),e("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.isAttend,callback:function(e){t.isAttend=e},expression:"isAttend"}},[e("van-radio",{attrs:{name:!0,shape:"square"}},[t._v("出席")]),t._v(" "),e("van-radio",{attrs:{name:!1,shape:"square"}},[t._v(t._s("请假/委托"))])],1)],1),t._v(" "),t.isJoin?t._e():e("div",{staticClass:"confrence"},[e("van-field",{attrs:{readonly:!0,"input-align":"left",label:"代会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(e){t.showPerson=!0}},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",[e("label",{staticClass:"mast-input"}),t._v("代会人员：\n            ")])]},proxy:!0}],null,!1,3628413746),model:{value:t.congressPerson,callback:function(e){t.congressPerson=e},expression:"congressPerson"}})],1),t._v(" "),e("van-field",{directives:[{name:"show",rawName:"v-show",value:!t.isJoin,expression:"!isJoin"}],attrs:{rows:"4",autosize:"",label:"请假理由:",type:"textarea",placeholder:"请输入请假理由"},model:{value:t.leaveReason,callback:function(e){t.leaveReason=e},expression:"leaveReason"}})],1),t._v(" "),e("div",{staticClass:"footer"},[e("debounce-click",[e("van-button",{attrs:{type:"theme"},on:{click:t.submit}},[t._v("提交")])],1)],1)]),t._v(" "),e("van-popup",{style:{height:"90%"},attrs:{"close-on-click-overlay":!1,position:"bottom","get-container":"#app",round:""},model:{value:t.showPerson,callback:function(e){t.showPerson=e},expression:"showPerson"}},[t.showPerson?e("selectPerson",{attrs:{extra:t.extra,type:0},on:{getSelectUser:t.getSelectUser,cancePerson:function(e){t.showPerson=!1}}}):t._e()],1)],1)},[],!1,null,null,null).exports},91369:function(e,t,s){s.r(t),s.d(t,{default:function(){return i}});var t=s(73473),n=s.n(t),t=s(63560),a=s(88561),o=s(25108),t={name:"SignFilePerson",components:{selectPerson:t.default},data:function(){return{isShow:!1,resolve:function(){},reject:function(){},data:{deptBaoming:!0},showPerson:!1,userInfo:{},joinPersons:[],joinPersonIds:"",joinPerson:"",congressPersons:[],congressPersonIds:"",congressPerson:"",leaveReason:"",isAttend:!0,attendance:1,isJoin:!0}},watch:{isAttend:function(){this.isJoin=!this.isJoin,this.showPerson=!1},attendance:function(e){}},methods:{init:function(){var e=a.Z.loadSessionStore("user"),e=(this.userInfo=e,[]),t=[];this.data=null,this.showPerson=!1,this.joinPersons=e,this.joinPersonIds=0<e.length?e[0].id:"",this.joinPerson=0<e.length?e[0].name:"",this.congressPersons=t,this.congressPersonIds=0<t.length?t[0].id:"",this.congressPerson=0<t.length?t[0].name:"",this.leaveReason="",this.isAttend=!0,this.isJoin=!0},show:function(e){var s=this;return this.init(),this.data=e,o.log(this.data),this.isShow=!0,new(n())(function(e,t){s.resolve=e,s.reject=t})},cancel:function(){this.isShow=!1,this.reject("流程被中断")},submit:function(){var t=this,e={meetingtzId:this.data.meetingtzId,pk:this.data.pk,pnId:this.data.pnId,attendance:this.attendance,leaveReason:this.leaveReason,"x-auth-token":a.Z.loadSessionStore("loginToken"),requestEnv:"mobile"};if(this.data.deptBaoming?e.attendType=2:e.attendType=1,-1!=this.attendance||this.leaveReason.length){if(2==this.attendance){if(!this.congressPersons.length)return void dsf.layer.toast("请选择代会人员");e.userName=this.congressPerson,e.userId=this.congressPersonIds}var s=dsf.layer.loading();dsf.http.post("fn/MeetingMobile/attendMeeting",e).done(function(e){"200"===e.code?(t.isShow=!1,t.resolve(e),t.isAttend=!0,t.isJoin=!0):dsf.layer.toast(e.message)}).error(function(){dsf.layer.toast(res.message)}).always(function(){dsf.layer.closeLoading(s)})}else dsf.layer.toast("请填写请假理由")},getUserNames:function(e){var t=[],s=[],e=e.map(function(e){return t.push(e.name),s.push(e.attrs.idValue),{id:e.attrs.idValue,pid:e.attrs.pidValue,name:e.name}});return{names:t.join(","),ids:s.join(","),persons:e}},getSelectUser:function(s){var e,t,n;0<s.length?(s.forEach(function(e,t){e.children&&0<e.children.length&&s.splice(t,1)}),e=(n=this.getUserNames(s)).names,t=n.ids,n=n.persons,this.congressPerson=e,this.congressPersonIds=t,this.congressPersons=n):(this.joinPerson="",this.joinPersonIds="",this.joinPersons="",this.congressPerson="",this.congressPersonIds="",this.congressPersons="")}}},i=(0,s(51900).Z)(t,function(){var t=this,e=t._self._c;return e("div",{staticClass:"ds-sign-file"},[e("van-popup",{staticClass:"ds-sign-file-pop",attrs:{position:"bottom","get-container":"#app",round:""},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[e("div",{staticClass:"header"},[e("van-nav-bar",{attrs:{title:"报名","left-text":"取消"},on:{"click-left":t.cancel}})],1),t._v(" "),e("div",{staticClass:"body"},[e("div",{staticClass:"join"},[e("label",{attrs:{for:""}},[t._v("是否出席:")]),t._v(" "),e("van-radio-group",{attrs:{direction:"horizontal"},model:{value:t.attendance,callback:function(e){t.attendance=e},expression:"attendance"}},[e("van-radio",{attrs:{name:1,shape:"square"}},[t._v("出席")]),t._v(" "),e("van-radio",{attrs:{name:-1,shape:"square"}},[t._v(t._s("请假"))]),t._v(" "),e("van-radio",{attrs:{name:2,shape:"square"}},[t._v(t._s("委托"))])],1)],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2==t.attendance,expression:"attendance==2"}],staticClass:"confrence"},[e("van-field",{attrs:{readonly:!0,"input-align":"left",label:"代会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(e){t.showPerson=!0}},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",[e("label",{staticClass:"mast-input"}),t._v("代会人员：\n            ")])]},proxy:!0}]),model:{value:t.congressPerson,callback:function(e){t.congressPerson=e},expression:"congressPerson"}})],1),t._v(" "),e("van-field",{directives:[{name:"show",rawName:"v-show",value:-1==t.attendance,expression:"attendance==-1"}],attrs:{rows:"4",autosize:"",label:"请假理由:",type:"textarea",placeholder:"请输入请假理由"},model:{value:t.leaveReason,callback:function(e){t.leaveReason=e},expression:"leaveReason"}})],1),t._v(" "),e("div",{staticClass:"footer"},[e("van-button",{attrs:{type:"theme"},on:{click:t.submit}},[t._v("提交")])],1)]),t._v(" "),e("van-popup",{style:{height:"90%"},attrs:{"close-on-click-overlay":!1,position:"bottom","get-container":"#app",round:""},model:{value:t.showPerson,callback:function(e){t.showPerson=e},expression:"showPerson"}},[e("selectPerson",{attrs:{type:0},on:{getSelectUser:t.getSelectUser,cancePerson:function(e){t.showPerson=!1}}})],1)],1)},[],!1,null,null,null).exports}}]);