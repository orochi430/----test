"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[36873,31204],{8449:function(e,t,n){var a=n(8167),o=n(31314),r=n(77193),s=n(8450),i=n.n(s),c=n(25108),s=function(){function s(){(0,a.Z)(this,s),(0,r.Z)(this,"ws",null),(0,r.Z)(this,"userid",""),(0,r.Z)(this,"ponReceivedTodo",null),(0,r.Z)(this,"ponScanCodeAfter",null),(0,r.Z)(this,"setIntervalWesocketPush",null)}return(0,o.Z)(s,[{key:"open",value:function(e){var t=dsf.url.getRootPath(),n=dsf.util.loadSessionStore("user").user_id||dsf.util.loadSessionStore("user").userId;t.startsWith("http:")?t=t.replace("http","ws")+"servletWebsocket/"+n:t.startsWith("https:")&&(t=t.replace("https","wss")+"servletWebsocket/"+n),this.ws=new WebSocket(t),this.ws.onopen=function(){e&&e()},this.ws.onmessage=function(e){var t;"pong"!=e.data&&(c.log(e),e=JSON.parse(e.data),t=s.getInstance(),-1<e.badgeType.indexOf("inbox")&&0<e.userIds.filter(function(e){return e==t.userid}).length?null!=t.ponReceivedTodo&&t.ponReceivedTodo({badgeType:e.badgeType,refresh:!0}):"qrCodeMessag"==e.badgeType&&e.userIds==t.userid?null!=t.ponScanCodeAfter&&t.ponScanCodeAfter({data:e.data}):"sameScreenMessage"==e.badgeType&&e.userIds.includes(t.userid)&&null!=t.ponmeettingSameScreen&&t.ponmeettingSameScreen({data:e.data}))},this.ws.onerror=function(e){c.log(e)},this.ws.onclose=function(){s.getInstance()}}},{key:"sendMessage",value:function(e){this.ws.send(i()(e))}},{key:"onReceivedTodo",value:function(e,t){this.userid=e,this.ponReceivedTodo=t}},{key:"onScanCodeAfter",value:function(e,t){this.userid=e,this.ponScanCodeAfter=t}},{key:"onmeettingSameScreen",value:function(e,t){this.userid=e,this.ponmeettingSameScreen=t}},{key:"clearFunction",value:function(){this.ponReceivedTodo=null,this.ponScanCodeAfter=null}},{key:"sendPing",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:6e4,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"ping";clearInterval(this.setIntervalWesocketPush),this.ws&&1==this.ws.readyState&&this.ws.send(n),this.setIntervalWesocketPush=setInterval(function(){e.ws&&1==e.ws.readyState?e.ws.send(n):clearInterval(e.setIntervalWesocketPush)},t)}},{key:"getWsReadyState",value:function(){return s.instance.ws.readyState}}],[{key:"getInstance",value:function(e,t,n){return s.instance||(s.instance=new s).open(function(){s.instance.sendPing(),t&&n&&s.instance[t](n)}),s.instance}},{key:"close",value:function(e){s.instance&&s.instance.ws&&(clearInterval(s.instance.setIntervalWesocketPush),1==s.instance.ws.readyState&&s.instance.ws.close(),s.instance=null,e)&&e()}}]),s}();t.Z=s},36873:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var t=n(26243),a=n.n(t),t=n(62680),o=n.n(t),t=n(95366),r=n.n(t),t=n(6919),s=n.n(t),i=n(77193),t=n(79529),c=n.n(t),l=n(88561),u=n(8449),t=n(20629),d=n(25108);function f(t,e){var n,s=a()(t);return o()&&(n=o()(t),e&&(n=n.filter(function(e){return r()(t,e).enumerable})),s.push.apply(s,n)),s}var t=(0,i.Z)({data:function(){return{code:"",title:this.$route.query.title,loading:null,meetingInfo:l.Z.loadSessionStore("meeting"),timeInterval:null,qrcodeInvalid:dsf.config.setting["SYS-MOBILE-QRCODEINVALID-0002"]||1,oaScoket:{}}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach(function(e){(0,i.Z)(t,e,n[e])}):s()?Object.defineProperties(t,s()(n)):f(Object(n)).forEach(function(e){Object.defineProperty(t,e,r()(n,e))})}return t}({},(0,t.rn)({isShowAppHeader:function(e){return e.isShowAppHeader}})),created:function(){this.title&&dsf.url.setTitle(decodeURI(this.title)),this.refreshQrCode(),this.openMySocket()},beforeRouteLeave:function(e,t,n){u.Z.close(),n()},methods:{getMyQrCode:function(){var t=this;t.loading=dsf.layer.loading(),dsf.http.post("fn/peopleCongress/myQrCode",{masterId:t.meetingInfo.id}).done(function(e){"success"==e.type&&(t.code="".concat(e.data,"&ran=").concat(Math.random()))}).error(function(e){d.log("myQrCode-err",e)}).always(function(){dsf.layer.closeLoading(t.loading)})},calcDays:function(e,t){return c()(dsf.date.diffDays(dsf.date.parse(e),dsf.date.parse(t)))},refreshQrCode:function(){var e=this;e.getMyQrCode(),clearInterval(e.timeInterval),e.timeInterval=setInterval(function(){e.getMyQrCode()},60*e.qrcodeInvalid*1e3)},queryStatus:function(){var t=this;"peopleCongressQrCode"==t.$route.name&&dsf.http.get("fn/peopleCongress/codeScanningStatus").done(function(e){"success"==e.type?(t.code="",clearInterval(t.timeInterval),dsf.layer.toast(e.message,!0,function(){return t.$router.go(-1)})):500!=e.code&&100==e.code?setTimeout(t.queryStatus,3e3):dsf.layer.alert({title:"错误",message:e.message},function(){t.refreshQrCode(),setTimeout(t.queryStatus,3e3)})}).error(function(e){d.log("codeScanningStatus-err",e)}).always(function(){})},openMySocket:function(){var t=this;u.Z.close(),t.oaScoket=u.Z.getInstance(t),t.oaScoket.onScanCodeAfter(l.Z.loadSessionStore("user").userId,function(e){d.log("onScanCodeAfter"),200==e.data.code?(clearInterval(t.timeInterval),dsf.layer.toast(e.data.message,!0,function(){return t.$router.go(-1)})):500!=e.data.code&&100==e.data.code||dsf.layer.alert({title:"错误",message:e.data.message},function(){t.refreshQrCode()})})}}},"beforeRouteLeave",function(e,t,n){clearInterval(this.timeInterval),n()}),p=(0,n(51900).Z)(t,function(){var e=this,t=e._self._c;return t("div",{staticClass:"container",style:{minHeight:"calc(100vh - ".concat(e.isShowAppHeader?"0.92rem":"0px",")")}},[t("div",{staticClass:"top"},[t("img",{attrs:{src:"static/images/peopleCongress/icon_head.png",alt:""}}),e._v(" "),t("span",{staticStyle:{"font-size":"0.38rem"}},[e._v(e._s(e.meetingInfo.userName))]),e._v(" "),e._e(),e._v(" "),t("span",{staticClass:"job"},[e._v(e._s(e.meetingInfo.userType))])]),e._v(" "),t("div",{staticClass:"card"},[t("div",{staticClass:"cell flex jb"},[t("img",{attrs:{src:"static/images/peopleCongress/wdsfp-icon-OrganizationalUnit.png",alt:""}}),e._v(" "),t("span",[e._v("单位部门：")]),t("span",{staticStyle:{flex:"1"}},[e._v(e._s(e.meetingInfo.dept))])]),e._v(" "),t("div",{staticClass:"cell flex jb"},[t("img",{attrs:{src:"static/images/peopleCongress/wdsfp-icon-ContactNumber.png",alt:""}}),e._v(" "),t("span",[e._v("联系电话：")]),t("span",{staticStyle:{flex:"1","line-height":"0.4rem"}},[e._v(e._s(e.meetingInfo.mobile))])]),e._v(" "),t("div",{staticClass:"code"},[t("div",[t("img",{attrs:{src:e.code,alt:""},on:{click:e.refreshQrCode}})])])])])},[],!1,null,"a213aa50",null).exports},8167:function(e,t,n){function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return s}})},31314:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(26771),o=n(44660);function s(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),a(e,(0,o.Z)(s.key),s)}}function r(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),a(e,"prototype",{writable:!1}),e}}}]);