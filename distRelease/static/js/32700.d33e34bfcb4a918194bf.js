"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[32700],{22866:function(e,t,n){n.r(t);var o=n(66250),a=n(33453),E=n.n(a),a=n(62207),c=n.n(a),a=n(73473),r=n.n(a),a=n(79529),v=n.n(a),I=n(25108),a={};function l(e,t,n,o){"project"==e?t.multinfos["22052014314165eniovTE43nrDYdcSm"].rows.forEach(function(e){o.$set(e,"220519112844EVzjXP7jUJlVKmc5kFh",{value:"",text:""}),o.$set(e,"220513201635mvLQr5jrPrTngcmMXhU",{value:"",text:""}),o.$set(e,"220513201809v9TGFYMGOirhYbOfNJP",{value:"",text:""}),o.$set(e,"220513201908F1JxdmM6Vc1gAhxOvAa",{value:"",text:""}),o.$set(e["c-res-space-009"],"value","")}):"building"==e?(o.$set(t.multinfos["22052014314165eniovTE43nrDYdcSm"].rows[n.subFormIndex],"220513201809v9TGFYMGOirhYbOfNJP",{value:"",text:""}),o.$set(t.multinfos["22052014314165eniovTE43nrDYdcSm"].rows[n.subFormIndex],"220513201908F1JxdmM6Vc1gAhxOvAa",{value:"",text:""}),o.$set(t.multinfos["22052014314165eniovTE43nrDYdcSm"].rows[n.subFormIndex]["c-res-space-009"],"value","")):"floor"==e&&(o.$set(t.multinfos["22052014314165eniovTE43nrDYdcSm"].rows[n.subFormIndex],"220513201908F1JxdmM6Vc1gAhxOvAa",{value:"",text:""}),o.$set(t.multinfos["22052014314165eniovTE43nrDYdcSm"].rows[n.subFormIndex]["c-res-space-009"],"value",""))}a.initHandle=function(n,e,o){var t=e.controls.find(function(e){return"22052014314165eniovTE43nrDYdcSm"==e.metaId}),r=("1"!=n.main["C-RQ-SPACE-REQUIREMENT-015"].value&&(t.show=0),e.controls.find(function(e){return"95F7kT88b9dUG0aO"==e.controlId})),i=(r.show=0,e.controls.find(function(e){return"kolfE5aGmedIKqWI"==e.controlId})),e=(i.show=0,n.multinfos["220518142254070nC4NzYGHcRoY6vZX"].rows);function s(){var t=0;n.multinfos["22052014314165eniovTE43nrDYdcSm"].rows.forEach(function(e){t+=c()("0"+e["c-res-space-009"].value)}),o.$set(n.main["C-RQ-SPACE-REQUIREMENT-017"],"value",t),o.$set(n.main["C-RQ-SPACE-REQUIREMENT-016"],"value",n.multinfos["22052014314165eniovTE43nrDYdcSm"].rows.length)}function u(a){window["C-RQ-SPACE-REQUIREMENT-008_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?projectId="+a,o=[];return t.split("?")[1]&&(t.split("?")[1].split("&").forEach(function(e){"projectId"!=e.split("=")[0]&&o.push(e)}),n=n+"&"+o.join("&")),n},window["C-RQ-SPACE-REQUIREMENT-011_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?projectId="+a,o=[];return t.split("?")[1]&&(t.split("?")[1].split("&").forEach(function(e){"projectId"!=e.split("=")[0]&&o.push(e)}),n=n+"&"+o.join("&")),n}}e.length&&"1"==e[0]["C-RQ-SPACE-REQUIREMENT-ITEM-016"].value&&(r.show=1,i.show=1),s(),o.$bus.on("subFormAdd",function(e){s()}),o.$bus.on("subFormDelete",function(e){s()}),o.$bus.on("blurBus",function(e){"c-res-space-009"==e.metaData.metaId&&s()}),o.$bus.on("inputRadio",function(e){"C-RQ-SPACE-REQUIREMENT-015"==e.metaData.metaId&&("1"==e.value?t.show=1:t.show=0)}),n.main["C-RQ-SPACE-REQUIREMENT-069"].value.length&&u(n.main["C-RQ-SPACE-REQUIREMENT-069"].value),o.$bus.on("selectUserBus",function(a){"C-RQ-SPACE-REQUIREMENT-008"==a.metaData.metaId&&a.value&&dsf.http.post("fn/customerLeadInfoController/getPhoneByUId",{uid:a.value}).then(function(e){o.$set(n.main["C-RQ-SPACE-REQUIREMENT-029"],"value",e.data.data.phone)}),"C-JYTA-0061"==a.metaData.metaId&&a.value&&(window["C-JYTA-0062_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?companyId="+a.value;return n=t.split("?")[1]?n+"&"+t.split("?")[1]:n}),"C-RQ-SPACE-REQUIREMENT-069"==a.metaData.metaId&&a.value&&u(a.value),"C-RQ-SPACE-REQUIREMENT-083"==a.metaData.metaId&&a.value&&(l("project",n,a,o),window["220519112844EVzjXP7jUJlVKmc5kFh_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?projectId="+a.value,o=[];return t.split("?")[1]&&(t.split("?")[1].split("&").forEach(function(e){"projectId"!=e.split("=")[0]&&o.push(e)}),n=n+"&"+o.join("&")),n},window["220513201635mvLQr5jrPrTngcmMXhU_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?projectId="+a.value,o=[];return t.split("?")[1]&&(t.split("?")[1].split("&").forEach(function(e){"projectId"!=e.split("=")[0]&&o.push(e)}),n=n+"&"+o.join("&")),n}),"220513201635mvLQr5jrPrTngcmMXhU"==a.metaData.metaId&&a.value&&(l("building",n,a,o),window["220513201809v9TGFYMGOirhYbOfNJP_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?buildingId="+a.value,o=[];return t.split("?")[1]&&(t.split("?")[1].split("&").forEach(function(e){"buildingId"!=e.split("=")[0]&&o.push(e)}),n=n+"&"+o.join("&")),n}),"220513201809v9TGFYMGOirhYbOfNJP"==a.metaData.metaId&&a.value&&(l("floor",n,a,o),window["220513201908F1JxdmM6Vc1gAhxOvAa_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?floorId="+a.value,o=[];return t.split("?")[1]&&(t.split("?")[1].split("&").forEach(function(e){"floorId"!=e.split("=")[0]&&o.push(e)}),n=n+"&"+o.join("&")),n}),"220513201908F1JxdmM6Vc1gAhxOvAa"==a.metaData.metaId&&a.value&&dsf.http.post("fn/customerLeadInfoController/getArea",{spaceId:a.value}).then(function(e){e=e.data;"success"==e.type&&(o.$set(n.multinfos["22052014314165eniovTE43nrDYdcSm"].rows[a.subFormIndex]["c-res-space-009"],"value",e.data.area),s())})}),o.$bus.on("checkVal",function(a){if("C-JYTA-0009"==a.metaData.metaId&&(window["C-JYTA-0061_beforeOpenCode"]=function(e,t){var n=t.split("?")[0]+"?qdlx="+a.value,o=[];return t.split("?")[1]&&(t.split("?")[1].split("&").forEach(function(e){"projectId"!=e.split("=")[0]&&o.push(e)}),n=n+"&"+o.join("&")),n}),"C-RQ-SPACE-REQUIREMENT-ITEM-016"==a.metaData.metaId&&("1"==a.value?(r.show=1,i.show=1):(r.show=0,i.show=0)),"C-RQ-SPACE-REQUIREMENT-ITEM-019"==a.metaData.metaId){var e="0%";switch(a.value){case"1":e="10%";break;case"2":e="30%";break;case"3":e="50%";break;case"4":e="70%";break;case"5":e="90%";break;case"6":e="100%"}o.$set(n.multinfos["220518142254070nC4NzYGHcRoY6vZX"].rows[a.subFormIndex]["C-RQ-SPACE-REQUIREMENT-ITEM-020"],"value",e.replace("%",""))}})},a.saveFilter=function(f,m,p){return new(r())(function(){var n=(0,o.Z)(E().mark(function e(t,n){var a,o,r,i,s,u,c,l,d;return E().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a="220518142254070nC4NzYGHcRoY6vZX",o=f.multinfos["220522124533ZkeCXW7AM6iuXizGEyf"].rows,r=f.multinfos["22052014314165eniovTE43nrDYdcSm"].rows,i=f.multinfos[a].rows,0<o.length&&(s=o[0]["C-JYTA-0061"].text,o.forEach(function(e,t){0!=t&&e["C-JYTA-0061"].text!=s&&n("当前客户渠道信息存在多家公司，无法保存")})),1==f.main["C-RQ-SPACE-REQUIREMENT-015"].value&&f.main["C-RQ-SPACE-REQUIREMENT-069"].value!=f.main["C-RQ-SPACE-REQUIREMENT-083"].value&&n("来访项目和项目字段不同，无法保存"),u=[],r.forEach(function(e){return"Deleted"!=e.action?u.push(e["220513201908F1JxdmM6Vc1gAhxOvAa"].value):""}),I.log(u),function(e){var t,n={};for(t in e){if(n[e[t]])return 1;n[e[t]]=!0}}(u)&&n("当前客户房源信息存在重复"),c=!0,1!=f.main["C-RQ-SPACE-REQUIREMENT-015"].value)e.next=26;else{if(0==(l=f.multinfos["22052014314165eniovTE43nrDYdcSm"].rows.filter(function(e){return"Deleted"!=e.action})).length)return n("意向房源子表必填,至少存在一条数据!"),e.abrupt("return");e.next=19}break;case 19:return d="",l.forEach(function(e){d.length&&(d+=","),d+=e["220513201908F1JxdmM6Vc1gAhxOvAa"].value}),e.next=23,dsf.http.post("fn/customerLeads/selectFYInfo",{fyId:d}).then(function(e){e=e.data;I.log(e),"200"!=e.code&&(dsf.layer.toast(e.message),c=!1)});case 23:if(c){e.next=26;break}return n(),e.abrupt("return");case 26:dsf.http.post("fn/commonTool/getIdByTableName",{tableName:"g_contact",dbName:"ImBzServiceConnection"}).then(function(e){e.data;return dsf.http.post("fn/commonTool/getIdByTableName",{tableName:"rq_space_requirement_item",dbName:"ImBzServiceConnection"})}).then(function(e){var n,o=e.data.data.id;return p.pk?(n=0,i.forEach(function(e,t){"Added"==e.action&&(p.$set(e[a],"value",v()(o)+n),n++)})):i.forEach(function(e,t){p.$set(e[a],"value",v()(o)+t)}),dsf.http.post("fn/commonTool/getIdByTableName",{tableName:"mdm_channel",dbName:"ImBzServiceConnection"})}).then(function(e){e.data;p.pk?t():dsf.http.post("fn/commonTool/getIdByTableName",{tableName:"rq_space_requirement",dbName:"ImBzServiceConnection"}).then(function(e){e=e.data,dsf.http.post("fn/UpdateGNRInfoController/updateInfo",{moduleId:p.moduleId,oldId:p.formParams.pk,newId:e.data.id}).then(function(e){e=e.data;I.log("fn/UpdateGNRInfoController/updateInfo",e)}),e=e.data.id;p.pk=e,p.formParams.pk=e,p.$set(m.parameters,"pk",e),p.$set(f.main,"A0001",{value:e}),t()})});case 27:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}())},t.default=a}}]);