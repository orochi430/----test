"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[92545],{92545:function(t,e,a){a.r(e),a.d(e,{default:function(){return l}});var n=a(66250),o=a(5044),e=a(8450),i=a.n(e),e=a(33453),s=a.n(e),c=a(25108),r=a(70492);a(40451),a(83062),a(21865);var e={data:function(){return{show:!1,date:dsf.date.format(new Date,"yyyy-mm-dd"),minDate:new Date(2022,0,1),maxDate:new Date,total:0,list:[],showChart:!0,showUnit:!1,placeId:"",placeName:"全部",option:{},columns:[{text:"全部",value:""}],stateText:"",stateValue:"",showState:!1,stateColumns:[]}},deactivated:function(){"commonList"!=this.$route.name&&this.$deleteCache(this)},mounted:function(){this.getPlace(),this.getData(dsf.date.format(new Date,"yyyy-mm-dd"))},methods:{getPlace:function(){var e=this;dsf.http.post("/ctrl/device/getPlaces").then(function(t){"200"==t.data.code&&(e.columns=[].concat((0,o.Z)(e.columns),(0,o.Z)(t.data.data)))})},getData:function(){var a=this;return(0,n.Z)(s().mark(function t(){var e;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=dsf.layer.loading(),t.next=3,dsf.http.post("/ctrl/device/countAccessRecord",{date:a.date,place_name:a.placeId}).then(function(t){dsf.layer.closeLoading(e),t.data.data?(a.total=t.data.data.total,a.list=t.data.data.list,c.log(a.list)):(a.total=0,a.list=[],dsf.layer.toast(t.data.messge))}).error(function(t){dsf.layer.closeLoading(e)});case 3:0<a.list.length?(a.showChart=!0,a.drawLine(a.list)):a.showChart=!1;case 4:case"end":return t.stop()}},t)}))()},toList:function(){var t={"query_OA_ACCESS_RECORDS.C-ACCESS-RECORDS-0001":"".concat(this.date," - ").concat(this.date)};this.$router.push({path:"/commonList/220322155159B6DOXReCG8DuIE9gwM5/220318112117wJNhpmh1Q3QEyNdHat5",query:{secQuery:i()(t)}})},drawLine:function(a){c.log(a);var n,o=this,t=r.init(document.getElementById("myChart"));this.autoHeight=30*a.length+60,t.resize({height:this.autoHeight}),t.getZr().on("click",function(t){c.log(n),c.log(a);var e={equipment:o.list[n].code,"query_OA_ACCESS_RECORDS.C-ACCESS-RECORDS-0001":"".concat(o.date," - ").concat(o.date)};o.$router.push({path:"/commonList/2205171914462OXImpneGQBfq9Nn62c/220405162139n0I5f23XnQayBPWs21m",query:{secQuery:i()(e),notLink:1}})}),t.setOption({title:{show:!1,textStyle:{fontWeight:"normal",fontSize:"0"},left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},formatter:function(t){n=t[0].dataIndex},grid:{left:"3%",right:"4%",bottom:"3%",top:"3%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01],minInterval:1},yAxis:{type:"category",data:a.map(function(t){return t.name})},series:[{name:"查询量",type:"bar",barCategoryGap:"50%",itemStyle:{barBorderRadius:[0,10,10,0],color:new r.graphic.LinearGradient(0,0,1,1,[{offset:0,color:"#0091FF"},{offset:.7,color:"#32C5FF"},{offset:1,color:"#32C5FF"}])},label:{show:!0,position:"right"},data:a.map(function(t){return t.num})}]})},onConfirm:function(t){this.show=!1,this.date=dsf.date.format(t,"yyyy-mm-dd"),this.getData()},confirmUnit:function(t){c.log(t),this.showUnit=!1,this.placeId=t.value,this.placeName=t.text,this.getData(this.date,this.placeId)},confirmState:function(t){c.log(t),this.showState=!1,this.stateText=t.text,this.stateValue=t.value,this.getData()}}},l=(0,a(51900).Z)(e,function(){var e=this,t=e._self._c;return t("div",{staticClass:"container",style:{minHeight:"calc(100vh - ".concat(e.$store.state.isShowAppHeader?"0.92rem":"0px",")")}},[t("van-cell",{attrs:{title:"日期选择","is-link":"",value:e.date},on:{click:function(t){e.show=!0}}}),e._v(" "),t("van-cell",{attrs:{title:"场所选择","is-link":"",value:e.placeName},on:{click:function(t){e.showUnit=!0}}}),e._v(" "),t("div",{staticClass:"total"},[t("div",[e._v("访问总次数")]),e._v(" "),t("div",{staticClass:"num"},[e._v(e._s(e.total))])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showChart,expression:"showChart"}],staticClass:"chart-container"},[t("div",{style:{width:"95vw",height:"100%"},attrs:{id:"myChart"}})]),e._v(" "),t("van-calendar",{attrs:{"min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.onConfirm},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}}),e._v(" "),t("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showUnit,callback:function(t){e.showUnit=t},expression:"showUnit"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:e.columns,"value-key":"text"},on:{cancel:function(t){e.showUnit=!1},confirm:e.confirmUnit}})],1),e._v(" "),t("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showState,callback:function(t){e.showState=t},expression:"showState"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:e.stateColumns,"value-key":"text"},on:{cancel:function(t){e.showState=!1},confirm:e.confirmState}})],1)],1)},[],!1,null,"a14b4936",null).exports}}]);