"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[29945],{29945:function(t,e,n){n.r(e),n.d(e,{default:function(){return s}});var e={name:"weekSlider",props:{defaultDate:{type:String,default:moment().format("YYYY-MM-DD")},showYear:{type:Boolean,default:!1},activeBgColor:{type:String,default:"#D10000"},todayBgColor:{type:String},activeTxtColor:{type:String,default:"rgba(255, 255, 255, 1)"},todayTxtColor:{type:String},lang:{type:String,default:"ch"}},data:function(){return{leaders:[],monthname:[],dates:[],direction:null,activeIndex:1,isAnimation:!1,yearMonthStr:"",start:{x:null,y:null},end:{x:null,y:null},distan:{x:0,y:0},sliderWidth:0,weekLanguages:{ch:["日","一","二","三","四","五","六"],en:["Sun","Mon","Tue","Wed","Thur","Fri","Sat"]}}},watch:{dates:{handler:function(t,e){this.yearMonthStr=moment(t[1].date).format("YYYY-MM")},deep:!0}},computed:{todayStyle:function(){return{color:this.todayTxtColor||""}}},mounted:function(){this.sliderWidth=this.$refs.sliders.offsetWidth},created:function(){var t=this;this.dates.push({date:moment(t.defaultDate).subtract(7,"d").format("YYYY-MM-DD")},{date:t.defaultDate},{date:moment(t.defaultDate).add(7,"d").format("YYYY-MM-DD")})},methods:{getDaies:function(t){var e=this,a=[],s=Number(moment(t).format("E")),n=e.weekLanguages[e.lang],i=moment(),r=moment(e.defaultDate);7===s&&(s=0);for(var d=0;d<7;d++){var o=moment(t).subtract(s-d,"d");a.push({date:o.format("YYYY-MM-DD"),week:n[d],isToday:o.format("YYYY-MM-DD")===i.format("YYYY-MM-DD"),isDay:o.format("YYYY-MM-DD")===r.format("YYYY-MM-DD")})}return a},getTransform:function(t){var e=this,a={};return t===e.activeIndex&&(a.transform="translateX("+e.distan.x+"px)"),t<e.activeIndex&&(a.transform="translateX(-100%)"),t>e.activeIndex&&(a.transform="translateX(100%)"),a.transition=e.isAnimation?"transform 0.2s ease-out":"none",a},touchstartHandle:function(t){t=t.touches[0];this.start.x=t.pageX,this.start.y=t.pageY},touchmoveHandle:function(t){var e=this,t=t.touches[0],t=(e.isAnimation=!0,e.end.x=t.pageX,e.end.y=t.pageY,e.distan.x=e.end.x-e.start.x,e.distan.y=e.end.y-e.start.y,e.distan.x<0?this.$refs.sliders.children[2]:this.$refs.sliders.children[0]);e.distan.x<0?t.style.transform="translateX("+(e.sliderWidth+e.distan.x)+"px)":t.style.transform="translateX("+(-e.sliderWidth+e.distan.x)+"px)"},touchendHandle:function(t){var e=this,t=t.changedTouches[0];if(e.isAnimation=!0,e.end.x=t.pageX,e.end.y=t.pageY,e.distan.x=e.end.x-e.start.x,e.distan.y=e.end.y-e.start.y,e.getTouchDirection(e.distan.x,e.distan.y),"left"===e.direction)e.activeIndex=2;else if("right"===e.direction)e.activeIndex=0;else for(var a=0;a<this.$refs.sliders.children.length;a++)this.$refs.sliders.children[a].style.transform="translateX("+(100*a-100)+"%)";e.distan.x=0,e.distan.y=0,e.direction=null},onTransitionEnd:function(t){var e=this;e.isAnimation=!1,1===t&&2===this.activeIndex?(e.dates.push({date:moment(e.dates[e.activeIndex].date).add(7,"d").format("YYYY-MM-DD")}),e.dates.shift(),e.activeIndex=1):1===t&&0===this.activeIndex&&(e.dates.unshift({date:moment(e.dates[e.activeIndex].date).subtract(7,"d").format("YYYY-MM-DD")}),e.dates.pop(),e.activeIndex=1)},getAngle:function(t,e){return 180*Math.atan2(e,t)/Math.PI},getTouchDirection:function(t,e){20<Math.abs(t)&&(-45<=(t=this.getAngle(t,e))&&t<=45?this.direction="right":(135<=t&&t<=180||-180<=t&&t<-135)&&(this.direction="left"))},dayClickHandle:function(t){this.$emit("dateClick",t),this.$emit("update:defaultDate",t)},buildDateStyle:function(t,e){var a={};return t&&(a.color=this.todayTxtColor||"",a.backgroundColor=this.todayBgColor||""),e&&(a.color=this.activeTxtColor||"",a.backgroundColor=this.activeBgColor||""),a}}},a=n(51900),e=(0,a.Z)(e,function(){var a=this,s=a._self._c;return s("div",[a.showYear?s("div",{staticClass:"year_str"},[a._v(a._s(a.yearMonthStr))]):a._e(),a._v(" "),s("div",{staticClass:"week-slider"},[s("div",{ref:"sliders",staticClass:"sliders",on:{touchstart:a.touchstartHandle,touchmove:a.touchmoveHandle,touchend:a.touchendHandle}},[a._l(a.dates,function(t,e){return[s("div",{staticClass:"slider",style:a.getTransform(e),on:{"webkit-transition-end":function(t){return a.onTransitionEnd(e)},transitionend:function(t){return a.onTransitionEnd(e)}}},a._l(a.getDaies(t.date),function(e,t){return s("div",{key:t,staticClass:"day"},[s("div",{staticStyle:{"font-size":"13px"}},[a._v(a._s(e.week))]),a._v(" "),s("div",{staticClass:"solar",style:a.buildDateStyle(e.isToday,e.isDay),on:{click:function(t){return t.stopPropagation(),a.dayClickHandle(e.date)}}},[a._v("\n              "+a._s(e.date.split("-")[2])+"\n            ")]),a._v(" "),s("div",{staticClass:"lunar",class:{festival:a.dsf.date.isFestival(e,e.date)}},[s("span",{staticStyle:{"font-size":"11px",color:"#999999"}},[a._v(a._s(a.dsf.date.solarToLunar(e,e.date)))])])])}),0)]})],2)])])},[],!1,null,"52bfb972",null).exports,s=(0,a.Z)({name:"weekDuty",props:{},components:{weekSlider:e},data:function(){return{default_date:moment(new Date).format("YYYY-MM-DD"),leaders:[],shiftleader:[],dayshift:[],nightshift:[]}},computed:{},watch:{},methods:{dateClickhandler:function(t){var e=this;this.leaders=[],dsf.http.post("/fn/mobileDuty/currentDayDuty",{daydate:t}).then(function(t){null!=t.data.data&&(e.leaders=t.data.data)})}},created:function(){},mounted:function(){var e=this;dsf.http.post("/fn/mobileDuty/currentDayDuty",{daydate:moment(new Date).format("YYYY-MM-DD")}).then(function(t){e.leaders=t.data.data})},beforeDestroy:function(){}},function(){var a=this,s=a._self._c;return s("div",{staticClass:"weekduty"},[s("week-slider",{attrs:{showYear:!0,defaultDate:a.default_date},on:{dateClick:a.dateClickhandler,"update:defaultDate":function(t){a.default_date=t},"update:default-date":function(t){a.default_date=t}}}),a._v(" "),s("div",{staticClass:"content-box"},[s("div",{staticClass:"leader"},[s("div",{staticClass:"content-duty"},[s("div",{staticClass:"title"},[a._v("白天值班")]),a._v(" "),a._l(a.leaders.dayshift,function(t,e){return s("div",{key:e+1,staticClass:"p"},[s("span",{staticClass:"name"},[s("span",[a._v(a._s(t.name))]),a._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:2==t.leader,expression:"item.leader == 2"}],staticClass:"van-tag"},[a._v("主")]),a._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:3==t.leader,expression:"item.leader == 3"}],staticClass:"van-tag"},[a._v("副")])]),a._v(" "),s("span",{staticClass:"gray"},[s("img",{attrs:{src:n(32462),alt:""}}),a._v(" "),s("span",{staticClass:"ellipsis"},[a._v(a._s(t.department))])]),a._v(" "),s("span",{staticClass:"gray"},[s("img",{attrs:{src:n(26769),alt:""}}),a._v(" "),s("span",[a._v(a._s(t.telephone))])])])})],2),a._v(" "),s("div",{staticClass:"content-duty"},[s("div",{staticClass:"title"},[a._v("夜间值班")]),a._v(" "),a._l(a.leaders.nightshift,function(t,e){return s("div",{key:e+3,staticClass:"p"},[s("span",{staticClass:"name"},[s("span",[a._v(a._s(t.name))]),a._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:2==t.leader,expression:"item.leader == 2"}],staticClass:"van-tag"},[a._v("主")]),a._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:3==t.leader,expression:"item.leader == 3"}],staticClass:"van-tag"},[a._v("副")])]),a._v(" "),s("span",{staticClass:"gray"},[s("img",{attrs:{src:n(32462),alt:""}}),a._v(" "),s("span",{staticClass:"ellipsis"},[a._v(a._s(t.department))])]),a._v(" "),s("span",{staticClass:"gray"},[s("img",{attrs:{src:n(26769),alt:""}}),a._v(" "),s("span",[a._v(a._s(t.telephone))])])])})],2)])])],1)},[],!1,null,"e2d4f87c",null).exports},32462:function(t,e,a){t.exports=a.p+"static/img/dept.6bc9eba..png"},26769:function(t,e,a){t.exports=a.p+"static/img/tel.deecb3a..png"}}]);