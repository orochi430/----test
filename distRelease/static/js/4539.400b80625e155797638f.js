"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[4539],{4539:function(t,e,a){a.r(e),a.d(e,{default:function(){return n}});var o=a(66250),e=a(8450),s=a.n(e),e=a(33453),r=a.n(e),c=a(25108),d=a(70492);a(40451),a(83062),a(21865);var e={data:function(){return{show:!1,date:dsf.date.format(new Date,"yyyy-mm-dd"),minDate:new Date(2022,0,1),maxDate:new Date,total:"",list:[],showChart:!0,showUnit:!1,unitId:"",unitName:dsf.util.loadSessionStore("user").unitName,option:{},columns:[],isShowUnit:dsf.util.checkUserRole("疫情查询管理")}},beforeRouteEnter:function(t,e,a){a(function(t){"commonList"!==e.name&&(t.unitId="",t.unitName=dsf.util.loadSessionStore("user").unitName,t.date=dsf.date.format(new Date,"yyyy-mm-dd"),t.isShowUnit=dsf.util.checkUserRole("疫情查询管理"),t.getData(t.date),t.getUnit())})},mounted:function(){this.getData(dsf.date.format(new Date,"yyyy-mm-dd")),this.isShowUnit&&this.getUnit()},methods:{getUnit:function(){var e=this;dsf.http.post("/ctrl/statistical/qryUnitStatistical",{rootUnitId:""}).then(function(t){200==t.data.code?(e.columns=t.data.data,e.columns.unshift({orgName:"本单位"}),c.log(t.data.data)):dsf.layer.toast(t.data.messge)}).error(function(t){})},getData:function(a,n){var i=this;return(0,o.Z)(r().mark(function t(){var e;return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=dsf.layer.loading(),t.next=3,dsf.http.post("/ctrl/statistical/qryStatistical",{qryDate:a,qryUnitId:n||""}).then(function(t){dsf.layer.closeLoading(e),200==t.data.code?(i.total=t.data.data.count,i.list=t.data.data.detail,c.log(i.list)):dsf.layer.toast(t.data.messge)}).error(function(t){dsf.layer.closeLoading(e)});case 3:0<i.list.length?(i.showChart=!0,i.drawLine(i.list)):i.showChart=!1;case 4:case"end":return t.stop()}},t)}))()},toList:function(){var t={unitId:this.unitId||dsf.util.loadSessionStore("user").unitId,"query_S-API-LOG-0001":"".concat(this.date," - ").concat(this.date)};this.$router.push({path:"/commonList/220322155159B6DOXReCG8DuIE9gwM5/220318112117wJNhpmh1Q3QEyNdHat5",query:{secQuery:s()(t)}})},drawLine:function(a){c.log(a);var n,i=this,t=d.init(document.getElementById("myChart"));this.autoHeight=30*a.length+120,t.resize({height:this.autoHeight}),t.getZr().on("click",function(t){c.log(n),c.log(a);var e={operateId:i.list[n].createUserid,"query_S-API-LOG-0001":"".concat(i.date," - ").concat(i.date)};i.$router.push({path:"/commonList/2203201536267aWr3w6S080rMhWfuZP/220318112117wJNhpmh1Q3QEyNdHat5",query:{secQuery:s()(e)}})}),t.setOption({title:{text:"当天疫情查询量（人）",textStyle:{fontWeight:"normal",fontSize:"16"},left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},formatter:function(t){n=t[0].dataIndex},legend:{show:!1},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01],minInterval:1},yAxis:{type:"category",data:a.map(function(t){return t.createUname})},series:[{name:"查询量",type:"bar",barCategoryGap:"50%",itemStyle:{barBorderRadius:[0,10,10,0],color:new d.graphic.LinearGradient(0,0,1,1,[{offset:0,color:"#0091FF"},{offset:.7,color:"#32C5FF"},{offset:1,color:"#32C5FF"}])},label:{show:!0,position:"right"},data:a.map(function(t){return t.num})}]})},onConfirm:function(t){this.show=!1,this.date=dsf.date.format(t,"yyyy-mm-dd"),this.getData(this.date,this.unitId)},confirmUnit:function(t){c.log(t),this.showUnit=!1,this.unitId=t.orgId,this.unitName=t.orgName,this.getData(this.date,this.unitId)}}},n=(0,a(51900).Z)(e,function(){var e=this,t=e._self._c;return t("div",{staticClass:"container",style:{minHeight:"calc(100vh - ".concat(e.$store.state.isShowAppHeader?"0.92rem":"0px",")")}},[t("van-cell",{attrs:{title:"日期选择","is-link":"",value:e.date},on:{click:function(t){e.show=!0}}}),e._v(" "),e.isShowUnit?t("van-cell",{attrs:{title:"单位选择","is-link":"",value:e.unitName},on:{click:function(t){e.showUnit=!0}}}):e._e(),e._v(" "),t("div",{staticClass:"total"},[t("div",[e._v("今日查询总人数")]),e._v(" "),t("div",{staticClass:"num",on:{click:function(t){return e.toList()}}},[e._v(e._s(e.total))])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showChart,expression:"showChart"}],staticClass:"chart-container"},[t("div",{style:{width:"95vw",height:"100%"},attrs:{id:"myChart"}})]),e._v(" "),t("van-calendar",{attrs:{"min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.onConfirm},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}}),e._v(" "),t("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showUnit,callback:function(t){e.showUnit=t},expression:"showUnit"}},[t("van-picker",{attrs:{"show-toolbar":"",columns:e.columns,"value-key":"orgName"},on:{cancel:function(t){e.showUnit=!1},confirm:e.confirmUnit}})],1)],1)},[],!1,null,"cfbeab36",null).exports}}]);