"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[60028],{9294:function(e,a,t){t.r(a);var n=t(8450),r=t.n(n),n=t(73473),u=t.n(n),c=t(90541),l=t(25108),n={};function d(e,a){a.show=2==e?1:0}n.initHandle=function(i,a,t){var s,o,n=a.controls.find(function(e){return"controlMobileAlink"==e.metaId}),e=(n&&(o=(s=a).controls.find(function(e){return"controlMobileAlink"==e.metaId}),c.Z.http.post("fn/superviseV6/approvalTask/hasTasks",{relationId:s.parameters.pk}).then(function(e){var a=r()({relationId:s.parameters.pk}),t="查看/新建任务计划",n="/commonForm/210604144527JntE2LI7dWrpBLsluZz?specialSaveObj=".concat(a);200==e.data.code&&e.data.data&&e.data.data.taskTitle&&(t=e.data.data.taskTitle,n="/commonForm/210604144527JntE2LI7dWrpBLsluZz/".concat(e.data.data.taskId,"?specialSaveObj=").concat(a)),l.log(o),o.extra.linkInfo=n,o.extra.linkName=t})),i.main["C-DB-0078"].value);e&&n&&d(e,n),i.main["C-DB-0086"]&&i.main["C-DB-0086"].value||t.$set(i.main,"C-DB-0086",{value:a.parameters.pk}),i.main["C-DB-0054"]&&i.main["C-DB-0054"].value||t.$set(i.main,"C-DB-0054",{value:"1",text:"待确认"}),t.$bus.$off("selectUserBus").on("selectUserBus",function(e){l.log("busObj.metaData",e.metaData),"C-DB-0001"===e.metaData.metaId&&(1<e.selectArr.length?(t.$set(i.main,"C-DB-0002",{value:"",text:""}),a.controls.find(function(e){return"C-DB-0002"==e.metaId}).privilege.editable=!1):a.controls.find(function(e){return"C-DB-0002"==e.metaId}).privilege.editable=!0)}),t.$bus.$off("userClickBus").on("userClickBus",function(e){var a,n,t;"C-DB-0002"!=e.metaId&&"C-DB-0001"!=e.metaId||(a="C-DB-0002"==e.metaId?i.main["C-DB-0001"]:i.main["C-DB-0002"],t=e.user,a.value.split(",").find(function(e){return e==t.id.slice(t.id.lastIndexOf("_")+1)})&&(t.checked=!1,c.Z.layer.toast("主办单位与协办单位不能重复")),e.user.checked&&(n=e.user,new(u())(function(a,t){c.Z.http.post("fn/superviseV6/approval/hasRolePersonByDept",{deptId:n.id.slice(n.id.lastIndexOf("_")+1),deptName:n.showName}).then(function(e){(200==e.data.code?a:(c.Z.layer.toast(e.data.message),t))()})}).catch(function(){e.user.checked=!1,e.callback(e.user)})))}),t.$bus.on("inputRadio",function(e){"C-DB-0078"==e.metaData.metaId&&d(e.value,n)})},n.saveFilter=function(n,e,i,a){return new(u())(function(e,a){var t=c.Z.date.parse(n.main["C-DB-0052"].value).getTime();c.Z.date.parse(i.$route.query.endDate).getTime()<t?a("办结期限不能大于主项目办结期限"):e()})},n.saveAfter=function(e,a,t){e.backSucces()},a.default=n}}]);