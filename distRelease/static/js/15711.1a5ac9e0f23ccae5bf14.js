"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[15711],{15711:function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});var a=s(25108),t={name:"green_code_upload",data:function(){return{date:(new Date).toLocaleDateString().replace(/\//g,"-"),file_list:[],no_submit:!0,show_code:!1,code_about:{name:"阴性",class:"green"},actions:[{name:"阴性",class:"green"},{name:"阳性",class:"red"}],user_message:{}}},watch:{file_list:{handler:function(e,t){var s=this;e.length?this.no_submit=!1:this.$nextTick(function(){s.no_submit=!0})},deep:!0,immediate:!0}},created:function(){this.getGreenCodeData()},methods:{getGreenCodeData:function(){var t=this;dsf.http.get("action?EpidemicAppAction=2",{userId:dsf.util.loadSessionStore("user").user_id}).then(function(e){var e=e.data;200==e.code&&(t.user_message=e.data,t.user_message.date||(e=new Date,t.user_message.date="".concat(e.getFullYear(),"-").concat(9<e.getMonth()+1?e.getMonth()+1:"0"+(e.getMonth()+1),"-").concat(9<e.getDate()?e.getDate():"0"+e.getDate())),t.user_message.photoPath)&&(t.file_list=[{url:t.user_message.photoPath,isImage:!0}])})},afterRead:function(e){a.log(e),e.status="uploading",e.message="上传中...",this.uploadFile(e)},uploadFile:function(t){var s=this,e=new FormData;e.append("file",t.file),e.append("userId",dsf.util.loadSessionStore("user").user_id),dsf.http.post("action?EpidemicAppAction=4",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){e=e.data;200==e.code&&(t.status="success",t.message="上传成功",s.user_message.photo=e.data.id)})},onSelect:function(e){this.show_code=!1,this.code_about=e},submitGreenCode:function(){var t=this;dsf.http.get("action?EpidemicAppAction=3",{userId:dsf.util.loadSessionStore("user").user_id,id:this.user_message.id,name:this.user_message.name,phone:this.user_message.phone,identity:this.user_message.identity,healthCode:this.code_about.name,photo:this.user_message.photo,date:this.user_message.date,temperatureAm:this.user_message.temperatureAm,temperaturePm:this.user_message.temperaturePm}).then(function(e){e=e.data;200==e.code&&dsf.layer.alert({title:"温馨提示",message:e.message},function(){t.$router.back()})})}}},n=(0,s(51900).Z)(t,function(){var t=this,e=t._self._c;return e("div",{staticClass:"green_code_upload"},[e("van-cell-group",{staticClass:"group_one"},[e("van-cell",{attrs:{value:t.user_message.name,title:"姓名"}}),t._v(" "),e("van-cell",{staticClass:"identity",attrs:{title:"身份证"},scopedSlots:t._u([{key:"default",fn:function(){return[e("van-field",{attrs:{placeholder:"请输入身份证号",clearable:""},model:{value:t.user_message.identity,callback:function(e){t.$set(t.user_message,"identity",e)},expression:"user_message.identity"}})]},proxy:!0}])}),t._v(" "),e("van-cell",{attrs:{value:t.user_message.phone,title:"手机号"}}),t._v(" "),e("van-cell",{attrs:{value:t.user_message.date,title:"上传日期"}})],1),t._v(" "),e("van-cell-group",{staticClass:"group_two"},[e("van-cell",{staticClass:"identity",attrs:{title:"上午体温"},scopedSlots:t._u([{key:"default",fn:function(){return[e("van-field",{attrs:{placeholder:"请输入体温度数",clearable:""},model:{value:t.user_message.temperatureAm,callback:function(e){t.$set(t.user_message,"temperatureAm",e)},expression:"user_message.temperatureAm"}})]},proxy:!0}])}),t._v(" "),e("van-cell",{staticClass:"identity",attrs:{title:"下午体温"},scopedSlots:t._u([{key:"default",fn:function(){return[e("van-field",{attrs:{placeholder:"请输入体温度数",clearable:""},model:{value:t.user_message.temperaturePm,callback:function(e){t.$set(t.user_message,"temperaturePm",e)},expression:"user_message.temperaturePm"}})]},proxy:!0}])}),t._v(" "),e("van-cell",{class:t.code_about.class,attrs:{value:t.code_about.name,title:"核酸或抗原检测","is-link":""},on:{click:function(e){t.show_code=!0}}}),t._v(" "),e("van-cell",{attrs:{title:"上传图片"},scopedSlots:t._u([{key:"label",fn:function(){return[e("van-uploader",{attrs:{"after-read":t.afterRead,"max-count":1},model:{value:t.file_list,callback:function(e){t.file_list=e},expression:"file_list"}})]},proxy:!0}])})],1),t._v(" "),e("van-action-sheet",{attrs:{actions:t.actions},on:{select:t.onSelect},model:{value:t.show_code,callback:function(e){t.show_code=e},expression:"show_code"}}),t._v(" "),e("div",{staticClass:"operate"},[e("van-button",{attrs:{disabled:t.no_submit,type:"info"},on:{click:t.submitGreenCode}},[t._v("\n      提交\n    ")])],1)],1)},[],!1,null,"5898b4bb",null).exports}}]);