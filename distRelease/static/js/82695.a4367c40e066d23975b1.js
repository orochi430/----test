"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[82695],{82695:function(t,e,n){n.r(e),n.d(e,{default:function(){return u}});var s=n(66250),e=n(77193),a=(n(85684),n(43567)),i=n(33453),o=n.n(i),r=n(2728),c=n(8250),i=n(42152),l=n.n(i),i={components:(0,e.Z)({},a.Z.Component.name,a.Z.Component),props:["_userdata"],data:function(){return{default_avatar:'this.src="'+n(11727)+'"',userdata:{},showProps:[],docTitle:"",navs:[],deptname:"",actions:[],show:!1,selectNumber:"",btnCopy:null}},methods:{copyText:function(t){var e=this;e.btnCopy.on("success",function(t){dsf.layer.toast("复制成功"),t.clearSelection(),e.btnCopy.destroy()}),e.btnCopy.on("error",function(t){dsf.layer.toast("复制失败"),e.btnCopy.destroy()})},actionCilck:function(t,e){0==e?this.phoneTo(this.selectNumber):2==e?$iaction.savePhoneNumber({phoneNumber:this.selectNumber,name:this.userdata.userName,type:0},function(t){},function(t){}):1==e&&this.copyText(this.selectNumber)},goChat:function(){var t="".concat(dsf.config.IMSetting.OATOIM,"#/SSOLogin?toid=").concat(this.userdata.userId);dsf.util.loadSessionStore("imAccessToken")?t+="&accessToken=".concat(dsf.util.loadSessionStore("imAccessToken")):t+="&logname=".concat(dsf.util.loadSessionStore("user").logName),"app"==dsf.util.getClientName()?c.Z.getIMId()?c.Z.toPrivateChat(this.userdata.userId):xsfWindow.openWebView({title:"即时通讯",url:t,colorString:"#111111"}):dsf.layer.toast("当前菜单仅支持在App中使用")},previewPhoto:function(t){(0,a.Z)({images:[t],closeable:!0})},getPhotoSrc:function(t){return dsf.url.getWebPath(t)},phoneTo:function(t){window.location.href="tel:".concat(t)},smsTo:function(t){window.location.href="sms:".concat(t)},toImgChange:function(){},setTitle:function(){this.$route.query&&this.$route.query.title?r.Z.setTitle(this.$route.query.title):r.Z.setTitle(" ")},goPhonePop:function(e){var t=this;t.selectNumber=e,t.show=!0,t.$nextTick(function(){document.querySelectorAll(".actionStyle").forEach(function(t){t.setAttribute("data-clipboard-text",e)}),t.btnCopy=new(l())(document.querySelectorAll(".actionStyle"))})},onCancel:function(){}},created:function(){var a=this,n=this;n.actions.push({name:"呼叫"}),n.actions.push({name:"复制号码",className:"actionStyle"}),"android"==dsf.util.checkSystem()&&"app"==dsf.util.getClientName()&&n.actions.push({name:"添加到通讯录"}),this.showProps=dsf.config.mailList.mailDetailShow.filter(function(t){return t.ifShow}),this.userdata=this._userdata||JSON.parse(this.$route.query.userdata),n.$toast.loading("加载中"),dsf.http.post("/fn/contacts/getMobileUserDetail",{userId:this.userdata.userId,pk:this.userdata.pk||""}).then(function(){var e=(0,s.Z)(o().mark(function t(e){var s;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("zydx"==dsf.config.projectName)return t.next=3,dsf.util.isMyDept(e.data.data.orgNameLv1Text);t.next=6;break;case 3:if(t.sent){t.next=6;break}e.data.data.mobile="",a.showProps=a.showProps.filter(function(t){return"mobile"!=t.prop});case 6:a.userdata=e.data.data,a.navs=e.data.data.navs,a.navs?null!=(s=a.navs)&&s.forEach(function(t,e){""!=a.deptname&&(a.deptname+="-"),0<e&&(a.deptname+=t.name)}):a.deptname=a.userdata.orgName,n.$toast.clear();case 10:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}())},filters:{filterName:function(t){return t.slice(t.length-2)},filterMobile:function(t,e){return e.mobileDesensitizationSafeContent||t},filterEmail:function(t,e){return e.emailDesensitizationSafeContent||t},userAvatar:function(t){return t.slice(t.length-2)}}},u=(0,n(51900).Z)(i,function(){var s=this,a=s._self._c;return a("div",{directives:[{name:"show",rawName:"v-show",value:s.userdata&&s.userdata.userName,expression:"userdata && userdata.userName"}],staticClass:"mailDetail"},[a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[a("div",{staticClass:"name"},[s._v(s._s(s.userdata.userName))])]),s._v(" "),a("div",{staticClass:"photo"},[s.userdata.photoSrc?a("img",{attrs:{src:s.getPhotoSrc(s.userdata.photoSrc),onerror:s.default_avatar},on:{click:function(t){s.previewPhoto(s.getPhotoSrc(s.userdata.photoSrc))}}}):a("div",{staticClass:"userImg"},[s._v(s._s(s._f("filterName")(s.userdata.userName)))])])]),s._v(" "),s.navs&&s.navs.length?a("div",{staticClass:"orgName"},[s._v(s._s(s.navs[0].name))]):s._e(),s._v(" "),s._l(s.showProps,function(t,e){return a("div",{key:e,staticClass:"propBox"},["userName"==t.prop?a("div",{staticClass:"infoItem disfr"},[a("div",{staticClass:"info flex1 fc jsb"},[a("span",{staticClass:"infoText"},[s._v(s._s(t.text))]),s._v(" "),a("span",{staticClass:"infoName"},[s._v(s._s(s.userdata.userName))])])]):"tel"==t.prop?a("div",{staticClass:"infoItem disfr"},[a("div",{staticClass:"info flex1 fc jsb"},[a("span",{staticClass:"infoText"},[s._v(s._s(t.text))]),s._v(" "),a("span",{staticClass:"infoName infoColor",on:{click:function(t){return s.goPhonePop(s.userdata.tel)}}},[s._v(s._s(s.userdata.tel))]),s._v(" "),s.userdata.tel?a("div",{staticClass:"itemIcon"},[a("img",{attrs:{src:n(2693),alt:""},on:{click:function(t){return s.phoneTo(s.userdata.tel)}}})]):s._e()])]):"mobile"==t.prop?a("div",{staticClass:"infoItem disfr"},[a("div",{staticClass:"info flex1 fc jsb"},[a("span",{staticClass:"infoText"},[s._v(s._s(t.text))]),s._v(" "),a("span",{staticClass:"infoName infoColor",on:{click:function(t){return s.goPhonePop(s.userdata.mobile)}}},[s._v("\n                    "+s._s(s._f("filterMobile")(s.userdata.mobile,s.userdata))+"\n                ")])]),s._v(" "),s.userdata.mobile?a("div",{staticClass:"itemIcon disfr ac"},[a("img",{attrs:{src:n(66628),alt:""},on:{click:function(t){return s.phoneTo(s.userdata.mobile)}}}),s._v(" "),a("i",{staticClass:"iconfont iconletter infoName infoColor",on:{click:function(t){return s.smsTo(s.userdata.mobile)}}})]):s._e()]):"email"==t.prop?a("div",{staticClass:"infoItem disfr"},[a("div",{staticClass:"info flex1 fc jsb"},[a("span",{staticClass:"infoText"},[s._v(s._s(t.text))]),s._v(" "),a("span",{staticClass:"infoName"},[s._v(s._s(s._f("filterEmail")(s.userdata.email,s.userdata)))])]),s._v(" "),a("div",{staticClass:"itemIcon disfr ac"})]):"orgName"==t.prop?a("div",{staticClass:"infoItem disfr"},[a("div",{staticClass:"info flex1 fc jsb"},[a("span",{staticClass:"infoText"},[s._v(s._s(t.text))]),s._v(" "),a("span",{staticClass:"infoName"},[s._v(s._s(s.deptname))])])]):a("div",{staticClass:"infoItem disfr"},[a("div",{staticClass:"info flex1 fc jsb"},[a("span",{staticClass:"infoText"},[s._v(s._s(t.text))]),s._v(" "),a("span",{staticClass:"infoName"},[s._v(s._s(s.userdata[t.prop]))])])])])}),s._v(" "),s.dsf.config.IMSetting&&s.dsf.config.IMSetting.OATOIM?a("div",{staticClass:"btn-container"},[a("van-button",{staticClass:"btn",attrs:{type:"info"},on:{click:s.goChat}},[s._v("发消息\n        ")])],1):s._e(),s._v(" "),a("van-action-sheet",{attrs:{actions:s.actions,"cancel-text":"取消","close-on-click-action":""},on:{cancel:s.onCancel,select:s.actionCilck},model:{value:s.show,callback:function(t){s.show=t},expression:"show"}})],2)},[],!1,null,"d720e97e",null).exports},66628:function(t,e,s){t.exports=s.p+"static/img/mailDetail_phone.c773bcc..png"},2693:function(t,e,s){t.exports=s.p+"static/img/tel.a09f5bc..png"},11727:function(t,e,s){t.exports=s.p+"static/img/default-avatar.ad3a581..png"}}]);