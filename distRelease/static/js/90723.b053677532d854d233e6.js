"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[90723,56229,51669],{56229:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var o,t=a(62680),n=a.n(t),t=a(95366),s=a.n(t),t=a(6919),i=a.n(t),r=a(66250),c=a(77193),t=a(33453),l=a.n(t),t=a(8450),u=a.n(t),t=a(26243),d=a.n(t),t=a(20629),f=a(2728),p=a(25108);function m(t,e){var a,i=d()(t);return n()&&(a=n()(t),e&&(a=a.filter(function(e){return s()(t,e).enumerable})),i.push.apply(i,a)),i}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?m(Object(a),!0).forEach(function(e){(0,c.Z)(t,e,a[e])}):i()?Object.defineProperties(t,i()(a)):m(Object(a)).forEach(function(e){Object.defineProperty(t,e,s()(a,e))})}return t}var t={props:["value","tabKey","checkable","checkType","oppsetTop","tabOppsetTop"],name:"customTabs",model:{prop:"value",event:"input"},components:{defaultList:function(){return Promise.all([a.e(17672),a.e(50856),a.e(63560),a.e(63450),a.e(9303),a.e(74023),a.e(96345),a.e(39946),a.e(1696),a.e(14355)]).then(a.bind(a,14355))},tabTodo:function(){return Promise.all([a.e(17672),a.e(50856),a.e(63560),a.e(9303),a.e(74023),a.e(96345),a.e(33274),a.e(28038)]).then(a.bind(a,33274))},jiangsuyancaoTable:function(){return Promise.all([a.e(26573),a.e(9193)]).then(a.bind(a,26573))},commonForm:function(){return Promise.all([a.e(17672),a.e(42152),a.e(50856),a.e(63560),a.e(63450),a.e(9303),a.e(74023),a.e(96345),a.e(49852),a.e(39946),a.e(1696),a.e(14355),a.e(59655),a.e(86720),a.e(40954),a.e(58930),a.e(13852),a.e(85027),a.e(59146),a.e(80809)]).then(a.bind(a,32444))},ElecHomePage:function(){return a.e(16848).then(a.bind(a,16848))},diskFile:function(){return Promise.all([a.e(97805),a.e(82060),a.e(89590)]).then(a.bind(a,45411))},cdReportIndex:function(){return a.e(8124).then(a.bind(a,8124))}},data:function(){return{active:0,tabParams:{},tabsPage:!1,clickTabIndex:0,routeKey:"",tabsConfig:null,tempKeyWord:"",realKeyWord:"",docTitle:"",showDetailBadge:!1,sticky:!0,goSearchRoute:this.$route.query.goSearch}},computed:h({},(0,t.rn)({isShowAppFooter:function(e){return e.isShowAppFooter},isShowAppHeader:function(e){return e.isShowAppHeader}})),activated:function(){f.Z.setTitle(this.docTitle),this.refreshBadge(this.active),this.tabsConfig.url&&1==this.tabsConfig.tabslist.length&&(this.oppsetTop=dsf.util.getOffsetTop("0.92rem"))},created:function(){var i=this;return(0,r.Z)(l().mark(function e(){var t,a;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((o=i).$route.query.active&&(i.active=Number(i.$route.query.active)),t=dsf.config.commonTabs,i.routeKey=i.tabKey||i.$route.params.key,i.tabsConfig=t[i.routeKey],i.tabsConfig.url)return e.next=8,dsf.http.post(i.tabsConfig.url).then(function(e){200==e.data.code&&(i.tabsConfig.tabslist=e.data.data,1==i.tabsConfig.tabslist.length)&&(i.sticky=!1,setTimeout(function(){$(".commontabs > .van-tabs__wrap").css("display","none"),i.oppsetTop=dsf.util.getOffsetTop("0.92rem")},100))});e.next=8;break;case 8:i.tabsConfig&&(i.docTitle=i.$route.query.title||i.tabsConfig.remark,i.showDetailBadge=i.tabsConfig.showDetailBadge||!1,f.Z.setTitle(i.docTitle),i.tabParams=JSON.parse(u()(i.tabsConfig)),a=[],i.tabParams.tabslist.forEach(function(e){var t=h({},e);t.params&&d()(t.params).forEach(function(e){t.params[e]=dsf.util.getReplaceUrl(t.params[e])}),t.badgeUrl&&(t.badgeUrl=dsf.util.getReplaceUrl(t.badgeUrl),dsf.http.get(t.badgeUrl).then(function(e){i.$delete(t,"badge");e=e.data.total||e.data.badge||e.data.data;i.$set(t,"badge",e)})),t.countUrl&&(t.countUrl=dsf.util.getReplaceUrl(t.countUrl),dsf.http.get(t.countUrl).then(function(e){i.$delete(t,"count");e=e.data.total||e.data.badge||e.data.data;i.$set(t,"count",e)})),t.privilege?null!=(e=dsf.util.loadSessionStore("user"))&&e.privileges.some(function(e){return e.name==t.privilege})&&a.push(t):null!=(e=dsf.util.loadSessionStore("user"))&&e.privileges.some(function(e){return e.name==t.noPrivilege})||a.push(t)}),i.tabParams.tabslist=a),i.$eventBus.onRefreshBadge(i,function(e){i.refreshBadge(e)});case 10:case"end":return e.stop()}},e)}))()},filters:{badgeCount:function(e){return 100<e?o.showDetailBadge?e:"99+":e<1?"":e}},methods:{refreshBadge:function(a){var i=this;this.tabParams.tabslist.forEach(function(t,e){!t.badgeUrl||null!=a&&a!=e||dsf.http.get(t.badgeUrl).then(function(e){e=e.data.total||e.data.badge||e.data.data;i.$set(t,"badge",e)}),!t.countUrl||null!=a&&a!=e||dsf.http.get(t.countUrl,{}).then(function(e){e=e.data.total||e.data.badge||e.data.data;i.$set(t,"count",e)})})},tabChange:function(e,t){p.log(e+"---"+t),this.clickTabIndex=e},onSearch:function(){this.realKeyWord=this.tempKeyWord},onFocus:function(){this.goSearchRoute&&this.$router.push({name:this.goSearchRoute})},cancelCheck:function(){this.$emit("cancelCheck")},confirmCheck:function(e){this.$emit("confirmCheck",e)}},deactivated:function(){var e,t,a=this,i=this;["jiangsuyancaoNewsDetail"].filter(function(e){return e==a.$route.name}).length,dsf.config.setting["SYS-MOBILE-FORM-0020"]&&(e=dsf.config.setting["SYS-MOBILE-FORM-0020"].split(","),t=!1,e.forEach(function(e){i.$route.path.toLowerCase()==e&&(t=!0)}),t)&&(i.$eventBus.Off(this,"refreshBadge"),i.$deleteCache(this))},beforeRouteLeave:function(e,t,a){var i;"commonList"!=e.name&&"index"!=e.name&&"wanHome"!=e.name&&!e.name.toLowerCase().includes("index")||(this.$eventBus.Off(this,"refreshBadge"),i=this,setTimeout(function(){i.$deleteCache(i)},500)),a()}},g=(0,a(51900).Z)(t,function(){var a=this,i=a._self._c;return i("div",{attrs:{id:"common-tabs"}},[a.tabsConfig&&a.tabsConfig.showSearchBox?i("van-search",{attrs:{"show-action":"",placeholder:"请输入查询信息","left-icon":"",clearable:!1},on:{search:a.onSearch,focus:a.onFocus},scopedSlots:a._u([{key:"right-icon",fn:function(){return[i("div",{staticClass:"flex ac",on:{click:a.onSearch}},[i("van-icon",{attrs:{name:"search",size:"0.44rem"}})],1)]},proxy:!0},{key:"action",fn:function(){},proxy:!0}],null,!1,2275234293),model:{value:a.tempKeyWord,callback:function(e){a.tempKeyWord=e},expression:"tempKeyWord"}}):a._e(),a._v(" "),i("van-tabs",{staticClass:"commontabs",attrs:{sticky:a.sticky,"offset-top":a.tabOppsetTop?a.dsf.util.getOffsetTop(a.tabOppsetTop):a.dsf.util.getOffsetTop(),swipeable:"","swipe-threshold":""},on:{change:a.tabChange},model:{value:a.active,callback:function(e){a.active=e},expression:"active"}},a._l(a.tabParams.tabslist,function(e,t){return i("van-tab",{key:t,attrs:{title:"tabs"+e.name,badge:a._f("badgeCount")(e.badge),name:t},scopedSlots:a._u([{key:"title",fn:function(){return[e.icon?i("van-icon",{attrs:{name:e.icon}}):a._e(),a._v(" "),i("span",[a._v(a._s(e.name))]),e.count?i("span",[a._v("("+a._s(a._f("badgeCount")(e.count))+")")]):a._e()]},proxy:!0}],null,!0)},[a._v(" "),"defaultList"==e.goRoute?i("keep-alive",[i("default-list",{attrs:{currentTabs:t,params:e,tabsPage:a.tabsPage,clickTabIndex:a.clickTabIndex,routeKey:a.routeKey,mainKeyWord:a.realKeyWord,oppsetTop:a.oppsetTop||(a.isShowAppHeader?"1.8rem":"0.88rem"),checkable:a.checkable,"check-type-pop":a.checkType},on:{cancelCheck:a.cancelCheck,confirmCheck:a.confirmCheck}})],1):"jiangsuyancaoTable"==e.goRoute?i("jiangsuyancao-table",{attrs:{params:e,oppsetTop:a.isShowAppHeader?"1.8rem":"0.88rem"}}):"elecHomePage"==e.goRoute?i("keep-alive",[i("ElecHomePage",{attrs:{clickTabIndex:a.clickTabIndex,currentTabs:t,tabParams:a.tabParams.tabslist[a.clickTabIndex]}})],1):"commonForm"==e.goRoute?i("commonForm",{attrs:{currentTabs:t,clickTabIndex:a.clickTabIndex,_moduleId:e.params.moduleId,_pk:e.params.pk,_formId:e.params.formId,_params:e.params||{}}}):"diskFile"==e.goRoute?i("diskFile",{attrs:{currentTabs:t,clickTabIndex:a.clickTabIndex,params:e,mainKeyWord:a.realKeyWord}}):"cdReportIndex"==e.goRoute?i("keep-alive",[i("cdReportIndex",{attrs:{currentTabs:t,clickTabIndex:a.clickTabIndex,params:e,mainKeyWord:a.realKeyWord}})],1):i("tab-todo",{attrs:{params:e}})],1)}),1)],1)},[],!1,null,"e00f8b7e",null).exports},85822:function(e,t,o){o.r(t),o.d(t,{default:function(){return l}});var t=o(32444),a=o(48440),i=o(18428),n=o.n(i),i=o(82060),s=o(25108),i={components:{EnclosurePreview:i.default},props:{pk:{type:String,default:function(){}}},data:function(){return{fileUrl:"",imgPreview:!1,previewImg:[],popFile:{},fileShow:!1,appTopMenu:dsf.config.appTopMenu.value,loading:!1,activeNames:0,list:[],errored:!1}},computed:{showList:function(){return this.list.filter(function(e){return e.is_show})}},created:function(){this.loadData()},methods:{setActivity:function(e){var i=this;s.log("activeNames",e),i.showList.forEach(function(e,t,a){e.activity="展开"}),"number"==typeof e?i.showList[e].activity="收起":Array.isArray(e)&&e.forEach(function(e,t,a){i.showList[e].activity="收起"})},loadData:function(){var t=this;dsf.http.post("fn/meetingNotice/getTopic",{pk:t.pk}).done(function(e){"success"==e.type&&(t.list=e.data.map(function(e,t){return n()({},e,{title:"议题".concat(dsf.util.numToHan(t+1),"：").concat(e.title),activity:0==t?"收起":"展开"})}))}).error(function(e){s.log("topics-error",e),dsf.layer.toast("数据获取失败！",!1),t.errored=!0}).always(function(){}),t.loading=!1},onRefresh:function(){this.loadData()},openFile:function(e,t){var a=dsf.util.loadSessionStore("loginToken"),a=(e.navtiveUrl=e.fileName,this.popFile=e,dsf.url.getServerUrl("fn/office/openMobileOffice?fileId=".concat(e.fileId,"&moduleId=").concat(e.moduleId,"&nodeId=").concat(e.flowId,"&x-auth-token=").concat(a,"&screenWidth=").concat(document.body.clientWidth))),i=e.navtiveUrl.lastIndexOf("."),i=e.navtiveUrl.substr(i+1).toLowerCase();"mp4"!=i&&(0==e.navtiveUrl.indexOf("http")&&-1<e.navtiveUrl.indexOf("response-content-type=image")?this.localImgPreview(e.navtiveUrl):-1<["png","jpg","jpeg","bmp","gif"].indexOf(i)?this.localImgPreview(a):"iSignature"==t||"dianJu"==t||dsf.config.commonForm.yzyWps||(navigator.userAgent.includes("DreamSoft"),this.localFilePreviewOrEdit(a,e,t)))},localImgPreview:function(e){this.imgPreview=!0,this.previewImg=[e]},localFilePreviewOrEdit:function(e,t,a){this.fileUrl="edit"==a?t.editUrl:e,dsf.config.commonForm.webViewPreview?(a=dsf.url.getRootPath()+e.replace("../",""),xsfWindow.openWebView({title:t.title,url:a,colorString:"#111111"})):(this.fileShow=!0,this.popFile=t)}},watch:{}},r=o(51900),i=(0,r.Z)(i,function(){var a=this,i=a._self._c;return i("div",{staticClass:"topic-page"},[i("van-pull-refresh",{on:{refresh:a.onRefresh},model:{value:a.loading,callback:function(e){a.loading=e},expression:"loading"}},[a.errored?i("div",[i("commonempty",{attrs:{image:"error",description:"发生错误"}})],1):0<a.showList.length?i("div",[i("div",{staticClass:"topic-list"},[i("van-collapse",{attrs:{accordion:""},on:{change:a.setActivity},model:{value:a.activeNames,callback:function(e){a.activeNames=e},expression:"activeNames"}},a._l(a.showList,function(e,t){return i("van-collapse-item",{key:t,staticClass:"item",attrs:{name:t,value:e.activity},scopedSlots:a._u([{key:"title",fn:function(){return[i("div",{staticClass:"title"},[i("i",{staticClass:"indexicon"},[a._v(a._s(Number(t)+1))]),a._v(a._s(e.title)+"\n                            ")])]},proxy:!0},{key:"default",fn:function(){return[i("div",{staticClass:"item-msg"},[i("div",{staticClass:"box user"},[i("div",{staticClass:"bt"},[i("img",{attrs:{src:o(29728),alt:""}}),a._v("汇报人员\n                                    ")]),a._v(" "),i("div",{staticClass:"text"},[a._v("\n                                        "+a._s(e.reporter)+"    "+a._s(e.reporterDept)+"\n                                    ")])]),a._v(" "),e.is_yd?a._e():i("div",{staticClass:"box team"},[i("div",{staticClass:"bt"},[i("img",{attrs:{src:o(14387),alt:""}}),a._v("列席部门\n                                    ")]),a._v(" "),i("div",{staticClass:"text"},[a._v(a._s(e.attendDept))])]),a._v(" "),0<e.attach.length?i("div",{staticClass:"files"},[i("div",{staticClass:"bt"},[i("img",{attrs:{src:o(73123),alt:""}}),a._v("议题材料\n                                    ")]),a._v(" "),i("div",{staticClass:"files-list"},a._l(e.attach,function(t,e){return i("a",{key:e,on:{click:function(e){return a.openFile(t)}}},[a._v(a._s(t.fileName))])}),0)]):a._e()])]},proxy:!0}],null,!0)})}),1)],1)]):i("div",[i("commonempty",{attrs:{description:"暂无数据"}})],1)]),a._v(" "),i("van-popup",{staticClass:"filePop",attrs:{"get-container":"#app",position:"bottom"},model:{value:a.fileShow,callback:function(e){a.fileShow=e},expression:"fileShow"}},[i("van-nav-bar",{attrs:{title:a.popFile.fileName},on:{"click-left":function(e){a.fileShow=!1},"click-right":function(e){a.fileShow=!1}},scopedSlots:a._u([a.appTopMenu?{key:"left",fn:function(){return[i("van-icon",{attrs:{name:"arrow-left"}}),i("span",[a._v("返回")])]},proxy:!0}:{key:"right",fn:function(){return[i("span",[a._v("关闭")])]},proxy:!0}],null,!0)}),a._v(" "),a.dsf.config.commonForm.LocalDocPreview?i("enclosure-preview",{attrs:{file:a.popFile}}):i("iframe",{key:"".concat(a.popFile.fileId,"_").concat(new Date),attrs:{id:"filePreview",src:a.fileUrl,frameborder:"0"}})],1),a._v(" "),i("van-image-preview",{attrs:{images:a.previewImg,closeable:""},model:{value:a.imgPreview,callback:function(e){a.imgPreview=e},expression:"imgPreview"}})],1)},[],!1,null,"444bffda",null).exports,c=o(25108),t={components:{commonForm:t.default,topic:i,meettingTopic:a.default},data:function(){return{loading:null,meetingPk:this.$route.params.pk,meetingModuleId:this.$route.params.moduleId,topicPk:void 0,topicModuleId:void 0,topicFormId:this.$route.query.topicFormId,tabType:this.$route.query.tabType||"0",active:this.$route.query.tabIdx||0,isShowTab:!1,formData:{main:{A0001:{value:this.$route.params.pk}}},showFile:!1}},created:function(){this.loading=dsf.layer.loading(),this.getTabs(),this.checkFiles()},methods:{checkFiles:function(){var t=this;dsf.http.post("/fn/meetingNotice/getTopic",{pk:this.$route.params.pk}).then(function(e){c.log(e),200==e.data.code&&0<e.data.data.length&&(t.showFile=!0)})},getTabs:function(){var t=this,a=this;"0"==a.tabType?dsf.http.post("fn/meetingApply/getSqData",{pk:a.meetingPk,moduleId:a.meetingModuleId}).done(function(e){200==e.code&&e.data?(a.isShowTab=!0,c.log("getSqData",e.data),a.topicPk=e.data.pk,a.topicModuleId=e.data.moduleId):500==e.code?a.$router.replace({path:"/commonForm/".concat(a.meetingModuleId,"/").concat(a.meetingPk),query:t.$route.query}):dsf.layer.toast("数据获取失败！")}).error(function(e){c.log("error",e),dsf.layer.toast("数据获取失败！")}).always(function(){dsf.layer.closeLoading(a.loading)}):"1"==a.tabType&&(a.isShowTab=!0,a.topicPk=a.meetingPk,a.topicModuleId=a.meetingModuleId,dsf.layer.closeLoading(a.loading))}}},l=(0,r.Z)(t,function(){var t=this,e=t._self._c;return e("div",[t.isShowTab&&t.showFile?e("van-tabs",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[e("van-tab",{attrs:{title:"会议信息"}},[e("common-form",{attrs:{_pk:t.meetingPk,"_module-id":t.meetingModuleId}})],1),t._v(" "),e("van-tab",{attrs:{title:"相关议题"}},[e("meettingTopic",{attrs:{formData:t.formData}})],1)],1):t._e(),t._v(" "),t.showFile?t._e():e("common-form",{attrs:{_pk:t.meetingPk,"_module-id":t.meetingModuleId}})],1)},[],!1,null,"368de5f4",null).exports},73123:function(e,t,a){e.exports=a.p+"static/img/file-text.0105cbd..svg"},14387:function(e,t,a){e.exports=a.p+"static/img/team.4d0d746..svg"},29728:function(e,t,a){e.exports=a.p+"static/img/user.763223b..svg"}}]);