"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[6850],{6850:function(t,e,n){n.r(e),n.d(e,{default:function(){return l}});var a=n(66250),e=n(33453),s=n.n(e),o=n(88561),i=n(25108),e={name:"msgdisclosure",data:function(){return{value:"",data:[],obj_hei:{height:""},docurl:"",office365:"https://doc.pudong.gov.cn:1443/?furl=",loading:!1,finished:!1,start:0,limit:15}},computed:{contentHeight:function(){var t=document.body.clientHeight;return this.obj_hei.height=t-62+"px",this.obj_hei}},created:function(){this.getList()},mounted:function(){},methods:{onSearch:function(t){this.start=0,this.getList()},onClear:function(){this.getList()},toDtail:function(n){var i=this;return(0,a.Z)(s().mark(function t(){var e;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0==n.attachList.length)t.next=12;else{if(e=(new Date).getTime(),e=dsf.url.getServerUrl("fn/file/download?infoId="+n.attachList[0].infoId+"&fileId="+n.attachList[0].id+"&fileName="+n.attachList[0].title+"&nrType="+n.attachList[0].type+"&moduleId="+n.moduleId+"&x-auth-token="+o.Z.loadSessionStore("loginToken"))+"&fullfilename=".concat(e)+n.attachList[0].title,i.docurl=dsf.url.openOffice(e),4==dsf.config.previewSetting.previewType)return t.next=7,dsf.http.post("fn/office/mobile/wpsPreview",{fileId:item.id,readOnly:0<item.canEdit});t.next=9}break;case 7:e=t.sent,i.docurl=e.data.data;case 9:i.$router.push({name:"dsfIframe",params:{url:i.docurl}}),t.next=13;break;case 12:i.dsf.layer.toast("没有对应的文件");case 13:case"end":return t.stop()}},t)}))()},getList:function(){var e=this,t={start:this.start,limit:this.limit,module:"gk",key:this.value};this.start=t.start,dsf.http.post("/fn/mobileXXBS/getkwORgkList",t).then(function(t){200===t.status?(e.data=t.data,e.data.forEach(function(t){t.time=e.getTime(t.time)}),i.log(e.data),e.loading=!1,t.data.length<e.limit&&(e.finished=!0)):e.dsf.layer.toast(t.message)}).catch(function(t){e.dsf.layer.toast(t.message)}).finally(function(){})},getTime:function(t){return dsf.date.format(new Date(t),"yyyy-mm-dd")},onLoad:function(){var n=this,t={start:this.start+this.limit,limit:this.limit,module:"gk",key:this.value};this.start=t.start,dsf.http.post("/fn/mobileXXBS/getkwORgkList",t).then(function(t){if(200===t.status){t.data.forEach(function(t){t.time=n.getTime(t.time)});for(var e=0;e<t.data.length;e++)n.data.push(t.data[e]);n.loading=!1,t.data.length<n.limit&&(n.finished=!0)}else n.dsf.layer.toast(t.message)}).catch(function(t){n.dsf.layer.toast(t.message)}).finally(function(){n.loading=!1})}}},l=(0,n(51900).Z)(e,function(){var n=this,t=n._self._c;return t("div",{staticClass:"ds-announcement"},[t("div",{staticClass:"announcement-search"},[t("form",{attrs:{action:"/"}},[t("van-search",{attrs:{placeholder:"搜索"},on:{search:n.onSearch,clear:n.onClear},model:{value:n.value,callback:function(t){n.value=t},expression:"value"}})],1)]),n._v(" "),t("div",{staticClass:"announcement-list",style:n.contentHeight},[t("div",{staticClass:"announcement-list-inner"},[t("van-list",{attrs:{finished:n.finished,"immediate-check":!1,"finished-text":"没有更多了"},on:{load:n.onLoad},model:{value:n.loading,callback:function(t){n.loading=t},expression:"loading"}},n._l(n.data,function(e){return t("div",{key:e.id,staticClass:"announcement-list-content",on:{click:function(t){return n.toDtail(e)}}},[t("div",{staticClass:"announcement-list-content-tit clamp"},[n._v(n._s(e.title))]),n._v(" "),t("div",{staticClass:"announcement-list-time"},[t("div",{staticClass:"announcement-list-time-left"},[t("i",{staticClass:"iconfont"},[n._v("")]),n._v(" "),t("span",[n._v(n._s(e.userName))])]),n._v(" "),t("div",{staticClass:"announcement-list-time-right"},[t("i",{staticClass:"iconfont"},[n._v("")]),n._v(" "),t("span",[n._v(n._s(e.time))])])])])}),0)],1)])])},[],!1,null,null,null).exports}}]);