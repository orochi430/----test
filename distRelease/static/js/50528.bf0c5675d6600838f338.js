"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[50528],{50528:function(t,e,n){n.r(e),n.d(e,{default:function(){return a}});var i=n(25108),e={name:"meetingEnter",components:{},data:function(){return{active:0,ybm:0,wbm:0,checked:!0,List:[],dialogShow:!1,text:"您有会议【".concat(this.$route.query.name,"】需要报名，请您尽快报名"),flag:!1}},computed:{},watch:{active:function(t){var e=this;i.log(t),this.$nextTick(function(){e.getData()})}},methods:{infoClick:function(t){"未读"!=t.statusName&&"已读"!=t.statusName&&("1"==t.remoteType?this.$router.push({path:"/commonForm/".concat(t.moduleId,"/").concat(t.id,"?listId=MeetingBmList&method=viewFkb&validateByList=1&tzlx=").concat(t.tzlx,"&remoteStatus=").concat(t.remoteType)}):this.$router.push({path:"/commonForm/".concat(t.moduleId,"/").concat(t.id,"?listId=MeetingBmList&method=viewBmb&validateByList=1&tzlx=").concat(t.tzlx)}))},checkChange:function(t){i.log(this.List)},btn1Click:function(){var a=this,s="";this.List.forEach(function(t){t.data.forEach(function(t,e){t.checked&&(s+=""==s?t.id:","+t.id,a.wbm--)})}),s?(i.log(s),dsf.http.post("/fn/meetingNotice/revoke",{pk:s}).done(function(t){i.log(t),"200"==t.code?(dsf.layer.toast(t.message),a.getData()):dsf.layer.toast(t.message)})):dsf.layer.toast("请至少选择一个人员或部门")},btn2Click:function(){var a="",s=!1;this.List.forEach(function(t){t.data.forEach(function(t,e){t.checked&&("已报名"==t.statusName&&(s=!0),a+=""==a?t.id:","+t.id)})}),s?dsf.layer.toast("存在已报名人员，请重新选择"):a?(this.dialogShow=!this.dialogShow,i.log(a)):dsf.layer.toast("请至少选择一个人员或部门")},btn3Click:function(){var e,a=this,s=!1;this.List.forEach(function(t){t.data.forEach(function(t){"无需报名"==t.statusName&&t.checked&&(s=!0)})}),s?dsf.layer.toast("无需报名人员不可重报，请重新选择"):(e="",this.List.forEach(function(t){t.data.forEach(function(t){t.checked&&(e+=""==e?t.id:","+t.id,a.ybm--,a.wbm++)})}),e?(i.log(e),dsf.http.post("/fn/meetingNotice/backNotice",{pk:e}).done(function(t){i.log(t),"200"==t.code?(dsf.layer.toast(t.message),a.getData()):dsf.layer.toast(t.message)})):dsf.layer.toast("请至少选择一个人员"))},btn4Click:function(){var e=this,a="";this.List.forEach(function(t){t.data.forEach(function(t,e){t.checked&&(a+=""==a?t.id:","+t.id)})}),a?dsf.http.post("/fn/meetingNotice/remind",{pk:a,content:this.text}).done(function(t){i.log(t),"200"==t.code?(dsf.layer.toast(t.message),e.dialogShow=!e.dialogShow,e.getData(),e.List.forEach(function(t){t.data.forEach(function(t,e){t.checked=!1})})):dsf.layer.toast(t.message)}):dsf.layer.toast("请至少选择一个人员或部门")},getData:function(){var e=this;dsf.http.post("fn/meetingNotice/getBmDetailData",{noticeId:this.$route.query.pk,type:0==this.active?"all":1==this.active?"wbm":"ybm"}).done(function(t){i.log(t),0==e.active&&(e.ybm=0,e.wbm=0),e.List=[],"200"==t.code?(t.data&&(e.List=t.data,e.List.forEach(function(t){e.$set(t,"show",!0),t.data.forEach(function(t){e.$set(t,"checked",!1)}),0==e.active&&(e.ybm+=t.ybm,e.wbm+=t.wbm)}),i.log(e.List)),e.flag=!0):dsf.layer.toast(t.message)})},canCleClick:function(t){var e=this;dsf.http.post("ctrl/meetingNotice/revoke",{pk:t.id}).done(function(t){i.log(t),"200"==t.code?e.getData():dsf.layer.toast(t.message)})}},created:function(){},mounted:function(){this.getData(),i.log(this.$route.query.name)},destroyed:function(){}},a=(0,n(51900).Z)(e,function(){var t,s=this,i=s._self._c;return s.flag?i("div",{staticClass:"meetEnter"},[i("van-tabs",{attrs:{color:"#0075CD"},model:{value:s.active,callback:function(t){s.active=t},expression:"active"}},[i("van-tab",{attrs:{title:"全部(".concat(s.ybm+s.wbm,")")}}),s._v(" "),i("van-tab",{attrs:{title:"未报名(".concat(s.wbm,")")}}),s._v(" "),i("van-tab",{attrs:{title:"已报名(".concat(s.ybm,")")}})],1),s._v(" "),0<s.List.length?i("div",{staticClass:"content",style:{top:s.$store.state.isShowAppHeader?"1.84rem":"0.92rem"}},s._l(s.List,function(a,t){return i("div",{key:t,staticClass:"card"},[i("div",{staticClass:"title"},[i("div",{staticClass:"title-box"},[i("i"),s._v(s._s(a.name)+"\n          "),0==s.active&&0<a.ybm+a.wbm?i("label",{attrs:{for:""}},[s._v("（"+s._s(a.ybm)+"/"+s._s(a.ybm+a.wbm)+"）")]):s._e()]),s._v(" "),i("van-switch",{attrs:{size:"20px"},model:{value:a.show,callback:function(t){s.$set(a,"show",t)},expression:"item.show"}})],1),s._v(" "),a.show?i("ul",s._l(a.data,function(e,t){return i("li",{key:t},[i("van-swipe-cell",{scopedSlots:s._u([{key:"right",fn:function(){var t;return["-1"!=e.jsStatus||null!=(t=s.dsf.config.meetProjectconfig)&&t.BGTsingUpInfo?s._e():i("van-button",{attrs:{square:"",type:"danger",text:"撤回"},on:{click:function(t){return s.canCleClick(e)}}})]},proxy:!0}],null,!0)},[i("div",{staticClass:"list-main"},[i("div",{staticClass:"list-top"},[i("van-checkbox",{attrs:{"icon-size":"14px",shape:"square"},on:{change:function(t){return s.checkChange(e)}},model:{value:e.checked,callback:function(t){s.$set(e,"checked",t)},expression:"ele.checked"}}),s._v(" "),i("div",{staticClass:"info",on:{click:function(t){return s.infoClick(e)}}},[a.name.includes("部门")?i("img",{attrs:{src:n(10749),alt:""}}):i("img",{attrs:{src:n(87897),alt:""}}),s._v(" "),i("div",[i("div",[i("span",[s._v(s._s(e.name))]),s._v(" "),i("label",{class:{YiDu:"已读"==e.statusName,WeiTuo:"委托他人"==e.statusName,QinJia:"已请假"==e.statusName,BaoMing:"已报名"==e.statusName},attrs:{for:""}},[s._v(s._s(e.statusName))])])])])],1),s._v(" "),e.chr||e.wtr?i("p",{staticClass:"list-text"},[s._v("\n              "+s._s(e.chr?"参会人："+e.chr:"委托人:"+e.wtr)+"\n            ")]):s._e(),s._v(" "),e.bzValue?i("p",{staticClass:"list-text"},[s._v("\n              请假理由："+s._s(e.bzValue)+"\n            ")]):s._e()])])],1)}),0):s._e()])}),0):i("div",{staticClass:"content",style:{top:s.$store.state.isShowAppHeader?"1.84rem":"0.92rem"}},[i("commonempty",{staticClass:"meeting-empty",attrs:{image:n(96996),description:"暂无反馈情况"}})],1),s._v(" "),null!=(t=s.dsf.config.meetProjectconfig)&&t.BGTsingUpInfo?s._e():i("div",{staticClass:"footer"},[2!=s.active?i("button",{staticClass:"btn1",on:{click:s.btn1Click}},[s._v("\n      取消通知\n    ")]):s._e(),s._v(" "),2!=s.active?i("button",{staticClass:"btn2",on:{click:s.btn2Click}},[s._v("\n      未报名提醒\n    ")]):s._e(),s._v(" "),2!=s.active||null!=(t=s.dsf.config.meetProjectconfig)&&t.JAQsingUpInfo?s._e():i("button",{staticClass:"btn2",on:{click:s.btn3Click}},[s._v("重报")])]),s._v(" "),i("van-action-sheet",{attrs:{title:"提醒"},model:{value:s.dialogShow,callback:function(t){s.dialogShow=t},expression:"dialogShow"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:s.text,expression:"text"}],attrs:{name:"",id:"",rows:"10"},domProps:{value:s.text},on:{input:function(t){t.target.composing||(s.text=t.target.value)}}}),s._v(" "),i("van-button",{attrs:{type:"primary"},on:{click:s.btn4Click}},[s._v("确定")])],1)],1):s._e()},[],!1,null,"31471ebf",null).exports},10749:function(t,e,a){t.exports=a.p+"static/img/hy-dept.28f5070..png"},87897:function(t,e,a){t.exports=a.p+"static/img/hy-user.edae47f..png"},96996:function(t,e,a){t.exports=a.p+"static/img/img_hyap.6dd1a5b..png"}}]);