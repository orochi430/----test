"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[96396],{31255:function(e,t,n){n.r(t);var c=n(5044),a=(n(8450),n(73473)),o=n.n(a),a=n(79529),s=n.n(a),u=(n(43562),n(90541)),r=n(88561),l=n(25108),a={};a.handle=function(e,t){};function d(e){var t,n,a,o,s;return e?(t=(e=new Date(e)).getFullYear(),n=e.getMonth()+1,a=e.getDate(),o=e.getHours(),s=e.getMinutes(),e=e.getSeconds(),t+"-"+i(n)+"-"+i(a)+" "+i(o)+":"+i(s)+":"+i(e)):""}function i(e){return e=s()(e)<10?"0"+e:e}a.initHandle=function(o,s,i){o.main["c-meetingsq-009"].value;var t=r.Z.loadSessionStore("checkedMettingRoom")?r.Z.loadSessionStore("checkedMettingRoom").value:null,e=i.formMeta.controls.filter(function(e){return"c-meetingsq-009"==e.metaId}),a=(t&&e.length&&e[0].enumData&&(e=e[0].enumData.filter(function(e){return e.value==t})[0],i.$set(i.formData.main,"c-meetingsq-009",{value:e.value,text:e.text})),t&&r.Z.loadSessionStore("checkedMettingStime")&&(i.$set(i.formData.main,"c-meetingsq-007",{value:r.Z.loadSessionStore("checkedMettingStime").value}),i.$set(i.formData.main,"c-meetingsq-008",{value:moment(new Date(r.Z.loadSessionStore("checkedMettingStime").value)).add(2,"hours").format("YYYY-MM-DD HH:mm")})),m(o.main["c-meetingsq-075"].value||"",1),i.$bus.on("selectDateTime",function(e){"c-meetingsq-007"==e.metaData.metaId&&u.Z.http.post("/fn/meetingType/getMeetingType",{meetingTypeId:o.main["c-meetingsq-075"].value}).then(function(e){200==e.data.code&&e.data.data&&(e.data.data.duration&&0!=e.data.data.duration?i.$set(o.main,"c-meetingsq-008",{value:d(Number(36e5*e.data.data.duration)+Number(new Date(o.main["c-meetingsq-007"].value).getTime()))}):i.$set(o.main,"c-meetingsq-008",{value:""}))})}),i.$bus.on("checkVal",function(e){var t;l.log(e),"c-meetingsq-009"==e.metaData.metaId&&(0<o.multinfos["220722142648kKYetU59O4DmtskAkoA"].rows.length&&o.multinfos["220722142648kKYetU59O4DmtskAkoA"].rows.forEach(function(e,t){i.$set(o.multinfos["220722142648kKYetU59O4DmtskAkoA"].rows[t],"action","Deleted")}),t=e.value,u.Z.http.post("/fn/meetingRoom/getMeetingRoomDefaultResource",{roomId:t}).then(function(e){l.log(e),e&&e.data&&e.data.data&&e.data.data.dzValue&&i.$set(o.main,"c-meetingsq-122",{value:e.data.data.dzValue,text:e.data.data.hymrzyText})})),"c-meetingsq-075"==e.metaData.metaId&&m(e.value,0)}),i.$bus.on("blurBus",function(t){var n;l.log(t),"C-MEETING-RESOURCE-005"==t.metaData.metaId&&(n=o.multinfos[t.subFormId].rows[t.subFormIndex],a.forEach(function(e){e.id==n&&e.maxVal&&Number(t.value)<Number(e.maxVal+1)&&(u.Z.layer.toast("".concat(e.name,"的最大数量为").concat(e.maxVal,",请重新填写")),i.$set(o.multinfos[t.subFormId].rows[t.subFormIndex],"C-MEETING-RESOURCE-005",{value:""}))}))}),n(),[]);function n(){for(var t in o.multinfos)if(0<o.multinfos[t].rows.length)for(var e=function(a){for(var e in s.subform)!function(n){i.formData.multinfos[n]&&i.$watch(function(){return i.formData.multinfos[n].rows},function(e,t){o.multinfos[n].rows[a].structControl.forEach(function(e){"资源分类id"==e.label&&(e.show=0),"资源id"==e.label&&(e.show=0),"是否填写数量"==e.label&&(e.show=0)})},{deep:!0,immediate:!0})}(e);o.multinfos[t].rows.forEach(function(e){"-1"==e["C-MEETING-RESOURCE-006"].value&&e.structControl.forEach(function(e){"数量"==e.label&&(e.show=0)})})},n=0;n<o.multinfos[t].rows.length;n++)e(n)}function m(e,n){var t=["出席领导","列席领导","出席部门","列席部门","出席单位","出席人员","列席人员","特邀人员","外单位人员","列席单位","工作人员","参会人员"];s.controls.forEach(function(e){t.includes(e.label)&&(e.show=0)}),u.Z.http.post("/fn/meetingType/getMeetingType",{meetingTypeId:e}).then(function(e){var t;l.log(e),200==e.data.code&&e.data.data&&((t=e.data.data).chdxText&&(t.chdxText+="参会人员",s.controls.forEach(function(e){t.chdxText.includes(e.label)&&(e.show=1)})),n||(t.duration&&0!=t.duration&&o&&!o.main["c-meetingsq-008"].value&&i.$set(o.main,"c-meetingsq-008",{value:d(Number(36e5*t.duration)+Number(new Date(o.main["c-meetingsq-007"].value).getTime()))}),i.$set(o.main,"c-meetingsq-052",{value:t.nonvotingLeader,text:t.nonvotingLeaderText,schema:t.nonvotingLeaderSchema}),i.$set(o.main,"c-meetingsq-115",{value:t.lxLeader,text:t.lxLeaderText,schema:t.lxLeaderSchema}),i.$set(o.main,"c-meetingsq-042",{value:t.chbm,text:t.chbmText,schema:t.chbmSchema}),i.$set(o.main,"c-meetingsq-043",{value:t.lxbm,text:t.lxbmText,schema:t.lxbmSchema}),i.$set(o.main,"c-meetingsq-116",{value:t.cxUnit,text:t.cxUnitText,schema:t.cxUnitSchema}),i.$set(o.main,"c-meetingsq-117",{value:t.lxUnit,text:t.lxUnitText,schema:t.lxUnitSchema}),i.$set(o.main,"c-meetingsq-013",{value:t.chr,text:t.chrText,schema:t.chrSchema}),i.$set(o.main,"c-meetingsq-053",{value:t.lxUser,text:t.lxUserText,schema:t.lxUserSchema}),i.$set(o.main,"c-meetingsq-118",{value:t.tyUser,text:t.tyUserText,schema:t.tyUserSchema}),i.$set(o.main,"c-meetingsq-112",{value:t.workUser,text:t.workUserText,schema:t.workUserSchema}),i.$set(o.main,"c-meetingsq-050",{value:t.wdwUser,text:t.wdwUserText,schema:t.wdwUserSchema}),t.isYtLx&&"1"==t.isYtLx?i.formMeta.controls.forEach(function(e){"4PheCMgUGJoh5do8"==e.controlId&&i.$set(e,"show",1),"vyOGRsirWy2juycU"==e.controlId&&i.$set(e,"show",1)}):i.formMeta.controls.forEach(function(e){"4PheCMgUGJoh5do8"==e.controlId&&i.$set(e,"show",0),"vyOGRsirWy2juycU"==e.controlId&&i.$set(e,"show",0)})))})}i.$bus.on("subFormTreeSelect",function(e){l.log(e),e.selectArr.forEach(function(t,e){o.multinfos["220722142648kKYetU59O4DmtskAkoA"].rows.find(function(e){return e["220722142648kKYetU59O4DmtskAkoA"].value==t.id})||(a.find(function(e){return e.id==t.id})||a.push({id:t.id,name:t.name,maxVal:t.attrs.limitMaxNum}),i.$refs.formTab[0]&&i.$refs.formTab[0].$refs["220722142648kKYetU59O4DmtskAkoA"][0].$refs.subform.addCard(!1).then(function(e){i.$set(e,"C-MEETING-RESOURCE-001",{value:t.attrs.resourceTypeText}),i.$set(e,"C-MEETING-RESOURCE-003",{value:t.name}),i.$set(e,"C-MEETING-RESOURCE-002",{value:t.attrs.resourceTypeId}),i.$set(e,"C-MEETING-RESOURCE-004",{value:t.id}),i.$set(e,"C-MEETING-RESOURCE-006",{value:t.attrs.isWirteNum,text:0<t.attrs.isWirteNum?"是":"否"}),t.attrs.isWirteNum<0&&(e.structControl.find(function(e){return"C-MEETING-RESOURCE-005"==e.metaId}).show=!1)}).then(function(){n()}))})})},a.saveFilter=function(s,e,i){function m(e){return l.log(e),e.replace(/-/g,"/")}return new(o())(function(n,a){try{var e=Date.parse(m(s.main["c-meetingsq-007"].value))||"",t=Date.parse(m(s.main["c-meetingsq-008"].value))||"",o=new Date;l.log(e,t),e&&t?i.$route.query.todoId?n():e<o?a("开始时间已过"):t<=e?a("结束时间必须大于开始时间"):u.Z.http.post("fn/meetingRoomOccupy/checkRoomOccupy",{pk:s.main.B0035.value,hys:s.main["c-meetingsq-009"].value,sdate:s.main["c-meetingsq-007"].value,edate:s.main["c-meetingsq-008"].value}).done(function(e){var t;"success"==e.type?(t=[].concat((0,c.Z)(i.formButtons.mainButtons),(0,c.Z)(i.formButtons.commonButtons)).find(function(e){return"send"==e.action}))&&t.parameters?u.Z.http.post("/fn/meetingRoom/getFlowByHys",{hys:s.main["c-meetingsq-009"].value}).done(function(e){"success"==e.type&&e.data&&(t.parameters.find(function(e){return"wfId"==e.key}).value=e.data),n()}):n():a(e.message)}):a("请填写会议时间")}catch(e){l.log(e),n()}})},a.hysydSend=function(n,e,a){u.Z.http.post("fn/meetingRoomOccupy/checkRoomOccupy",{pk:n.main.B0035.value,hys:n.main["c-meetingsq-009"].value,sdate:n.main["c-meetingsq-007"].value,edate:n.main["c-meetingsq-008"].value}).done(function(e){var t;"success"==e.type?(t=[].concat((0,c.Z)(a.formButtons.mainButtons),(0,c.Z)(a.formButtons.commonButtons)).find(function(e){return"send"==e.action}))&&t.parameters?u.Z.http.post("/fn/meetingRoom/getFlowByHys",{hys:n.main["c-meetingsq-009"].value}).done(function(e){"success"==e.type&&e.data&&(t.parameters.find(function(e){return"wfId"==e.key}).value=e.data),a.btnAction("send")}):a.btnAction("send"):u.Z.layer.toast(e.message,!1)})},t.default=a}}]);