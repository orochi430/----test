"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[55840],{11650:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});var n=a(25108),e={props:["value","columns","metaData","checkedVal"],data:function(){return{showPopup:this.value,nextPopup:!1,textTemp:""}},watch:{value:function(){this.showPopup=this.value}},methods:{pupupClose:function(){this.$emit("input",this.showPopup),this.$emit("pupopClose",this.showPopup)},selectValue:function(t){n.log(t),this.textTemp&&(t={text:this.textTemp,value:this.textTemp},this.textTemp=""),t.children||(this.showPopup=!this.showPopup),this.$emit("input",this.showPopup),this.$emit("selectItem",t)}},created:function(){}},s=(0,a(51900).Z)(e,function(){var a=this,t=a._self._c;return t("van-popup",{staticClass:"flex dc",staticStyle:{height:"60vh"},attrs:{"get-container":"#app",position:"bottom",round:""},on:{close:a.pupupClose},model:{value:a.showPopup,callback:function(t){a.showPopup=t},expression:"showPopup"}},[t("div",{staticClass:"popup-title"},[t("i",{staticClass:"iconfont iconxialajiantou",attrs:{size:"0.4rem"},on:{click:function(t){a.showPopup=!1}}}),a._v(" "),t("span",[a._v("选择")])]),a._v(" "),t("div",{staticClass:"choose-container"},a._l(a.columns.columns,function(e){return t("div",{staticClass:"choose-col flex jb",on:{click:function(t){return a.selectValue(e)}}},[t("span",{staticClass:"elps"},[a._v(a._s(e.text))]),a._v(" "),e.value==a.checkedVal?t("i",{staticClass:"iconfont iconcheck"}):a._e()])}),0)])},[],!1,null,"758e7a0f",null).exports},55840:function(t,e,a){a.r(e),a.d(e,{default:function(){return i}});var n=a(66250),e=a(33453),s=a.n(e),e=a(70596),o=a.n(e),e={name:"commonStatistic",components:{controlDialog:a(11650).default},props:{},data:function(){return{startDate:"2023-08-01",endDate:dsf.date.format(new Date,"yyyy-mm-dd"),moduleName:{text:"",value:""},showDate:!1,changeDateType:"",minDate:new Date((new Date).getFullYear()-5,0,1),maxDate:new Date((new Date).getFullYear()+5,11,31),showPopup:!1,columns:{columns:[]},departData:{names:[],values1:[],values2:[]}}},created:function(){},mounted:function(){this.getModuleIds()},methods:{initEchart:function(){var t=o().init(this.$refs.barEchart),e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:"2%",right:"center"},color:["#5470C6","#FAC858"],grid:{left:"3%",right:"4%",bottom:"8%",top:"8%",containLabel:!0},xAxis:{type:"value",minInterval:1,axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"#ccc"}},axisLabel:{color:"#666",fontSize:14},splitLine:{show:!1}},yAxis:{type:"category",axisLine:{show:!0,lineStyle:{color:"#ccc"}},axisLabel:{color:"#666",fontSize:14,interval:0,formatter:function(t){var e="",a=t.length,n=Math.ceil(a/10);if(10<a)for(var s=0;s<n;s++){var o=10*s,i=10+o;e+=s==n-1?t.substring(o,a):t.substring(o,i)+"\n"}else e=t;return e}},axisTick:{show:!1},data:this.departData.names},series:[{name:"已办结",type:"bar",stack:"total",label:{show:!0,color:"#333",position:"inside",fontSize:12,formatter:function(t){return 0<t.value?t.value:""}},barCategoryGap:"30%",barMaxWidth:40,data:this.departData.values1},{name:"流转中",type:"bar",stack:"total",label:{show:!0,color:"#333",position:"inside",fontSize:12,formatter:function(t){return 0<t.value?t.value:""}},barCategoryGap:"30%",barMaxWidth:40,data:this.departData.values2}]};t.setOption(e,!0),window.onresize=function(){t.resize()}},changeDate:function(t){this.showDate=!0,this.changeDateType=t},onConfirm:function(t){this.showDate=!1;t=moment(t).format("yyyy-MM-DD");"start"==this.changeDateType&&new Date(t).getTime()>new Date(this.endDate).getTime()||"end"==this.changeDateType&&new Date(this.startDate).getTime()>new Date(t).getTime()?this.$toast.fail("结束时间必须大于开始时间"):("start"==this.changeDateType?this.startDate=t:this.endDate=t,this.getModuleData())},getModuleIds:function(){var e=this;dsf.http.get("ctrl/statistical/modusage/queryModuleIds").then(function(t){t&&t.data&&200==t.data.code&&(e.columns.columns=t.data.data.map(function(t){return{text:t.moName,value:t.moId}}),e.moduleName=e.columns.columns[0],e.getModuleData())})},selectedModule:function(t){this.moduleName=t,this.getModuleData()},getModuleData:function(){var a=this;return(0,n.Z)(s().mark(function t(){var e;return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(e=a).departData={names:[],values1:[],values2:[]},t.next=4,dsf.http.post("ctrl/statistical/business/appQueryModuleData",{moduleId:a.moduleName.value,startTime:a.startDate,endTime:a.endDate}).then(function(t){t&&t.data&&200==t.data.code&&(t.data.data.reverse().forEach(function(t){e.departData.names.push(t.orgName),e.departData.values1.push(t.concludeNum),e.departData.values2.push(t.turnoverNum)}),e.$nextTick(function(){e.initEchart()}))});case 4:case"end":return t.stop()}},t)}))()}},computed:{},watch:{}},i=(0,a(51900).Z)(e,function(){var e=this,t=e._self._c;return t("div",{staticClass:"commonStatistic",style:{height:"calc(100vh - ".concat(e.dsf.util.getOffsetTop(),")")}},[t("van-sticky",{attrs:{"offset-top":e.dsf.util.getOffsetTop()}},[t("div",{staticClass:"top-select"},[t("div",{staticClass:"select-contain"},[e._v("\n                开始日期："),t("p",{on:{click:function(t){return e.changeDate("start")}}},[e._v(e._s(e.startDate))])]),e._v(" "),t("div",{staticClass:"select-contain"},[e._v("\n                结束日期："),t("p",{on:{click:function(t){return e.changeDate("end")}}},[e._v(e._s(e.endDate))])]),e._v(" "),t("div",{staticClass:"select-contain"},[e._v("\n                文件类型："),t("p",{on:{click:function(t){e.showPopup=!0}}},[e._v(e._s(e.moduleName.text)+"\n                    "),t("i",{staticClass:"iconfont iconsanjiaoyou"})])])])]),e._v(" "),t("div",{staticClass:"echart-content"},[t("div",{staticClass:"content-title"},[t("i"),e._v(" "),t("p",[e._v(e._s(e.moduleName.text))])]),e._v(" "),t("div",{ref:"barEchart",staticClass:"barEchart"})]),e._v(" "),t("van-calendar",{attrs:{"min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.onConfirm},model:{value:e.showDate,callback:function(t){e.showDate=t},expression:"showDate"}}),e._v(" "),t("control-dialog",{attrs:{columns:e.columns,checkedVal:e.moduleName.value},on:{selectItem:e.selectedModule,pupopClose:function(t){e.showPopup=!1}},model:{value:e.showPopup,callback:function(t){e.showPopup=t},expression:"showPopup"}})],1)},[],!1,null,"24809715",null).exports}}]);