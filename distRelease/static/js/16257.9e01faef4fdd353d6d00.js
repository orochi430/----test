(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[16257],{3896:function(e,t,a){a(94058),a(91867),a(73871),a(54138),a(82834),a(605),a(85828),e.exports=a(34579).Map},54138:function(e,t,a){"use strict";var n=a(56175),i=a(20765),o="Map";e.exports=a(32269)(o,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){e=n.getEntry(i(this,o),e);return e&&e.v},set:function(e,t){return n.def(i(this,o),0===e?0:e,t)}},n,!0)},85828:function(e,t,a){a(6237)("Map")},605:function(e,t,a){a(46730)("Map")},82834:function(e,t,a){var n=a(83856);n(n.P+n.R,"Map",{toJSON:a(61718)("Map")})},16257:function(e,t,a){"use strict";a.d(t,{Z:function(){return h}});var i=a(5044),t=a(18281),o=a.n(t),n=a(12888),s=a(90541),r=a(25108),t={name:"timePicker",props:{touchable:{type:Boolean,default:!0,desc:"能否手动滑动切换"},clickMode:{type:String,default:"month",desc:"切换按钮的切换模式 可选month/week"},endSliderCallBack:{type:Function,default:function(){return!1},desc:"自定义滑动完成之后触发的回调函数"},defaultDate:{type:String,default:moment().format("YYYY-MM-DD"),desc:"传入的时间 格式为2020-01-01这样"},activeBgcolor:{type:String,default:"#35c",desc:"选中日期的背景颜色"},activeTextcolor:{type:String,default:"#FFF",desc:"选中日期的文字颜色"},todayDotcolor:{type:String,default:"#fff",desc:"当前日期下小点的颜色"},havaSch:{type:Array,default:function(){return[]}},startNumber:{type:Number,default:1,desc:"日期从星期几开始,默认为1表示星期一开始到星期天,取值范围1-7"},language:{type:String,default:"ch",desc:"显示的文字是英语还是汉字,能结合startNumber来自动偏移"},cancelChecked:{type:Boolean,default:!1},curyear:{type:Number},curmonth:{type:Number},isShowMonth:{type:Boolean,default:!0}},data:function(){return{prev_now_next:[],currentIndex:1,weekLanguages:{},checkedDate:"",currentMonth:[],defaultShowType:"week",reWriter:"",sdate:"",edate:"",holidayMonth:[]}},computed:{getYearMonth:function(){var e=this.reWriter||this.prev_now_next[1][0].date,t=!1,a=(this.prev_now_next[1].forEach(function(e){e.isToday&&(t=!0)}),(e=t&&!this.reWriter?this.defaultDate:e).split("-")[0]+"年"+e.split("-")[1]+"月");return this.$emit("update:curyear",moment(e).year()),this.$emit("update:curmonth",moment(e).month()),a}},watch:{cancelChecked:function(e){""!=this.reWriter&&s.Z.config.homePage.schedule.defaultToday?this.checkedDate=this.reWriter:s.Z.config.homePage.schedule.defaultToday&&(this.checkedDate=this.defaultDate)}},created:function(){this.initTimer(this.defaultDate)},mounted:function(){this.getDataday()},activated:function(){},deactivated:function(){},methods:{initTimer:function(e){for(var t in this.checkedDate="",this.weekLanguages={ch:["一","二","三","四","五","六","日"],en:["Mon","Tue","Wed","Thur","Fri","Sat","Sun"],pos:[1,2,3,4,5,6,7]},this.weekLanguages)this.weekLanguages[t]=this.weekLanguages[t].slice(this.startNumber-1).concat(this.weekLanguages[t].slice(0,this.startNumber-1));for(var a=0;a<3;a++)this.prev_now_next.push(this.getWeekInfo(moment(e).add(7*a-7,"d").format("YYYY-MM-DD")));s.Z.config.homePage.schedule.defaultToday&&this.dateClick({date:s.Z.date.format(new Date,"yyyy-mm-dd")}),this.currentMonth=this.getFullMonth(e),this.$emit("thisMonth",this.currentMonth),this.$emit("thisWeek",this.prev_now_next[1])},reGetprev_now_next:function(e){this.prev_now_next=[];for(var t=0;t<3;t++)this.prev_now_next.push(this.getWeekInfo(moment(e).add(7*t-7,"d").format("YYYY-MM-DD")))},getWeekInfo:function(e){for(var t=Number(moment(e).format("E")),a=[],n=moment(),i=(moment(this.defaultDate),0);i<7;i++){var o=moment(e).subtract(this.weekLanguages.pos.indexOf(t)-i,"d");a.push({date:o.format("YYYY-MM-DD"),isToday:n.format("YYYY-MM-DD")===o.format("YYYY-MM-DD"),week:this.weekLanguages[this.language][i]})}return a},addSch:function(e){return-1!=this.havaSch.indexOf(e)},dateClick:function(e){e.date,this.checkedDate,this.checkedDate=e.date,this.$emit("checkedDate",this.checkedDate),this.reWriter=this.checkedDate},defaultDateShow:function(e){this.checkedDate=e.date},judgeChecked:function(e){return e==this.checkedDate},isToday:function(e){return e==moment(Date.now()).format("yyyy-MM-DD")},isHoliday:function(t){var e=this.holidayMonth.find(function(e){return t==e.date});return!(!e||1==e.type||this.isToday(t)||this.judgeChecked(t))},prevClick:function(){"week"==this.clickMode?this.$refs.swiperCon.prev():"month"==this.clickMode&&(this.reWriter=moment([this.curyear,this.curmonth,1]).startOf("month").subtract("month",1).format("YYYY-MM-DD"),this.prev_now_next=[],this.initTimer(this.reWriter))},nextClick:function(){"week"==this.clickMode?this.$refs.swiperCon.next():"month"==this.clickMode&&(this.reWriter=moment([this.curyear,this.curmonth,1]).startOf("month").subtract("month",-1).format("YYYY-MM-DD"),this.prev_now_next=[],this.initTimer(this.reWriter))},onChange:function(e){this.reWriter="";var t=this;this.checkedDate="",0==e?(this.prev_now_next.unshift(t.getWeekInfo(moment(t.prev_now_next[e][0].date).subtract(7,"d").format("YYYY-MM-DD"))),this.prev_now_next.pop()):2==e&&(this.prev_now_next.push(t.getWeekInfo(moment(t.prev_now_next[e][0].date).add(7,"d").format("YYYY-MM-DD"))),this.prev_now_next.shift()),this.currentMonth=this.getFullMonth(t.prev_now_next[1][0].date),this.$emit("thisMonth",this.currentMonth),this.$emit("thisWeek",this.prev_now_next[1]),this.endSliderCallBack&&s.Z.isFunction(this.endSliderCallBack)&&this.endSliderCallBack()},mGetDate:function(e){var e=new Date(e),t=e.getFullYear(),e=e.getMonth()+1;return new Date(t,e,0).getDate()},getWeekByDay:function(e){e=new Date(e);return("ch"==this.language?["日","一","二","三","四","五","六"]:["Sun","Mon","Tue","Wed","Thur","Fri","Sat"])[e.getDay()]},getMonthInfo:function(e,t){for(var a=new Date(e),n=this.mGetDate(a),i=(t&&this.getHoliday(a,n),[]),o=1;o<=n;o++){var s=a.setDate(o),s=moment(s).format("YYYY-MM-DD");i.push({date:s,isToday:s===moment().format("YYYY-MM-DD"),week:this.getWeekByDay(s),isCurrentMonth:t})}return i},getFullMonth:function(e){var t=this.getMonthInfo(e,!0);if("一"!=t[0].week&&"Mon"!=t[0].week)for(var a=this.getMonthInfo(moment(e).subtract(1,"months").format("YYYY-MM-DD"),!1).reverse(),n=0;n<=a.length&&(t.unshift(a[n]),"一"!=a[n].week)&&"Mon"!=a[n].week;n++);if("日"!=t[t.length-1].week&&"Sun"!=t[t.length-1].week)for(var i=this.getMonthInfo(moment(e).add(1,"months").format("YYYY-MM-DD"),!1),o=0;o<=i.length&&(t.push(i[o]),"日"!=i[o].week)&&"Sun"!=i[o].week;o++);return t=this.group(t,7)},group:function(e,t){for(var a=0,n=[];a<e.length;)n.push(e.slice(a,a+=t));return n},toggleShowType:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.defaultShowType=e,this.$emit("toggleShowType",this.defaultShowType,t)},getLunarCalendar:function(e){e=n.Z.solar2lunar.apply(n.Z,(0,i.Z)(e.split("-")));return e.lunarFestival||e.festival||e.Term||("初一"==e.IDayCn?e.IMonthCn:e.IDayCn)},getHoliday:function(e,t){var n=this,a=e.setDate(1),e=e.setDate(t);n.sdate=moment(a).format("YYYY-MM-DD"),n.edate=moment(e).format("YYYY-MM-DD"),a&&e&&s.Z.http.post("/ctrl/leave/maintenance/getLeaveByRange",{start:n.sdate,end:n.edate}).then(function(e){var t,a;200==e.data.code?((t=n.holidayMonth).push.apply(t,(0,i.Z)(e.data.data)),a=new(o()),n.holidayMonth=n.holidayMonth.filter(function(e){return!a.has(e.date)&&a.set(e.date,1)})):s.Z.layer.toast("获取数据失败,请稍后再试")}).catch(function(e){return r.log(e)})},getDataday:function(){var e=this;s.Z.config.homePage.schedule.defaultToday&&""==this.checkedDate&&(this.checkedDate=this.defaultDate),s.Z.config.homePage.schedule.defaultToday&&setTimeout(function(){e.dateClick({date:s.Z.date.format(new Date,"yyyy-mm-dd")})},100)}}},h=(0,a(51900).Z)(t,function(){var n=this,i=n._self._c;return i("div",{staticClass:"week-slider"},[i("div",{directives:[{name:"show",rawName:"v-show",value:n.isShowMonth,expression:"isShowMonth"}],staticClass:"slider-title"},[i("i",{staticClass:"icon iconfont iconsanjiaoyou iconsanjiaozuo",class:{"title-icon-active":!0},on:{click:function(e){return n.prevClick()}}}),n._v(" "),i("span",{staticStyle:{"font-weight":"bold"}},[n._v(n._s(n.getYearMonth))]),n._v(" "),i("i",{staticClass:"icon iconfont iconsanjiaoyou",class:{"title-icon-active":!0},on:{click:function(e){return n.nextClick()}}})]),n._v(" "),i("div",{staticClass:"slider-content"},[i("van-swipe",{directives:[{name:"show",rawName:"v-show",value:"week"==n.defaultShowType,expression:"defaultShowType == 'week'"}],ref:"swiperCon",staticClass:"my-swiper",attrs:{touchable:n.touchable,"initial-swipe":n.currentIndex,loop:!1,"show-indicators":!1},on:{change:n.onChange}},n._l(n.prev_now_next,function(e){return i("van-swipe-item",{key:e[0].date},[i("div",{staticClass:"date-box"},[i("div",{staticClass:"lang-box"},n._l(e,function(t,e){return i("div",{key:e,staticClass:"day-of-week"},[i("div",{directives:[{name:"show",rawName:"v-show",value:n.isShowMonth,expression:"isShowMonth"}],staticClass:"day-title"},[n._v("\n                "+n._s(t.week)+"\n              ")]),n._v(" "),i("div",{staticClass:"day-date",class:{active:n.judgeChecked(t.date),toDay:n.isToday(t.date)&&!n.dsf.config.homePage.schedule.defaultToday,holiday:n.isHoliday(t.date)},on:{click:function(e){return n.dateClick(t)}}},[i("span",[n._v(n._s(t.date.split("-")[2].replace(/^0+/,"")))]),n._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:n.addSch(t.date),expression:"addSch(item.date)"}],staticClass:"day-dot",class:{"has-sch":n.addSch(t.date)&&!n.judgeChecked(t.date)},style:{background:n.addSch(t.date)&&n.judgeChecked(t.date)?n.todayDotcolor:""}})]),n._v(" "),i("span",{staticClass:"lunar-calendar",class:[n.isHoliday(t.date)?"holiday":""],domProps:{textContent:n._s(n.getLunarCalendar(t.date))}})])}),0)])])}),1),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"month"==n.defaultShowType,expression:"defaultShowType == 'month'"}],staticClass:"date-box"},n._l(n.currentMonth,function(e,a){return i("div",{key:a,staticClass:"lang-box"},n._l(e,function(t,e){return i("div",{key:e,staticClass:"day-of-week"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!a,expression:"!index"}],staticClass:"day-title"},[n._v(n._s(t.week))]),n._v(" "),i("div",{class:[t.isCurrentMonth?"":"not-current-month"]},[i("div",{staticClass:"day-date",class:{active:n.judgeChecked(t.date),toDay:n.isToday(t.date),holiday:n.isHoliday(t.date)},on:{click:function(e){return n.dateClick(t)}}},[i("span",[n._v(n._s(t.date.split("-")[2].replace(/^0+/,"")))]),n._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:n.addSch(t.date),expression:"addSch(itm.date)"}],staticClass:"day-dot",class:{"has-sch":n.addSch(t.date)&&!n.judgeChecked(t.date)},style:{background:n.addSch(t.date)&&n.judgeChecked(t.date)?n.todayDotcolor:""}})]),n._v(" "),i("span",{staticClass:"lunar-calendar",class:[n.isHoliday(t.date)?"holiday":""],domProps:{textContent:n._s(n.getLunarCalendar(t.date))}})])])}),0)}),0),n._v(" "),i("div",{staticClass:"flex ac jc arrow-container"},["week"==n.defaultShowType?i("van-icon",{attrs:{name:"arrow-down"},on:{click:function(e){return n.toggleShowType("month",!0)}}}):i("van-icon",{attrs:{name:"arrow-up"},on:{click:function(e){return n.toggleShowType("week",!0)}}})],1)],1)])},[],!1,null,"3b424459",null).exports},18281:function(e,t,a){e.exports=a(3896)}}]);