"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[40817,31204],{40817:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});function i(e,t){return e?t[e]:t[f]}function r(e,t){t&&!t[N]&&Object.defineProperty(t,N,{value:e.id,enumerable:!1,configurable:!1,writable:!1})}function a(e){for(var t=1,n=arguments.length;t<n;t++){var i,a,o=arguments[t]||{};for(i in o)o.hasOwnProperty(i)&&void 0!==(a=o[i])&&(e[i]=a)}return e}function h(e){for(var t=!0,n=!0,i=!0,a=0,o=e.length;a<o;a++){var r=e[a];!0===r.checked&&!r.indeterminate||(t=!1,r.disabled)||(i=!1),!1===r.checked&&!r.indeterminate||(n=!1)}return{all:t,none:n,allWithoutDisable:i,half:!t&&!n}}function u(e){var t,n,i;0!==e.childNodes.length&&(i=(n=h(e.childNodes)).all,t=n.none,n=n.half,i?(e.checked=!0,e.indeterminate=!1):n?(e.checked=!1,e.indeterminate=!0):t&&(e.checked=!1,e.indeterminate=!1),i=e.parent)&&0!==i.level&&!e.store.checkStrictly&&u(i)}function s(e,t){var n=e.store.props,i=e.data||{};return"function"==typeof(n=n[t])?n(i,e):"string"==typeof n?i[n]:void 0===n?void 0===(e=i[t])?"":e:void 0}var t=n(8450),o=n.n(t),t=n(27921),d=n.n(t),t=n(90487),l=n.n(t),c=n(5044),f="$treeNodeId",p=n(25108),t={name:"treeNode",components:{NodeContent:{props:{node:{required:!0}},render:function(e){var t=this.$parent,n=t.tree,i=this.node,a=i.data,o=i.store;return t.renderContent?t.renderContent.call(t._renderProxy,e,{_self:n.$vnode.context,node:i,data:a,store:o}):n.$scopedSlots.default?n.$scopedSlots.default({node:i,data:a}):e("span",{class:"tree-node__label"},[i.label])}}},props:{node:{default:function(){return{}}},props:{},renderContent:Function,renderAfterExpand:{type:Boolean,default:!0},showCheckbox:{type:Boolean,default:!1}},data:function(){return{tree:null,expanded:!1,childNodeRendered:!1,oldChecked:null,oldIndeterminate:null}},watch:{"node.indeterminate":function(e){this.handleSelectChange(this.node.checked,e)},"node.checked":function(e){this.handleSelectChange(e,this.node.indeterminate)},"node.expanded":function(e){var t=this;this.$nextTick(function(){return t.expanded=e}),e&&(this.childNodeRendered=!0)}},methods:{getNodeKey:function(e){return i(this.tree.nodeKey,e.data)},handleSelectChange:function(e,t){this.oldChecked!==e&&this.oldIndeterminate!==t&&this.tree.$emit("check-change",this.node.data,e,t),this.oldChecked=e,this.indeterminate=t},handleClick:function(){var e=this.tree.store;e.setCurrentNode(this.node),this.tree.$emit("current-change",e.currentNode?e.currentNode.data:null,e.currentNode),(this.tree.currentNode=this).tree.expandOnClickNode&&this.handleExpandIconClick(),this.tree.checkOnClickNode&&!this.node.disabled&&this.handleCheckChange(null,{checked:!this.node.checked}),this.tree.$emit("node-click",this.node.data,this.node,this),p.log(this.node)},handleContextMenu:function(e){this.tree._events["node-contextmenu"]&&0<this.tree._events["node-contextmenu"].length&&(e.stopPropagation(),e.preventDefault()),this.tree.$emit("node-contextmenu",e,this.node.data,this.node,this)},handleExpandIconClick:function(){this.node.isLeaf||(this.expanded?(this.tree.$emit("node-collapse",this.node.data,this.node,this),this.node.collapse()):(this.node.expand(),this.$emit("node-expand",this.node.data,this.node,this)))},handleCheckChange:function(e,t){var n=this;this.node.setChecked(t.checked,!this.tree.checkStrictly),this.$nextTick(function(){var e=n.tree.store;n.tree.$emit("check",n.node.data,{checkedNodes:e.getCheckedNodes(),checkedKeys:e.getCheckedKeys(),halfCheckedNodes:e.getHalfCheckedNodes(),halfCheckedKeys:e.getHalfCheckedKeys()})})},handleChildNodeExpand:function(e,t,n){this.broadcast("treeNode","tree-node-expand",t),this.tree.$emit("node-expand",e,t,n)},broadcast:function(e,t,n){function a(t,n,i){this.$children.forEach(function(e){e.$options.componentName===t?e.$emit.apply(e,[n].concat(i)):a.apply(e,[t,n].concat([i]))})}a.call(this,e,t,n)}},created:function(){var t=this,e=this.$parent,e=(e.isTree?this.tree=e:this.tree=e.tree,this.tree);e||p.warn("Can not find node's tree.");e=(e.props||{}).children||"children";this.$watch("node.data.".concat(e),function(){t.node.updateChildren()}),this.node.expanded&&(this.expanded=!0,this.childNodeRendered=!0),this.tree.accordion&&this.$on("tree-node-expand",function(e){t.node!==e&&t.node.collapse()})}},v=n(51900),t=(0,v.Z)(t,function(){var t=this,n=this,i=n._self._c;return i("div",{directives:[{name:"show",rawName:"v-show",value:n.node.visible,expression:"node.visible"}],staticClass:"tree-node",class:{"is-hidden":!n.node.visible,"is-expanded":n.expanded},attrs:{role:"treeitem",tabindex:"-1","aria-expanded":n.expanded,"aria-disabled":n.node.disabled,"aria-checked":n.node.checked},on:{click:function(e){return e.stopPropagation(),n.handleClick.apply(null,arguments)},contextmenu:function(e){return t.handleContextMenu(e)}}},[i("div",{staticClass:"tree-node_content",style:{"padding-left":.3*(n.node.level-1)+"rem"}},[i("van-checkbox",{directives:[{name:"show",rawName:"v-show",value:n.showCheckbox&&!n.node.disabled,expression:"showCheckbox && !node.disabled"}],attrs:{disabled:!!n.node.disabled},on:{change:function(e){return n.handleCheckChange(null,n.node)}},nativeOn:{click:function(e){e.stopPropagation()}},model:{value:n.node.checked,callback:function(e){n.$set(n.node,"checked",e)},expression:"node.checked"}}),n._v(" "),i("node-content",{attrs:{node:n.node}}),n._v(" "),n.node.isLeaf?n._e():i("span",{staticClass:"isShowChiled",on:{click:function(e){return e.stopPropagation(),n.handleExpandIconClick.apply(null,arguments)}}},[i("span",{staticClass:"r_line"}),n._v(" "),i("span",{staticClass:"r_span"},[n._v(n._s(n.expanded?"收起":"展开"))]),n._v(" "),i("van-icon",{attrs:{name:n.expanded?"arrow-up":"arrow-down"}})],1)],1),n._v(" "),i("transition",{attrs:{name:"fade"}},[!n.renderAfterExpand||n.childNodeRendered?i("div",{directives:[{name:"show",rawName:"v-show",value:n.expanded,expression:"expanded"}],staticClass:"tree-node__children",attrs:{role:"group"}},n._l(n.node.childNodes,function(e){return i("tree-node",{key:n.getNodeKey(e),attrs:{node:e,props:n.props,"show-checkbox":n.showCheckbox,"render-after-expand":n.renderAfterExpand},on:{"node-expand":n.handleChildNodeExpand}})}),1):n._e()])],1)},[],!1,null,"740a4795",null).exports,y=n(13682),k=n(8167),C=n(31314),g=n(26243),m=n.n(g),N="$treeNodeId",b=0,x=function(){function o(e){for(var t in(0,k.Z)(this,o),this.id=b++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1);var n=this.store;if(!n)throw new Error("[Node]store is required!");n.registerNode(this);var i,a=n.props;a&&void 0!==a.isLeaf&&"boolean"==typeof(a=s(this,"isLeaf"))&&(this.isLeafByUser=a),!0!==n.lazy&&this.data?(this.setData(this.data),n.defaultExpandAll&&(this.expanded=!0)):0<this.level&&n.lazy&&n.defaultExpandAll&&this.expand(),Array.isArray(this.data)||r(this,this.data),this.data&&(a=n.defaultExpandedKeys,(i=n.key)&&a&&-1!==a.indexOf(this.key)&&this.expand(null,n.autoExpandParent),i&&void 0!==n.currentNodeKey&&this.key===n.currentNodeKey&&(n.currentNode=this,n.currentNode.isCurrent=!0),n.lazy&&n._initDefaultCheckedNode(this),this.updateLeafState())}return(0,C.Z)(o,[{key:"setData",value:function(e){Array.isArray(e)||r(this,e),this.data=e,this.childNodes=[];for(var t,n=0,i=(t=0===this.level&&this.data instanceof Array?this.data:s(this,"children")||[]).length;n<i;n++)this.insertChild({data:t[n]})}},{key:"label",get:function(){return s(this,"label")}},{key:"key",get:function(){var e=this.store.key;return this.data?this.data[e]:null}},{key:"disabled",get:function(){return s(this,"disabled")}},{key:"nextSibling",get:function(){var e=this.parent;if(e){var t=e.childNodes.indexOf(this);if(-1<t)return e.childNodes[t+1]}return null}},{key:"previousSibling",get:function(){var e=this.parent;if(e){var t=e.childNodes.indexOf(this);if(-1<t)return 0<t?e.childNodes[t-1]:null}return null}},{key:"contains",value:function(s){var d=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return function e(t){for(var n=t.childNodes||[],i=!1,a=0,o=n.length;a<o;a++){var r=n[a];if(r===s||d&&e(r)){i=!0;break}}return i}(this)}},{key:"remove",value:function(){var e=this.parent;e&&e.removeChild(this)}},{key:"insertChild",value:function(e,t,n){if(!e)throw new Error("insertChild error: child is required.");e instanceof o||(n||-1===(n=this.getChildren(!0)||[]).indexOf(e.data)&&(void 0===t||t<0?n.push(e.data):n.splice(t,0,e.data)),a(e,{parent:this,store:this.store}),e=new o(e)),e.level=this.level+1,void 0===t||t<0?this.childNodes.push(e):this.childNodes.splice(t,0,e),this.updateLeafState()}},{key:"insertBefore",value:function(e,t){var n;t&&(n=this.childNodes.indexOf(t)),this.insertChild(e,n)}},{key:"insertAfter",value:function(e,t){var n;t&&-1!==(n=this.childNodes.indexOf(t))&&(n+=1),this.insertChild(e,n)}},{key:"removeChild",value:function(e){var t=this.getChildren()||[],n=t.indexOf(e.data),t=(-1<n&&t.splice(n,1),this.childNodes.indexOf(e));-1<t&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(t,1)),this.updateLeafState()}},{key:"removeChildByData",value:function(e){for(var t=null,n=0;n<this.childNodes.length;n++)if(this.childNodes[n].data===e){t=this.childNodes[n];break}t&&this.removeChild(t)}},{key:"expand",value:function(t,n){function i(){if(n)for(var e=a.parent;0<e.level;)e.expanded=!0,e=e.parent;a.expanded=!0,t&&t()}var a=this;this.shouldLoadData()?this.loadData(function(e){e instanceof Array&&(a.checked?a.setChecked(!0,!0):a.store.checkStrictly||u(a),i())}):i()}},{key:"doCreateChildren",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};e.forEach(function(e){t.insertChild(a({data:e},n),void 0,!0)})}},{key:"collapse",value:function(){this.expanded=!1}},{key:"shouldLoadData",value:function(){return!0===this.store.lazy&&this.store.load&&!this.loaded}},{key:"updateLeafState",value:function(){var e;!0===this.store.lazy&&!0!==this.loaded&&void 0!==this.isLeafByUser?this.isLeaf=this.isLeafByUser:(e=this.childNodes,!this.store.lazy||!0===this.store.lazy&&!0===this.loaded?this.isLeaf=!e||0===e.length:this.isLeaf=!1)}},{key:"setChecked",value:function(s,d,e,l){var c=this;if(this.indeterminate="half"===s,this.checked=!0===s,!this.store.checkStrictly){if(!this.shouldLoadData()||this.store.checkDescendants){var t=h(this.childNodes),n=t.all,t=t.allWithoutDisable,i=(this.isLeaf||n||!t||(this.checked=!1,s=!1),function(){if(d){for(var e=c.childNodes,t=0,n=e.length;t<n;t++){var i=e[t],a=(l=l||!1!==s,i.disabled?i.checked:l);i.setChecked(a,d,!0,l)}var o=h(e),r=o.half,o=o.all;o||(c.checked=o,c.indeterminate=r)}});if(this.shouldLoadData())return void this.loadData(function(){i(),u(c)},{checked:!1!==s});i()}n=this.parent;!n||0===n.level||e||u(n)}}},{key:"getChildren",value:function(){var e,t,n,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 0===this.level?this.data:(e=this.data)?(n="children",void 0===e[n=(t=this.store.props)?t.children||"children":n]&&(e[n]=null),i&&!e[n]&&(e[n]=[]),e[n]):null}},{key:"updateChildren",value:function(){var n=this,e=this.getChildren()||[],i=this.childNodes.map(function(e){return e.data}),a={},o=[];e.forEach(function(e,t){var n=e[N];!!n&&0<=function(e,t){for(var n=0;n!==e.length;++n)if(t(e[n]))return n;return-1}(i,function(e){return e[N]===n})?a[n]={index:t,data:e}:o.push({index:t,data:e})}),this.store.lazy||i.forEach(function(e){a[e[N]]||n.removeChildByData(e)}),o.forEach(function(e){var t=e.index,e=e.data;n.insertChild({data:e},t)}),this.updateLeafState()}},{key:"loadData",value:function(t){var n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!0!==this.store.lazy||!this.store.load||this.loaded||this.loading&&!m()(i).length?t&&t.call(this):(this.loading=!0,this.store.load(this,function(e){n.loaded=!0,n.loading=!1,n.childNodes=[],n.doCreateChildren(e,i),n.updateLeafState(),t&&t.call(n,e)}))}}]),o}(),_=function(){function i(e){var t,n=this;for(t in(0,k.Z)(this,i),this.currentNode=null,this.currentNodeKey=null,e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.nodesMap={},this.root=new x({data:this.data,store:this}),this.lazy&&this.load?(0,this.load)(this.root,function(e){n.root.doCreateChildren(e),n._initDefaultCheckedNodes()}):this._initDefaultCheckedNodes()}return(0,C.Z)(i,[{key:"filter",value:function(a){var o=this.filterNodeMethod,r=this.lazy;(function t(e){var n,i=(e.root||e).childNodes;i.forEach(function(e){e.visible=o.call(e,a,e.data,e),t(e)}),!e.visible&&i.length&&(n=!0,n=!i.some(function(e){return e.visible}),e.root?e.root.visible=!1==n:e.visible=!1==n),a&&e.visible&&!e.isLeaf&&!r&&e.expand()})(this)}},{key:"setData",value:function(e){e!==this.root.data?(this.root.setData(e),this._initDefaultCheckedNodes()):this.root.updateChildren()}},{key:"getNode",value:function(e){var t;return e instanceof x?e:(t="object"!==(0,y.Z)(e)?e:(t=this.key,e=e,t?e[t]:e.$treeNodeId),this.nodesMap[t]||null)}},{key:"insertBefore",value:function(e,t){t=this.getNode(t);t.parent.insertBefore({data:e},t)}},{key:"insertAfter",value:function(e,t){t=this.getNode(t);t.parent.insertAfter({data:e},t)}},{key:"remove",value:function(e){e=this.getNode(e);e&&e.parent&&(e===this.currentNode&&(this.currentNode=null),e.parent.removeChild(e))}},{key:"append",value:function(e,t){t=t?this.getNode(t):this.root;t&&t.insertChild({data:e})}},{key:"_initDefaultCheckedNodes",value:function(){var t=this,e=this.defaultCheckedKeys||[],n=this.nodesMap;e.forEach(function(e){e=n[e];e&&e.setChecked(!0,!t.checkStrictly)})}},{key:"_initDefaultCheckedNode",value:function(e){-1!==(this.defaultCheckedKeys||[]).indexOf(e.key)&&e.setChecked(!0,!this.checkStrictly)}},{key:"setDefaultCheckedKey",value:function(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}},{key:"registerNode",value:function(e){this.key&&e&&e.data&&void 0!==e.key&&(this.nodesMap[e.key]=e)}},{key:"deregisterNode",value:function(e){var t=this;this.key&&e&&e.data&&(e.childNodes.forEach(function(e){t.deregisterNode(e)}),delete this.nodesMap[e.key])}},{key:"getCheckedNodes",value:function(){var n=0<arguments.length&&void 0!==arguments[0]&&arguments[0],i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=[];return function t(e){(e.root||e).childNodes.forEach(function(e){!(e.checked||i&&e.indeterminate)||n&&!e.isLeaf||a.push(e.data),t(e)})}(this),a}},{key:"getCheckedKeys",value:function(){var t=this;return this.getCheckedNodes(0<arguments.length&&void 0!==arguments[0]&&arguments[0]).map(function(e){return(e||{})[t.key]})}},{key:"getHalfCheckedNodes",value:function(){var n=[];return function t(e){(e.root||e).childNodes.forEach(function(e){e.indeterminate&&n.push(e.data),t(e)})}(this),n}},{key:"getHalfCheckedKeys",value:function(){var t=this;return this.getHalfCheckedNodes().map(function(e){return(e||{})[t.key]})}},{key:"_getAllNodes",value:function(){var e,t=[],n=this.nodesMap;for(e in n)n.hasOwnProperty(e)&&t.push(n[e]);return t}},{key:"updateChildren",value:function(e,t){var n=this.nodesMap[e];if(n){for(var i=n.childNodes,a=i.length-1;0<=a;a--){var o=i[a];this.remove(o.data)}for(var r=0,s=t.length;r<s;r++){var d=t[r];this.append(d,n.data)}}}},{key:"_setCheckedKeys",value:function(i){for(var a=this,o=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=2<arguments.length?arguments[2]:void 0,r=this._getAllNodes().sort(function(e,t){return t.level-e.level}),s=Object.create(null),d=m()(e),l=(r.forEach(function(e){return e.setChecked(!1,!1)}),0),t=r.length;l<t;l++)!function(){var e=r[l],t=e.data[i].toString();if(!(-1<d.indexOf(t)))return e.checked&&!s[t]&&e.setChecked(!1,!1);for(var n=e.parent;n&&0<n.level;)s[n.data[i]]=!0,n=n.parent;if(e.isLeaf||a.checkStrictly)return e.setChecked(!0,!1);e.setChecked(!0,!0),o&&(e.setChecked(!1,!1),function t(e){e.childNodes.forEach(function(e){e.isLeaf||e.setChecked(!1,!1),t(e)})}(e))}()}},{key:"setCheckedNodes",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=this.key,i={};e.forEach(function(e){i[(e||{})[n]]=!0}),this._setCheckedKeys(n,t,i)}},{key:"setCheckedKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=(this.defaultCheckedKeys=e,this.key),i={};e.forEach(function(e){i[e]=!0}),this._setCheckedKeys(n,t,i)}},{key:"setDefaultExpandedKeys",value:function(e){var t=this;(this.defaultExpandedKeys=e=e||[]).forEach(function(e){e=t.getNode(e);e&&e.expand(null,t.autoExpandParent)})}},{key:"setChecked",value:function(e,t,n){e=this.getNode(e);e&&e.setChecked(!!t,n)}},{key:"getCurrentNode",value:function(){return this.currentNode}},{key:"setCurrentNode",value:function(e){var t=this.currentNode;t&&(t.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}},{key:"setUserCurrentNode",value:function(e){e=e[this.key],e=this.nodesMap[e];this.setCurrentNode(e)}},{key:"setCurrentNodeKey",value:function(e){null==e?(this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null):(e=this.getNode(e))&&this.setCurrentNode(e)}}]),i}(),g={components:{treeNode:t},props:{data:{type:Array},nodeKey:{type:String},lazy:{type:Boolean,default:!1},load:{type:Function},defaultExpandAll:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:Array},multiple:{type:Boolean,default:!1},checkStrictly:Boolean,currentNodeKey:[String,Number],defaultExpandedKeys:Array,renderContent:Function,filterNodeMethod:Function,renderAfterExpand:{type:Boolean,default:!0},props:{default:function(){return{children:"children",label:"label",disabled:"disabled"}}},checkOnClickNode:{type:Boolean,default:!0}},data:function(){return{store:null,root:null,currentNode:null,treeItems:null,checkboxItems:[]}},computed:{children:{set:function(e){this.data=e},get:function(){return this.data}},treeItemArray:function(){return Array.prototype.slice.call(this.treeItems)},isEmpty:function(){var e=this.root.childNodes;return!e||0===e.length||e.every(function(e){return!e.visible})}},watch:{defaultCheckedKeys:function(e){this.store.setDefaultCheckedKey(e)},defaultExpandedKeys:function(e){this.store.defaultExpandedKeys=e,this.store.setDefaultExpandedKeys(e)},data:function(e){this.store.setData(e)},checkboxItems:function(e){Array.prototype.forEach.call(e,function(e){e.setAttribute("tabindex",-1)})},checkStrictly:function(e){this.store.checkStrictly=e}},created:function(){this.isTree=!0,this.store=new _({key:this.nodeKey,data:this.data,lazy:this.lazy,props:this.props,load:this.load,currentNodeKey:this.currentNodeKey,checkStrictly:this.checkStrictly,defaultCheckedKeys:this.defaultCheckedKeys,defaultExpandedKeys:this.defaultExpandedKeys,defaultExpandAll:this.defaultExpandAll,filterNodeMethod:this.filterNodeMethod}),this.root=this.store.root},methods:{filter:function(e){if(!this.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");this.store.filter(e)},getNodeKey:function(e){return i(this.nodeKey,e.data)},getNodePath:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");e=this.store.getNode(e);if(!e)return[];for(var t=[e.data],n=e.parent;n&&n!==this.root;)t.push(n.data),n=n.parent;return t.reverse()},getCheckedNodes:function(e,t){return this.store.getCheckedNodes(e,t)},getCheckedKeys:function(e){return this.store.getCheckedKeys(e)},getCurrentNode:function(){var e=this.store.getCurrentNode();return e?e.data:null},getCurrentKey:function(){var e;if(this.nodeKey)return(e=this.getCurrentNode())?e[this.nodeKey]:null;throw new Error("[Tree] nodeKey is required in getCurrentKey")},setCheckedNodes:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");this.store.setCheckedNodes(e,t)},setCheckedKeys:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");this.store.setCheckedKeys(e,t)},setChecked:function(e,t,n){this.store.setChecked(e,t,n)},getHalfCheckedNodes:function(){return this.store.getHalfCheckedNodes()},getHalfCheckedKeys:function(){return this.store.getHalfCheckedKeys()},setCurrentNode:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");this.store.setUserCurrentNode(e)},setCurrentKey:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");this.store.setCurrentNodeKey(e)},getNode:function(e){return this.store.getNode(e)},remove:function(e){this.store.remove(e)},append:function(e,t){this.store.append(e,t)},insertBefore:function(e,t){this.store.insertBefore(e,t)},insertAfter:function(e,t){this.store.insertAfter(e,t)},handleNodeExpand:function(e,t,n){this.broadcast("treeNode","tree-node-expand",t),this.$emit("node-expand",e,t,n)},updateKeyChildren:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");this.store.updateChildren(e,t)},initTabIndex:function(){this.treeItems=this.$el.querySelectorAll(".is-focusable[role=treeitem]"),this.checkboxItems=this.$el.querySelectorAll("input[type=checkbox]");var e=this.$el.querySelectorAll(".is-checked[role=treeitem]");e.length?e[0].setAttribute("tabindex",0):this.treeItems[0]&&this.treeItems[0].setAttribute("tabindex",0)},handleKeydown:function(e){var t,n,i=e.target;-1!==i.className.indexOf("el-tree-node")&&(t=e.keyCode,this.treeItems=this.$el.querySelectorAll(".is-focusable[role=treeitem]"),n=this.treeItemArray.indexOf(i),-1<[38,40].indexOf(t)&&(e.preventDefault(),n=38===t?0!==n?n-1:0:n<this.treeItemArray.length-1?n+1:0,this.treeItemArray[n].focus()),-1<[37,39].indexOf(t)&&(e.preventDefault(),i.click()),n=i.querySelector('[type="checkbox"]'),-1<[13,32].indexOf(t))&&n&&(e.preventDefault(),n.click())},broadcast:function(e,t,n){function a(t,n,i){this.$children.forEach(function(e){e.$options.componentName===t?e.$emit.apply(e,[n].concat(i)):a.apply(e,[t,n].concat([i]))})}a.call(this,e,t,n)}}},t=(0,v.Z)(g,function(){var t=this,n=t._self._c;return n("div",{staticClass:"dsf-tree"},t._l(t.root.childNodes,function(e){return n("tree-node",{key:t.getNodeKey(e),attrs:{node:e,props:t.props,"show-checkbox":t.showCheckbox,"render-after-expand":t.renderAfterExpand,"render-content":t.renderContent},on:{"node-expand":t.handleNodeExpand}})}),1)},[],!1,null,"77951a2c",null).exports,w=n(25108),g={components:{dsfTree:t},props:{show:Boolean},data:function(){return{activeName:"部门",showSearch:!1,searchValue:"",selectType:0,defaultProps:{children:"CHILDREN",label:"TITLE",isLeaf:"isuser"},searchProps:{children:"CHILDREN",label:"TITLE"},navBarSticky:!1,tabsOffsetTop:0,searchTree:[]}},watch:{searchValue:function(e){e?this.onSearch(e):this.searchTree=[]}},methods:{loadNode1:function(e,t){this.loadNode(e,t,1)},loadNode2:function(e,t){this.loadNode(e,t,2)},loadNode3:function(e,t){this.loadNode(e,t,3)},loadNode:function(e,t,n){if(0===e.level&&dsf.http.post("/fn/contacts/contactList",{type:n}).then(function(e){return 200==e.data.code?(e.data.data.forEach(function(e){e.disabled=!0}),t(e.data.data)):t([])}),1==e.level){if(!e.data.CHILDREN)return t([]);e.data.CHILDREN.forEach(function(e){e.disabled=!0}),t(e.data.CHILDREN)}1<e.level&&dsf.http.post("/fn/contacts/findUserAndDept",{type:n,id:e.data.ID,isUnit:e.data.IS_UNIT}).then(function(e){return 200==e.data.code?(e.data.data.USER.forEach(function(e){e.isuser=!0,e.EMAIL||(e.disabled=!0)}),e.data.data.DEPT.forEach(function(e){e.disabled=!0}),t(e.data.data.USER.concat(e.data.data.DEPT))):t([])}).catch(function(e){return t([])})},selectArr:function(){var e=this.$refs.tree1?this.$refs.tree1.getCheckedNodes():[],t=this.$refs.tree2?this.$refs.tree2.getCheckedNodes():[],n=this.$refs.tree3?this.$refs.tree3.getCheckedNodes():[],i=this.$refs.searchTree?this.$refs.searchTree.getCheckedNodes():[],e=d()(new(l())([].concat((0,c.Z)(e),(0,c.Z)(t),(0,c.Z)(n),(0,c.Z)(i))));w.log(e),this.$emit("update:show",!1),this.$emit("getArray",e)},onSearch:function(){var t=this;this.showSearch=!0,this.searchValue&&dsf.http.post("/fn/contacts/searchUser",{content:this.searchValue}).then(function(e){200==e.data.code&&(t.searchTree=e.data.data)})},back:function(){}}},t=(0,v.Z)(g,function(){var n=this,i=n._self._c;return i("div",{staticClass:"dsf-select-mail"},[i("van-sticky",[i("van-nav-bar",{attrs:{title:"通讯录","left-arrow":""},on:{"click-left":function(e){return n.$emit("update:show",!1)}},scopedSlots:n._u([{key:"left",fn:function(){return[i("van-icon",{attrs:{name:"arrow-left"}}),i("span",[n._v("返回")])]},proxy:!0}])}),n._v(" "),0==n.selectType?i("van-search",{ref:"search",attrs:{placeholder:"搜索","show-action":""},on:{click:n.onSearch,cancel:function(e){n.showSearch=!1}},model:{value:n.searchValue,callback:function(e){n.searchValue=e},expression:"searchValue"}}):n._e()],1),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!n.showSearch,expression:"!showSearch"}],staticClass:"tabs"},[0==n.selectType?i("van-tabs",{attrs:{animated:"",sticky:"","offset-top":n.onSearch?"1.96rem":"0"},model:{value:n.activeName,callback:function(e){n.activeName=e},expression:"activeName"}},[i("van-tab",{attrs:{title:"单位",name:"单位"}},[i("dsf-tree",{ref:"tree1",attrs:{lazy:"",load:n.loadNode1,props:n.defaultProps,showCheckbox:!0},scopedSlots:n._u([{key:"default",fn:function(e){var t=e.node,e=e.data;return i("span",{staticClass:"custom-tree-node tree-node__label",style:{paddingLeft:e.EMAIL?"":"0.4rem"}},[e.isuser?i("van-icon",{staticStyle:{"vertical-align":"sub"},attrs:{name:"user-circle-o",size:"0.4rem"}}):n._e(),n._v(" "),i("span",[n._v(n._s(t.label))]),n._v(" "),e.isuser?i("span",{staticStyle:{color:"#999","font-size":"var(--font_size_4)"}},[n._v(n._s(e.EMAIL||"（暂无邮箱）"))]):n._e()],1)}}],null,!1,27353275)})],1),n._v(" "),i("van-tab",{attrs:{title:"全省",name:"全省"}},[i("dsf-tree",{ref:"tree2",attrs:{lazy:"",load:n.loadNode2,props:n.defaultProps,showCheckbox:!0},scopedSlots:n._u([{key:"default",fn:function(e){var t=e.node,e=e.data;return i("span",{staticClass:"custom-tree-node tree-node__label",style:{paddingLeft:e.EMAIL?"":"0.4rem"}},[e.isuser?i("van-icon",{staticStyle:{"vertical-align":"sub"},attrs:{name:"user-circle-o",size:"0.4rem"}}):n._e(),n._v(" "),i("span",[n._v(n._s(t.label))]),n._v(" "),e.isuser?i("span",{staticStyle:{color:"#999","font-size":"var(--font_size_4)"}},[n._v(n._s(e.EMAIL||"（暂无邮箱）"))]):n._e()],1)}}],null,!1,27353275)})],1),n._v(" "),i("van-tab",{attrs:{title:"条线",name:"条线"}},[i("dsf-tree",{ref:"tree3",attrs:{lazy:"",load:n.loadNode3,props:n.defaultProps,showCheckbox:!0},scopedSlots:n._u([{key:"default",fn:function(e){var t=e.node,e=e.data;return i("span",{staticClass:"custom-tree-node tree-node__label",style:{paddingLeft:e.EMAIL?"":"0.4rem"}},[e.isuser?i("van-icon",{staticStyle:{"vertical-align":"sub"},attrs:{name:"user-circle-o",size:"0.4rem"}}):n._e(),n._v(" "),i("span",[n._v(n._s(t.label))]),n._v(" "),e.isuser?i("span",{staticStyle:{color:"#999","font-size":"var(--font_size_4)"}},[n._v(n._s(e.EMAIL||"（暂无邮箱）"))]):n._e()],1)}}],null,!1,27353275)})],1)],1):n._e()],1),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:n.showSearch,expression:"showSearch"}],staticStyle:{margin:"0.12rem 0.32rem"}},[i("dsf-tree",{ref:"searchTree",attrs:{data:n.searchTree,props:n.searchProps,showCheckbox:!0},scopedSlots:n._u([{key:"default",fn:function(e){var t=e.node,e=e.data;return i("span",{staticClass:"custom-tree-node tree-node__label",style:{paddingLeft:e.EMAIL?"":"0.4rem"}},[i("van-icon",{staticStyle:{"vertical-align":"sub"},attrs:{name:"user-circle-o",size:"0.4rem"}}),n._v(" "),i("span",[n._v(n._s(t.label))]),n._v(" "),i("span",{staticStyle:{color:"#999","font-size":"var(--font_size_4)"}},[n._v(n._s(e.EMAIL||"（暂无邮箱）"))])],1)}}])})],1),n._v(" "),i("div",{staticStyle:{height:"1.2rem"}},[i("div",{staticClass:"footer"},[i("van-button",{staticClass:"btn",attrs:{type:"info"},on:{click:n.selectArr}},[n._v("确认")])],1)])],1)},[],!1,null,"0e8d8d47",null).exports,S=n(25108),E=(0,v.Z)({components:{addressList:t},data:function(){return{recipient:"",carbonCopy:"",title:"",content:"",files:[],originalMail:null,originalContent:"",recipientShow:!1,carbonCopyShow:!1,fileShow:!1,fileTitle:"",fileUrl:""}},created:function(){this.$route.query.mail&&this.setOriginalMail()},methods:{setOriginalMail:function(){switch(this.originalMail=JSON.parse(this.$route.query.mail),this.originalContent="<br />---------- Origin message ----------<br />&gt;From：&quot;".concat(this.originalMail.sender.split("@")[0],"&quot; &lt;").concat(this.originalMail.sender,"&gt;<br />&gt;To：&quot;").concat(this.originalMail.recipient.split("@")[0],"&quot; &lt;").concat(this.originalMail.recipient,"&gt;<br />&gt;Subject：").concat(this.originalMail.title,"<br />&gt;Date：").concat(this.originalMail.createTime,'<blockquote style="margin:0 0 0 .8ex;border-left:1px #00c solid;padding-left:1ex">').concat(this.originalMail.content,"</blockquote>\n"),this.files=this.originalMail.files,this.$route.query.type){case"forward":this.title="转发：".concat(this.originalMail.title);break;case"replay":this.title="回复：".concat(this.originalMail.title),this.recipient=this.originalMail.sender}S.log(this.originalMail),S.log(this.content)},afterRead:function(e){var t=this;this.$toast.loading({message:"上传中...",forbidClick:!0,duration:0,overlay:!0}),S.log(e),dsf.http.upload("fn/mail/upload",{},e).then(function(e){200==e.data.code&&t.files.push(e.data.data),t.$toast.clear(),t.dsf.layer.toast(e.data.message)})},del:function(e,t){var n=this;dsf.layer.confirm({message:"是否确认删除该附件",confirmButtonText:"确认"},function(){dsf.http.post("fn/mail/delFile",e).then(function(e){200==e.data.code&&(dsf.layer.toast("删除成功"),n.files.splice(t,1))})})},send:function(){var e,t=this;this.recipient?this.content?(e=dsf.layer.loading("发送中"),dsf.http.post("fn/mail/send",{title:this.title,recipient:this.recipient,carbonCopy:this.carbonCopy,content:this.originalContent?"".concat(this.content,"<br/>------------------------<br/>").concat(this.originalContent):this.content,files:o()(this.files)}).then(function(e){S.log(e),200==e.data.code?(dsf.layer.toast("发送成功"),setTimeout(function(){t.$route.query.mail?t.$router.go(-2):t.$router.go(-1)},1e3)):dsf.layer.toast(e.data.message)}).catch(function(){dsf.layer.closeLoading(e)})):this.$toast.fail("请输入内容"):this.$toast.fail("请选择收件人")},getRecipient:function(e){var t=[];e.forEach(function(e){e.EMAIL&&t.push(e.EMAIL)}),this.recipient=d()(new(l())([].concat(t))).join(",")},getCarbonCopy:function(e){var t=[];e.forEach(function(e){e.EMAIL&&t.push(e.EMAIL)}),this.carbonCopy=d()(new(l())([].concat(t))).join(",")},openFile:function(e){this.fileShow=!0,this.fileTitle=e.title,this.fileUrl=dsf.config.previewSetting.previewLocation+e.url}}},function(){var i=this,e=i._self._c;return e("div",{staticClass:"detail",staticStyle:{"margin-top":"0.2rem"}},[e("van-field",{attrs:{label:"收件人：",type:"textarea",rows:"1",autosize:"","label-width":"1.4rem","right-icon":"contact"},on:{"click-right-icon":function(e){i.recipientShow=!0}},model:{value:i.recipient,callback:function(e){i.recipient=e},expression:"recipient"}}),i._v(" "),e("van-field",{attrs:{label:"抄送：",type:"textarea",rows:"1",autosize:"","label-width":"1.4rem","right-icon":"contact"},on:{"click-right-icon":function(e){i.carbonCopyShow=!0}},model:{value:i.carbonCopy,callback:function(e){i.carbonCopy=e},expression:"carbonCopy"}}),i._v(" "),e("van-field",{attrs:{label:"主题：",type:"textarea",rows:"1",autosize:"","label-width":"1.4rem"},model:{value:i.title,callback:function(e){i.title=e},expression:"title"}}),i._v(" "),e("van-field",{attrs:{type:"textarea",rows:"8",autosize:"",placeholder:"请输入内容"},model:{value:i.content,callback:function(e){i.content=e},expression:"content"}}),i._v(" "),e("div",{staticStyle:{padding:"0 0.32rem"},domProps:{innerHTML:i._s(i.originalContent)}}),i._v(" "),e("div",{staticStyle:{padding:"0.32rem"}},[e("div",{staticClass:"flex jb"},[e("span",[i._v("添加附件：")]),i._v(" "),e("van-uploader",{staticClass:"upload-btn",attrs:{"after-read":i.afterRead,accept:"*/*"}},[e("i",{staticClass:"iconfont iconattachment",staticStyle:{display:"inline-block",transform:"rotate(-45deg)","font-size":"var(--font_size_0)"}})])],1),i._v(" "),i._l(i.files,function(t,n){return e("div",{key:n,staticClass:"file",on:{click:function(e){return i.openFile(t)}}},[e("span",{staticClass:"elps"},[i._v(i._s(t.title))]),i._v(" "),e("van-icon",{staticStyle:{"padding-right":"0.2rem"},attrs:{name:"eye",color:"#3389e0",size:"0.32rem"}}),i._v(" "),e("van-icon",{attrs:{name:"cross",color:"#3389e0",size:"0.32rem"},on:{click:function(e){return e.stopPropagation(),i.del(t,n)}}})],1)})],2),i._v(" "),e("div",{staticStyle:{height:"1.2rem"}},[e("div",{staticClass:"footer"},[e("van-button",{staticClass:"btn",attrs:{type:"info"},on:{click:i.send}},[i._v("发送\n      ")])],1)]),i._v(" "),e("van-popup",{style:{height:"100%"},attrs:{"get-container":"#app",position:"bottom"},model:{value:i.recipientShow,callback:function(e){i.recipientShow=e},expression:"recipientShow"}},[e("address-list",{attrs:{show:i.recipientShow},on:{"update:show":function(e){i.recipientShow=e},getArray:i.getRecipient}})],1),i._v(" "),e("van-popup",{style:{height:"100%"},attrs:{"get-container":"#app",position:"bottom"},model:{value:i.carbonCopyShow,callback:function(e){i.carbonCopyShow=e},expression:"carbonCopyShow"}},[e("address-list",{attrs:{show:i.carbonCopyShow},on:{"update:show":function(e){i.carbonCopyShow=e},getArray:i.getCarbonCopy}})],1),i._v(" "),e("van-popup",{staticClass:"filePop",attrs:{"get-container":"#app",position:"bottom"},model:{value:i.fileShow,callback:function(e){i.fileShow=e},expression:"fileShow"}},[e("van-nav-bar",{attrs:{title:i.fileTitle},on:{"click-left":function(e){i.fileShow=!1}},scopedSlots:i._u([{key:"left",fn:function(){return[e("van-icon",{attrs:{name:"arrow-left"}}),e("span",[i._v("返回")])]},proxy:!0}])}),i._v(" "),i.fileShow?e("iframe",{attrs:{id:"filePreview",src:i.fileUrl,frameborder:"0"}}):i._e()],1)],1)},[],!1,null,"44164a78",null).exports},8167:function(e,t,n){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return i}})},31314:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(26771),o=n(44660);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),a(e,(0,o.Z)(i.key),i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),a(e,"prototype",{writable:!1}),e}}}]);