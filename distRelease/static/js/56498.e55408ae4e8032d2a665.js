"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[56498],{56498:function(s,e,t){t.r(e),t.d(e,{default:function(){return o}});var n=t(25108),e={name:"changePassWord",data:function(){return{isLoading:!1,editPassword_form:{oldPsw:"",newPsw:"",checkPsw:""},isIm:!1}},created:function(){this.userInfo=dsf.util.loadSessionStore("user"),this.$route.query.isIm&&(this.isIm=1==this.$route.query.isIm)},computed:{minPwd:function(){return dsf.config.setting.hasOwnProperty("SYS-SEC-0001")&&dsf.config.setting["SYS-SEC-0001"]||6},strengthPwd:function(){return dsf.config.setting.hasOwnProperty("SYS-SEC-0002")&&dsf.config.setting["SYS-SEC-0002"]||1},point:function(){n.log(this.strengthPwd);var s=1==this.strengthPwd?"，只能包含合法字符：数字、字母、~@^!#$()*":2==this.strengthPwd?"，而且同时包含数字+字母":"，而且同时包含数字+大小写字母+合法特殊字符 ~@^!#$()*";return"密码必须至少"+this.minPwd+"位"+s},oldPwdRules:function(){return[{validator:function(s){return""!==s},message:"请输入旧密码"}]},newPwdRules:function(){var e=this,s=[{validator:function(s){return""!==s},message:"请输入新密码"},{pattern:/^[A-Za-z0-9\~\@\^\!\#\$\(\)\*]+$/,message:"密码只能包含合法字符：数字、字母、~@^!#$()*"},{pattern:new RegExp("^.{"+this.minPwd+",}$",""),message:"密码长度至少为".concat(this.minPwd,"位")},{validator:function(s){return s!==e.editPassword_form.oldPsw},message:"新密码不能和旧密码相同"}];return 2==this.strengthPwd&&s.push({pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z0-9\~\@\^\!\#\$\(\)\*]+$/,message:"密码必须包含数字+字母"}),3==this.strengthPwd&&s.push({pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\~\@\^\!\#\$\(\)\*])[A-Za-z0-9\~\@\^\!\#\$\(\)\*]+$/,message:"密码必须包含数字+大小写字母+合法特殊字符 ~@^!#$()*"}),n.log(s),s},checkPwdRules:function(){var e=this;return[{validator:function(s){return""!==s},message:"请再次输入密码"},{validator:function(s){return s===e.editPassword_form.newPsw},message:"两次输入密码不一致"}]}},mounted:function(){},methods:{onSubmit:function(){var e=this;dsf.http.post("/fn/userinfo/updatePwd",{pwd:this.editPassword_form.oldPsw,newPwd:this.editPassword_form.newPsw,userId:dsf.util.loadSessionStore("user").user_id}).then(function(s){s=s.data;"success"==s.type?e.isIm&&window.native&&window.native.isNative?e.dsf.layer.toast("修改密码成功","success",function(){window.native.back()}):e.dsf.layer.toast("修改密码成功,请重新登录","success",function(){"/changePassWord"==dsf.util.loadSessionStore("homePage")&&dsf.util.removeSessionStore("homePage"),dsf.util.logOut()}):e.dsf.layer.toast(s.message||"修改失败")}).catch(function(s){s=s.message;e.dsf.layer.toast(s)})},goBack:function(){this.$router.go(-1)}}},o=(0,t(51900).Z)(e,function(){var e=this,s=e._self._c;return s("div",{attrs:{id:"changePassWord"}},[s("div",{staticClass:"content"},[s("van-form",{ref:"editPassword_form",on:{submit:e.onSubmit}},[s("van-field",{attrs:{clearable:"",type:"password",name:"oldPsw",label:"旧密码",placeholder:"请输入旧密码",error:!1,rules:e.oldPwdRules},model:{value:e.editPassword_form.oldPsw,callback:function(s){e.$set(e.editPassword_form,"oldPsw",s)},expression:"editPassword_form.oldPsw"}}),e._v(" "),s("van-field",{attrs:{clearable:"",type:"password",name:"newPsw",label:"新密码",placeholder:"请输入新密码",error:!1,rules:e.newPwdRules},model:{value:e.editPassword_form.newPsw,callback:function(s){e.$set(e.editPassword_form,"newPsw",s)},expression:"editPassword_form.newPsw"}}),e._v(" "),s("van-field",{attrs:{clearable:"",type:"password",name:"checkPsw",label:"确认密码",placeholder:"请再次输入新密码",error:!1,rules:e.checkPwdRules},model:{value:e.editPassword_form.checkPsw,callback:function(s){e.$set(e.editPassword_form,"checkPsw",s)},expression:"editPassword_form.checkPsw"}}),e._v(" "),s("div",{staticClass:"point-content"},[e._v(e._s(e.point))]),e._v(" "),s("div",{staticClass:"btngroup"},[s("van-button",{staticClass:"btn",attrs:{block:"",type:"info","native-type":"submit"}},[e._v("保存")])],1)],1)],1)])},[],!1,null,"6e34627c",null).exports}}]);