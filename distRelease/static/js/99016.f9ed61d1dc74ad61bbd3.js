"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[99016],{57116:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var t=a(77193),r=(a(85684),a(43567));function f(e){return P.Z.http.post("fn/xform/save",e)}function d(e){return P.Z.http.post("fn/recycle/logic",e)}function i(e){return P.Z.http.post("fn/supervise/approval/issue",e)}function p(e){return P.Z.http.post("/fn/convert/moduleRuleConvert",e)}function s(e){return P.Z.http.post("fn/opinionSignCheck/todoUpdSign",e)}function h(e,t){var a,n={maininfo:{}};return e.main&&(a=e.main,o()(a).forEach(function(e){var t=e.slice(0),a=(t.shift(),[]);t.forEach(function(t){y()(t).forEach(function(e){a.push({key:e,value:t[e]})})}),n.maininfo[e[0]]={values:a}})),e.multinfos&&(a=JSON.parse(F()(e.multinfos)),o()(a).forEach(function(e){e[1].rows.forEach(function(n){o()(n).forEach(function(e){var t,a;"action"!=e[0]&&"structControl"!=e[0]&&((t=e.slice(0)).shift(),a=[],t.forEach(function(t){y()(t).forEach(function(e){a.push({key:e,value:t[e]})})}),n[e[0]]={values:a})}),delete n.structControl}),n.maininfo[e[0]]&&delete n.maininfo[e[0]]}),n.multinfos=a),e.flowinfo&&(n.flowinfo=e.flowinfo),e.distribinfo&&(n.distribinfo=e.distribinfo),n}var g=a(5044),B=a(66250),n=a(33453),T=a.n(n),n=a(43562),o=a.n(n),n=a(26243),y=a.n(n),n=a(8450),F=a.n(n),n=a(90487),I=a.n(n),n=a(18428),v=a.n(n),n=a(73473),k=a.n(n),n=a(64830),Z=a.n(n),P=a(90541),R=a(25108),c=P.Z.util.loadSessionStore("user");(0,t.Z)(n={releaseNoticeFn:i,save:function(r,i,s,d,c,u,l,m){var n=!(8<arguments.length&&void 0!==arguments[8])||arguments[8],p=!(9<arguments.length&&void 0!==arguments[9])||arguments[9],t=function(){var e=(0,B.Z)(T().mark(function e(){var t,o,a;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=function(){var a,n,t=null,e=(p&&(t=P.Z.layer.loading("提交中")),c.signForm&&c.signForm.length&&c.signForm[0].$refs.currentFile&&c.signForm[0].$refs.currentFile.contentWindow.signMobile&&c.signForm[0].$refs.currentFile.contentWindow.setCompleteHandle(1),c.signForm&&c.signForm.length&&c.signForm[0].$refs.tabEnclosurePreview&&c.signForm[0].$refs.tabEnclosurePreview.setCompleteHandle(1),c.relevantFile&&c.relevantFile.length&&c.relevantFile[0].$refs.enclosure&&!c.relevantFile[0].$refs.enclosure.isPreview&&c.relevantFile[0].$refs.enclosure.$refs.tabEnclosurePreview.setCompleteHandle(1),{moduleId:d.formParams.moduleId,pk:d.formParams.pk||s.main.A0001.value,flowId:(null==(e=s.main.A0006)?void 0:e.value)||i.parameters.flowId,nodeId:r.nodeId||i.parameters.nodeId,nodeName:i.parameters.nodeName,formId:i.parameters.formId,initDataSource:d.$route.query.initDataSource||null,__DATA:F()(h(s)),notVaildateMetas:"main^"+(0,g.Z)(new(I())(d.notVaildateMetas)).join(",")+(n="",(a=s).multinfos&&y()(a.multinfos).forEach(function(e){var t;0<(null==(t=a.multinfos[e].notVaildateMetas)?void 0:t.length)&&(n+="$"+e+"^"+a.multinfos[e].notVaildateMetas.join(","))}),n)}),o=(d.$route.query.todoId&&"2"==d.$route.query.agencyType&&(e.agencyType=2,e.agencyUserId=d.$route.query.agencyUserId,e.agencyUserName=d.$route.query.agencyUserName),d.$route.query.specialSaveObj?JSON.parse(d.$route.query.specialSaveObj):{});f(v()(o,e)).then(function(e){200!=e.data.code?P.Z.layer.toast(e.data.message.split("(")[0]):(P.Z.config.commonForm.saveToStorage&&d.delFormStorage(),d.removeLocalOptions(),d.initSubForm(),u?(P.Z.layer.closeLoading(t),e=m||d.nowButtonParameters,u(d,e,s)):(e=d.nowButtonParameters.successMessage||"表单保存成功",p&&P.Z.layer.toast(e),"save"!=d.nowButton.action||"1"!=d.nowButtonParameters.saveType&&"5"!=d.nowButtonParameters.saveType?d.$eventBus.refresh(d,{text:123,noRefreshTitle:!0}):d.backSucces()),l&&d.backSucces())}).error(function(){})},o=[],y()(i.subform).forEach(function(){var a=(0,B.Z)(T().mark(function e(t,a){var n;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null!=(n=d.$refs)&&null!=(n=n.formTab[0])&&n.$refs[t]&&(n=d.$refs.formTab[0].$refs[t][0].$refs.subform.$refs.nestedForm)&&n.forEach(function(e){o.push(e.$refs.controlNestedForm.saveNestedForm())});case 1:case"end":return e.stop()}},e)}));return function(e,t){return a.apply(this,arguments)}}()),o.length)return e.next=6,k().all(o);e.next=6;break;case 6:if(!d.allFile.length){e.next=15;break}a=0;case 8:if(a<d.allFile.length){if(1==d.allFile[a].allowVerify&&0==d.allFile[a].file.length)return P.Z.layer.toast("".concat(d.allFile[a].name,"不能为空，请上传文件")),e.abrupt("return");e.next=12}else e.next=15;break;case 12:a++,e.next=8;break;case 15:d.$refs.formTab&&d.$refs.formTab.length&&d.$refs.formTab[0].$refs.commonForm&&n?d.$refs.formTab[0].$refs.commonForm.validate().then(function(){t()}).catch(function(e){R.log(e),d.headTab="formTab",d.$nextTick(function(){d.$refs.formTab[0].$refs.commonForm.scrollToField(e[0].name)}),P.Z.layer.toast(e[0].message,!1)}):t();case 16:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();d.spHandleJS&&d.spHandleJS.saveFilter?d.spHandleJS.saveFilter(d.formData,d.formMeta,d,d.nowButtonParameters.action).then(function(e){t()}).catch(function(e){R.log(e),P.Z.layer.toast(e)}):t()},saveNoTip:function(e,t,a,n,o){this.save(e,t,a,n,n.$refs,o,!1,null,!(5<arguments.length&&void 0!==arguments[5])||arguments[5],!1)},saveNestedFormSync:function(e,n,o,r,t,a,i,s){return R.log("Updated111"),new(k())(function(t,a){f({moduleId:n.parameters.moduleId,pk:n.parameters.pk,flowId:n.parameters.flowId,nodeId:n.parameters.nodeId,formId:n.parameters.formId,initDataSource:null,__DATA:F()(h(o)),notVaildateMetas:"main^"+(0,g.Z)(new(I())(r.notVaildateMetas))}).then(function(e){R.log("Updated11"),t(e)}).error(function(e){a(e)})})},saveAndBack:function(e,t,a,n,o,r){this.save(e,t,a,n,o,r,!0)},send:function(i,s,d,o,c,u,l,m){var p=this;return(0,B.Z)(T().mark(function e(){var r,t,a,n;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=function(){return(n=(0,B.Z)(T().mark(function e(t,a){var n,o;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u)return e.next=3,u(t,a,d);e.next=3;break;case 3:t.sendFileData={opinionContent:a.opinionContent,id:a.infoId,moduleId:i.moduleId,sendType:a.sendType||"SR_SEND",pid:a.pid||s.parameters.pId||0,pnid:a.pnid||s.parameters.pnId||0,flowId:a.wfId||s.parameters.flowId,nextLineId:a.nextLineId,info_id:s.parameters.pk,bt:a.bt,moduleName:"",allowEditOpinion:t.shoEditOpinion&&s.parameters.allowEditOpinion,opinionRequired:s.parameters.opinionRequired,direction:a.direction,nodeId:s.parameters.nodeId,hasControlOpinionTagView:t.hasControlOpinionTagView,nextNodeId:a.nextNodeId,isBackTrack:a.isBackTrack,intelligenceSend:a.intelligenceSend,determineUser:a.determineUser||t.$route.query.agencyUserId,disableAutoSend:a.disableAutoSend,agencyType:t.$route.query.agencyType,sendUserId:a.RealUserId,sendUserName:a.RealUserName,sendDeptId:a.RealDeptID,sendDeptName:a.RealDeptName},o=!0,t.formParams.sendCheck=!0,null!=(n=P.Z.config.commonFlow)&&n.openOpinionPopupBeforeSend?0!=t.shoEditOpinion&&0<s.parameters.allowEditOpinion&&!t.alreadyWriteOpintion&&(o=!1,r.BtnWriteOpinion(i,s,d,t,c)):t.hasControlOpinionTagView?Z()(d.flowinfo)[0].opinionContent?t.formParams.sendCheck=!1:(o=!1,P.Z.layer.toast("请填写意见",!1)):s.parameters.opinionRequired&&t.isShowQiXiangJuEditOpinion&&0==t.formParams.isSign?(t.formParams.sendCheck=!1,t.qixiangjuOpinion.length<1&&(o=!1)):s.parameters.opinionRequired&&t.isShowWriteOpintionBtn&&!t.hasControlOpinionTagView&&0==t.formParams.isSign&&(t.formParams.sendCheck=!1,t.currentOpintion.length<1)&&(o=!1,r.BtnWriteOpinion(i,s,d,t,c)),o&&(t.showPopUp=!0,t.alreadyWriteOpintion=!1,t.$nextTick(function(){t.$refs.sendPop.$el.style.display="none",t.$refs.sendFileCom.show()}));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)},a=function(e,t){return n.apply(this,arguments)},r=p,JSON.parse(F()(s)),t=l||o.nowButtonParameters,0==y()(t).length&&(t={pid:s.parameters.pId,pnid:s.parameters.pnId,wfId:s.parameters.flowId}),m&&v()(t,m),t.sendOpinion?s.controls.find(function(e){return"controlEditOpinion"==e.controlType})?(s.controls.find(function(e){return"controlEditOpinion"==e.controlType}).extra.opinionContent+=t.sendOpinion,e.next=16):e.next=12:e.next=16;break;case 12:return o.isShowWriteOpintionBtn=!0,o.alreadyWriteOpintion=!0,e.next=16,P.Z.http.post("/fn/mobileSaveOpinion/saveOpinion?flowId=".concat(s.parameters.flowId,"&nodeId=").concat(s.parameters.nodeId,"&moduleId=").concat(s.parameters.moduleId),{__DATA:F()({info_id:s.parameters.pk,pid:new String(s.parameters.pId),pnid:new String(s.parameters.pnId),opinion:t.sendOpinion,type:"g_inbox"})}).then(function(e){});case 16:p.save(i,s,d,o,c,a,!1,t);case 17:case"end":return e.stop()}},e)}))()},custom1:function(e,t,a,n,o,r){2==a.main["G-REPORT-003"].value?n.$set(a.main,"G-REPORT-003",{value:"4",text:"已调整"}):n.$set(a.main,"G-REPORT-003",{value:"3",text:"已上报"}),this.saveAndBack(e,t,a,n,o,r)},custom2:function(e,t,a,n,o){n.$set(a.main,"G-REPORT-003",{value:"2",text:"已取消"}),this.save(e,t,a,n,o)},deleteFocus:function(e,t,a,n,o){P.Z.layer.loading("提交中");var r={infoId:n.nowButtonParameters.infoId,"x-auth-token":P.Z.util.loadSessionStore("loginToken")};P.Z.http.post("/fn/mobileFocus/deleteFocus",r).then(function(e){e=e.data.message;P.Z.layer.toast(e),"操作成功"==e&&n.initData()})},setFocus:function(e,t,a,n,o){var r;1!=P.Z.config.setting["SYS-MOBILE-FORM-0018"]?(P.Z.layer.loading("提交中"),r={fid:0,infoId:n.nowButtonParameters.infoId,"x-auth-token":P.Z.util.loadSessionStore("loginToken")},P.Z.http.post("fn/mobileFocus/setFocus",r).then(function(e){e.data;P.Z.layer.toast("操作成功"),n.initData()})):n.showChooseFolder=!0},logicDeleteXForm:function(e,t,a,n,o){var r=new Array,i={pk:t.parameters.pk,moduleId:t.parameters.moduleId},s=(r.push(i),{data:F()(r),moduleId:t.parameters.moduleId});P.Z.layer.confirm({message:"是否确认删除",confirmButtonText:"确认"},function(){n.spHandleJS&&n.spHandleJS.beforeDelete?n.spHandleJS.beforeDelete(n.formData,n.formMeta,n).then(function(e){d(s).then(function(e){n.dsf.layer.toast(e.data.message),n.specialJSObj.spHandleJS.afterLogicDeleteXForm&&n.specialJSObj.spHandleJS.afterLogicDeleteXForm(n.formData,n.formMeta,n),n.backSucces()})}):d(s).then(function(e){n.dsf.layer.toast(e.data.message),n.specialJSObj.spHandleJS.afterLogicDeleteXForm&&n.specialJSObj.spHandleJS.afterLogicDeleteXForm(n.formData,n.formMeta,n),n.backSucces()})})},qingDiao:function(e,t,a,n,o){a={pk:a.main.A0001.value,deviceId:"",userId:P.Z.util.loadSessionStore("user").user_id},P.Z.http.post("fn/meeting/signMeeting",a).then(function(e){n.dsf.layer.toast(e.data.message),n.init()}).error(function(){n.dsf.layer.toast("网络忙,请重试")})},zhiDing:function(e,t,a,n,o){a={pk:a.main.A0001.value,type:n.getType()},P.Z.http.post("/fn/mobileToDo/topRead",a).then(function(e){var e=e.data,t=(e.message,e.result);"success"!==e.type&&!t||n.init(),P.Z.layer.toast("操作成功")}).error(function(){P.Z.layer.clear()})},quXiaoZhiDing:function(e,t,a,n,o){a={pk:a.main.A0001.value,type:n.getType()},P.Z.http.post("/fn/mobileToDo/unTopRead",a).then(function(e){var e=e.data,t=(e.message,e.result);"success"!==e.type&&!t||n.init(),P.Z.layer.toast("操作成功")}).error(function(){P.Z.layer.clear()})},reviewed:function(e,t,a,n,o){a={infoIds:a.main.A0001.value,distribIds:a.distribId,shareContent:a.distribinfo?Z()(a.distribinfo)[0].shareContent:"已阅"};P.Z.http.post("fn/mobileToReadOperation/readed",a).then(function(e){var e=e.data,t=(e.message,e.result);"success"!==e.type&&!t||P.Z.layer.toast("阅毕成功",!0,function(){return n.backSucces()})}).error(function(){P.Z.layer.clear()})},instruction:function(e,t,a,n,o){n.showyuebi=!0,n.$nextTick(function(){n.$refs.yuebi.Show()})},"Flow.backSend":function(e,t,a,n,o){this.save(e,t,a,n,o,function(){n.returnNodePop=!0})},dswReaded:function(e,t,a,n,o){var r=t.parameters.pk;this.reviewed(e,t,a,n,o),P.Z.http.post("fn/ybController/ybyb",{pk:r})},partReview:function(e,t,a,n,o){this.save(e,t,a,n,o,function(){n.showSeparate=!0;var e={info_id:a.main.A0001.value};n.$nextTick(function(){n.$refs.readPop.show(e).then(function(){1!=n.nowButtonParameters.refreshForm&&!n.formMeta.controls.find(function(e){return"controlShareRead"==e.controlType})||n.init()},function(e){})})})},rePartReview:function(e,t,a,n,o){this.save(e,t,a,n,o,function(){n.showSeparate=!0;var e={info_id:a.main.A0001.value};n.$route.query.distribId&&"0"!=n.$route.query.distribId&&(e.distribId=n.$route.query.distribId),n.$nextTick(function(){n.$refs.readPop.show(e).then(function(){n.formMeta.controls.find(function(e){return"controlShareRead"==e.controlType})&&n.init()},function(e){})})})},fenYue:function(e,t,a,n,o){this.partReview(e,t,a,n,o)},"xform.shareRead":function(e,t,a,n,o){this.partReview(e,t,a,n,o)},"xform.close":function(e,t,a,n,o){n.$router.go(-1)},viewMeetingSignPD:function(e,t,a,n,o){n.$router.push({path:"/meeting/signup/status",query:{id:a.main.A0001.value}})},videoConferencing:function(e,t,a,n,o){P.Z.video.startWithConf(a.main.A0001.value||a.main.A0001.value||a.main.A0001.value)},processVideo:function(e,t,a,n,o){P.Z.video.startWithForm(a.main.A0001.value||a.main.A0001.value||a.main.A0001.value)},"RemoteDocExchange.remoteFeedback":function(e,t,a,n,o){this.save(e,t,a,n,o,function(t){P.Z.http.post("fn/remoteExchange/feedback?rcvRecordId=".concat(t.$route.params.rcvRecordId,"&feedbackId=").concat(t.$route.params.pk,"&feedbackModuleId=").concat(t.$route.params.moduleId)).then(function(e){"success"==e.data.type&&t.dsf.layer.toast(e.data.message)})})},yiJianHuiZhi:function(e,t,a,n,o){var r=this;P.Z.http.post("fn/remoteExchange/feedbackByServer",{rcvRecordId:a.main.A0001.value,doFeedback:!1}).then(function(e){var e=e.data,t=e.message,a=e.type,e=e.data;"success"===a?n.$router.push({name:"commonForm",params:{pk:e.feedbackId,moduleId:e.feedbackModuleId,rcvRecordId:e.rcvRecordId}}):r.dsf.layer.toast(t)})},showNotice:function(e,t,a,n,o){a=a.main["C-DB-FK-018"].value;n.$router.push({path:"/commonForm/190323145209SuSc9CTjs9rg88i22T1/"+a,query:{listId:"201202164226r9VxOPsVNy6npQnMKST"}})},exchangeFeedbackByRemoteRcv:function(e,t,n,o,a){var r;r={receiveDocId:n.main.A0001.value},P.Z.http.post("fn/remoteExchange/feedbackByServer",r).then(function(e){var e=e.data,t=e.message,a=e.type,e=e.data;"success"===a?o.$router.push({path:"/opinionReceipt",query:{feedbackId:e.feedbackId,feedbackModuleId:e.feedbackModuleId,rcvRecordId:n.main.A0002.value}}):o.dsf.layer.toast(t)}).error(function(){})},back:function(e,t,a,n,o){var r=n.nowButtonParameters,r={pid:r.pid,pnid:r.pnid,wfId:r.wfId};n.dataValue=r,n.showFlowBack=!0,n.$nextTick(function(){n.$refs.wfDialog.show({text:"退回"})})},NoopinionBack:function(e,t,a,n,o){var r=n.nowButtonParameters,r={pid:r.pid,pnid:r.pnid,wfId:r.wfId};n.dataValue=r,n.showFlowBack=!0,n.$nextTick(function(){n.$refs.wfDialog.show({text:"退回原因"})})},feedback:function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"210723164631rGtQC0zTkW9rU5dYlxQ",initDataSource:1,srcInfo:a.main.A0001.value}).then(function(e){200==e.data.code&&n.$router.replace({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:a.main.A0001.value,relationId:a.main.A0001.value,type:"反馈"}})})},deptFeedback:function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"2207191416105iDaeqzLIL5zalLANw6",initDataSource:1,srcInfo:a.main.A0001.value}).then(function(e){200==e.data.code&&n.$router.replace({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:a.main.A0001.value,relationId:a.main.A0001.value}})})},DUBANTIJIAO:function(e,t,a,n,o){this.save(e,t,a,n,o,function(){P.Z.http.post("fn/supervise/approval/feedBack",{pk:a.main.A0001.value,fid:a.main["C-DB-FK-018"].value}).then(function(e){"200"==e.data.code&&P.Z.layer.toast("提交成功",!0,function(){n.$router.go(-1)})})})},Transfer:function(e,t,a,n,o){a={info_id:a.main.A0001.value};n.showPerson=!0,n.dataValue=a,n.isTransfer=!0,n.extra={multiple:!1,tabs:[{action:"fn/user/select/data?types=person&rootObject=5&action=self_org&async=true",name:"本机构",subTabKey:"department"}]}},"xform.changeUser":function(e,t,a,n,o){a={info_id:a.main.A0001.value,pnid:t.parameters.pnId,wfId:t.parameters.flowId,pid:t.parameters.pId};n.showPerson=!0,n.dataValue=a,n.extra={multiple:!1,tabs:[{action:"fn/user/select/data?types=person&rootObject=5&action=self_org&async=true",name:"本机构",subTabKey:"department"}]},n.isTransfer=!0},"xform.cancelReceive":function(e,t,a,n,o){P.Z.layer.confirm({title:"提示",message:"是否确认取消签收？"},function(){var e={pk:n.pk,todoId:n.$route.query.todoId,moduleId:n.moduleId};P.Z.http.post("fn/flow/cancelReceive",e).then(function(e){P.Z.layer.toast(e.data.message,!0,function(){return n.backSucces()})})})},baoMing:function(e,t,a,n,o){a={meetingtzId:a.main.A0001.value,pk:a.main.A0001.value,pnId:t.parameters.pnId,deptBaoming:!0};n.$refs.signFile.show(a).then(function(){P.Z.layer.toast("报名成功",!0),n.init()},function(e){})},duBanQingKuang:function(e,t,a,n,o){a={dataValue:{B0035:a.main.B0035.value}};n.$router.push({name:"InspectorCondition",params:{data:a}})},shenQingYanQi:function(e,t,a){a?this.showDelayform=!0:this.$router.push({name:"DelayForm",params:{data:e}})},banJie:function(e,t,a,n,o){this.$router.push({name:"supervise",params:{info_id:a.main.A0001.value}})},releaseNotice:function(e,t,a,n,o){function r(e,t,a){if(null==t)throw new TypeError("Cannot destructure "+t);t={pk:a.main.A0001.value},P.Z.http.post("fn/supervise/approval/noticeIssue",t).then(function(e){P.Z.layer.toast(e.data.message)})}"190326163643A2kqaNa59H8vqHitU53"==a.main.A0004.value?this.save(e,t,a,n,o,r):i({pk:a.main.A0001.value}).then(function(e){P.Z.layer.toast(e.data.message)})},exchangeReject:function(e,t,a,n,o){a={dataValue:{A0004:a.main.A0004.value,A0001:a.main.A0001.value}};n.$router.push({name:"RejectedSign",params:{data:a}})},leaveMeeting:function(e,t,a,n,o){n.$refs.askLeave.show({meetingtzId:a.main.A0001.value}).then(function(){P.Z.layer.toast("请假成功",!0)})},unconfirmMeeting:function(e,t,a,n,o){a={sqid:a.main.A0001.value},P.Z.http.post("fn/meeting/endMeetingInstance",a).then(function(e){var e=e.data,t=e.message;e.type;n.dsf.layer.toast(t)}).finally(function(){P.Z.layer.closeLoading(loading)})},handleMeetingtzPD:function(e,t,a,n,o){a={meetingtzId:a.main.A0001.value,pk:a.main.A0001.value,pnId:t.parameters.pnId};n.$refs.signFile.show(a).then(function(){P.Z.layer.toast("报名成功",!0),n.init()},function(e){})},huiYiBianGeng:function(e,t,a,n,o){n.$router.push({path:"/meeting/change",query:{pk:a.main.A0001.value,moduleId:a.main.A0004.value}})},qianShouQingKuang:function(e,t,a,n,o){a={remoteId:a.main.A0001.value},P.Z.http.post("fn/remoteExchangeData/getSendRecord",a).then(function(e){"error"==e.data.type?P.Z.layer.toast(e.data.message,!0):(e={dataValue:{fid:e.data.data.sendRecordId}},n.$router.push({name:"signIn",params:{data:e}}))})},agreeRecycle:function(e,t,a,n,o){t={pk:n.pk,todoId:t.parameters.pId+"_"+t.parameters.pnId,moduleId:n.moduleId};P.Z.http.post("fn/flow/agreeRecycle",t).then(function(e){P.Z.layer.toast("操作成功",!0,function(){return n.backSucces()})})},refuseRecycle:function(e,t,a,n,o){t={pk:n.pk,todoId:t.parameters.pId+"_"+t.parameters.pnId,moduleId:n.moduleId};P.Z.http.post("fn/flow/refuseRecycle",t).then(function(e){P.Z.layer.toast("操作成功",!0,function(){return n.backSucces()})})},showSignature:function(e,t,a,n,o){"xunmeng"==P.Z.config.ddSetting.dingdingType?P.Z.http.get("fn/wdct/signOff",{infoId:n.formParams.pk,moduleId:n.formParams.moduleId}).then(function(e){var t,a;"200"==e.data.code?((t=e.data.data).downloadUrl=P.Z.url.getRootPath()+t.downloadUrl+"&x-auth-token=".concat(P.Z.util.loadSessionStore("loginToken")),a={pageIndex:1,url:t.downloadUrl,type:0},P.Z.commonForm.nativeCommon("documentannotate",a).then(function(e){P.Z.http.get(t.saveUrl,{sourceUrl:F()(e.data)}).then(function(e){P.Z.layer.toast("批示成功"),n.$emit("quanyue")})}).catch(function(e){P.Z.layer.toast("批示失败")})):P.Z.layer.toast(e.data.message)}):P.Z.http.get("fn/handWrite/signOff",{infoId:n.formParams.pk,moduleId:n.formParams.moduleId}).then(function(e){var t;"200"==e.data.code?((t=e.data.data).downloadUrl=P.Z.url.getRootPath()+t.downloadUrl,P.Z.dd.signature(t)):P.Z.layer.toast(e.data.message)})},HandWriteSignature:function(e,t,a,n,o){var r="";"signForm"==n.headTab?r=n.$refs.signForm[0].currentFile:"relevantFile"==n.headTab&&(r=n.$refs.relevantFile[0].$refs.enclosure.fileObj),P.Z.http.get("fn/wdct/circle",{infoId:r.infoId,moduleId:r.moduleId,fileId:r.id}).then(function(e){var t,a;"200"==e.data.code?((t=e.data.data).downloadUrl=P.Z.url.getRootPath()+t.downloadUrl+"&x-auth-token=".concat(P.Z.util.loadSessionStore("loginToken")),a={pageIndex:1,url:t.downloadUrl,type:0},P.Z.commonForm.nativeCommon("documentannotate",a).then(function(e){P.Z.http.get(t.saveUrl,{sourceUrl:e.data}).then(function(e){P.Z.layer.toast("批示成功"),n.$eventBus.quanyue(n)})}).catch(function(e){P.Z.layer.toast("批示失败")})):P.Z.layer.toast(e.data.message)})},BtnWriteOpinion:function(e,t,a,n,o){n.showBtnWriteOpintion=!0,n.isShowWriteOpintionBtn=!0,n.alreadyWriteOpintion=!1,n.$nextTick(function(){n.$refs.BtnWriteOpintion.Show()})},YoZoHandWrite:function(e,t,a,n,o){var r="";"signForm"==n.headTab?r=n.$refs.signForm[0].currentFile:"relevantFile"==n.headTab&&(r=n.$refs.relevantFile[0].$refs.enclosure.fileObj),n.$nextTick(function(){n.$router.push({name:"HandwrittenSign",query:{pk:n.formParams.pk,moduleId:n.formParams.moduleId,todoId:n.$route.query.todoId,fileId:r?r.id:""}})})},seeNoticeStatus:function(e,t,a,n,o){n.$router.push({path:"/announcementStatus",query:{pk:a.main.A0001.value,bt:"您有一份标题为【".concat(a.main.B0001.value,"】的公告,请及时处理")}})},"Public.moduleRuleConvert":function(e,t,a,n,o,r,i){var i=i||n.nowButtonParameters,s={convertId:i.convertId,srcInfo:a.main.A0001.value,isEndSrcFlow:i.isEndSrcFlow};r&&(s.initDataSource=r),p(s).then(function(e){200!=e.data.code?P.Z.layer.toast(e.data.message):(e={name:"commonForm",params:{pk:(e=e.data.data).pk,moduleId:e.moduleId}},r&&(e.query={initDataSource:s.initDataSource}),n.$router.push(e))})},"Public.tempModuleRuleConvert":function(e,t,a,n,o){var r=n.nowButtonParameters;this["Public.moduleRuleConvert"](e,t,a,n,o,1,r)},"Public.moduleConvertAndEndNode":function(e,a,t,n,o,r,i){var s=i||n.nowButtonParameters,d={convertId:s.convertId,srcInfo:t.main.A0001.value,isEndSrcFlow:s.isEndSrcFlow};r&&(d.initDataSource=r),p(d).then(function(e){var t;200!=e.data.code?P.Z.layer.toast(e.data.message):(t=e.data.data,e={todoData:'[{"pk":"'+n.formParams.pk+'","pnid":"'+a.parameters.pnId+'"}]'},P.Z.http.post("fn/flow/batchEndNode",e).then(function(e){200==e.data.code?(P.Z.layer.toast("转换成功，源文件已办结",!0),"false"!=F()(s.isOpenForm)&&(e={name:"commonForm",params:{pk:(e=t).pk,moduleId:e.moduleId}},r&&(e.query={flag:d.flag}),n.$router.push(e))):P.Z.layer.toast("办结失败",!1)}))})},tempXtModuleRuleConvert:function(r,i,s,d,c){var u=this,e={pkId:d.formParams.pk,ifZxt:"1"};P.Z.http.post("fn/dealZxtContro/updateNotSenXt",e).then(function(e){var t,a,n,o;"success"==e.data.type?(t=e.data.data.xtStatusCou,a=function(e){return e.findIndex(function(e){return"办结"==e.name})},n=function(e,t){return e.splice(t,1)},o=d.formMeta.buttons,0==t&&(-1!=a(o.commonButtons)?n(a(o.commonButtons)):-1!=a(o.mainButtons)&&n(o.mainButtons,a(o.mainButtons))),u["Public.tempModuleRuleConvert"](r,i,s,d,c)):P.Z.layer.toast(e.data.message)})},dongSendToXt:function(e,t,a,n,o){var r={pkId:n.formParams.pk,ifZxt:"-1"};P.Z.http.post("fn/dealZxtContro/notSenXt",r).then(function(e){"success"==e.data.type&&f({moduleId:t.parameters.moduleId,pk:t.parameters.pk,flowId:t.parameters.flowId,nodeId:t.parameters.nodeId,formId:t.parameters.formId,initDataSource:null,__DATA:F()(h(a)),notVaildateMetas:"main^"+(0,g.Z)(new(I())(n.notVaildateMetas))}).then(function(e){200!=e.data.code?P.Z.layer.toast(e.data.message.split("(")[0]):n.initData()})})},fileCodeToVoid:function(e,t,a,n,o){P.Z.layer.confirm({title:"提示",message:"确定要文号作废吗？"},function(){P.Z.http.post("fn/dqFileCodeUse/toVoid?pk=".concat(n.formParams.pk)).then(function(e){P.Z.layer.toast(e.data.message),"success"==e.data.type&&n.$eventBus.emitRefreshFilecode(n,{})})})},"Flow.endInstance":function(e,t,a,n,o){P.Z.layer.confirm({message:"是否确定办结文件？",confirmButtonText:"确认"},function(){P.Z.http.post("/fn/flow/endInstance",{pk:n.formParams.pk}).then(function(e){200!=e.data.code?P.Z.layer.toast(e.data.message):n.spHandleJS.afterEndInstance?n.spHandleJS.afterEndInstance(n):P.Z.layer.toast("操作成功",!0,function(){return n.backSucces()})})})},bjSw:function(t,a,n,o,r){var i=this;o.saveNoTip(function(){P.Z.http.post("fn/sw/queryCount",{pk:a.parameters.pk,pnId:a.parameters.pnId}).done(function(e){"success"==e.type?0<e.data?i.batchEndNode(t,a,n,o,r):P.Z.layer.toast("办理意见、上传附件、关联文件至少选择一项上传",!1):P.Z.layer.toast("操作失败",!1)}).error(function(e){R.log("queryCount-err",e),P.Z.layer.toast("操作失败",!1)})})},transaction:function(e,t,a,n,o){P.Z.http.post("ctrl/wdct/checkClean",{pk:t.parameters.pk,pnid:t.parameters.pnId||n.$route.query.pnId}).then(function(e){"false"==e.data.message?P.Z.layer.alert({title:"提示",message:"请在pc端中，完成抄清操作",confirmButtonText:"知道了"},function(){}):n.isShowTransactionActionSheet=!0})},noticeSend:function(e,t,a,n,o){this.NoticePublish(e,t,a,n,o)},NoticePublish:function(t,e,a,n,o){P.Z.layer.loading("发布中"),f({moduleId:n.formParams.moduleId,pk:n.formParams.pk||a.main.A0001.value,flowId:t.flowId||e.parameters.flowId,nodeId:t.nodeId||e.parameters.nodeId,formId:e.parameters.formId,initDataSource:n.$route.query.initDataSource||null,__DATA:F()(h(a))}).then(function(e){200!=e.data.code?P.Z.layer.toast(e.data.message):P.Z.http.post("/fn/notice/publish",{pks:n.formParams.pk,moduleId:t.moduleId}).then(function(e){200!=e.data.code?P.Z.layer.toast(e.data.message):P.Z.layer.toast("成功",!0,function(){return n.backSucces()})})}).error(function(){})},cancelPublish:function(e,t,a,n,o){n.$dialog.confirm({title:"提示",message:"是否确认取消发布该条通知公告"}).then(function(){R.log("then"),P.Z.http.post("fn/notice/cancelPublish",{pks:n.formParams.pk,moduleId:e.moduleId}).then(function(e){200==e.data.code&&P.Z.layer.toast(e.data.message,!0,function(){return n.backSucces()})})}).catch(function(){R.log("cancell")})},delayTodo:function(e,t,a,n,o){var r=this;P.Z.layer.confirm({message:"是否缓办该表单",confirmButtonText:"确认"},function(){r.save(e,t,a,n,o),P.Z.http.post("fn/flow/delayTodo",{pnIds:t.parameters.pnId,isDelay:!0}).then(function(e){200==e.data.code?P.Z.layer.toast(e.data.message,function(){return n.backSucces()}):P.Z.layer.toast(e.data.message)})})},cancelDelayTodo:function(e,t,a,n,o){P.Z.layer.confirm({message:"是否取消缓办",confirmButtonText:"确认"},function(){P.Z.http.post("fn/flow/delayTodo",{pnIds:t.parameters.pnId,isDelay:!1}).then(function(e){200==e.data.code?P.Z.layer.toast(e.data.message,function(){return n.backSucces()}):P.Z.layer.toast(e.data.message)})})},changeMeetingInfo:function(t,a,n,o,r){var i=this;if("1"==n.main["c-meetingsqbg-002"].value){if(n.main["c-meetingsqbg-003"].value==n.main["c-meetingsqbg-004"].value&&n.main["c-meetingsqbg-005"].value==n.main["c-meetingsqbg-007"].value&&n.main["c-meetingsqbg-012"].value==n.main["c-meetingsqbg-013"].value&&n.main["c-meetingsqbg-006"].value==n.main["c-meetingsqbg-008"].value&&n.main["c-meetingsqbg-043"].value==n.main["c-meetingsqbg-001"].value)return void P.Z.layer.toast("没有信息变化，无需变更！");P.Z.http.post("fn/meetingRoomOccupy/checkRoomOccupy",{pk:o.$route.query.fid,hys:n.main["c-meetingsqbg-004"].value||n.main["c-meetingsqbg-003"].value,sdate:n.main["c-meetingsqbg-007"].value||n.main["c-meetingsqbg-005"].value,edate:n.main["c-meetingsqbg-008"].value||n.main["c-meetingsqbg-006"].value}).then(function(e){"success"==e.data.type?P.Z.layer.confirm({message:"是否确认变更",confirmButtonText:"确认"},function(){i.send(t,a,n,o,r,s)}):P.Z.layer.toast(e.data.message)})}else P.Z.layer.confirm({message:"是否取消会议",confirmButtonText:"确认"},function(){i.send(t,a,n,o,r,s)});var s=function(){P.Z.layer.toast("变更成功",function(){return o.backSucces()})}},issueNotice:function(t,a,n,o,r){function i(){P.Z.http.post("fn/meetingNotice/issueNotice",{pk:a.parameters.pk}).then(function(e){R.log(e),200==e.data.code?P.Z.layer.toast("下发通知成功",!0,function(){return o.backSucces()}):P.Z.layer.toast("下发通知失败",!1)})}var s=this;n.main["c-meetingtz-019"].value?n.main["c-meetingtz-020"].value?n.main["c-meetingtz-010"].value?P.Z.http.post("fn/meetingRoomOccupy/checkRoomOccupy",{pk:n.main.B0035.value,hys:n.main["c-meetingtz-010"].value,sdate:n.main["c-meetingtz-019"].value,edate:n.main["c-meetingtz-020"].value}).then(function(e){"success"==e.data.type?P.Z.layer.confirm({message:"是否确认下发通知",confirmButtonText:"确认"},function(){s.save(t,a,n,o,r,i)}):P.Z.layer.toast(e.data.message)}):P.Z.layer.toast("会议室不能为空"):P.Z.layer.toast("结束时间不能为空"):P.Z.layer.toast("开始时间不能为空")},singleMeetingIssueNotice:function(e,t,a,n,o){this.save(e,t,a,n,o,function(){P.Z.http.post("ctrl/meetingRemote/singleMeetingIssueNotice",{pk:t.parameters.pk}).then(function(e){R.log(e),"200"==e.status&&P.Z.layer.toast("下发通知成功",function(){n.backSucces()})})})},goSignUpForm:function(e,t,a,n,o){var r;t.parameters.todoId&&"230517224206lQszMtXvkQGlirGaxBu"!=t.parameters.moduleId?P.Z.http.post("fn/meetingNotice/getBmInfoById",{pk:t.parameters.todoId.split("_")[0]}).then(function(e){200==e.data.code&&n.$router.push({name:"commonForm",params:{moduleId:e.data.data.moduleId,pk:t.parameters.todoId.split("_")[0]},query:{listId:"MeetingList",method:"customNode",validateByList:1,showNodeId:"19",pk:t.parameters.todoId.split("_")[0],type:"1",isback:2}})}):(r={},r=1==n.$route.query.noticeType?{listId:"MeetingList",method:"chooseMember",validateByList:1,type:1,isback:2}:2==n.$route.query.noticeType?{listId:"MeetingList",method:"reportMember",validateByList:1,isback:2}:{listId:"MeetingList",method:"reportMember",validateByList:1,formId:"230603000903YhuPIxN0fH1JJHUbrj0",isback:2},n.$router.push({name:"commonForm",params:{moduleId:n.$route.query.signUpModuleId||t.parameters.moduleId,pk:n.$route.query.signUpPk||t.parameters.pk},query:r}))},reportBm:function(t,a,n,o,r){var e,i=this,s="";for(e in n.multinfos)0<n.multinfos[e].rows.length&&n.multinfos[e].rows.forEach(function(e){s+=e["c-meetingchry-002"].value+","});P.Z.http.post("fn/meetingNotice/checkSignup",{pk:a.parameters.pk,userIds:s,fid:n.main.A0031.value}).then(function(e){R.log(e),e.data.data?P.Z.layer.toast(e.data.data):i.save(t,a,n,o,r,d)});var d=function(){P.Z.http.post("ctrl/meetingNotice/submitSignUp",{pk:a.parameters.pk}).then(function(e){R.log(e.data),200==e.data.code||200==e.code?P.Z.layer.toast("上报成功","success",function(){o.$route.query.isback?o.backSucces(o.$route.query.isback):o.backSucces()}):P.Z.layer.toast(e.data.message)})}},IParticipate:function(e,t,a,n,o){var r=P.Z.util.loadSessionStore("user");R.log(r),t.parameters.todoId?P.Z.http.post("fn/meetingNotice/getBmInfoById",{pk:t.parameters.todoId.split("_")[0]}).then(function(e){200==e.data.code&&n.$router.push({name:"commonForm",params:{moduleId:e.data.data.moduleId,pk:t.parameters.todoId.split("_")[0]},query:{listId:"MeetingList",method:"reportMember",validateByList:1,userId:r.user_id,deptId:r.deptId,isback:2}})}):n.$router.push({name:"commonForm",params:{moduleId:n.$route.query.signUpModuleId||t.parameters.moduleId,pk:n.$route.query.signUpPk||t.parameters.pk},query:{listId:"MeetingList",method:"reportMember",validateByList:1,userId:r.user_id,deptId:r.deptId,isback:2}})},OtherParticipate:function(e,t,a,o,n){a={info_id:a.main.A0001.value,pnid:t.parameters.pnId,wfId:t.parameters.flowId,pid:t.parameters.pId};o.showPerson=!0,o.dataValue=a,o.extra={typesString:"person,department,post,group,privateGroup",rootObject:"5",multiple:!0,tabs:[{key:"self_dept",action:"fn/user/select/data?types=person&rootObject=1&action=self_dept&async=true&excludeIds=".concat(P.Z.util.loadSessionStore("user").user_id),urlParams:{}}]},o.getSelectUser=function(e){R.log(e);var a="",n="";e.forEach(function(e,t){a+=0==t?e.id:","+e.id,n+=0==t?e.attrs.deptId:","+e.attrs.deptId}),t.parameters.todoId?P.Z.http.post("fn/meetingNotice/getBmInfoById",{pk:t.parameters.todoId.split("_")[0]}).then(function(e){200==e.data.code&&o.$router.push({name:"commonForm",params:{moduleId:e.data.data.moduleId,pk:t.parameters.todoId.split("_")[0]},query:{listId:"MeetingList",method:"reportMember",validateByList:1,userId:a,deptId:n,isback:2}})}):o.$router.push({name:"commonForm",params:{moduleId:o.$route.query.signUpModuleId||t.parameters.moduleId,pk:o.$route.query.signUpPk||t.parameters.pk},query:{listId:"MeetingList",method:"reportMember",validateByList:1,userId:a,deptId:n,isback:2}})}},departmentalRegistration:function(e,t,a,o,n){a={info_id:a.main.A0001.value,pnid:t.parameters.pnId,wfId:t.parameters.flowId,pid:t.parameters.pId};o.showPerson=!0,o.dataValue=a,o.extra={typesString:"person,department,post,group,privateGroup",rootObject:"5",multiple:!0,tabs:[{key:"self_dept",action:"fn/user/select/data?types=person&rootObject=3&action=self_dept&async=true",urlParams:{}}]},o.getSelectUser=function(e){R.log(e);var a="",n="";e.forEach(function(e,t){a+=0==t?e.id:","+e.id,n+=0==t?e.attrs.deptId:","+e.attrs.deptId}),t.parameters.todoId?P.Z.http.post("fn/meetingNotice/getBmInfoById",{pk:t.parameters.todoId.split("_")[0]}).then(function(e){200==e.data.code&&o.$router.push({name:"commonForm",params:{moduleId:e.data.data.moduleId,pk:t.parameters.todoId.split("_")[0]},query:{listId:"MeetingList",method:"reportMember",validateByList:1,userId:a,deptId:n,isback:2}})}):o.$router.push({name:"commonForm",params:{moduleId:o.$route.query.signUpModuleId||t.parameters.moduleId,pk:o.$route.query.signUpPk||t.parameters.pk},query:{listId:"MeetingList",method:"reportMember",validateByList:1,userId:a,deptId:n,isback:2}})}},applicationSituation:function(e,t,a,n,o){n.$router.push({path:"/meetingEnter",query:{pk:t.parameters.pk}})},SeatingView:function(e,t,a,n,o){P.Z.http.post("fn/meetingRoomOccupy/seatView",{pk:a.main.B0035.value,moduleId:t.parameters.moduleId}).then(function(e){R.log(e),"200"===e.data.code?"2"==e.data.data.seatType?(0,r.Z)([e.data.data.imgUrl]):"1"!=e.data.data.seatType||fileId?"1"==e.data.data.seatType&&fileId&&(0,r.Z)([e.data.data.imgUrl]):P.Z.layer.toast("未上传座位图，请导入"):P.Z.layer.toast(e.data.data.message)})},newMeetingLeave:function(e,t,a,n,o){function r(){P.Z.http.post("/fn/meetingNotice/leave",{pk:t.parameters.pk}).then(function(e){200==e.data.code?(P.Z.layer.toast("请假成功"),n.backSucces(2)):P.Z.layer.toast("请假失败")})}var i=this;P.Z.layer.confirm({message:"是否确认请假",confirmButtonText:"确认"},function(){i.save(e,t,a,n,o,r)})},meetingLeaveToBmd:function(e,t,a,n,o){t.parameters.todoId?P.Z.http.post("fn/meetingNotice/getBmInfoById",{pk:t.parameters.todoId.split("_")[0]}).then(function(e){200==e.data.code&&n.$router.push({name:"commonForm",params:{moduleId:e.data.data.moduleId,pk:t.parameters.todoId.split("_")[0]},query:{listId:"MeetingList",method:"customNode",validateByList:1,showNodeId:"19",pk:t.parameters.todoId.split("_")[0],type:"2"}})}):n.$router.push({name:"commonForm",params:{moduleId:n.$route.query.signUpModuleId,pk:n.$route.query.signUpPk},query:{listId:"MeetingList",method:"chooseMember",validateByList:1,type:2}})},meetingEntrust:function(e,t,a,n,o){t.parameters.todoId?P.Z.http.post("fn/meetingNotice/getBmInfoById",{pk:t.parameters.todoId.split("_")[0]}).then(function(e){200==e.data.code&&n.$router.push({name:"commonForm",params:{moduleId:e.data.data.moduleId,pk:t.parameters.todoId.split("_")[0]},query:{listId:"MeetingList",method:"customNode",validateByList:1,showNodeId:"19",pk:t.parameters.todoId.split("_")[0],type:"3"}})}):n.$router.push({name:"commonForm",params:{moduleId:n.$route.query.signUpModuleId,pk:n.$route.query.signUpPk},query:{listId:"MeetingList",method:"chooseMember",validateByList:1,type:3}})},newMeetingTrunTo:function(e,t,a,n,o){a={info_id:a.main.A0001.value,pnid:t.parameters.pnId,wfId:t.parameters.flowId,pid:t.parameters.pId};n.showPerson=!0,n.dataValue=a,n.extra={typesString:"person,department,post,group,privateGroup",rootObject:"5",multiple:!1,tabs:[{key:"self_dept",action:"fn/user/select/data?types=person&rootObject=1&action=self_dept&async=true",urlParams:{}}]},n.isTransfer=!0,n.getSelectUser=function(a){R.log(a);var e=null;if(a.forEach(function(e,t){e.children&&0<e.children.length&&a.splice(t,1)}),n.isTransfer){if(1<a.length)return void P.Z.layer.toast("请仅选中一人转交",!0);e=a[0]}P.Z.http.post("fn/meetingNotice/trunTo",{pk:n.$route.query.signUpPk,userId:e.id,userName:e.name,userSchema:"".concat(e.type,"::").concat(e.id)}).then(function(e){200==e.data.code?P.Z.layer.toast("转交成功",!0,function(){n.backSucces()}):P.Z.layer.toast("转交失败",!1)})}},meetingSignUp:function(e,t,a,n,o){this.send(e,t,a,n,o,function(){P.Z.http.post("/fn/meetingNotice/reportBm",{pk:t.parameters.pk}).then(function(e){200==e.data.code?P.Z.layer.toast("报名成功",!0,function(){return n.backSucces()}):P.Z.layer.toast("报名失败",!1)})})},meetingLeave:function(e,t,a,n,o){function r(){P.Z.http.post("/fn/meetingNotice/leave",{pk:t.parameters.pk}).then(function(e){200==e.data.code?P.Z.layer.toast("请假成功",!0,function(){return n.backSucces()}):P.Z.layer.toast("请假失败",!1)})}var i=this;P.Z.layer.confirm({message:"是否确认请假？",confirmButtonText:"确认"},function(){i.send(e,t,a,n,o,r)})},meetingTurnTo:function(e,o,t,r,a){var i={info_id:t.main.A0001.value,pnid:o.parameters.pnId,wfId:o.parameters.flowId,pid:o.parameters.pId};r.showPerson=!0,r.dataValue=i,r.extra={multiple:!1,tabs:[{action:"fn/user/select/data?types=person&rootObject=5&action=self_org&async=true",name:"本机构",subTabKey:"department"}]},r.isTransfer=!0,r.getSelectUser=function(a){R.log("getSelectUser",a);var t=null;if(a.forEach(function(e,t){e.children&&0<e.children.length&&a.splice(t,1)}),r.isTransfer){if(1<a.length)return void P.Z.layer.toast("请仅选中一人委托",!1);t=a[0]}var e=P.Z.util.loadSessionStore("user"),n=a.map(function(e){return e.id.replace("person_","")}),e={pk:i.info_id,pId:i.pid,pnId:i.pnid,fromUserId:e.user_id,userId:n.join(","),userName:a.map(function(e){return e.name}).join(","),deptId:a.map(function(e){return e.pid}).join(","),deptName:""};P.Z.http.post("/fn/flow/changeUser",e).done(function(e){R.log("changeUser",e),"success"==e.type?P.Z.http.post("fn/meetingNotice/trunTo",{pk:o.parameters.pk,userId:t.id,userName:t.name,userSchema:"".concat(t.type,"::").concat(t.id)}).done(function(e){200==e.code?P.Z.layer.toast("委托成功",!0,function(){return r.backSucces()}):P.Z.layer.toast("委托失败",!1)}):P.Z.layer.toast(e.message,!1)}).error(function(e){return R.log(e)}).always()}},MeetingJiYao:function(e,t,a,n,o){R.log("11"),P.Z.http.post("/ctrl/meeting/getHyjyByHyId",{pk:t.parameters.pk}).then(function(e){R.log(e)})},FaQiqunliao:function(e,t,a,n,o){dd.biz.contact.createGroup({corpId:"dinga215a69365c38b4e24f2f5cc6abecb85",users:["68322808-685947715","0428350360389383399","10070005571930976529"],onSuccess:function(e){},onFail:function(e){}})},ShiPin:function(e,t,a,n,o){dd.biz.conference.videoConfCall({title:"视频会议",calleeCorpId:"dinga215a69365c38b4e24f2f5cc6abecb85",calleeStaffIds:["68322808-685947715","0428350360389383399","10070005571930976529"],onSuccess:function(){},onFail:function(){}})},btnBWFW:function(e,t,a,n,o){a.main["210419103326nLnnu9jebQUtgOvASMx"].value="1",this.save(e,t,a,n,o,function(){n.$router.push({name:"commonForm",params:{moduleId:n.formParams.moduleId,pk:n.formParams.pk},query:{formId:"210830173152r9RoWUtbmDiuH3qkM4W"}})})},btnDelBWFW:function(e,t,a,n,o){a.main["210419103326nLnnu9jebQUtgOvASMx"].value="0",this.save(e,t,a,n,o,function(){})},batchEndNode:function(e,t,a,n,o){var r={todoData:'[{"pk":"'+n.formParams.pk+'","pnid":"'+t.parameters.pnId+'"}]'};P.Z.layer.confirm({message:"是否确定办结文件？",confirmButtonText:"确认"},function(){P.Z.http.post("fn/flow/batchEndNode",r).then(function(e){200==e.data.code?P.Z.layer.toast("办结成功",!0,function(){return n.backSucces()}):P.Z.layer.toast("办结失败",!1)})})},openMeetingFeedback:function(e,t,a,n,o){P.Z.http.post("fn/qfhy/getFeedbackId",{pk:a.main.A0001.value,userId:P.Z.util.loadSessionStore("user").user_id,fklx:1}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/2104141606331OznBwa4xmtnxhSqh0a/".concat(e.data.data.pk)})})},ckcxqk:function(e,t,a,n,o){n.$router.push({path:"/commonList/210419095025TxVutUdY12sOd4xXzW0/2104141711253iKSCQ3bJElFKMNksTA",query:{secQuery:'{"hyId": "'.concat(a.main.A0001.value,'"}'),notLink:1}})},goList1:function(e,t,a,n,o){n.$router.push({path:"/commonList/210912190154BBu4DDZxWW1fPHjdcMS/210608105939mkuTUSzHdhowHPHxlY8",query:{secQuery:'{"fid": "'.concat(e.pk,'"}'),fid:e.pk}})},goList2:function(e,t,a,n,o){n.$router.push({path:"/commonList/210912185726VzhfDurrSSVxw35J8Qh/210723164628N6ZfKTUlQtwXLTT7Mrg",query:{secQuery:'{"fid": "'.concat(e.pk,'"}'),fid:e.pk}})},smsUserSign:function(e,t,a,n,o){a.main["C-SMS-0013"]&&(a.main["C-SMS-0013"].value+="【".concat(c.name,"】"))},smsDeptSign:function(e,t,a,n,o){a.main["C-SMS-0013"]&&(a.main["C-SMS-0013"].value+="【".concat(c.deptName,"】"))},approvalVisitAgree:function(e,t,a,n,o){a.main["C-RBS-VISITOR-016"]&&(a.main["C-RBS-VISITOR-016"].value="1",a.main["C-RBS-VISITOR-016"].text="同意",n.btnAction("send"))},approvalVisitDisagree:function(e,t,a,n,o){a.main["C-RBS-VISITOR-016"]&&(a.main["C-RBS-VISITOR-016"].value="-1",a.main["C-RBS-VISITOR-016"].text="不同意",n.btnAction("send"))},acknowledgeReceipt:function(e,t,a,n,o){a.main["C-DB-0081"]&&(1==a.main["C-DB-0081"].value?P.Z.layer.confirm({message:"请确认本人是否是该督办件的经办人?",confirmButtonText:"确认"},function(){n.btnAction("send")}):n.btnAction("send"))},toFormtab:function(e,t,a,n,o){n.formStyle?n.formStyle=0:n.formStyle=1},flowinfo:function(e,t,a,n,o){n.isShowQiXiangJuFlow=!0},opinionView:function(e,t,a,n,o){n.isShowQiXiangJuOpinion=!0},qxjEditOpinion:function(e,t,a,n,o){n.isShowQiXiangJuEditOpinion=!0,n.isShowWriteOpintionBtn=!0,R.log(n.nowButton),n.$nextTick(function(){n.$refs.QiXiangJuEditOpinion.Show(),n.nowButton.xpath&&n.$refs.QiXiangJuEditOpinion.setXpath(n.nowButton.xpath)})},flowEnd:function(e,a,t,n,o){function r(e){P.Z.http.post("fn/flow/batchEndNode",{todoData:F()(e)}).then(function(e){200==e.data.code?P.Z.layer.toast("办结成功",!0,function(){return n.backSucces()}):P.Z.layer.toast("办结失败",!1)})}P.Z.http.post("fn/cmaEndNode/checkIssueStatus",{pk:n.formParams.pk,pnId:a.parameters.pnId}).then(function(e){var t=[{pk:n.formParams.pk,pnid:a.parameters.pnId}];e.data.data.deptName?P.Z.layer.confirm({message:"当前文件正由协办单位办理，确定结束将会影响协办单位文件办理!",confirmButtonText:"确认"},function(){e.data.data.pnIdArray.forEach(function(e){t.push({pk:n.formParams.pk,pnid:e.pnId})}),r(t)}):r(t)})},sendNote:function(e,t,a,n,o){var r;n.$route.query.todoId||n.$route.query.distribId?(r=n.$route.query.todoId?"ToDo":"ToRead",n.$router.push({path:"/TabCommonForm/Note/0/180725205942uc2zjrqnTt5sg7ReWmV",query:{formType:r,formPk:n.$route.query.todoId||n.$route.query.distribId}})):P.Z.layer.toast("当前模块暂无此功能")},"Flow.refuse":function(e,t,a,n,o){this.send(e,t,a,n,o,null,null,{direction:-1})},"Flow.pass":function(e,t,a,n,o){this.send(e,t,a,n,o,null,null,{direction:1})},"Flow.sendToLine":function(e,t,a,n,o){this.send(e,t,a,n,o)},assetCheck:function(e,t,a,n,o){n.$router.push({path:"/assetInventory",query:{showBtn:1,qcId:e.pk}})},inventory:function(e,t,a,n,o){n.$router.push("/commonList/211230155130PulGlXwmXzMg0s7PYTs/211230143315oQvGkV0bGLgCJF0BYFf?notLink=1&title=清查情况")},mobileFlowRecycle:function(e,t,a,n,o){P.Z.layer.confirm({message:"确认回收此份文件吗?",confirmButtonText:"确认"},function(){var e={pk:t.parameters.pk,flowId:t.parameters.flowId,pId:t.parameters.pId,pnId:t.parameters.pnId,fPnId:t.parameters.fid,bt:"",userId:P.Z.util.loadSessionStore("user").user_id,nodeName:""};P.Z.http.post("fn/mobileFlow/recycle",e).then(function(e){e.data.result?P.Z.layer.toast(e.data.message,!0,function(){return n.backSucces()}):P.Z.layer.toast(e.data.message)})})},reclaimFiles:function(e,t,a,n,o){P.Z.layer.confirm({message:"确认回收此份文件吗?",confirmButtonText:"确认"},function(){var e={pk:n.$route.query.infoId,flowId:n.$route.query.flowId,pId:n.$route.query.pId,pnId:n.$route.query.pnId,fPnId:n.$route.query.fid,bt:"",userId:P.Z.util.loadSessionStore("user").user_id,nodeName:""};P.Z.http.post("fn/flow/recycle",e).then(function(e){e.data.result?P.Z.layer.toast(e.data.message,!0,function(){return n.backSucces()}):P.Z.layer.toast(e.data.message)})})},signUserName:function(e,t,a,n,o){s({pid:t.parameters.pId,pnid:t.parameters.pnId,isSign:1,pk:n.formParams.pk}).then(function(e){e.data;e=t.buttons.mainButtons.find(function(e){return"signUserName"==e.action});e.action="cancelSignUserName",e.name="取消签名",P.Z.layer.toast("签名成功")}).catch(function(e){R.log(e),P.Z.layer.toast("操作失败")})},cancelSignUserName:function(e,t,a,n,o){s({pid:t.parameters.pId,pnid:t.parameters.pnId,isSign:0,pk:n.formParams.pk}).then(function(e){e.data;e=t.buttons.mainButtons.find(function(e){return"cancelSignUserName"==e.action});e.action="signUserName",e.name="签名",P.Z.layer.toast("取消签名成功")}).catch(function(e){R.log(e),P.Z.layer.toast("操作失败")})},toCreatePersonalAgenda:function(e,t,a,n,o){P.Z.http.post("ctrl/sdycCommonController/toCreatePersonalAgenda",{pk:n.formParams.pk}).then(function(e){200==e.data.code?n.$router.push("/commonForm/180719094152MnF6C2hEPtqIvhjJIxo/".concat(e.data.data.pk)):P.Z.layer.toast(e.data.message)})},reShareInfoSdyc:function(e,t,a,n,o){var r={info_id:a.main.A0001.value};n.separateTabs=[{action:"fn/user/select/data?types=person&rootObject=1&action=self_dept&async=true",name:"本部门",subTabKey:"department"}],n.showSeparate=!0,n.$nextTick(function(e){n.$refs.readPop.show(r)})},sdycAuthAttention:function(e,t,a,n,o){this.save(e,t,a,n,o,function(){n.$router.push("/commonForm/220312111313dbJt7LhwcN926JU2Exh?formId=220312111553JSGNoLqb3WDBqNLoA8P&infoId=".concat(e.pk))})},sdycAuthAttentionSure:function(e,t,a,n,o){n.formData.main["220312112056WneBhpkupoW3EWDfipt"].value?P.Z.http.post("fn/authAttention/saveData",{infoId:n.$route.query.infoId,userId:n.formData.main["220312112056WneBhpkupoW3EWDfipt"].value,userName:n.formData.main["220312112056WneBhpkupoW3EWDfipt"].text,userSchema:n.formData.main["220312112056WneBhpkupoW3EWDfipt"].schema,msg:n.formData.main["220312105343lkMYl5vkBrCucLyKkeW"].value}).then(function(e){200==e.data.code?P.Z.layer.toast("授权关注成功",!0,function(){return n.backSucces()}):P.Z.layer.toast(e.data.message)}):P.Z.layer.toast("请选择接收人")},sdycAuthAttentionList:function(e,t,a,n,o){n.$router.push({path:"/commonList/220312112323qE4N32wpnJkHiph7HAv/220312111313dbJt7LhwcN926JU2Exh",query:{secQuery:F()({sourcePk:e.pk})}})},"Flow.proxyFormSend":function(a,n,e,t,o){var r="flow-".concat(t.formParams.pk,"-").concat(n.parameters.pId,"-").concat(n.parameters.pnId),r=(e.flowinfo[r]&&t.$set(e.main,"S-PROCESS-0030",{value:e.flowinfo[r].opinionContent}),t.nowButtonParameters);0==y()(r).length&&(r={determineUser:e.main["S-PROCESS-0005"].value,determineInfoId:e.main["S-PROCESS-0003"].value,pid:e.main["S-PROCESS-0004"].value,pnid:e.main["S-BASE-0001"].value}),this.save(a,n,e,t,o,function(e,t){e.sendFileData={id:"",moduleId:a.moduleId,sendType:"SR_SEND",pid:t.pid||0,pnid:t.pnid||0,flowId:"",info_id:t.determineInfoId,bt:"",moduleName:"",allowEditOpinion:e.shoEditOpinion&&n.parameters.allowEditOpinion,opinionRequired:n.parameters.opinionRequired,direction:t.direction,nodeId:n.parameters.nodeId,determineUser:t.determineUser,determineInfoId:t.determineInfoId},e.showPopUp=!0,e.$nextTick(function(){e.$refs.sendFileCom.show()})},!1,r)},openOpinion2:function(e,t,a,n,o){var r=n.formParams.pk,i=n.formParams.moduleId;P.Z.http.post("fn/opinionc/yjdl",{pk:r}).then(function(e){"success"==(e=e.data).type?n.$router.push({path:"/commonForm/190314094242VQ9wScyToHKiCEnz45L/".concat(e.message),query:{listId:"1903141007552oa8qPy14Jli1PosdgD",method:"view",validateByList:1,originModuleId:i,originPk:r,status:1,specialSaveObj:F()({originModuleId:i,originPk:r})}}):P.Z.layer.toast("无可代录意见！")})},reject:function(e,t,a,n,o){n.nowButton.parameters.length?n.$refs.rejectDialog.show(n.nowButton.parameters[0].name).then(function(e){P.Z.http.post(n.nowButton.parameters[0].value,{pk:n.formParams.pk,reason:e}).then(function(e){e=e.data;P.Z.layer.toast(e.message,!0,function(){return n.backSucces()})})}):P.Z.layer.toast("当前按钮未配置参数")},noteReply:function(e,t,a,n,o){n.$router.push({path:"/commonForm/".concat(e.moduleId),query:{method:"create",listId:"180726211007WCqjA6vmt7HaNaInl7U",replyId:e.pk}})},noteForward:function(e,t,a,n,o){n.$router.push({path:"/commonForm/".concat(e.moduleId),query:{method:"create",listId:"180726211007WCqjA6vmt7HaNaInl7U",forwardIds:e.pk}})},noteSave:function(e,t,a,n,o){a={id:n.noteId,noteTitle:a.main.B0001?a.main.B0001.value:"",content:a.main["C-BJ-0001"]?a.main["C-BJ-0001"].value:"",range:a.main["C-BJ-0002"]?a.main["C-BJ-0002"].value:"",rangeName:a.main["C-BJ-0002"]?a.main["C-BJ-0002"].text:"",rangeSchema:a.main["C-BJ-0002"]?a.main["C-BJ-0002"].schema:"",jccd:a.main.B0006?a.main.B0006.value:"",jccdText:a.main.B0006?a.main.B0006.text:"",isSms:a.main["C-BJ-0024"]?a.main["C-BJ-0024"].value:"-1",isSmsText:a.main["C-BJ-0024"]?a.main["C-BJ-0024"].text:"否",smsContent:a.main["C-BJ-0025"]?a.main["C-BJ-0025"].value:"",file:{attach:n.allFile.length&&n.allFile[0].uploadObj||[]}},n.$route.query.replyId&&(a.replyId=n.$route.query.replyId),n.$route.query.forwardIds&&(a.forwardIds=n.$route.query.forwardIds),a={__DATA:F()(a),moduleId:n.moduleId};P.Z.http.post("fn/mobileNote/save",a).then(function(e){e.data.result?P.Z.layer.toast(e.data.message,!0):P.Z.layer.toast(e.data.message,!1)})},noteSend:function(e,t,a,n,o){a={id:n.noteId,noteTitle:a.main.B0001?a.main.B0001.value:"",content:a.main["C-BJ-0001"]?a.main["C-BJ-0001"].value:"",range:a.main["C-BJ-0002"]?a.main["C-BJ-0002"].value:"",rangeName:a.main["C-BJ-0002"]?a.main["C-BJ-0002"].text:"",rangeSchema:a.main["C-BJ-0002"]?a.main["C-BJ-0002"].schema:"",jccd:a.main.B0006?a.main.B0006.value:"",jccdText:a.main.B0006?a.main.B0006.text:"",isSms:a.main["C-BJ-0024"]?a.main["C-BJ-0024"].value:"-1",isSmsText:a.main["C-BJ-0024"]?a.main["C-BJ-0024"].text:"否",smsContent:a.main["C-BJ-0025"]?a.main["C-BJ-0025"].value:"",file:{attach:n.allFile.length&&n.allFile[0].uploadObj||[]}},n.$route.query.replyId&&(a.replyId=n.$route.query.replyId),n.$route.query.forwardIds&&(a.forwardIds=n.$route.query.forwardIds),a={__DATA:F()(a),moduleId:n.moduleId};P.Z.http.post("fn/mobileNote/send",a).then(function(e){e.data.result?P.Z.layer.toast(e.data.message,!0,function(){return n.backSucces()}):P.Z.layer.toast(e.data.message,!1)})},noReplyToConclude:function(e,t,a,n,o){P.Z.http.post("ctrl/notepaper/noReplyToConclude",{pk:n.pk,userId:""}).then(function(e){200==e.data.code&&n.backSucces()})},fwRuleConvert:function(e,t,a,n,o){P.Z.http.post("/ctrl/fwconvertRules/conversion",{ids:t.parameters.pk||n.formParams.pk||e.pk}).then(function(e){"success"==e.data.type?"1"==e.data.message?P.Z.layer.toast("同步成功",!0,function(){return n.backSucces()}):"2"==e.data.message&&P.Z.layer.toast("文件已转规章制度",!1):P.Z.layer.toast("同步失败",!1)})},xiaoliPublish:function(e,t,a,n,o){var r,i=a.main.A0001.value;"1"==a.main["2108241539404N5u3scBD2B9v1lJWtg"].value?this.dsf.layer.toast("该通知已发布!"):(r={pk:i},this.save(e,t,a,n,o,function(){P.Z.http.post("fn/calendar/release",r).then(function(e){var e=e.data,t=e.message;"success"===e.type&&"1"==t?P.Z.layer.toast("发布成功",!0,function(){return n.backSucces()}):P.Z.layer.toast("发布失败",!1)}).finally(function(){})}))},xiaolicancelPublish:function(e,t,a,n,o){var r={pk:a.main.A0001.value};this.save(e,t,a,n,o,function(){P.Z.http.post("fn/calendar/unRelease",r).then(function(e){var e=e.data,t=e.message;"success"===e.type&&"1"==t?P.Z.layer.toast("取消成功",!0,function(){return n.backSucces()}):P.Z.layer.toast("已有部门填写了校历征集,不能取消发布!",!1)}).finally(function(){})})},"xform.cancelEndInstance":function(e,t,a,n,o){a={pk:a.main.A0001.value,reason:"取消办结"},P.Z.http.post("/fn/flow/cancelEndInstance",a).then(function(e){e=e.data;P.Z.layer.toast(e.message,!0,function(){return n.backSucces()})})},"Flow.cancelEndNode":function(e,t,a,n,o){var r=P.Z.layer.loading("正在取消");a={pk:a.main.A0001.value},P.Z.http.post("/fn/flow/cancelEndNode",a).then(function(e){e=e.data;P.Z.layer.closeLoading(r),P.Z.layer.toast(e.message,!0,function(){return n.backSucces()})})},ycSendBack:function(a,n,o,r,e){P.Z.layer.confirm({title:"退回原因",message:'<textarea rows="5" id="failReason" placeholder="请填写退回原因" class="van-field__control" style="border: 1px solid #ddd; padding: 6px"></textarea>'},function(){R.log(document.getElementById("failReason").value);var t=r.nowButtonParameters;P.Z.http.post("ctrl/projectApprovalApply/saveBackOpinion",{infoId:n.parameters.pk,nodeId:t.nextNodeId,opinion:document.getElementById("failReason").value}).then(function(e){200==e.data.code?(r.sendFileData={id:n.parameters.pk,moduleId:a.moduleId,sendType:"SR_JUMPSEND",pid:n.parameters.pId||0,pnid:n.parameters.pnId||0,flowId:n.parameters.flowId,info_id:n.parameters.pk,bt:o.main.B0001.value,allowEditOpinion:0,opinionRequired:n.parameters.opinionRequired,nodeId:n.parameters.nodeId,nextNodeId:t.nextNodeId,endOtherLink:0,isBackTrack:-1},r.showPopUp=!0,r.$nextTick(function(){r.$refs.sendFileCom.show()})):P.Z.layer.toast("保存退回意见失败")})},function(){})},fanKuiQingKuang:function(e,t,a,n,o){n.$router.push("/superviseIdea?id=".concat(n.pk))},DBjieShouQingKuang:function(e,t,a,n,o){n.$router.push("/superviseAccept?id=".concat(n.pk))},saveDBCB:function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"2106161334381PC5vugnZwQyjNoMLzA",initDataSource:1,srcInfo:n.pk}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:n.pk,relationId:n.pk,type:"催办"}})})},ApplyDelay:function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"2106161334595i5kcF958pSy79wI6t1",initDataSource:1,srcInfo:n.pk}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:n.pk,relationId:n.pk,type:"延期"}})})}},"banJie",function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"210616133423XmMnuQ7yvMILNoWX6NY",initDataSource:1,srcInfo:n.pk}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:n.pk,relationId:n.pk,type:"办结"}})})}),(0,t.Z)(n,"pingJia",function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"210723193202gK3WrhlYN0pG9bE77fE",initDataSource:1,srcInfo:n.pk}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:n.pk,relationId:n.pk,type:"评价"}})})}),(0,t.Z)(n,"increaseChengBan",function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"220805171120LY8GOHEtSNDgVStRskk",initDataSource:1,srcInfo:n.pk}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:n.pk,relationId:n.pk,type:"增加承办"}})})}),(0,t.Z)(n,"bianGengPlan",function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"220805171717HXpWekYcCtbO2GgbEWh",initDataSource:1,srcInfo:n.pk}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:n.pk,relationId:n.pk,type:"变更计划"}})})}),(0,t.Z)(n,"dbtzChange",function(e,t,a,n,o){P.Z.http.post("/ctrl/convert/moduleRuleConvert",{convertId:"210715193605z4SYYk4JHBUGNy3b7tF",initDataSource:1,srcInfo:n.pk}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:{initDataSource:1,sourcePk:n.pk,relationId:n.pk,type:"变更"}})})}),(0,t.Z)(n,"xform.specialSend",function(e,t,a,n,o){this.send(e,t,a,n,o,null,{pid:t.parameters.pId,pnid:t.parameters.pnId,wfId:t.parameters.flowId,sendType:"SR_SPECIAL"},n.nowButtonParameters)}),(0,t.Z)(n,"xform.copySend",function(t,a,n,o,r){var i=this;"1"==o.nowButtonParameters.isNeedOpinion?(o.componentName="sxCopyOpinion",o.spHandleJS.closeDialogCallback=function(e){"{}"!=F()(e)&&"确定"==e.actionName&&i.send(t,a,n,o,r,null,{pid:a.parameters.pId,pnid:a.parameters.pnId,wfId:a.parameters.flowId,opinionContent:e.value,sendType:"SR_COPY"},o.nowButtonParameters)}):this.send(t,a,n,o,r,null,{pid:a.parameters.pId,pnid:a.parameters.pnId,wfId:a.parameters.flowId,sendType:"SR_COPY"},o.nowButtonParameters)}),(0,t.Z)(n,"xform.exSend",function(e,t,a,n,o){P.Z.layer.loading(),n.componentName="exSendDialog",P.Z.http.post("fn/mobileFlow/getFlowNode",{type:"SR_EXSEND",infoId:t.parameters.pk,moduleId:t.parameters.moduleId,pid:t.parameters.pId,nextNodeId:n.nowButtonParameters.startNodeId,nextLineId:n.nowButtonParameters.nextLineId}).then(function(e){P.Z.layer.clear(),"200"==e.status&&n.$bus.$emit("ZFLineData",e.data.data)})}),(0,t.Z)(n,"commonDialogBtn",function(e,t,a,n,o){n.nowButtonParameters&&n.nowButtonParameters.name?n.componentName=n.nowButtonParameters.name:P.Z.layer.toast("按钮参数配置错误，请检查参数是否正确！！"),R.log(n.nowButtonParameters)}),(0,t.Z)(n,"showFlow",function(e,t,a,n,o){1==n.nowButtonParameters.isNew?n.componentName="newMovingDialog":n.componentName="movingDialog"}),(0,t.Z)(n,"effectivenessHandle",function(e,t,a,n,o){n.$router.push({path:"/effectivenessDetail?pk=".concat(n.pk)})}),(0,t.Z)(n,"InputOpinion",function(e,t,a,n,o){1==n.nowButtonParameters.param1?(n.formMeta.controls.find(function(e){return"controlEditOpinion"==e.controlType}).extra.opinionContent="同意",this["Flow.pass"](e,t,a,n,o)):-1==n.nowButtonParameters.param1&&(n.formMeta.controls.find(function(e){return"controlEditOpinion"==e.controlType}).extra.opinionContent="不同意",this["Flow.refuse"](e,t,a,n,o))}),(0,t.Z)(n,"xform.forceRecycle",function(e,t,a,n,o){P.Z.layer.confirm({message:"您是否确认强制回收？",confirmButtonText:"确认"},function(){P.Z.http.post("/fn/flow/getForceRecycleData",{pk:n.pk}).then(function(e){200==e.data.code?n.componentName="forceRecycle":P.Z.layer.toast("接口请求失败！")})})}),(0,t.Z)(n,"DSF.Meeting.Action.issueNotice",function(e,a,n,o,t){function r(){var e;null!=(e=n.main["c-meetingtz-091"])&&e.value?P.Z.http.post("ctrl/meetingNotice/generatorFile",{fileType:"0",templateId:n.main["c-meetingtz-091"].value,moduleId:a.parameters.moduleId,pk:a.parameters.pk}).then(function(e){R.log(e),"200"==e.status&&(P.Z.layer.toast(e.data.message),i())}):i()}var i=function(){var t=P.Z.layer.loading("通知下发中");P.Z.http.post("/fn/meetingNotice/issueNotice",{pk:a.parameters.pk}).then(function(e){if(R.log(e),200==e.data.code){if(!e.data.data)return void P.Z.layer.toast("操作成功",function(){o.backSucces()});e.data.data.needOpen?o.$router.replace({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.tzId),query:{listId:e.data.data.listId,method:e.data.data.method,validateByList:e.data.data.validateByList,notCheck:!0}}):P.Z.layer.toast("下发通知成功",function(){R.log(o.isFromList),o.isFromList?o.backSucces():o.$route.query.isFromreserve?o.$router.replace({path:"/reserveNewMeeting?title=会议室预定"}):o.$router.go(-1)})}else P.Z.layer.toast(e.data.message);P.Z.layer.closeLoading(t)})};this.save(e,a,n,o,t,function(){n.multinfos&&n.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"]&&P.Z.http.post("/ctrl/meeting/changeTopicFid",{fid:n.main.A0001.value,ids:n.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.map(function(e){return e["210618155422Xgcs9ChmODWRV36fMHJ"].value})}).then(function(e){R.log(e)});var e=(n.main["c-meetingsq-009"]||n.main["c-meetingtz-010"]).value,t=(n.main["c-meetingsq-007"]||n.main["c-meetingtz-019"]).value,a=(n.main["c-meetingsq-008"]||n.main["c-meetingtz-020"]).value;P.Z.http.post("fn/meetingRoomOccupy/checkRoomOccupy",{pk:n.main.B0035.value,hys:e,sdate:t,edate:a}).then(function(e){R.log(e),"error"==e.data.type?P.Z.layer.toast(e.data.message):r()})})}),(0,t.Z)(n,"issueMeetingNotice",function(e,a,n,o,t){function r(){var t=P.Z.layer.loading("通知下发中");P.Z.http.post("/ctrl/meetingNoticeSfb/issueNotice",{pk:a.parameters.pk}).then(function(e){if(R.log(e),200==e.data.code){if(!e.data.data)return void P.Z.layer.toast("操作成功",function(){o.backSucces()});e.data.data.needOpen?o.$router.replace({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.tzId),query:{listId:e.data.data.listId,method:e.data.data.method,validateByList:e.data.data.validateByList,notCheck:!0}}):P.Z.layer.toast("下发通知成功",function(){o.isFromList?o.backSucces():o.$router.replace({path:"/commonList/200818195728QeQ7vIeoJ3jWto301pj/190121161348OthBI4s3sEhvfuDJ5FD?title=会议通知"})})}else P.Z.layer.toast(e.data.message);P.Z.layer.closeLoading(t)})}this.save(e,a,n,o,t,function(){n.multinfos&&n.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"]&&P.Z.http.post("/ctrl/meeting/changeTopicFid",{fid:n.main.A0001.value,ids:n.multinfos["210618155422Xgcs9ChmODWRV36fMHJ"].rows.map(function(e){return e["210618155422Xgcs9ChmODWRV36fMHJ"].value})}).then(function(e){R.log(e)});var e=(n.main["c-meetingsq-009"]||n.main["c-meetingtz-010"]).value,t=(n.main["c-meetingsq-007"]||n.main["c-meetingtz-019"]).value,a=(n.main["c-meetingsq-008"]||n.main["c-meetingtz-020"]).value;P.Z.http.post("fn/meetingRoomOccupy/checkRoomOccupy",{pk:n.main.B0035.value,hys:e,sdate:t,edate:a}).then(function(e){R.log(e),"error"==e.data.type?P.Z.layer.toast(e.data.message):r()})})}),(0,t.Z)(n,"DSF.Meeting.Action.meetingNgSend",function(a,n,o,r,i){var t,s=this;o.main["c-meetingsq-007"].value?o.main["c-meetingsq-008"].value?o.main["c-meetingsq-009"].value?(P.Z.http.post("fn/meeting/getMeetingConfig?configCode=p1001-HY-TYSZ-002").then(function(e){R.log(e),"200"==e.status&&t(e.data.data||"")}),t=function(t){P.Z.http.post("fn/meetingRoomOccupy/checkRoomOccupy",{pk:o.main.B0035.value,hys:o.main["c-meetingsq-009"].value,sdate:o.main["c-meetingsq-007"].value,edate:o.main["c-meetingsq-008"].value}).then(function(e){"error"==e.data.type?"1"==t?P.Z.layer.confirm({message:e.data.message+"是否确认发送？",confirmButtonText:"确认"},function(){s.send(a,n,o,r,i,null)}):P.Z.layer.toast(e.data.message):s.send(a,n,o,r,i,null)})}):P.Z.layer.toast("会议室不能为空"):P.Z.layer.toast("结束时间不能为空"):P.Z.layer.toast("开始时间不能为空")}),(0,t.Z)(n,"xform.saveFormTemporarily",function(e,t,a,n,o,r){n.$route.query.specialSaveObj=F()({temporarilySave:!0}),this.saveNoTip(e,t,a,n,r,!1)}),(0,t.Z)(n,"remoteTransmission",function(e,t,a,i,n){var a={info_id:a.main.A0001.value},s=(i.showPerson=!0,i.dataValue=a,i.isTransfer=!0,i.selectType=1,i.nowButtonParameters.orgType);i.extra={multiple:!0,tabs:[{action:"fn/orgManager/getOrgByType?orgType=".concat(s,"&checkedIds="),name:"远程发送",subTabKey:"department"}]},i.getSelectUser=function(e){var t="",a="",n="",o="",e=(e.forEach(function(e){t+=e.id+",",a+=e.name+",",n+=e.attrs.domain+",",o+="999,"}),t+"|"+a+"|"+n+"|"+o),e={infoId:i.formParams.pk,range:e,nrtypes:"",targetType:3,orgType:s},r=P.Z.layer.loading("发送中");P.Z.http.get("fn/proxySend/remotesend",e).then(function(e){R.log(e),200==e.data.code?P.Z.layer.toast("远程发送成功"):P.Z.layer.toast("远程发送失败"),P.Z.layer.closeLoading(r),i.$nextTick(function(){i.$router.go(-1)})})}}),(0,t.Z)(n,"meetingRemoteSubmitBm",function(e,t,a,n,o){this.save(e,t,a,n,o,function(){P.Z.http.post("ctrl/meetingRemote/submitNotice",{pk:t.parameters.pk,isEndFlow:1}).then(function(e){var t;R.log(e.data),"200"==(null==(t=e.data)?void 0:t.code)?P.Z.layer.toast("上报成功",function(){n.$route.query.isback?n.backSucces(n.$route.query.isback):n.backSucces()}):P.Z.layer.toast(e.data.message)})})}),(0,t.Z)(n,"remoteMeetingConvertSq",function(e,t,a,n,o){P.Z.layer.confirm({title:"提示",message:"确认是否转会议申请"},function(){P.Z.http.post("ctrl/convert/moduleConvert",{sourceModule:t.parameters.moduleId,targetModule:"190111184257QgSNR8cW92akDpqeWMA",srcInfo:t.parameters.pk,isEndSrcFlow:1,pnid:t.parameters.pnId}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/190111184257QgSNR8cW92akDpqeWMA/".concat(e.data.data.pk)})})})}),(0,t.Z)(n,"remoteMeetingConvertSw",function(e,a,t,n,o){P.Z.layer.confirm({title:"提示",message:"请确认是否转收文"},function(){P.Z.http.post("ctrl/meetingRemote/getConvertSwModuleId",{}).then(function(e){"200"==e.status&&e.data?r(e.data.data):P.Z.layer.toast("请联系管理员配置转换模块")})});var r=function(t){P.Z.http.post("ctrl/convert/moduleConvert",{sourceModule:a.parameters.moduleId,targetModule:t,srcInfo:a.parameters.pk,isEndSrcFlow:1,pnid:a.parameters.pnId}).then(function(e){200==e.data.code&&n.$router.push({path:"/commonForm/".concat(t,"/").concat(e.data.data.pk)})})}}),(0,t.Z)(n,"openRemoteMeetingNotice",function(e,t,a,n,o){P.Z.http.post("ctrl/meetingRemote/getMeetingNotice",{sourceId:a.main.A0003.value,moduleId:t.parameters.moduleId,pk:t.parameters.pk}).then(function(e){var t;"200"==e.status&&null!=(t=e.data)&&t.data?(t="1"!=e.data.data.hytzStatus?"16":"-1",n.$router.push({name:"commonForm",params:{moduleId:"230517224206lQszMtXvkQGlirGaxBu",pk:a.main.A0003.value},query:{listId:"MeetingList",method:"customNode",validateByList:1,showNodeId:t}})):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"exchangeAccept",function(e,t,a,u,n,o){var r=!(6<arguments.length&&void 0!==arguments[6])||arguments[6];function i(i,e,n,s,t){s=s||{};var a,o,r,d=u.formData.main["C-R-RCV-0088"].value;"3"==d?p({convertId:e,srcInfo:i}).then(function(e){var t,a,n,o,r;200!=e.data.code?P.Z.layer.toast(e.data.message):(e=e.data.data,r=i,t=e.pk,a=e.moduleId,n=e.moduleName,o=s,e=u.formData.main["C-R-RCV-0088"].value,r={sourcePk:i,targetPk:t,targetModuleId:a,isConvertToDo:void 0!==(o=o||{}).isConvertToDo&&o.isConvertToDo,doSign:void 0===o.doSign||o.doSign},e="3"==e?"ctrl/hardDiskExchange/acceptCallback":"ctrl/remoteExchange/acceptCallback",P.Z.http.post(e,r).then(function(e){"success"==e.data.type?c(t,a,0,o):P.Z.layer.toast(e.data.message)}))}):(a="",o=null,o="5"==d?(a="ctrl/localInsideController/accept",{pk:i,convertId:e,targetModuleId:n,moduleId:s.moduleId}):"6"==d||"6"==s.mode?(a="ctrl/exRemoteInterfaceController/acceptDoc",{pk:i,convertId:e,targetModuleId:n,isConvertToDo:null==s.isConvertToDo?"":s.isConvertToDo,moduleId:s.moduleId,ruleId:t}):(a="ctrl/remoteExchange/acceptByRule",{pk:i,convertId:e,targetModuleId:n,isConvertToDo:void 0!==s.isConvertToDo&&s.isConvertToDo,doSign:void 0===s.doSign||s.doSign,ruleId:t}),r=P.Z.layer.loading(),P.Z.http.post(a,o).then(function(e){var t,a;P.Z.layer.closeLoading(r),"success"==e.data.type&&e.data.data?(t=(a=e.data.data).pk,a=a.moduleName,c(t,n,0,s)):P.Z.layer.toast(e.data.message)}).catch(function(e){P.Z.layer.toast("请求失败")}))}function c(s,d,e,c){c.isOpenForm?P.Z.layer.toast("签收成功","success",function(){var e,t,a,n=s,o=d,r=c,i="/commonForm/".concat(o,"/").concat(n);6==r.mode?(t=r.backFileId,(null!=(e=r.isfeedback)&&(1==e||2==e)||null!=t&&""!=t)&&(i+="?reloadParentFormOnSave=true&listId=ExchangeRecvList&method=view&validateByList=1")):r&&r.extParams&&(2==r.extParams.isJoint||3==r.extParams.isJoint)||2==u.$router.query.isJoint||3==u.$router.query.isJoint?(e=r&&r.extParams||{},a=r=t="",2==e.isJoint||3==e.isJoint?(t=e.isJoint,r=e.relaId||n,a=e.isFeedback,e.allowFeedback):(t=u.$router.query.isJoint||"",r=n,a="true"==u.$router.query.isFeedback,u.$router.query.allowFeedback),i=function(){return l.apply(this,arguments)}(n,o,t,r,a),i+=(u.$router.query.handleMark,u.$router.query.handleMark)):i+="?reloadParentFormOnSave=true&listId=ExchangeRecvList&method=view&validateByList=1",R.log(i),1==u.nowButtonParameters.closePage&&(i=i+(i.includes("?")?"&":"?")+"closePage=1"),u.$router.replace({path:i})}):P.Z.layer.toast("签收成功","success",function(){u.backSucces()})}function l(){return(l=(0,B.Z)(T().mark(function e(t,a,n,o,r){var i,s,d;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i="",s="/commonForm/","2"==n&&o?(s+=r?"200903105015ZPCUsVIG564HqIlyu16/".concat(o)+"?listId=ExchangeToDoList&method=jointFeedback&validateByList=1&rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r+i:"201229211221GAua7d9c37nlHDE9pu8/".concat(o)+"?listId=ExchangeToDoList&method=joint&validateByList=1&rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r,e.next=22):e.next=6;break;case 6:"3"==n&&o?(s+=r?"200903105015ZPCUsVIG564HqIlyu16/".concat(o)+"?listId=ExchangeToDoList&method=sealFeedback&validateByList=1&rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r+i:"201229211221GAua7d9c37nlHDE9pu8/".concat(o)+"?listId=ExchangeToDoList&method=seal&validateByList=1&rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r,e.next=22):e.next=10;break;case 10:r&&o?(s+="200903105015ZPCUsVIG564HqIlyu16/".concat(o)+"?listId=ExchangeToDoList&method=normalFeedback&validateByList=1&rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r,e.next=22):e.next=14;break;case 14:if(o)return d={pk:o},e.next=19,P.Z.http.post("ctrl/remoteExchangeData/getInfo",{data:d}).then(function(e){e.data.data&&e.data.data.moduleId?s+="".concat(e.data.data.moduleId,"/").concat(o)+"?rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r+"&listId=ExchangeToDoList&method=normalRela&validateByList=1":s+="".concat(a,"/").concat(o)+"?rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r+"&listId=ExchangeToDoList&method=normal&validateByList=1"});e.next=21;break;case 19:e.next=22;break;case 21:s+="pk="+t+"&moduleId="+a+"&rcvRecordId="+t+"&isJoint="+n+"&isFeedback="+r+"&listId=ExchangeToDoList&method=normal&validateByList=1";case 22:return e.abrupt("return",s);case 23:case"end":return e.stop()}},e)}))).apply(this,arguments)}this.save(e,t,a,u,n,function(){var a={mode:u.formData.main["C-R-RCV-0088"].value,backFileId:u.formData.main["C-R-RCV-0056"].value,isfeedback:u.formData.main["C-R-RCV-0041"].value,moduleId:u.moduleId,isOpenForm:r},n=P.Z.layer.loading(),o=u.pk;P.Z.http.post("ctrl/remoteExchangeData/getReceiveTarget",{rcvRecordId:u.pk}).then(function(e){var t;P.Z.layer.closeLoading(n),"success"===e.data.type?e.data.data&&1<e.data.data.length?u.$refs.ckDialog.show(e.data.data,"请选择要转换的目标模块","ruleId","ruleName",[],!1).then(function(e){e=e[0];i(o,e.id,e.targetModuleId,a,e.ruleId)}).catch(function(){P.Z.layer.toast("请选择要转换的目标模块")}):e.data.data&&0<e.data.data.length?(t=e.data.data[0],a.convertId=t.id,a.ruleId=t.ruleId,a.exchangeDocType=t.exchangeDocType,i(o,t.id,t.targetModuleId,a,t.ruleId)):P.Z.layer.toast("签收模块未配置"):P.Z.layer.toast(e.data.message)})})}),(0,t.Z)(n,"exchangeSendBack",function(e,t,a,n,o){P.Z.http.post("ctrl/remoteExchange/checkCanReject",{pk:n.formParams.pk,moduleId:n.formParams.moduleId,level:3}).then(function(e){"success"===e.data.type?n.componentName="exchangeSendBack":P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"RemoteDocExchange.acceptByButtonParam",function(e,t,a,n,o){var r=-1!=n.nowButtonParameters.isOpenForm;this.exchangeAccept(e,t,a,n,o,null,r)}),(0,t.Z)(n,"RemoteDocExchange.commonSend",function(e,t,h,g,a){var n=g.nowButtonParameters,s=n.vendor,d=n.exchangeModeId,c=n.allowFeedback,u=n.isJoint,o=n.docType,l=n.singleSendRecord,m=n.sendLevel,p=n.selectAttvalue,f=n.desc,y=n.sendAs,I=n.initDataMeta,v=n.repetition,k=n.selectFileRelationValue,Z=n.sendType,S=n.templateId,w=n.checkFileRequired,b=(n.otherParameters,o);function x(e){var t={};if(-1<e.indexOf("[")){for(var a=e.match(/\[[^\[]*\]/g),n=0;a&&n<a.length;n++){var o,r=a[n];r&&(r=(r=r.substring(1,r.length-1)).split("="))&&2==r.length&&(o=r[1],"true"===r[1]?o=!0:"false"===r[1]&&(o=!1),t[r[0]]=o)}R.log(F()(t)),e=e.substring(0,e.indexOf("["))}return{pattern:t,config:e}}function r(){return(r=(0,B.Z)(T().mark(function e(){var t,a,n,o,r,i;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=x(s),t=n.pattern,s=n.config,n=x(u),a=n.pattern,u=n.config,a.text&&(t.isJointText=a.text),m&&(m=(n=m.split(";"))[0],1<n.length)&&n[1],6!=s){e.next=18;break}if(null!=m&&""!=m||("1"==(n=null==(a=h.main["C-GW-FW-0202"])?void 0:a.value)?m="superiorOfficialsend":"2"==n?m="sidewaysOfficialsend":"3"==n&&(m="lowerOfficialsend")),Z&&m){e.next=15;break}return n=g.moduleId||(null==(a=h.main.A0004)?void 0:a.value),e.next=15,P.Z.http.post("fn/remoteExchangeData/getSendRule",{moduleId:n,exchangeModeId:d,exchangeDocType:b}).then(function(e){e.data.data?(m=m||e.data.data.sendRangeName,Z=Z||e.data.data.businessType+","+e.data.data.businessTypeText+";11,"+e.data.data.receiveType):P.Z.layer.toast(e.data.message)});case 15:if(null==m||""==m)return P.Z.layer.toast("发送范围层级未填写，请联系管理员!"),e.abrupt("return");e.next=18;break;case 18:o={vendor:s,exchangeModeId:d,allowFeedback:c,isJoint:u,exchangeDocType:b,singleSendRecord:l,sendLevel:m,selectAttvalue:p,selectFileRelationValue:k,desc:f||"",sendAs:y||"",initDataMeta:I||"",repetition:v||0,templateId:S,flat:0,checkFileRequired:w},Z?1<(r=Z.split(";")).length?1<(i=r[0].split(",")).length?(o.typeclass=i[0],o.typeclassName=i[1],e.next=30):e.next=28:e.next=40:e.next=42;break;case 28:return P.Z.layer.toast("发送类型配置不正确，请联系管理员!"),e.abrupt("return");case 30:1<(i=r[1].split(",")).length?(o.typemethod=i[0],o.typemethodname=i[1],e.next=38):e.next=36;break;case 36:return P.Z.layer.toast("发送类型方法配置不正确，请联系管理员!"),e.abrupt("return");case 38:e.next=42;break;case 40:return P.Z.layer.toast("发送类型配置不正确，请联系管理员!"),e.abrupt("return");case 42:$.extend(o,t),!function(e){var t=e.isJoint,a=e.exchangeDocType,n=void 0===e.singleSendRecord?-1:e.singleSendRecord,o=function(e){var t,a=null==(a=h.main.B0054)?void 0:a.value;if(!e&&a)t=a;else if(e){a=e.split(":");if(2<=a.length&&a[0]){for(var n=a[0],a=(2<=a.length?a[1]:"1")||"",o=null==(n=h.main[n])?void 0:n.value,r=a.split(","),i=0;i<r.length;i++)if(o==r[i]){t=1;break}}else t=e}return t=void 0===t?-1:t}(e.allowFeedback);void 0===t&&(t=-1);a=a||"";var r=e.pk||g.formMeta.parameters.pk,i=e.moduleId||g.moduleId;$.extend(e,{allowFeedback:o,isJoint:t,exchangeDocType:a,singleSendRecord:n});!e.repetition||"1"!==e.repetition&&1!==e.repetition||!function(t,a,e){var n="";a.remoteSendPaper&&"convert"==a.remoteSendPaper&&(n=a.remoteSendPaper),""!==e&&P.Z.http.post("ctrl/remoteExchangeData/getLastSendDetail",{pk:e,sendType:n,convertId:a.convertId}).then(function(e){e.data?"success"==e.data.type?(t.ids=e.data.data.ids||"",t.text=e.data.data.names||"",t.dyfs=e.data.data.dyfs||"",t.dyfh=e.data.data.dyfh||"",e.data.data.isFeedback&&(a.allowFeedback=e.data.data.isFeedback),a.repetitionData=t):(R.error("获取发送单位"),P.Z.layer.toast(e.data.message)):(R.error("获取发送单位"),P.Z.layer.toast("获取发送单位"))})}({ids:"",text:"",dyfs:"",dyfh:""},e,r);switch(e.vendor){case"1":$.extend(e,{sendurl:"fn/dreamExView/getTargetOrganizeList"}),R.log("暂不支持");break;case"2":case"5":$.extend(e,{sendurl:"fn/localExchangeView/getOrganizeList?isRemote=-1&filterByDomain=1&id="+r+"&level="+e.sendLevel}),R.log("暂不支持");break;case"3":$.extend(e,{sendurl:"fn/localExchangeView/selOrganizeList?sendOrgid="+e.sendOrgid+"&level="+e.sendLevel+"&sendAs="+e.sendAs}),R.log("暂不支持");break;case"4":$.extend(e,{sendurl:"fn/exchangeCenterCaller/getSendRange?level="+e.sendLevel}),s(r,i,e);break;case"6":$.extend(e,{sendurl:"fn/exRemoteInterfaceController/selSendRange?infotype="+e.sendLevel}),s(r,i,e);break;default:P.Z.layer.toast("undefined vendor="+e.vendor)}function s(){d.apply(this,arguments)}function d(){return(d=(0,B.Z)(T().mark(function e(a,n,o){return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o.checkFileRequired)return e.next=3,P.Z.http.post("ctrl/remoteExchangeData/checkFileRequired",{pk:a,fileTypes:o.checkFileRequired}).then(function(e){"success"!=e.data.type&&P.Z.layer.toast(e.data.message)});e.next=3;break;case 3:"2"==o.isJoint||"3"==o.isJoint?P.Z.http.post("ctrl/remoteExchangeData/getSendRecord",{remoteId:a,isJoint:o.isJoint}).then(function(e){var t;"success"==e.data.type||"404"==e.data.code?(t=e.data.data,"2"==o.isJoint?e.data.data&&e.data.data.sendRecordId?P.Z.layer.confirm({title:"提示",message:"是否发起新一轮会签"},function(){p(a,n,o)}):p(a,n,o):t&&t.join&&t.join.partFeedback?P.Z.layer.confirm({title:"提示",message:"请会签完之后进行盖章",showCancelButton:!0},function(){c(t,o,a,n,e.data)}):c(t,o,a,n,e.data)):(R.log(e.data.message),P.Z.layer.toast(e.data.message))}):p(a,n,o);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function c(e,t,a,n,o){e&&e.sendRecordId?g.$refs.ckDialog.show([{id:1,name:"增加盖章单位"},{id:2,name:"重新盖章"},{id:3,name:"发起新一轮盖章"}],"请选择操作类型","id","name",[],!1).then(function(e){e=e[0];1==e?o.data.allSealed?P.Z.layer.toast("盖章已完成，不能增加盖章单位。"):(t.sealType="add",t.sendRecordId=o.data.sendRecordId,t.mode=t.vendor,function(){u.apply(this,arguments)}(a,t.sendRecordId,t)):2==e?P.Z.http.post("ctrl/exchangeCenterOperation/findReSealData",{sendRecordId:o.data.sendRecordId}).then(function(e){var d,c,u,l,m;t.sealType="reseal","success"==e.data.type?e.data.data&&e.data.data.seal?(d=a,c=n,u=t,l=e.data.data.seal,m=e.data.data.all,g.$refs.ckDialog.show(l,"请选择盖章基准文件","id","title",[],!1).then(function(e){for(var n,t=e[0].id,o=(u.mergeDocId=t,[]),e=(t&&(n=l.findIndex(function(e){return e.id==t}),l.forEach(function(e,t){var a=e.swdwId;t<=n&&"-1"!=e.id&&o.push(a)})),o.join(",")),a=[],r=[],i=0;m&&i<m.length;i++){var s=m[i];-1===o.indexOf(s.swdwId)&&(a.push(s.swdwId),r.push(s.swdwName))}u.sendUnits=a.join(","),u.sendUnitNames=r.join(","),u.sendurl="fn/exchangeCenterCaller/getOneSendRange?pk="+d+"&level="+u.sendLevel+"&filterByExclude=true&excludeUnits="+e,p(d,c,u)})):P.Z.layer.toast("未找到盖章数据"):P.Z.layer.toast(e.data.message)}):(t.sealType="new",p(a,n,t))}):(t.sealType="normal",p(a,n,t))}function u(){return(u=(0,B.Z)(T().mark(function e(t,a,n){var o;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(3==n.isJoint||5==n.isJoint)return e.next=3,P.Z.http.post("ctrl/remoteExchangeData/getSendRecord",{remoteId:t,isJoint:n.isJoint}).then(function(e){"success"==e.data.type?e.data.data.allSealed?P.Z.layer.toast("盖章已完成，不能增加盖章单位。"):(n.pk=n.sourceId,t=n.sourceId,n.sealType="add",n.sendRecordId=a,"6"==n.mode?n.sendurl="fn/exRemoteInterfaceController/selOneSendRange?pk="+t+"&infotype="+n.sendLevel+"&recordId="+n.sendRecordId:n.sendurl="fn/exchangeCenterCaller/getOneSendRange?pk="+t+"&level="+n.sendLevel+"&recordId="+n.sendRecordId,p(t,n.moduleId,n)):R.error(e.data)});e.next=4;break;case 3:return e.abrupt("return");case 4:o="fn/exchangeCenterCaller/getOneSendRange?pk="+t+"&level="+n.sendlevel+"&recordId="+a+"&flat="+n.flat,"6"==n.mode&&(o="fn/exRemoteInterfaceController/selOneSendRange?pk="+t+"&infotype="+n.sendlevel+"&recordId="+a+"&flat="+n.flat),g.componentName="ExCenterSend",g.selectType=1,g.extra={multiple:!0,tabs:[{action:o,name:"选择机构",subTabKey:"department",params:n}]};case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p(e,t,a){var n=a.exchangeModeId||"",o=a.selectAttvalue||"",r=a.selectFileRelationValue||"",i=a.isJoint||"",s=a.desc,d={},d=("2"!=i&&"3"!=i||"add"!=a.sealType&&(d=h.main["C-FW-0035"]||{}),{ids:d.value||"",text:d.text||""});if(a.sendUnits&&(d.ids&&(d.ids+=","),d.ids+=a.sendUnits||""),a.sendUnitNames&&(d.text&&(d.text+=","),d.text+=a.sendUnitNames||""),a.initDataMeta&&processInitDataMeta(d,a),a.sendByTargets||a.remoteSendPaper&&"convert"!=a.remoteSendPaper){d="";if(a.remoteSendPaper)R.log(a.remoteSendPaper),d=(null==(m=h.main[a.remoteSendPaper])?void 0:m.value)||"";else{var c,u,l=[],m=a.targetMetaId;if(m){if(!h.main[m])return void P.Z.layer.toast("发送目标单位元数据为空");c=h.main[m].value.split(","),u=h.main[m].text.split(",")}else c=a.targetIds.split(","),u=a.targetNames.split(",");for(var p=0;p<c.length;p++){var f={id:c[p],name:u[p]};l.push(f)}d=F()(l)}d?(a.selectedAttachments="",a.pk=e,a.moduleId=t,a.sourceId=h.main.A0003.value,a.reloadParent=!0,R.log("暂不支持")):(R.log("发送目标单位为空"),P.Z.layer.toast("发送目标单位为空"))}else{m=a.sendurl+"&pk="+e+"&moduleId="+t+"&exchangeModeId="+n+"&sendType=4&selectAttvalue="+o+"&isJoint="+i+"&desc="+encodeURIComponent(s)+"&flat="+a.flat+"&selectFileRelationValue="+r;a.colseCopyPageDowm&&(m+="&colseCopyPageDowm="+a.colseCopyPageDowm),a.templateId&&(m+="&templateId="+a.templateId),g.componentName="ExCenterSend",g.selectType=1,g.extra={multiple:!0,tabs:[{action:m,name:"选择机构",subTabKey:"department",params:a}]}}}}(o);case 44:case"end":return e.stop()}},e)}))).apply(this,arguments)}this.save(e,t,h,g,a,function(){return r.apply(this,arguments)})}),(0,t.Z)(n,"DSF.Meeting.Action.meetingChange",function(e,t,a,n,o){P.Z.http.post("ctrl/meetingChange/convert",{masterId:n.formData.main.B0035.value}).then(function(e){var t;200==e.data.code?(t={initDataSource:1,fid:n.formData.main.B0035.value,pk:e.data.data.pk,source:e.data.data.source},e.data.data.showNodeId&&v()(t,{showNodeId:e.data.data.showNodeId,listId:"MeetingList",method:"customNode"}),e.data.data.hyTodo&&"1"==e.data.data.hyTodo?P.Z.layer.toast("操作成功",!0,function(){return n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:t})}):n.$router.push({path:"/commonForm/".concat(e.data.data.moduleId,"/").concat(e.data.data.pk),query:t})):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"RemoteDocExchange.doSW2SendBackDoc",function(e,t,a,o,n){var r=o.pk,i=o.nowButtonParameters.exchangeMode,s=o.nowButtonParameters.ruleId,d=o.nowButtonParameters.subExchangeDocType,c=o.nowButtonParameters.srcType,u={},l=("6"==i&&(u.sourceId=a.main.A0003.value,u.exchangeModeId=i),r),a="receivedDoc",m=c,i=u;a={type:a,pk:l,ruleId:s,subExchangeDocType:d||""},v()(a,i),P.Z.layer.loading(),P.Z.http.post("ctrl/remoteExchangeData/getSendBackDoc",a).then(function(e){var n,t,a;P.Z.layer.clear(),"success"===e.data.type&&e.data.data?(n=e.data.data.rcvRecordId,(a=e.data.data.backData)&&a.pk&&a.moduleId?(t=a.pk,a=a.moduleId,o.$router.replace("/commonForm/".concat(a,"/").concat(t,"?reloadParentFormOnSave=true&rcvRecordId=").concat(n,"&srcType=").concat(m))):(a=e.data.data.convert.id,p({convertId:a,srcInfo:l}).then(function(e){var t,a;"success"==e.data.type?(t=e.data.data.pk,a=e.data.data.moduleId,o.$router.replace("/commonForm/".concat(a,"/").concat(t,"?reloadParentFormOnSave=true&rcvRecordId=").concat(n,"&srcType=").concat(m))):P.Z.layer.toast(e.data.message)}))):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"RemoteDocExchange.sendBackDoc",function(e,t,a,n,o){var r=n.nowButtonParameters.isSendToEnd,i=n.nowButtonParameters.isCreateTodo,s=n.nowButtonParameters.sendType,d={exchangeDocType:n.nowButtonParameters.exchangeDocType,exchangeModeId:n.nowButtonParameters.exchangeModeId};this.save(e,t,a,n,o,function(){var e=n.pk,t=n.moduleId,a=n.$route.query.rcvRecordId,e={pk:e,moduleId:t,rcvRecordId:a,isSendToEnd:r,isCreateTodo:i},t=(v()(e,d),P.Z.layer.loading(),"ctrl/remoteExchange/sendBackDoc");"5"==s?t="ctrl/localInsideController/sendBackDoc":"6"==s&&(t="ctrl/exRemoteInterfaceController/sendBackDoc");P.Z.http.post(t,e).then(function(e){P.Z.layer.clear(),"success"===e.data.type?n.backSucces():P.Z.layer.toast(e.data.message)})})}),(0,t.Z)(n,"xform.inboxToLeader",function(e,t,a,n,o){P.Z.layer.loading(),P.Z.http.post("fn/flow/updateInboxSecretaryStatus",{pnId:t.parameters.pnId,status:2}).then(function(e){P.Z.layer.clear(),200==e.data.code&&P.Z.layer.toast("发送成功","success",function(){n.removeLocalOptions(),n.backSucces()})})}),(0,t.Z)(n,"xform.inboxForwardSkipLeader",function(e,t,a,n,o){3!=n.$route.query.status&&3!=t.parameters.secretaryProcessStatus||(n.isShowWriteOpintionBtn=!0,n.alreadyWriteOpintion=!0),this.send(e,t,a,n,o,null,{determineUser:n.$route.query.leaderId},n.nowButtonParameters)}),(0,t.Z)(n,"xform.inboxBackwardSkipLeader",function(e,t,a,n,o){3!=n.$route.query.status&&3!=t.parameters.secretaryProcessStatus||(n.isShowWriteOpintionBtn=!0,n.alreadyWriteOpintion=!0),this.send(e,t,a,n,o,null,{determineUser:n.$route.query.leaderId,direction:-1,disableAutoSend:-2},n.nowButtonParameters)}),(0,t.Z)(n,"xform.inboxToSecretary",function(e,t,a,n,o){this.save(e,t,a,n,o,function(){P.Z.layer.loading(),P.Z.http.post("fn/flow/updateInboxSecretaryStatus",{pnId:t.parameters.pnId,status:3}).then(function(e){P.Z.layer.clear(),200==e.data.code&&P.Z.layer.toast("发送成功","success",function(){n.backSucces()})})},!0)}),(0,t.Z)(n,"xform.shareToLeader",function(e,t,a,n,o){P.Z.layer.loading(),P.Z.http.post("ctrl/leaderShareRead/changeProcessMode",{distribIds:t.parameters.distribId,type:2}).then(function(e){P.Z.layer.clear(),200==e.data.code?P.Z.layer.toast("发送成功","success",function(){n.backSucces()}):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"xform.shareLeaderConfirm",function(e,t,a,n,o){P.Z.layer.loading(),P.Z.http.post("ctrl/leaderShareRead/changeProcessMode",{distribIds:t.parameters.distribId,type:4}).then(function(e){P.Z.layer.clear(),200==e.data.code?P.Z.layer.toast("操作成功","success",function(){n.backSucces()}):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"xform.toJySec",function(e,t,a,n,o){P.Z.layer.loading(),P.Z.http.post("ctrl/instructionsInfo/toSec",{distribId:t.parameters.distribId}).then(function(e){P.Z.layer.clear(),200==e.data.code?P.Z.layer.toast("操作成功","success",function(){n.backSucces()}):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"xform.secToPsj",function(e,t,a,n,o){P.Z.layer.loading(),P.Z.http.post("ctrl/instructionsInfo/secToPsj",{insId:n.$route.query.insId}).then(function(e){P.Z.layer.clear(),200==e.data.code?P.Z.layer.toast("操作成功","success",function(){n.backSucces()}):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"xform.secReadEnd",function(e,t,a,n,o){P.Z.layer.loading(),P.Z.http.post("ctrl/instructionsInfo/secToPsj",{insId:n.$route.query.insId}).then(function(e){P.Z.layer.clear(),200==e.data.code?P.Z.layer.toast("操作成功","success",function(){n.backSucces()}):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"readAndToInstruction",function(e,t,a,n,o){var r=n.allFile[0].document[0].id;P.Z.http.post("ctrl/p2433Common/readed",{pk:t.parameters.pk,moduleId:t.parameters.moduleId,nrId:r,uploadFile:!0,isSecretary:!0,distribId:n.$route.query.distribId}).then(function(e){"success"==e.data.type?P.Z.layer.toast("操作成功","success",function(){n.backSucces()}):P.Z.layer.toast(e.data.message)})}),(0,t.Z)(n,"DreamIM.createChatGroup",function(e,a,t,n,o){return(0,B.Z)(T().mark(function e(){var t;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.parameters.pk,e.next=3,new(k())(function(n,e){P.Z.http.get("fn/im/operation/getGroupInfo",{groupId:t,type:"document"}).then(function(e){var t,a;"success"==e.data.type&&null!=(t=e.data.data)&&t.groupId?(a=e.data.data.groupId,e.data.data.inGroup?window.native&&window.native.chatTo({conversationType:"GROUP",toId:a}):P.Z.http.get("fn/im/operation/joinGroup",{groupId:a}).then(function(e){"success"===e.data.type?window.native&&window.native.chatTo({conversationType:"GROUP",toId:a}):P.Z.layer.toast(e.data.message)})):n()})});case 3:P.Z.http.post("fn/im/operation/getChatUsersByDocument",{pk:t}).then(function(e){"success"==e.data.type&&e.data.data&&(e=e.data.data.users||[],window.native)&&window.native.showSelectUsers({title:"选择联系人",data:{users:e,isLimitCount:!1,total:9999}},function(e){R.log(e),e&&e.userIds&&(e=e.userIds.join(","),e={groupId:t,type:"document",userIds:e},P.Z.http.post("fn/im/operation/createChatGroup",e).then(function(e){var t;"success"===e.data.type&&e.data.data?(t=e.data.data.groupId,P.Z.layer.toast("创建群成功"),window.native&&window.native.chatTo({conversationType:"GROUP",toId:t})):P.Z.layer.toast(e.data.message)}))})}).catch(function(e){P.Z.layer.toast("创建群聊失败")});case 4:case"end":return e.stop()}},e)}))()}),(0,t.Z)(n,"handwritSign",function(e,t,a,n,o){var r=t.parameters,i=!(2!=r.secretaryProcessMode&&3!=r.secretaryProcessMode);P.Z.layer.loading(),P.Z.http.post("ctrl/instructions/signedFile",{id:"230716135502ednDlLWLSO8VsLwqzrC"==r.moduleId?r.pnId:r.pk,moduleId:r.moduleId,nodeId:r.nodeId,pnId:r.pnId,needSignFile:1}).then(function(e){var t,a;P.Z.layer.clear(),200==e.data.code&&e.data.data&&e.data.data.fileId&&(e=(t=e.data.data).fileName.substr(t.fileName.lastIndexOf(".")+1),e={id:t.fileId,title:"ofd"!=e&&"pdf"!=e?t.fileName.substr(0,t.fileName.lastIndexOf("."))+".pdf":t.fileName,isHandleWrite:!0,hasWenzi:!1,uploadFileId:t.uploadFileId,fileType:t.fileType,openToPage:t.pagination||0},a={info_id:r.pk,moduleId:r.moduleId,nodeId:r.nodeId,nodeName:r.nodeName,flowId:r.flowId,pId:r.pId,pnId:r.pnId,type:"todo",canBack:!1},P.Z.shuke.shGovShuke(e,a,function(e){R.log(e),e.openTime&&(P.Z.http.post("/fn/approvalFileInformation/save",{infoId:r.pk,fileId:t.uploadFileId,startTime:moment(Number(e.openTime)).format("yyyy-MM-DD hh:mm:ss"),endTime:moment(Number(e.closeTime)).format("yyyy-MM-DD hh:mm:ss"),pagination:e.currentPage,readingTime:Math.floor((e.closeTime-e.openTime)/1e3)}).then(function(e){}),t.uploadFileId!=t.fileId)&&P.Z.http.post("/fn/approvalFileInformation/save",{infoId:r.pk,fileId:t.fileId,startTime:moment(Number(e.openTime)).format("yyyy-MM-DD hh:mm:ss"),endTime:moment(Number(e.closeTime)).format("yyyy-MM-DD hh:mm:ss"),pagination:e.currentPage,readingTime:Math.floor((e.closeTime-e.openTime)/1e3)}).then(function(e){}),"send"==e.type&&(n.alreadyWriteOpintion=!0,n.isShowWriteOpintionBtn=!0,i?n.handleActionClick("xform.inboxToSecretary"):n.handleActionClick("send"))}))}).catch(function(e){P.Z.layer.toast("暂不支持手写签批")})}),(0,t.Z)(n,"addLeaderReview",function(e,t,a,n,o){n.handleActionClick("xform.saveFormTemporarily"),n.ShowAddLeaderReview=!0,n.leaderReviewKey=Math.random(),n.leaderOrder=n.nowButtonParameters.showOrder||"2"}),(0,t.Z)(n,"xform.shareAbout",function(e,t,a,n,o){n.componentName="shareAboutDialog"}),(0,t.Z)(n,"xform.processNodeSendRange",function(e,t,a,n,o){n.$route.query.specialSaveObj=F()({temporarilySave:!0}),this.saveNoTip(e,t,a,n,function(){n.ShowAddLeaderReview=!0,n.leaderReviewKey=Math.random(),n.leaderOrder=n.nowButtonParameters.order||"2",n.processSettings={flowId:n.nowButtonParameters.flowId,nodeId:n.nowButtonParameters.nodeId,targetNodeId:n.nowButtonParameters.targetNodeId,isLoad:n.nowButtonParameters.isLoad,sendMode:n.nowButtonParameters.sendMode||"1",order:n.nowButtonParameters.order||"2"}})}),(0,t.Z)(n,"jingan_quanyue",function(t,a,n,o,r,i){var s=this;o.isShowWriteOpintionBtn=!0,o.alreadyWriteOpintion=!0,P.Z.layer.loading(),P.Z.http.post("/fn/mobileSaveOpinion/saveOpinion?flowId=".concat(a.parameters.flowId,"&nodeId=").concat(a.parameters.nodeId,"&moduleId=").concat(a.parameters.moduleId),{__DATA:F()({info_id:a.parameters.pk,pid:new String(a.parameters.pId),pnid:new String(a.parameters.pnId),opinion:"圈阅。",type:"g_inbox"})}).then(function(e){P.Z.layer.clear(),e.data.result?s.send(t,a,n,o,r,i):P.Z.layer.toast(e.data.message,!1)}).catch(function(){P.Z.layer.clear()})}),(0,t.Z)(n,"superRecycleV2",function(e,t,a,o,n){return(0,B.Z)(T().mark(function e(){var t,a,n;return T().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=P.Z.layer.loading(),a=o.pk,n=o.nowButtonParameters.issuper,o.formParams.isSuperRecycle=!0,e.next=6,P.Z.http.post("fn/flow/getInfoStatus",{infoId:a}).then(function(e){e=e.data;"success"==e.type&&2==e.data?P.Z.layer.toast("文件已办结!"):"error"==e.type&&(P.Z.layer.closeLoading(t),P.Z.layer.toast("服务器错误!"))});case 6:return e.next=8,P.Z.http.post("fn/flow/getSuperRecycleData",{pk:a,issuper:n}).then(function(e){e=e.data;e.data.length?(o.formParams.superRecycleData=e.data,o.formParams.issuper=n,P.Z.layer.closeLoading(t),o.componentName="sxSuperRecycle"):(P.Z.layer.closeLoading(t),P.Z.layer.toast("暂无回收节点！"))});case 8:case"end":return e.stop()}},e)}))()}),(0,t.Z)(n,"recycle",function(e,t,a,n,o){var r={pk:n.pk,pid:t.parameters.pid||t.parameters.pId,bt:a.main.B0001.value};P.Z.layer.confirm({message:"<div style='font-size: 18px;'>确定回收该文件吗？</div>",confirmButtonText:"确定"},function(){P.Z.http.post("ctrl/flow/checkRecycle",r).then(function(e){e=e.data;"success"==e.type?"1"==e.message?P.Z.http.post("ctrl/flow/recycle",e.data).then(function(e){"success"==e.data.type?P.Z.layer.toast(e.data.message,function(){n.backSucces()}):P.Z.layer.toast(e.data.message)}):P.Z.http.post("ctrl/flow/recycleListData",{pk:n.pk}).then(function(e){e=e.data;0==e.count?P.Z.layer.toast("暂无回收节点！"):(n.formParams.superRecycleData=e.data,n.formParams.isSuperRecycle=!1,n.componentName="sxSuperRecycle")}):P.Z.layer.toast(e.message)})})}),(0,t.Z)(n,"Flow.openEditOpinionList",function(e,t,a,n,o){n.componentName="opinionSxDialog",n.formParams.selectOpinion=!0,n.spHandleJS.closeDialogCallback=function(e){n.initData()}}),(0,t.Z)(n,"xform.sendAndInputOpinion",function(e,t,a,n,o,r,i,s){this.send(e,t,a,n,o,r,i,s)}),(0,t.Z)(n,"xform.endNode",function(e,a,t,n,o){this.saveNoTip(e,a,t,n,function(){r()},!1);var r=function(){P.Z.layer.confirm({message:"是否确定办结文件？",confirmButtonText:"确认"},function(){var t=[{pk:n.formParams.pk,pnid:a.parameters.pnId,isNeedOpinion:n.nowButtonParameters.isNeedOpinion||-1}];1==n.nowButtonParameters.isNeedOpinion?(n.componentName="endNodeOpinion",n.spHandleJS.closeDialogCallback=function(e){R.log(e),"{}"!=F()(e)&&"确定"==e.actionName&&(t[0].opinion=e.value,i(t))}):i(t)})},i=function(e){P.Z.http.post("/fn/flow/batchEndNode",{todoData:F()(e)}).then(function(e){200==e.data.code?P.Z.layer.toast("办结成功",!0,function(){return n.backSucces()}):P.Z.layer.toast("办结失败",!1)})}});var u=n}}]);