"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[8124],{8124:function(t,e,a){a.r(e),a.d(e,{default:function(){return o}});var r=a(25108),e={name:"reportOne",props:["currentTabIndex","tabslist","searchList","searchIndex","dateStart","dateEnd","dateStr"],data:function(){return{myChart1:null,myChart2:null,color2:["#DF5858","#F7B500","#0A8BD8"],echartData:[],echartData2:[],chart1color:["#FFB218","#32C5FF","#048AEF","#1664E0","#44D7B6","#4AEAB0","#EC4E4F","#EFDD79","#1C80EF"],currentDBLX:null}},watch:{searchIndex:function(t){0==this.currentTabIndex&&t<3&&(this.currentDBLX=null,this.changeChart1(),this.changeChart2())},dateStr:function(t){0==this.currentTabIndex&&t.length&&(this.currentDBLX=null,this.changeChart1(),this.changeChart2())}},mounted:function(){this.initCharts()},methods:{getChartData1:function(e){var a=this,t=(a.echartData=[],{type:a.searchIndex+1});3==a.searchIndex&&(t.start=a.dateStart,t.end=a.dateEnd),dsf.http.post("ctrl/customStatic/summary",t).then(function(t){r.log(t.data),"success"==t.data.type?(t.data.data.forEach(function(t){a.echartData.push(t)}),e()):dsf.layer.toast("当前暂无数据")})},getChartData2:function(e){var t,a=this,n=(a.echartData2=[],{type:a.searchIndex+1});3==a.searchIndex&&(n.start=a.dateStart,n.end=a.dateEnd),a.currentDBLX&&(n.fileType=null==(t=a.echartData.find(function(t){return t.name==a.currentDBLX.name}))?void 0:t.key),dsf.http.post("ctrl/customStatic/task",n).then(function(t){r.log(t.data),"success"==t.data.type?(t.data.data.forEach(function(t){a.echartData2.push(t)}),e()):dsf.layer.toast("当前暂无数据")})},changeTab:function(t){this.currentTabIndex=t,this.searchList.forEach(function(t){t.selected=!1}),this.searchList[0].selected=!0,this.getChartsData()},initCharts:function(){var t=this;t.getChartData1(function(){t.initCharts1()}),t.getChartData2(function(){t.initCharts2()})},initCharts1:function(){var e=this,t=e.echartData.reduce(function(t,e){return t+ +e.value},0),a={backgroundColor:"#fff",color:e.chart1color,title:{text:"{name|督办任务}\n{val|"+t+"}",top:"center",left:"center",textStyle:{rich:{name:{fontSize:16,fontWeight:"bold",color:"#0E7CE2",padding:[10,0]},val:{fontSize:16,fontWeight:"bold",color:"#F8456B"}}}},legend:{show:!1,bottom:"0",icon:"rect",itemWidth:12,itemHeight:12,textStyle:{rich:{name:{fontSize:12,fontWeight:"bold"}}},formatter:function(t){return"{name|"+t+"}"}},series:[{type:"pie",radius:["40%","60%"],center:["50%","50%"],data:e.setLabel1(e.echartData),itemStyle:{normal:{borderColor:"#fff",borderWidth:1}},label:{show:!0,position:"outside",formatter:"{b|{b}}\n{a|{d}%}\n{hr|}",rich:{hr:{backgroundColor:"t",width:3,height:3,borderRadius:3,padding:[3,3,0,-12]},a:{align:"center",padding:[-20,10,0,10],height:20},b:{padding:[-20,10,-30,10]}}},labelLine:{normal:{length:10,length2:15}}}]};setTimeout(function(){e.myChart1=echarts.init(document.getElementById("echarts1")),e.myChart1.setOption(a),e.myChart1.on("click",function(t){r.log(t),e.currentDBLX=t,e.changeChart2()})},0)},initCharts2:function(){var e=this,t={backgroundColor:"#fff",color:e.color2,title:{text:"{name|督办情况}",top:"center",left:"center",textStyle:{rich:{name:{fontSize:16,fontWeight:"bold",color:"#FD4900"}}}},series:[{type:"pie",radius:["40%","60%"],center:["50%","50%"],data:e.setLabel1(e.echartData2,2),labelLine:{normal:{length:10,length2:20}}}]};setTimeout(function(){e.myChart2=echarts.init(document.getElementById("echarts2")),e.myChart2.setOption(t),e.myChart2.on("click",function(t){r.log(t),e.$router.push({path:"/reportGo",query:{dbsx:e.currentDBLX?e.currentDBLX.data.source.key:"",status:t.name,searchIndex:e.searchIndex,dateStart:e.dateStart,dateEnd:e.dateEnd}})})},0)},changeChart1:function(){var a=this;a.getChartData1(function(){var t=a.myChart1.getOption(),e=(t.series[0].data=a.setLabel1(a.echartData),a.echartData.reduce(function(t,e){return t+ +e.value},0));t.title[0].text="{name|督办任务}\n{val|"+e+"}",a.myChart1.setOption(t,!0)})},changeChart2:function(){var t=this,e=t.myChart2.getOption();t.getChartData2(function(){t.currentDBLX?e.title[0].text="{name|"+t.getParamsNameArr(6,t.currentDBLX).join("\n")+"}":e.title[0].text="{name|督办情况}",e.series[0].data=t.setLabel1(t.echartData2,2),t.myChart2.setOption(e,!0)})},setLabel1:function(n,r){for(var s=this,i=[],c=["a","b","c","d","e","f","g"],o=0;o<n.length;o++)!function(){var t={},e=(t.name=n[o].name,t.value=n[o].value,t.source=n[o],s.getParamsNameArr(5,t)),a=(e.push(n[o].value+"条"),["{hr|}"]);e.forEach(function(t,e){a.push("{"+c[e]+"|"+t+"}")}),e=e.length,t.label={normal:{show:!0,formatter:a.join("\n"),rich:{hr:{backgroundColor:(r?s.color2:s.chart1color)[o],width:3,height:3,borderRadius:3,padding:[3,3,0,-12]}}}},2==e&&(t.label.normal.rich.a={align:"left",padding:[-20,5,-40,5],height:20,fontSize:14},t.label.normal.rich.b={align:"left",padding:[-20,5,-10,5],height:20,fontSize:14}),3==e&&(t.label.normal.rich.a={align:"left",padding:[-20,5,-55,5],height:20,fontSize:14},t.label.normal.rich.b={align:"left",padding:[-20,5,-25,5],height:20,fontSize:14},t.label.normal.rich.c={align:"left",padding:[-30,5,0,5],height:20,fontSize:14}),4==e&&(t.label.normal.rich.a={align:"left",padding:[-20,5,-70,5],height:20,fontSize:14},t.label.normal.rich.b={align:"left",padding:[-20,5,-40,5],height:20,fontSize:14},t.label.normal.rich.c={align:"left",padding:[-20,5,-10,5],height:20,fontSize:14},t.label.normal.rich.d={align:"left",padding:[-40,5,0,5],height:20,fontSize:14}),i.push(t)}();return i},setLabel2:function(t){for(var e=[],a=0;a<t.length;a++){var n={};n.name=t[a].name,n.value=t[a].value,n.label={normal:{show:!0,formatter:["{a|"+t[a].value+"条}","{hr|}"].join("\n"),rich:{a:{padding:[-90,1,-80,1],fontSize:14},hr:{height:5,width:5,lineHeight:5,marginBottom:10,padding:[0,-5],borderRadius:5,backgroundColor:this.color2[a]}}}},e.push(n)}return e},getChartData:function(a){this.searchList.forEach(function(t,e){t.selected=a==e}),3==a?this.isShowTypePicker=!0:this.getChartsData()},getParamsNameArr:function(t,e){var a=[],n=e.name.length,r=t<n?4:t,s=Math.ceil(n/r);if(r<n)for(var i=0;i<s;i++){var c="",o=i*r,l=o+r,c=i===s-1?e.name.substring(o,n):e.name.substring(o,l);a.push(c)}else a.push(e.name);return a}}},n=a(51900),e=(0,n.Z)(e,function(){this._self._c;return this._m(0)},[function(){var t=this,e=t._self._c;return e("div",{staticClass:"pie-container one"},[e("div",{staticClass:"task-container"},[e("span",[t._v("督办事项")])]),t._v(" "),e("div",{staticClass:"chart-container"},[e("div",{staticClass:"echarts",attrs:{id:"echarts1"}})]),t._v(" "),e("div",{staticClass:"task-container"},[e("span",[t._v("督办情况"),e("i",[t._v("（点击图片支持下钻）")])])]),t._v(" "),e("div",{staticClass:"chart-container"},[e("div",{staticClass:"echarts",attrs:{id:"echarts2"}})])])}],!1,null,"7e602d4e",null).exports,s=a(25108),i=(0,n.Z)({name:"reportTwo",props:["currentTabIndex","tabslist","searchList","searchIndex","dateStart","dateEnd","dateStr"],data:function(){return{colors:["#0091FF","#32C5FF","#1A74D8","#16C8A0","#8AC9B5","#6DD400","#F7B500","#D19900","#F88542","#DC5609"],tableData:[]}},watch:{searchIndex:function(t){1==this.currentTabIndex&&t<3&&this.getData()},dateStr:function(t){1==this.currentTabIndex&&t.length&&this.getData()}},created:function(){this.getData()},mounted:function(){},methods:{goList:function(t){s.log(t),this.$router.push({path:"/reportGo",query:{leaderName:t.name,leaderId:t.value,searchIndex:this.searchIndex,dateStart:this.dateStart,dateEnd:this.dateEnd}})},getData:function(){var r=this,t={type:r.searchIndex+1};3==r.searchIndex&&(t.start=r.dateStart,t.end=r.dateEnd),dsf.http.post("ctrl/customStatic/leader",t).then(function(e){var a,n;r.tableData=[],s.log(e.data),"success"==e.data.type?(a={title:e.data.data.swTitle.name,total:e.data.data.swTitle.value,dataList:[]},e.data.data.swData.forEach(function(t){a.dataList.push({name:t.name,value:t.key,color:r.colors[Math.floor(10*Math.random())],count:t.value,progress:Math.floor(t.value/e.data.data.swTitle.value*100)})}),n={title:e.data.data.sfTitle.name,total:e.data.data.sfTitle.value,dataList:[]},e.data.data.sfData.forEach(function(t){n.dataList.push({name:t.name,value:t.key,color:r.colors[Math.floor(10*Math.random())],count:t.value,progress:Math.floor(t.value/e.data.data.sfTitle.value*100)})}),r.tableData=r.tableData.concat([a,n])):dsf.layer.toast("当前暂无数据")})}}},function(){var a=this,n=a._self._c;return n("div",{staticClass:"container one"},[a._m(0),a._v(" "),a._l(a.tableData,function(t,e){return n("div",{key:e,staticClass:"table-container"},[n("div",{staticClass:"table-title"},[n("span",[a._v(a._s(t.title))]),a._v(" "),n("span",[a._v(a._s(t.total)+"条")])]),a._v(" "),n("div",{staticClass:"table-content"},a._l(t.dataList,function(e,t){return n("div",{key:t,staticClass:"table-row"},[n("div",{staticClass:"name"},[a._v(a._s(e.name))]),a._v(" "),n("div",{staticClass:"progress"},[n("van-progress",{attrs:{percentage:e.progress,"show-pivot":!1,color:e.color,"stroke-width":"8","track-color":"#F1F1F1"}})],1),a._v(" "),n("div",{staticClass:"count bottomline",on:{click:function(t){return a.goList(e)}}},[a._v("\n          "+a._s(e.count)+"条\n        ")])])}),0)])})],2)},[function(){var t=this._self._c;return t("div",{staticClass:"type-container"},[t("span",[this._v("市领导")])])}],!1,null,"057d27a6",null).exports,c=a(25108),a=(0,n.Z)({name:"reportThree",props:["currentTabIndex","tabslist","searchList","searchIndex","dateStart","dateEnd","dateStr"],data:function(){return{currentRowIndex:-1,colors:["#0091FF","#32C5FF","#1A74D8","#16C8A0","#8AC9B5","#6DD400","#F7B500","#D19900","#F88542","#DC5609"],tableData1:[],tableData2:[],currentRow:null}},watch:{searchIndex:function(t){var e=this;2==this.currentTabIndex&&t<3&&(this.currentRowIndex=-1,this.getTableData1(function(){e.getTableData2()}))},dateStr:function(t){var e=this;2==this.currentTabIndex&&t.length&&(this.currentRowIndex=-1,this.getTableData1(function(){e.getTableData2()}))}},created:function(){},mounted:function(){var t=this;t.getTableData1(function(){t.getTableData2()})},methods:{goList1:function(t,e){c.log(t),this.$router.push({path:"/reportGo",query:{status:e,fgLeaderName:t.name,fgLeaderId:t.userId,searchIndex:this.searchIndex,dateStart:this.dateStart,dateEnd:this.dateEnd}})},goList2:function(t){c.log(t),this.$router.push({path:"/reportGo",query:{deptId:t.id,deptName:t.name,fgLeaderName:"-1"!=this.currentRow.userId?this.currentRow.name:"",fgLeaderId:"-1"!=this.currentRow.userId?this.currentRow.userId:"",searchIndex:this.searchIndex,dateStart:this.dateStart,dateEnd:this.dateEnd}})},getClass:function(t,e){return 0<t&&e<this.tableData1.length-1?"bottomline":""},changeRow:function(a,t){a!=this.tableData1.length-1&&(t.selected?(t.selected=!1,this.currentRowIndex=-1,this.tableData1.length&&(this.currentRow=this.tableData1[this.tableData1.length-1])):(this.currentRowIndex=a,this.currentRow=t,this.tableData1.forEach(function(t,e){t.selected=a==e})),this.getTableData2())},getTableData1:function(e){var a=this;a.searchIndex;3==a.searchIndex&&(a.dateStart,a.dateEnd),dsf.http.post("ctrl/customStatic/hostLeaderTask").then(function(t){a.tableData1=[],c.log(t.data),t.data.data.forEach(function(t){a.tableData1.push({userId:t.userId,name:t.userName,completed:t.ybNum,progress:t.zbNum,over:t.cqNum,total:t.total,selected:!1})}),a.tableData1.length&&(a.currentRow=a.tableData1[a.tableData1.length-1]),e()})},getTableData2:function(){var e=this,a=this,t={type:a.searchIndex+1};3==a.searchIndex&&(t.start=a.dateStart,t.end=a.dateEnd),a.currentRow&&"-1"!=a.currentRow.userId&&(t.leaderId=a.currentRow.userId),dsf.http.post("ctrl/customStatic/unitTask",t).then(function(t){a.tableData2=[],c.log(t.data),t.data.data.forEach(function(t){a.tableData2.push({id:t.key,name:t.name,progress:Math.floor(t.value/a.currentRow.total*100),color:e.colors[Math.floor(10*Math.random())],count:t.value})})})}}},function(){var n=this,r=n._self._c;return r("div",{staticClass:"container one"},[n._m(0),n._v(" "),r("div",{staticClass:"table-container"},[n._m(1),n._v(" "),r("div",{staticClass:"table-content"},n._l(n.tableData1,function(e,a){return r("div",{key:a,staticClass:"table-row",class:a==n.currentRowIndex?"rowactive":"",on:{click:function(t){return n.changeRow(a,e)}}},[r("div",{staticClass:"name center",class:a==n.tableData1.length-1?"highlight":""},[n._v("\n          "+n._s(e.name)+"\n        ")]),n._v(" "),r("div",{staticClass:"count",class:n.getClass(e.completed,a),on:{click:function(t){return t.stopPropagation(),n.goList1(e,"已办")}}},[n._v("\n          "+n._s(e.completed)+"\n        ")]),n._v(" "),r("div",{staticClass:"count",class:n.getClass(e.progress,a),on:{click:function(t){return t.stopPropagation(),n.goList1(e,"在办")}}},[n._v("\n          "+n._s(e.progress)+"\n        ")]),n._v(" "),r("div",{staticClass:"count",class:n.getClass(e.over,a),on:{click:function(t){return t.stopPropagation(),n.goList1(e,"超期")}}},[n._v("\n          "+n._s(e.over)+"\n        ")]),n._v(" "),r("div",{staticClass:"count",class:n.getClass(e.total,a),on:{click:function(t){return t.stopPropagation(),n.goList1(e)}}},[n._v("\n          "+n._s(e.total)+"\n        ")])])}),0)]),n._v(" "),n._m(2),n._v(" "),r("div",{staticClass:"table-container"},[r("div",{staticClass:"table-content"},n._l(n.tableData2,function(e,t){return r("div",{key:t,staticClass:"table-row"},[r("div",{staticClass:"name name2"},[n._v(n._s(e.name))]),n._v(" "),r("div",{staticClass:"progress"},[r("van-progress",{attrs:{percentage:e.progress,"show-pivot":!1,color:e.color,"stroke-width":"8","track-color":"#F1F1F1"}})],1),n._v(" "),r("div",{staticClass:"count count2 right bottomline",on:{click:function(t){return n.goList2(e)}}},[n._v("\n          "+n._s(e.count)+"条\n        ")])])}),0)])])},[function(){var t=this._self._c;return t("div",{staticClass:"type-container"},[t("span",[this._v("主办领导情况")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-title"},[e("span",[t._v("分管领导")]),t._v(" "),e("span",[t._v("已办")]),t._v(" "),e("span",[t._v("在办")]),t._v(" "),e("span",[t._v("超期")]),t._v(" "),e("span",[t._v("总计")])])},function(){var t=this._self._c;return t("div",{staticClass:"type-container"},[t("span",[this._v("处室办理")])])}],!1,null,"016fe1d2",null).exports,o=(0,n.Z)({name:"reportIndex",components:{reportOne:e,reportTwo:i,reportThree:a},data:function(){return{currentTabIndex:0,tabslist:[{name:"督办汇总"},{name:"市领导批示"},{name:"主办领导及处室"}],searchList:[{id:1,name:"近三个月",selected:!0},{id:2,name:"近六个月",selected:!1},{id:3,name:"近一年",selected:!1},{id:4,name:"更多",selected:!1}],searchIndex:0,isShowTypePicker:!1,dateStart:"",dateEnd:"",dateStr:"",start:!1,end:!1,minDate1:new Date(1970,0,1),maxDate1:new Date,minDate2:new Date(1970,0,1),maxDate2:new Date}},created:function(){},mounted:function(){},methods:{btnReset:function(){this.dateStart="",this.dateEnd="",this.minDate1=new Date(1970,0,1),this.maxDate1=new Date,this.minDate2=new Date(1970,0,1),this.maxDate2=new Date},btnSure:function(){this.start=!1,this.end=!1,this.isShowTypePicker=!1,this.minDate1=new Date(1970,0,1),this.maxDate1=new Date,this.minDate2=new Date(1970,0,1),this.maxDate2=new Date,this.dateStr=this.dateStart+"|"+this.dateEnd},startConfirm:function(t){this.start=!1,this.minDate2=t,this.dateStart=dsf.date.format(t,"yyyy-mm-dd")},endConfirm:function(t){this.end=!1,this.maxDate1=t,this.dateEnd=dsf.date.format(t,"yyyy-mm-dd")},changeTab:function(t){this.currentTabIndex=t,this.searchList.forEach(function(t){t.selected=!1}),this.searchList[0].selected=!0,this.searchIndex=0,this.dateStr=""},changeSelect:function(a){this.searchIndex=a,this.searchList.forEach(function(t,e){t.selected=a==e}),3==a&&(this.isShowTypePicker=!0),this.dateStr=""},typeConfirm:function(t,e){this.currentType=t,this.currentTypeIndex=e,this.isShowTypePicker=!1},startDateConfirm:function(t){new Date(t).getTime()>new Date(this.endDate.replace(/-/g,"/")).getTime()?dsf.layer.toast("开始日期不能大于结束日期"):(this.startDate=this.dateFormat(t,"yyyy-MM-dd"),this.isShowStartTimePicker=!1)},endDateConfirm:function(t){new Date(t).getTime()<new Date(this.startDate.replace(/-/g,"/")).getTime()?dsf.layer.toast("结束日期不能小于起始日期"):(this.endDate=this.dateFormat(t,"yyyy-MM-dd"),this.isShowEndTimePicker=!1)},dateFormat:function(t,e){var a,n={"M+":(t=new Date(t)).getMonth()+1,"d+":t.getDate(),"H+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()},t=4<=(t=t.getFullYear().toString()).length?t:"0000".substr(0,4-t.length)+t;for(a in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t+"").substr(4-RegExp.$1.length))),n)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[a]:("00"+n[a]).substr((""+n[a]).length)));return e}}},function(){var a=this,n=a._self._c;return n("div",{attrs:{id:"inspector-statistics"}},[n("div",{staticClass:"tabs"},[n("div",{staticClass:"tablist"},a._l(a.tabslist,function(t,e){return n("div",{key:e,staticClass:"tab",class:e==a.currentTabIndex?"tabactive":"",attrs:{name:e},on:{click:function(t){return a.changeTab(e)}}},[a._v("\n        "+a._s(t.name)+"\n      ")])}),0),a._v(" "),n("div",{staticClass:"select-container"},a._l(a.searchList,function(t,e){return n("div",{key:t.id,class:t.selected?"select active":"select",on:{click:function(t){return a.changeSelect(e)}}},[a._v("\n        "+a._s(t.name)+"\n      ")])}),0),a._v(" "),n("div",{staticClass:"tabcontent"},[n("div",{directives:[{name:"show",rawName:"v-show",value:0==a.currentTabIndex,expression:"currentTabIndex == 0"}],staticClass:"panel"},[n("reportOne",{attrs:{currentTabIndex:a.currentTabIndex,tabslist:a.tabslist,searchList:a.searchList,searchIndex:a.searchIndex,dateStart:a.dateStart,dateEnd:a.dateEnd,dateStr:a.dateStr}})],1),a._v(" "),1==a.currentTabIndex?n("div",{staticClass:"panel"},[n("reportTwo",{attrs:{currentTabIndex:a.currentTabIndex,tabslist:a.tabslist,searchList:a.searchList,searchIndex:a.searchIndex,dateStart:a.dateStart,dateEnd:a.dateEnd,dateStr:a.dateStr}})],1):a._e(),a._v(" "),2==a.currentTabIndex?n("div",{staticClass:"panel"},[n("reportThree",{attrs:{currentTabIndex:a.currentTabIndex,tabslist:a.tabslist,searchList:a.searchList,searchIndex:a.searchIndex,dateStart:a.dateStart,dateEnd:a.dateEnd,dateStr:a.dateStr}})],1):a._e()])]),a._v(" "),n("van-popup",{style:{height:"35%"},attrs:{round:"",position:"bottom","get-container":"#app"},model:{value:a.isShowTypePicker,callback:function(t){a.isShowTypePicker=t},expression:"isShowTypePicker"}},[n("div",{staticClass:"datetitle"},[a._v("查询")]),a._v(" "),n("div",{staticClass:"datebody"},[n("div",{staticClass:"datelabel"},[n("span",[a._v("办理期限")])]),a._v(" "),n("div",{staticClass:"dateselect"},[n("van-field",{attrs:{readonly:"",clickable:"",name:"calendar",value:a.dateStart,placeholder:"选择日期"},on:{click:function(t){a.start=!0}}}),n("i",{staticClass:"iflex"},[a._v("——")]),a._v(" "),n("van-field",{attrs:{readonly:"",clickable:"",name:"calendar",value:a.dateEnd,placeholder:"选择日期"},on:{click:function(t){a.end=!0}}})],1)]),a._v(" "),n("div",{staticClass:"datefooter"},[n("van-button",{attrs:{type:"default"},on:{click:function(t){return a.btnReset()}}},[a._v("重置")]),a._v(" "),n("van-button",{attrs:{type:"info"},on:{click:function(t){return a.btnSure()}}},[a._v("确定")])],1),a._v(" "),n("van-calendar",{attrs:{"get-container":"#app","min-date":a.minDate1,"max-date":a.maxDate1},on:{confirm:a.startConfirm},model:{value:a.start,callback:function(t){a.start=t},expression:"start"}}),a._v(" "),n("van-calendar",{attrs:{"get-container":"#app","min-date":a.minDate2,"max-date":a.maxDate2},on:{confirm:a.endConfirm},model:{value:a.end,callback:function(t){a.end=t},expression:"end"}})],1)],1)},[],!1,null,"eeffe5c4",null).exports}}]);