"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[52869],{52869:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});var e=a(79529),o=a.n(e),n=a(25108),e={data:function(){return{calcType:this.$route.params.calcType,userName:dsf.util.loadSessionStore("user").name,groupName:dsf.util.loadSessionStore("user").attndGroupName,default_avatar:+a(4615)+'"',avatar:dsf.url.getWebPath("/fn/mobilePhoto/download?id=".concat(dsf.util.loadSessionStore("user").user_id,"&time=").concat((new Date).getTime())),mode:0,kvp:[],kvp2:[],nowDay:moment().format("YYYY-MM-DD"),showPop:!1,showPopTitle:""}},computed:{sdate:function(){var t=this,t=0==t.mode?t.getCurrWeekDays(t.nowDay):t.getCurrMonthDays(t.nowDay);return t[0]},edate:function(){var t=this,t=0==t.mode?t.getCurrWeekDays(t.nowDay):t.getCurrMonthDays(t.nowDay);return t[1]},showKvp:function(){return this.kvp.filter(function(t){return t.visible})}},created:function(){this.loadData()},methods:{loadData:function(){var t,e=this;"1"==e.$route.query.demo?(e.kvp=[{key:"平均工时",value:"11.4小时"},{key:"出勤天数",value:"5天"},{key:"休息天数",value:"2天"},{key:"外勤",value:"1天"},{key:"迟到",value:"0次"},{key:"早退",value:"0次"},{key:"缺卡",value:"0次"},{key:"旷工",value:"0天"}],1==e.mode&&(e.kvp=e.kvp=[{key:"平均工时",value:"11.4小时"},{key:"出勤天数",value:"22天"},{key:"休息天数",value:"8天"},{key:"外勤",value:"1天"},{key:"迟到",value:"0次"},{key:"早退",value:"0次"},{key:"缺卡",value:"0次"},{key:"旷工",value:"1天"}])):(t={type:e.calcType,sdate:e.sdate,edate:e.edate},1==this.calcType&&e.$set(t,"groupId",e.$route.params.btId),dsf.http.post("fn/attnd/getSummary",t).done(function(t){"success"==t.type&&(e.kvp=t.data)}).error(function(t){n.log("getSummary-error",t)}))},checkBox:function(e){var a=this,t=["迟到","早退","缺卡","旷工"].indexOf(e.key);1==this.$route.params.calcType&&-1!=t&&dsf.http.post("/fn/attnd/getSummary2",{type:t+1,sdate:this.sdate,edate:this.edate,groupId:this.$route.params.btId}).done(function(t){"success"==t.type&&(a.kvp2=t.data,a.showPop=!0,a.showPopTitle=e.key)})},getMyGroup:function(){var a=this;dsf.http.get("fn/attnd/getMyGroup").done(function(t){var e;"success"==t.type&&(a.groupName=t.data.groupName,(e=dsf.util.loadSessionStore("user")).attndGroupName||(e.attndGroupName=t.data.groupName,dsf.util.saveToSessionStore("user",e)))}).error(function(t){n.log("getMyGroup-error",t)}).always(function(){})},chengeMode:function(t){this.mode!=t&&(this.mode=t,this.nowDay=moment().format("YYYY-MM-DD"),this.loadData())},getCurrWeekDays:function(t){var e=[],a=(o()(moment().format("d")),moment(t).startOf("week").add(1,"day").format("YYYY-MM-DD")),t=moment(t).endOf("week").add(1,"day").format("YYYY-MM-DD");return e.push(a),e.push(t),this.nowDay=a,e},getCurrMonthDays:function(t){var e=[],a=moment(t).startOf("month").format("YYYY-MM-DD"),t=moment(t).endOf("month").format("YYYY-MM-DD");return e.push(a),e.push(t),this.nowDay=a,e},prevClick:function(){var t=this;0==t.mode?t.nowDay=moment(t.nowDay).subtract(7,"days").format("YYYY-MM-DD"):1==t.mode&&(t.nowDay=moment(t.nowDay).subtract(1,"month").startOf("month").format("YYYY-MM-DD")),t.loadData()},nextClick:function(){var t=this;0==t.mode?t.nowDay=moment(t.nowDay).add(7,"days").startOf("week").format("YYYY-MM-DD"):1==t.mode&&(t.nowDay=moment(t.nowDay).add(1,"month").startOf("month").format("YYYY-MM-DD")),t.loadData()}},filters:{dateFormatWeek:function(t){return t?dsf.date.format(t,"mm.dd"):""},dateFormatMonth:function(t){return t?dsf.date.format(t,"yyyy.mm"):""}}},r=(0,a(51900).Z)(e,function(){var a=this,o=a._self._c;return o("div",{staticClass:"summaryMore-page"},[o("div",{staticClass:"bar"},[o("div",{staticClass:"bar-btns"},[o("div",{class:["btn","btn-l",{"btn-active":0==a.mode}],on:{click:function(t){return a.chengeMode(0)}}},[a._v("\n        周\n      ")]),a._v(" "),o("div",{class:["btn","btn-r",{"btn-active":1==a.mode}],on:{click:function(t){return a.chengeMode(1)}}},[a._v("\n        月\n      ")])]),a._v(" "),o("div",{staticClass:"bar-search"},[o("van-icon",{attrs:{name:"arrow-left"},on:{click:a.prevClick}}),a._v(" "),0==a.mode?o("span",[a._v(a._s(a._f("dateFormatWeek")(a.sdate))+" - "+a._s(a._f("dateFormatWeek")(a.edate)))]):o("span",[a._v(a._s(a._f("dateFormatMonth")(a.sdate)))]),a._v(" "),o("van-icon",{attrs:{name:"arrow"},on:{click:a.nextClick}})],1)]),a._v(" "),o("div",{staticClass:"content"},[o("van-cell-group",[o("van-cell",{scopedSlots:a._u([{key:"title",fn:function(){return[o("div",{staticClass:"info"},[0==a.calcType?o("div",{staticClass:"info-avatar"},[o("van-image",{attrs:{round:"",src:a.avatar}})],1):a._e(),a._v(" "),o("div",{staticClass:"info-msg"},[0==a.calcType?o("div",{staticClass:"name"},[a._v(a._s(a.userName))]):a._e()])])]},proxy:!0}])})],1),a._v(" "),0==a.kvp.length?o("commonempty",{attrs:{description:"暂无数据"}}):a._l(a.showKvp,function(e,t){return o("van-cell-group",{key:t},[o("van-cell",{attrs:{title:e.key,value:e.value},on:{click:function(t){return a.checkBox(e)}}})],1)}),a._v(" "),o("van-popup",{staticStyle:{height:"70%"},attrs:{position:"bottom",round:""},model:{value:a.showPop,callback:function(t){a.showPop=t},expression:"showPop"}},[o("van-nav-bar",{attrs:{title:a.showPopTitle,"left-text":"返回","left-arrow":""},on:{"click-left":function(t){a.showPop=!1}}}),a._v(" "),0==a.kvp2.length?o("commonempty",{attrs:{description:"暂无数据"}}):a._l(a.kvp2,function(t,e){return o("van-cell-group",{key:e},[o("van-cell",{attrs:{title:t.userName,value:t.num}})],1)})],2)],2)])},[],!1,null,"2fbaac84",null).exports},4615:function(t,e,a){t.exports=a.p+"static/img/icon_head.33f5a1d..png"}}]);