"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[6518],{6518:function(t,n,i){i.r(n),i.d(n,{default:function(){return r}});var a=i(66250),e=i(5044),n=i(33453),s=i.n(n),n=i(18428),o=i.n(n),c=i(25108),n={name:"announcement",data:function(){return{value:"",startindex:0,start:0,limit:10,total:0,data:[],obj_hei:{height:""},loading:!1,finished:!1,refreshing:!1}},computed:{contentHeight:function(){var t=document.body.clientHeight;return this.obj_hei.height=t-108+"px",this.obj_hei}},activated:function(){this.getList()},created:function(){},methods:{getList:function(){var n=this,t={start:n.start,limit:n.limit,key:n.value};dsf.http.post("fn/mobileNotice/getList",o()(t,this.$route.query)).then(function(t){n.refreshing&&(n.refreshing=!1),n.loading=!1,0==t.data.rows.length&&(n.finished=!0),200===t.status?0<n.data.length?n.data=[].concat((0,e.Z)(n.data),(0,e.Z)(t.data.rows)):n.data=t.data.rows:n.dsf.layer.toast(t.message)}).catch(function(t){n.dsf.layer.toast(t.message)}).finally(function(){})},onLoad:function(){this.startindex++,this.start=this.startindex*this.limit,this.getList()},initData:function(){this.finished=!1,this.start=0,this.startindex=0,this.data=[],this.getList()},onRefresh:function(){this.initData()},onSearch:function(t){this.initData()},onClear:function(){this.initData()},toDtail:function(n){var i=this;return(0,a.Z)(s().mark(function t(){return s().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("1"===n.status)return t.next=3,dsf.http.post("fn/mobileNotice/markRead",{pks:n.id}).then(function(t){c.log(t),i.data.forEach(function(t){t.info_id==n.info_id&&t.status<2&&(t.status=2)})});t.next=3;break;case 3:i.$router.push({path:"/commonForm/".concat(n.moduleId,"/").concat(n.info_id)});case 4:case"end":return t.stop()}},t)}))()}}},r=(0,i(51900).Z)(n,function(){var i=this,t=i._self._c;return t("div",{staticClass:"ds-announcement fc announcementbox"},[t("div",{staticClass:"announcement-search"},[t("form",{attrs:{action:"/"}},[t("van-search",{attrs:{placeholder:"搜索"},on:{search:i.onSearch,clear:i.onClear},model:{value:i.value,callback:function(t){i.value=t},expression:"value"}})],1)]),i._v(" "),i.data.length?t("div",{staticClass:"announcement-list flex1 verticalScroll"},[t("div",{staticClass:"announcement-list-inner"},[t("van-pull-refresh",{attrs:{"success-text":"刷新成功"},on:{refresh:i.onRefresh},model:{value:i.refreshing,callback:function(t){i.refreshing=t},expression:"refreshing"}},[t("van-list",{attrs:{finished:i.finished,"finished-text":"没有更多了"},on:{load:i.onLoad},model:{value:i.loading,callback:function(t){i.loading=t},expression:"loading"}},i._l(i.data,function(n){return t("div",{key:n.id,staticClass:"announcement-list-content",on:{click:function(t){return i.toDtail(n)}}},["2"!=n.status?t("span",{staticClass:"isStatus"}):i._e(),i._v(" "),t("div",{staticClass:"announcement-list-content-tit"},[i._v("\n                            "+i._s(n.itemsContent)+"\n                        ")]),i._v(" "),t("div",{staticClass:"announcement-list-time"},[t("div",{staticClass:"announcement-list-time-left",staticStyle:{display:"flex"}},[t("i",{staticClass:"iconfont iconyonghu"}),i._v(" "),t("span",{staticClass:"van-ellipsis"},[i._v(i._s(n.createUname))])]),i._v(" "),t("div",{staticClass:"announcement-list-time-right"},[t("i",{staticClass:"iconfont iconalarm"}),i._v(" "),t("span",[i._v(i._s(n.time))])])])])}),0)],1)],1)]):t("commonempty",{attrs:{description:"暂无数据"}})],1)},[],!1,null,"1768c3a3",null).exports}}]);