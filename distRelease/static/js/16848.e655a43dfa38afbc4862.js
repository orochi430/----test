"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[16848],{16848:function(e,t,a){a.r(t),a.d(t,{default:function(){return i}});var n=a(25108),t={name:"elecHomePage",data:function(){return{news:[],loading:!1,finished:!1,mainConfig:{data:dsf.config.commonTabs},refreshing:!1,currentPage:1,totalNum:0,imgPreview:!1,previewImg:[]}},created:function(){this.loadingNews()},props:{clickTabIndex:{type:Number,default:function(){return 0}},tabParams:{type:Object,default:function(){return{}}},currentTabs:{type:Number,default:function(){return 0}}},watch:{},computed:{},mounted:function(){},methods:{loadingNews:function(){var i=this,e=this.tabParams.url.split("?")[0],t={page:this.currentPage,newsType:this.tabParams.params.newsType,limit:this.tabParams.params.limit};dsf.http.post(e,t).then(function(e){var t=e.data.data.data;if(i.totalNum=e.data.data.total,200==e.data.code)if(0==t.length)i.finished=!0;else if(i.news.length<e.data.data.total)for(var a=0;a<t.length;a++)t[a].leftWidth=16,""==t[a].image&&(t[a].leftWidth=24),i.news.push(t[a])})},goNewsDetail:function(t){var a=this;1==t.useExternalURL?this.$router.push({name:"dsfIframe",query:{url:t.externalURL,title:t.title}}):dsf.http.post("/fn/newscontent/detail",{id:t.id}).then(function(e){200==e.data.code&&(""==e.data.data.content?a.filePre(e.data.data.attachFile[0]):a.$router.push({name:"elecDetail",query:{id:t.id},params:{data:e.data.data}}))}).error(function(e){dsf.layer.toast("无相关附件！")})},onLoad:function(){var e=this;setTimeout(function(){e.totalNum>e.news.length?(e.currentPage++,e.loadingNews(),e.loading=!1,e.refreshing=!1):e.finished=!0},1e3)},onRefresh:function(){this.loading=!0,this.finished=!1,this.currentPage=0,this.refreshing=!1,this.news=[],this.onLoad()},filePre:function(t){var a=this,e={fileId:t.fileId,moduleId:"220803111621B521Wfaj0JHZLp0lbpU",fileName:t.fileName,flowId:0,nodeId:-1,screenWidth:375,"x-auth-token":dsf.util.loadSessionStore("loginToken"),addLoading:1},i=t.fileName.lastIndexOf("."),i=t.fileName.substr(i+1).toLowerCase();-1<["png","jpg","jpeg","bmp","gif"].indexOf(i)?(this.imgPreview=!0,i=dsf.url.getWebPath("ctrl/file/download?infoId=".concat(t.infoId,"&fileId=").concat(t.fileId,"&fileName=").concat(t.fileName)),this.previewImg=[i],n.log(i)):dsf.http.post("/fn/office/openMobileOffice",e).then(function(e){200==e.data.code&&a.$router.push({name:"dsfIframe",query:{url:e.data.message,title:t.fileName}})}).error(function(e){dsf.layer.toast("文件预览失败！")})}}},i=(0,a(51900).Z)(t,function(){var a=this,e=a._self._c;return e("div",{staticClass:"elecPage"},[e("div",{staticClass:"elecContent"},[e("van-pull-refresh",{on:{refresh:a.onRefresh},model:{value:a.refreshing,callback:function(e){a.refreshing=e},expression:"refreshing"}},[e("van-list",{staticClass:"elecNews",attrs:{finished:a.finished,"immediate-check":!1,"finished-text":"没有更多了"},on:{load:a.onLoad},model:{value:a.loading,callback:function(e){a.loading=e},expression:"loading"}},a._l(a.news,function(t){return e("van-cell",{key:t.id,attrs:{value:""},on:{click:function(e){return a.goNewsDetail(t)}}},[e("div",{staticClass:"newsItem"},[e("van-row",{attrs:{type:"flex"}},[e("van-col",{attrs:{span:t.leftWidth}},[e("div",{staticClass:"leftNews"},[e("div",{staticClass:"newsTitle"},[1==t.isTop?e("span",{staticClass:"newsTop"},[a._v("置顶")]):a._e(),a._v(" "),e("span",[a._v("\n                      "+a._s(t.title)+"\n                    ")])]),a._v(" "),e("div",{staticClass:"releaseInfo"},[e("span",[a._v(a._s(t.newsType))]),a._v(" "),e("span",[a._v(a._s(t.time))])])])]),a._v(" "),t.image?e("van-col",{attrs:{span:"8"}},[e("van-image",{attrs:{width:"120",height:"85",src:t.image}})],1):a._e()],1)],1),a._v(" "),e("van-divider",{style:{borderColor:"rgb(193 196 198)",margin:0}})],1)}),1)],1),a._v(" "),e("van-image-preview",{attrs:{images:a.previewImg,closeable:""},model:{value:a.imgPreview,callback:function(e){a.imgPreview=e},expression:"imgPreview"}})],1)])},[],!1,null,"0584993d",null).exports}}]);