(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[78993],{23610:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});var t=i(77193),n=(i(41762),i(41956)),t={components:(0,t.Z)({},n.Z.name,n.Z),props:{file:{type:Object,default:function(){}},meetingId:{type:String},isShowCount:{type:Boolean,default:!0}},filters:{dateFormat:function(e){return e?dsf.date.format(e,"yyyy年mm月dd日 hh:ii"):""}},data:function(){return{fileType:{pdf:["pdf"],img:["jpeg","bmp","webp","svgz","svg","gif","jpg","ico","png","tif"],txt:["txt","sql","xml","html","css","js","java","php","bat","log"],word:["docx","docm","doc","dotx","dotm","dot"],xls:["xlsx","xlsm","xlsb","xls","xltx","xltm","xlt","xlam","xla","ods"],ppt:["pptx","pptm","ppt","potx","potm","pot","ppsx","ppsm","pps","ppam","ppa"]},hasFilePng:["ai","cloud","html","img","jpg","mp3","mp4","pdf","png","ppt","psd","rar","txt","word","wps","xls","zip","folder"],imgPreview:!1,previewImg:[]}},computed:{typeClass:function(){var e,t=this.file.type.toLowerCase();if(this.hasFilePng.includes(t))return i(83887)("./".concat(t,".png"));for(e in this.fileType)if(this.fileType[e].includes(t))return i(83887)("./".concat(e,".png"))}},methods:{link:function(){var t,i=this,n=this;"folder"==n.file.type?n.$router.push({name:"peopleCongressFile",params:{meetingId:n.meetingId,folderid:n.file.folderId},query:{title:n.file.folderName}}):(t="fn/peopleCongress/setRead",dsf.http.post(t,{fileId:n.file.fileId}).done(function(e){200==e.code&&(n.file.fileName.toLowerCase().includes(".png")||n.file.fileName.toLowerCase().includes(".jpg")||n.file.fileName.toLowerCase().includes(".jpeg")||n.file.fileName.toLowerCase().includes(".bmp")||n.file.fileName.toLowerCase().includes(".gif")?(t="peopleCongressFile"==n.$route.name?dsf.url.getWebPath("fn/conferenceFile/download?pk=".concat(n.file.fileId)):dsf.url.getWebPath("fn/mobileFileDownload/download?fileId=".concat(n.file.fileId,"&moduleId=").concat(n.file.moduleId,"&fileName=").concat(n.file.fileName)),i.imgPreview=!0,i.previewImg=[t]):(e="fn/office/openMobileOffice?fileId=".concat(n.file.fileId,"&moduleId=").concat(n.file.moduleId,"&nodeId=").concat(n.file.nodeId,"&flowId=").concat(n.file.flowId,"&filename=").concat(n.file.fileName),n.file.officeModuleId&&(e+="&officeModuleId=".concat(n.file.officeModuleId)),n.$router.push({name:"dsfIframe",params:{url:dsf.url.getServerUrl(e)}})))}).error(function(e){dsf.layer.toast("操作失败！")}).always(function(){}))}}},s=(0,i(51900).Z)(t,function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"file",on:{click:t.link}},[e("div",{staticClass:"typeIcon"},[e("img",{attrs:{src:t.typeClass,alt:""}}),t._v(" "),t.file.isNew?e("van-badge",{attrs:{dot:""}}):t._e()],1),t._v(" "),e("div",{staticClass:"info"},["folder"==t.file.type?e("div",[e("div",{staticClass:"title",domProps:{innerHTML:t._s(t.file.folderName)}}),t._v(" "),t.isShowCount?e("div",{staticClass:"num"},[t._v(t._s(t.file.filesCount)+"个文件")]):t._e()]):e("div",[e("div",{staticClass:"title",domProps:{innerHTML:t._s(t.file.fileName)}}),t._v(" "),t.isShowCount?e("div",{staticClass:"num"},[e("span",[t._v(t._s(t.file.viewCount)+"次查看")]),e("span",[t._v(t._s(t._f("dateFormat")(t.file.releaseTime)))])]):t._e()])])]),t._v(" "),e("van-image-preview",{attrs:{images:t.previewImg,closeable:""},model:{value:t.imgPreview,callback:function(e){t.imgPreview=e},expression:"imgPreview"}})],1)},[],!1,null,"0173f259",null).exports},78993:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var t=s(26243),o=s.n(t),t=s(23610),a=s(25108),t={components:{fileItem:t.Z},data:function(){return{keyword:"",showPanel:!1,showCal:!1,files:[],loading:null,meetingId:this.$route.params.meetingId,folderid:this.$route.params.folderid,errored:!1,topSearch:[],minDate:new Date((new Date).getFullYear()-5,0,1),maxDate:new Date((new Date).getFullYear()+5,11,31),isSearch:this.$route.query.isSearch,isFirstLoad:!1}},created:function(){this.isFirstLoad=!0,this.getFiles()},activated:function(){this.isFirstLoad||this.getFiles(),this.isFirstLoad=!1},mounted:function(){},methods:{getFiles:function(){a.log("getFiles");var t=this,e=(t.isSearch&&t.isFirstLoad&&t.onFocus(),t.loading=dsf.layer.loading(),"fn/peopleCongress/files");dsf.config.staticJson.enable&&t.folderid&&(e+="/".concat(t.folderid)),dsf.http.post(e,{meetingId:t.meetingId,folderId:t.folderid||""}).done(function(e){"success"==e.type?t.setFiles(e.data):t.errored=!0}).error(function(e){a.log("getFiles-err",e),t.errored=!0}).always(function(){dsf.layer.closeLoading(t.loading)})},onSearch:function(e,t){var i=this,n=(i.showPanel=!1,i.files=[],i.loading=dsf.layer.loading(),{});i.keyword&&(n.keyword=i.keyword),e&&t&&(n.sdate=e,n.edate=t),0<o()(n).length?(n.meetingId=i.meetingId,dsf.http.post("fn/peopleCongress/fileQuery",n).done(function(e){"success"==e.type?(i.setFiles(e.data),i.files.forEach(function(e){e.fileName&&(e.fileName=e.fileName.replace(i.keyword,'<span class="keyword">'.concat(i.keyword,"</span>"))),e.folderName&&(e.folderName=e.folderName.replace(i.keyword,'<span class="keyword">'.concat(i.keyword,"</span>")))})):i.files=[]}).error(function(e){a.log("fileQuery-err",e),i.errored=!0}).always(function(){dsf.layer.closeLoading(i.loading)})):i.getFiles()},onCancel:function(){this.showPanel=!1},onFocus:function(){var t=this;t.showPanel=!0,t.topSearch=[],dsf.http.post("fn/peopleCongress/fileTopSearch",{meetingId:t.meetingId}).done(function(e){"success"==e.type&&(t.topSearch=e.data)}).error(function(e){a.log("fileTopSearch-err",e)}).always(function(){})},setFiles:function(e){var t=this;t.files=[],e.folders&&0<e.folders.length&&e.folders.map(function(e){e.type="folder",t.files.push(e)}),e.files&&0<e.files.length&&e.files.map(function(e){e.type=e.fileName.substr(e.fileName.lastIndexOf(".")+1),t.files.push(e)})},onCalConfirm:function(e){this.showCal=!1;var t=dsf.date.format(e[0],"yyyy-mm-dd"),e=dsf.date.format(e[1],"yyyy-mm-dd");this.onSearch(t,e)}}},i=(0,s(51900).Z)(t,function(){var i=this,n=i._self._c;return n("div",[n("van-sticky",[n("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词"},on:{search:function(e){return i.onSearch()},cancel:i.onCancel,focus:i.onFocus},scopedSlots:i._u([{key:"action",fn:function(){return[n("van-icon",{attrs:{name:"filter-o"},on:{click:function(e){i.showCal=!0}}}),i._v(" "),n("span",{on:{click:i.onCancel}},[i._v("取消")])]},proxy:!0}]),model:{value:i.keyword,callback:function(e){i.keyword=e},expression:"keyword"}})],1),i._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:i.showPanel,expression:"showPanel"}],staticClass:"panel"},[0<i.topSearch.length?n("div",{staticClass:"panel-tip"},[i._v("大家都在看")]):i._e(),i._v(" "),i._l(i.topSearch,function(t,e){return n("span",{key:e,staticClass:"panel-keywords",on:{click:function(e){i.keyword=t,i.onSearch()}}},[i._v("\n      "+i._s(t)+"\n    ")])})],2),i._v(" "),n("van-calendar",{attrs:{type:"range",title:"发布时间","show-confirm":!1,"min-date":i.minDate,"max-date":i.maxDate,"allow-same-day":!0},on:{confirm:i.onCalConfirm},model:{value:i.showCal,callback:function(e){i.showCal=e},expression:"showCal"}}),i._v(" "),i.errored?n("div",[i._v("\n    数据获取失败！\n  ")]):0<i.files.length?n("div",i._l(i.files,function(e,t){return n("div",{directives:[{name:"show",rawName:"v-show",value:!i.showPanel,expression:"!showPanel"}],key:t},[n("file-item",{attrs:{file:e,"meeting-id":i.meetingId}}),i._v(" "),t<i.files.length-1?n("van-divider"):i._e()],1)}),0):0!=i.files.length||i.showPanel?i._e():n("div",{staticClass:"flex"},[n("commonempty",{staticClass:"file-empty",attrs:{image:s(89436),description:"暂无文件"}})],1)],1)},[],!1,null,"f7a2ea5e",null).exports},83887:function(e,t,i){var n={"./ai.png":44936,"./cloud.png":54073,"./doc.png":39636,"./docx.png":70071,"./folder-team.png":36556,"./folder.png":7818,"./html.png":97744,"./img.png":32954,"./jpeg.png":90699,"./jpg.png":84693,"./mp3.png":77957,"./mp4.png":96128,"./ofd.png":88825,"./pdf.png":46616,"./png.png":95742,"./ppt.png":68985,"./psd.png":89041,"./rar.png":45074,"./txt.png":48339,"./word.png":26206,"./wps.png":83392,"./xls.png":49472,"./xlsx.png":81682,"./xml.png":66874,"./zip.png":99021};function s(e){e=o(e);return i(e)}function o(e){if(i.o(n,e))return n[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}s.keys=function(){return Object.keys(n)},s.resolve=o,(e.exports=s).id=83887},44936:function(e,t,i){"use strict";e.exports=i.p+"static/img/ai.692fadd..png"},54073:function(e,t,i){"use strict";e.exports=i.p+"static/img/cloud.e0e5c0c..png"},39636:function(e,t,i){"use strict";e.exports=i.p+"static/img/doc.178d734..png"},70071:function(e,t,i){"use strict";e.exports=i.p+"static/img/docx.178d734..png"},36556:function(e,t,i){"use strict";e.exports=i.p+"static/img/folder-team.256a132..png"},7818:function(e,t,i){"use strict";e.exports=i.p+"static/img/folder.b74dd1f..png"},97744:function(e,t,i){"use strict";e.exports=i.p+"static/img/html.aed4382..png"},32954:function(e,t,i){"use strict";e.exports=i.p+"static/img/img.1e66416..png"},90699:function(e,t,i){"use strict";e.exports=i.p+"static/img/jpeg.6690b6f..png"},84693:function(e,t,i){"use strict";e.exports=i.p+"static/img/jpg.6690b6f..png"},77957:function(e,t,i){"use strict";e.exports=i.p+"static/img/mp3.11779e9..png"},96128:function(e,t,i){"use strict";e.exports=i.p+"static/img/mp4.bf3626d..png"},88825:function(e,t,i){"use strict";e.exports=i.p+"static/img/ofd.aa35dda..png"},46616:function(e,t,i){"use strict";e.exports=i.p+"static/img/pdf.0431c10..png"},95742:function(e,t,i){"use strict";e.exports=i.p+"static/img/png.99cbe3b..png"},68985:function(e,t,i){"use strict";e.exports=i.p+"static/img/ppt.2dcd0da..png"},89041:function(e,t,i){"use strict";e.exports=i.p+"static/img/psd.10d45f5..png"},45074:function(e,t,i){"use strict";e.exports=i.p+"static/img/rar.5ca3e88..png"},48339:function(e,t,i){"use strict";e.exports=i.p+"static/img/txt.9b1d964..png"},26206:function(e,t,i){"use strict";e.exports=i.p+"static/img/word.178d734..png"},83392:function(e,t,i){"use strict";e.exports=i.p+"static/img/wps.d841695..png"},49472:function(e,t,i){"use strict";e.exports=i.p+"static/img/xls.e136da2..png"},81682:function(e,t,i){"use strict";e.exports=i.p+"static/img/xlsx.e136da2..png"},66874:function(e,t,i){"use strict";e.exports=i.p+"static/img/xml.aed4382..png"},99021:function(e,t,i){"use strict";e.exports=i.p+"static/img/zip.4b7a304..png"},89436:function(e,t,i){"use strict";e.exports=i.p+"static/img/img_zwwj.5906452..png"}}]);