"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[80658],{80658:function(t,e,i){i.r(e),i.d(e,{default:function(){return c}});var s=i(44321),e=i(71937),e=i.n(e),n=i(22428),n=i.n(n),a=i(82060),o=i(70538),l=i(25108);o.default.use(n()),o.default.use(e());var n={components:{EnclosurePreview:a.default},props:{meeting:{type:Object,default:function(){}},files:{type:Array,default:function(){return[]}}},data:function(){return{activeNames:[],topics:[],hasFilePng:["ai","cloud","html","img","jpg","mp3","mp4","pdf","png","ppt","psd","rar","txt","word","wps","xls","zip","folder"],fileType:{pdf:["pdf"],img:["jpeg","bmp","webp","svgz","svg","gif","jpg","ico","png","tif"],txt:["txt","sql","xml","html","css","js","java","php","bat","log"],word:["docx","docm","doc","dotx","dotm","dot"],xls:["xlsx","xlsm","xlsb","xls","xltx","xltm","xlt","xlam","xla","ods"],ppt:["pptx","pptm","ppt","potx","potm","pot","ppsx","ppsm","pps","ppam","ppa"]},imgPreview:!1,previewImg:[],popFile:{},showFile:!1,filename:"",isPreview:!0}},created:function(){},methods:{goPreview:function(){this.isPreview=!0},goHandWrite:function(){this.isPreview=!1},goto:function(t){this.$router.push({path:"/meetingPad/index/topic/".concat(t.id)})},getData:function(){var i=this,e=this;dsf.http.post("fn/conferenceMobile/meetingTopics",{meetingId:e.meeting.id}).done(function(t){200==t.code&&0<t.data.length&&(e.topics=t.data,i.activeNames=[],e.topics.forEach(function(t,e){i.activeNames.push(e)}))}).error(function(t){dsf.layer.toast("数据获取失败！",!1)}).always(function(){})},typeClass:function(t){var e,i=t.fileName.substr(t.fileName.lastIndexOf(".")+1).toLowerCase();for(e in this.hasFilePng.includes(i)&&"static/images/fileType/".concat(i,".png"),this.fileType)if(this.fileType[e].includes(i))return"static/images/fileType/".concat(e,".png")},previewFile:function(t){this.setRead(t),this.popFile={id:t.fileId,name:t.fileName,infoId:t.infoId,moduleId:t.moduleId,isHandwrite:"1",flowId:t.flowId,nodeId:t.nodeId},navigator.userAgent.includes("DreamSoft")&&dsf.config.commonForm.nativeWps?this.wpsOpen(this.popFile):(this.isPreview=!0,this.filename=t.fileName,this.showFile=!0)},wpsOpen:function(t){var e=dsf.url.getRootPath(),i=dsf.util.loadSessionStore("user").auth.token,e={keepCallback:!0,downUrl:e+"fn/file/download?infoId=".concat(t.infoId,"&fileId=").concat(t.id,"&fileName=").concat(t.name,"&moduleId=").concat(t.moduleId,"&x-auth-token=").concat(i,"&fullfilename=").concat(t.name),saveUrl:"",fileName:t.name,openWithWPS:!0,uploadFile:!0,openMode:"readOnly",enterReviseMode:!1,showReviewingPaneRightDefault:!1,userName:dsf.util.loadSessionStore("user").name};l.log(e),$WPS.downAndOpen(e,function(t){l.log(t)},function(t){l.log("错误回调",t)})},closeFile:function(){this.showFile=!1,this.$refs.enclosurePreview.destroyInterval()},setRead:function(t){dsf.http.post("fn/conferenceMobile/setRead",{pk:t.fileId,moduleId:t.moduleId}).done(function(t){l.log("打开文件",t)}).error(function(t){l.log("error",t)}).always(function(){})}}},o=i(51900),e=(0,o.Z)(n,function(){var i=this,s=i._self._c;return s("div",{staticClass:"topic-container"},[0<i.files.length?i._l(i.files,function(e,t){return s("div",{key:t,staticClass:"file-item",on:{click:function(t){return i.previewFile(e)}}},[s("div",{staticClass:"file-icon",style:"background-image:url(".concat(i.typeClass(e),")")}),i._v(" "),s("div",{staticClass:"file-desc"},[s("div",{staticClass:"file-desc-name"},[i._v(i._s(e.fileName))])])])}):i._e(),i._v(" "),s("van-popup",{staticClass:"file-preview",staticStyle:{height:"100vh"},attrs:{"close-on-click-overlay":!0,"lock-scroll":"",position:"bottom"},model:{value:i.showFile,callback:function(t){i.showFile=t},expression:"showFile"}},[s("van-cell",{staticClass:"top-back",attrs:{title:i.filename,icon:"arrow-left",center:""},on:{click:i.closeFile}}),i._v(" "),s("div",{staticClass:"preview-outer"},[s("enclosure-preview",{ref:"enclosurePreview",attrs:{file:i.popFile,"is-preview":i.isPreview,"is-show-cur-person":!0,"is-signature":!0},on:{goPreview:i.goPreview,goHandWrite:i.goHandWrite}})],1)],1)],2)},[],!1,null,"5359341f",null).exports,c=(0,o.Z)({components:{topicItem:e},data:function(){return{id:this.$route.query.meetingId,seat:"",title:"",tag:"",reporter:"",duration:"",state:"",dept:"",files:[],topicList:[],topicInfo:null,meeting:dsf.util.loadSessionStore("meeting")}},computed:{meetingPk:function(){return"".concat(this.topicInfo&&this.topicInfo.id)}},watch:{topicInfo:{deep:!0,handler:function(){this.pageKey=(new Date).getTime()}}},created:function(){s.Z.commit("setMeetingName",this.meeting.title),this.getData()},methods:{topicClick:function(t){this.topicInfo=t},getData:function(){var e=this;dsf.http.post("fn/conferenceMobile/meetingTopics",{meetingId:this.id}).done(function(t){200==t.code&&t.data&&(e.topicList=t.data,0<e.topicList.length)&&(e.topicInfo=e.topicList[0])}).error(function(t){dsf.layer.toast("数据获取失败！",!1)}).always(function(){})}}},function(){var i=this,s=i._self._c;return s("div",{staticClass:"topic-container"},[s("div",{staticClass:"top"},[s("van-cell",{attrs:{title:"议题详情",icon:"arrow-left",center:""},on:{click:function(t){return i.$router.back()}}})],1),i._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"left"},i._l(i.topicList,function(e,t){return s("div",{key:t,staticClass:"topic-item",class:{active:e.id==i.topicInfo.id},on:{click:function(t){return i.topicClick(e)}}},[s("span",[i._v(i._s(e.title))])])}),0),i._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"title"},[i._v("议题详情")]),i._v(" "),i.topicInfo?s("div",{staticClass:"content"},[s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("会议议题")]),i._v(" "),s("span",{staticClass:"val"},[i._v(i._s(i.topicInfo.title))])]),i._v(" "),s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("会议标签")]),i._v(" "),s("span",{staticClass:"val"},[i._v(i._s(i.topicInfo.tag))])]),i._v(" "),s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("汇报人")]),i._v(" "),s("span",{staticClass:"val"},[i._v(i._s(i.topicInfo.reporter))])]),i._v(" "),s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("汇报时长")]),i._v(" "),s("span",{staticClass:"val"},[i._v(i._s(i.topicInfo.reportTime))])]),i._v(" "),s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("参会部门")]),i._v(" "),s("span",{staticClass:"val"},[i._v(i._s(i.topicInfo.attendDept))])]),i._v(" "),s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("会议材料")]),i._v(" "),i.topicInfo&&i.topicInfo.files?s("topicItem",{staticClass:"val",attrs:{files:i.topicInfo.files}}):i._e()],1),i._v(" "),s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("决议情况")]),i._v(" "),s("span",{staticClass:"val"},[i._v(i._s(i.topicInfo.resolution))])]),i._v(" "),s("div",{staticClass:"info-item"},[s("span",{staticClass:"name"},[i._v("审议状态")]),i._v(" "),s("span",{staticClass:"val"},[i._v(i._s(i.topicInfo.reviewStatus))])])]):i._e()])])])},[],!1,null,"6fb9c630",null).exports}}]);