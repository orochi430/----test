"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[62936,18868],{91369:function(e,s,n){n.r(s),n.d(s,{default:function(){return i}});var s=n(73473),t=n.n(s),s=n(63560),o=n(88561),a=n(25108),s={name:"SignFilePerson",components:{selectPerson:s.default},data:function(){return{isShow:!1,resolve:function(){},reject:function(){},data:{deptBaoming:!0},showPerson:!1,userInfo:{},joinPersons:[],joinPersonIds:"",joinPerson:"",congressPersons:[],congressPersonIds:"",congressPerson:"",leaveReason:"",isAttend:!0,attendance:1,isJoin:!0}},watch:{isAttend:function(){this.isJoin=!this.isJoin,this.showPerson=!1},attendance:function(e){}},methods:{init:function(){var e=o.Z.loadSessionStore("user"),e=(this.userInfo=e,[]),s=[];this.data=null,this.showPerson=!1,this.joinPersons=e,this.joinPersonIds=0<e.length?e[0].id:"",this.joinPerson=0<e.length?e[0].name:"",this.congressPersons=s,this.congressPersonIds=0<s.length?s[0].id:"",this.congressPerson=0<s.length?s[0].name:"",this.leaveReason="",this.isAttend=!0,this.isJoin=!0},show:function(e){var n=this;return this.init(),this.data=e,a.log(this.data),this.isShow=!0,new(t())(function(e,s){n.resolve=e,n.reject=s})},cancel:function(){this.isShow=!1,this.reject("流程被中断")},submit:function(){var s=this,e={meetingtzId:this.data.meetingtzId,pk:this.data.pk,pnId:this.data.pnId,attendance:this.attendance,leaveReason:this.leaveReason,"x-auth-token":o.Z.loadSessionStore("loginToken"),requestEnv:"mobile"};if(this.data.deptBaoming?e.attendType=2:e.attendType=1,-1!=this.attendance||this.leaveReason.length){if(2==this.attendance){if(!this.congressPersons.length)return void dsf.layer.toast("请选择代会人员");e.userName=this.congressPerson,e.userId=this.congressPersonIds}var n=dsf.layer.loading();dsf.http.post("fn/MeetingMobile/attendMeeting",e).done(function(e){"200"===e.code?(s.isShow=!1,s.resolve(e),s.isAttend=!0,s.isJoin=!0):dsf.layer.toast(e.message)}).error(function(){dsf.layer.toast(res.message)}).always(function(){dsf.layer.closeLoading(n)})}else dsf.layer.toast("请填写请假理由")},getUserNames:function(e){var s=[],n=[],e=e.map(function(e){return s.push(e.name),n.push(e.attrs.idValue),{id:e.attrs.idValue,pid:e.attrs.pidValue,name:e.name}});return{names:s.join(","),ids:n.join(","),persons:e}},getSelectUser:function(n){var e,s,t;0<n.length?(n.forEach(function(e,s){e.children&&0<e.children.length&&n.splice(s,1)}),e=(t=this.getUserNames(n)).names,s=t.ids,t=t.persons,this.congressPerson=e,this.congressPersonIds=s,this.congressPersons=t):(this.joinPerson="",this.joinPersonIds="",this.joinPersons="",this.congressPerson="",this.congressPersonIds="",this.congressPersons="")}}},i=(0,n(51900).Z)(s,function(){var s=this,e=s._self._c;return e("div",{staticClass:"ds-sign-file"},[e("van-popup",{staticClass:"ds-sign-file-pop",attrs:{position:"bottom","get-container":"#app",round:""},model:{value:s.isShow,callback:function(e){s.isShow=e},expression:"isShow"}},[e("div",{staticClass:"header"},[e("van-nav-bar",{attrs:{title:"报名","left-text":"取消"},on:{"click-left":s.cancel}})],1),s._v(" "),e("div",{staticClass:"body"},[e("div",{staticClass:"join"},[e("label",{attrs:{for:""}},[s._v("是否出席:")]),s._v(" "),e("van-radio-group",{attrs:{direction:"horizontal"},model:{value:s.attendance,callback:function(e){s.attendance=e},expression:"attendance"}},[e("van-radio",{attrs:{name:1,shape:"square"}},[s._v("出席")]),s._v(" "),e("van-radio",{attrs:{name:-1,shape:"square"}},[s._v(s._s("请假"))]),s._v(" "),e("van-radio",{attrs:{name:2,shape:"square"}},[s._v(s._s("委托"))])],1)],1),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:2==s.attendance,expression:"attendance==2"}],staticClass:"confrence"},[e("van-field",{attrs:{readonly:!0,"input-align":"left",label:"代会人员:",placeholder:"请选择",type:"textarea",autosize:"",rows:"1"},on:{click:function(e){s.showPerson=!0}},scopedSlots:s._u([{key:"label",fn:function(){return[e("span",[e("label",{staticClass:"mast-input"}),s._v("代会人员：\n            ")])]},proxy:!0}]),model:{value:s.congressPerson,callback:function(e){s.congressPerson=e},expression:"congressPerson"}})],1),s._v(" "),e("van-field",{directives:[{name:"show",rawName:"v-show",value:-1==s.attendance,expression:"attendance==-1"}],attrs:{rows:"4",autosize:"",label:"请假理由:",type:"textarea",placeholder:"请输入请假理由"},model:{value:s.leaveReason,callback:function(e){s.leaveReason=e},expression:"leaveReason"}})],1),s._v(" "),e("div",{staticClass:"footer"},[e("van-button",{attrs:{type:"theme"},on:{click:s.submit}},[s._v("提交")])],1)]),s._v(" "),e("van-popup",{style:{height:"90%"},attrs:{"close-on-click-overlay":!1,position:"bottom","get-container":"#app",round:""},model:{value:s.showPerson,callback:function(e){s.showPerson=e},expression:"showPerson"}},[e("selectPerson",{attrs:{type:0},on:{getSelectUser:s.getSelectUser,cancePerson:function(e){s.showPerson=!1}}})],1)],1)},[],!1,null,null,null).exports},18868:function(e,s,n){var a=n(25108);const i=(t,o=500,a=!0)=>{let i,r=0,l,c,d=n=>{i=setTimeout(()=>{var e=(new Date).getTime(),s=e-r;s<n?(r=e,d(o-s)):(a||t.apply(l,c),clearTimeout(i),i=null)},n)};return function(){l=this,c=arguments;var e=(new Date).getTime();r=e,i||(a&&t.apply(l,c),d(o))}};s.Z={name:"DebounceClick",functional:!0,render(e,s){var n,t=s.props.time,o=s.props.immediate,s=s.slots().default;return void 0===s?(a.warn("<debounce> 组件必须要有子元素"),null):((s=s[0]||null).data.on&&s.data.on.click?(n=s.data.on.click,n=i(n,t,o),s.data.on.click=n):s.componentOptions&&s.componentOptions.listeners.click&&(n=s.componentOptions.listeners.click,n=i(n,t,o),s.componentOptions.listeners.click=n),s)}}}}]);