"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[71236],{71236:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var s=a(66250),t=a(8450),n=a.n(t),t=a(33453),o=a.n(t),r=a(25108),t={name:"editMyInfo",data:function(){return{defaultVal:"",userInfo:null}},computed:{defaultLabel:function(){return"mobile"==this.$route.params.key?"手机号":"phone"==this.$route.params.key?"内线电话":void 0},defaultPlace:function(){return"mobile"==this.$route.params.key?"请输入手机号":"phone"==this.$route.params.key?"请输入内线电话":void 0},phoneRules:function(){return"mobile"==this.$route.params.key?[{validator:function(e){return""!==e},message:"请输入手机号"},{pattern:/^1(?:3\d|4[4-9]|5[0-35-9]|6[67]|7[013-8]|8\d|9\d)\d{8}$/,message:"请输入正确手机号"}]:"phone"==this.$route.params.key?[{validator:function(e){return""!==e},message:"请输入内线电话"},{pattern:/^[0-9]*$/,message:"请输入正确电话"}]:void 0}},created:function(){var t=this;return(0,s.Z)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.userInfo=dsf.util.loadSessionStore("user"),t.userInfo&&"phone"==t.$route.params.key?dsf.http.get("fn/subscript/getAllUserInfo?userId=".concat(t.userInfo.user_id),{}).then(function(e){e=e.data;"success"==e.type?t.defaultVal=e.data.innerTel.value:dsf.layer.toast("获取数据失败")}).catch(function(e){dsf.layer.toast("获取数据失败")}):t.userInfo&&t.userInfo[t.$route.params.key]&&(t.defaultVal=t.userInfo[t.$route.params.key]);case 2:case"end":return e.stop()}},e)}))()},mounted:function(){},methods:{goBack:function(){this.$router.go(-1)},onSubmit:function(){var e,t=this;"mobile"==this.$route.params.key&&!this.validateMobile()||"phone"==this.$route.params.key&&!this.validateTelephone()||(e={key:this.$route.params.key,value:this.defaultVal},"phone"==this.$route.params.key?dsf.http.get("fn/subscript/updateInnerPhone?userId=".concat(this.userInfo.user_id,"&phone=").concat(this.defaultVal),{}).then(function(e){"success"==e.data.type?(dsf.layer.toast("修改信息成功"),t.$router.go(-1)):dsf.layer.toast("修改信息失败,请稍后再试")}).catch(function(e){dsf.layer.toast("修改信息失败,请稍后再试")}):dsf.http.post("/fn/mobileUserData/update",{__DATA:n()(e)}).then(function(e){e=e.data;r.log(e),"success"==e.success?(t.userInfo[t.$route.params.key]=t.defaultVal,dsf.util.saveToLocalStore("user",t.userInfo),dsf.util.saveToSessionStore("user",t.userInfo),dsf.layer.toast("修改信息成功"),t.$router.go(-1)):dsf.layer.toast("修改信息失败,请稍后再试")}).catch(function(e){dsf.layer.toast("修改信息失败,请稍后再试")}))}}},u=(0,a(51900).Z)(t,function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"edit-my-info"}},[e("van-form",{on:{submit:t.onSubmit}},[e("div",{staticClass:"m-top_10"},[e("van-field",{attrs:{clearable:"",type:"tel",name:"phone",label:t.defaultLabel,placeholder:t.defaultPlace,rules:t.phoneRules},model:{value:t.defaultVal,callback:function(e){t.defaultVal=e},expression:"defaultVal"}})],1),t._v(" "),e("div",{staticClass:"btn-container"},[e("van-button",{staticClass:"btn",attrs:{type:"info","native-type":"submit"}},[t._v("保存")])],1)])],1)},[],!1,null,"1ba69c44",null).exports}}]);