"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[290],{78303:function(t,e,a){a.r(e);var n=a(8450),u=a.n(n),f=a(25108);e.default={toEndNotConfirm:function(t,e,a,n,o,s){f.log("nowButtonParameters",n.nowButtonParameters);var c=n.nowButtonParameters.defaultOpinion,r=e.parameters,d=r.pk,i=r.pnId,l={pk:d,pnid:i,isNeedOpinion:-1};n.buttonHandle.save(t,e,a,n,o,function(){var t=[];t.push(l),t=t,dsf.http.post("fn/flow/batchEndNode",{todoData:u()(t)}).then(function(t){200==t.data.code?null!=c&&""!=c.trim()?dsf.http.post("fn/flowListController/setOpinion",{pk:d,pnId:i,content:c}).then(function(t){"success"===t.data.type?dsf.layer.toast("操作成功",!0,function(){return n.backSucces()}):dsf.layer.toast(t.data.message)}).catch(function(t){f.log(t)}):dsf.layer.toast("操作成功",!0,function(){return n.backSucces()}):dsf.layer.toast("办结失败",!1)}).catch(function(t){f.log(t)})})},sendDefaultOpinion:function(t,e,a,n,o,s){var c=e.parameters,r=c.pk,d=c.pnId,i=n.nowButtonParameters.defaultOpinion;n.buttonHandle.send(t,e,a,n,o,function(){null!=i&&""!=i.trim()&&dsf.http.post("fn/flowListController/setOpinion",{pk:r,pnId:d,content:i}).then(function(t){"success"!==t.data.type&&dsf.layer.toast(t.data.message)}).catch(function(t){f.log(t)})})},topicIssue:function(e,a,n,o,s,t){var c=a.parameters.pk,r=o.nowButtonParameters.nextLineId;dsf.http.post("fn/meetingTopic/topicIssue",{pk:c}).then(function(t){"success"==t.data.type?o.alreadyWriteOpintion||dsf.layer.toast("入库成功",!1,function(){o.$set(n.main,"C-MEETING-TOPIC-0021",{value:"2",text:"已入库"}),r&&o.buttonHandle.send(e,a,n,o,s)}):dsf.layer.toast("入库失败",!1)}).catch(function(t){f.log(t)})},chengDu_showFlow:function(t,e,a,n,o,s){var e=e.parameters.pk,c=n.nowButtonParameters.showFlowUrl;c+="?infoId="+e,c=dsf.url.getServerUrl("fn/redirect/relative?x-auth-token=".concat(dsf.util.loadSessionStore("loginToken"),"&redirectUrl="))+c,n.componentName="TabsMovingDialog",n.formParams.url=c},distributeSendBackRefuse:function(t,e,a,n,o,s){var c,r=n.$route.query,d=r.pk,i=r.flowId,l=r.pId,r=r.pnId,u=n.nowButtonParameters.closeNum;""==i||""==l||""==r||""==d?dsf.layer.toast("流程信息不完整，无法驳回"):(d={pk:d,flowId:i,pid:l,pnid:r},f.log("reason",a.main["240106185415QcDHKj7ELLrV7zMkypL"]),""==a.main["240106185415QcDHKj7ELLrV7zMkypL"].value?dsf.layer.toast("请填写审批意见！"):(d.backReason=a.main["240106185415QcDHKj7ELLrV7zMkypL"].value,c=dsf.layer.loading(),dsf.http.post("ctrl/distribute/sendBackRefuse",d).then(function(t){dsf.layer.closeLoading(c),"success"===t.data.type?dsf.layer.toast("驳回成功！",!0,function(){return n.backSucces(u)}):dsf.layer.toast("驳回失败！")}).catch(function(t){dsf.layer.closeLoading(c),f.log(t)})))},distributeSendBackPass:function(t,e,a,n,o,s){var c=n.$route.query.pk,r=dsf.layer.loading(),d=n.nowButtonParameters.closeNum;dsf.http.post("ctrl/distribute/sendBackPass",{pk:c}).then(function(t){dsf.layer.closeLoading(r),"success"===t.data.type?dsf.layer.toast("审批成功",!0,function(){return n.backSucces(d)}):dsf.layer.toast("审批成功")}).catch(function(t){dsf.layer.closeLoading(r),f.log(t)})},distributeRecord:function(t,e,a,n,o,s){var e=e.parameters,c=e.pk,e=e.moduleId;n.$router.push({path:"/commonTabs/distributionRecords?pk=".concat(c,"&moduleId=").concat(e,"&isFooterBtnShow=1&title=分送记录")})},distributeSubRecord:function(t,e,a,n,o,s){var e=e.parameters,c=e.pk,e=e.moduleId;n.$router.push({path:"/commonList?fileType=subTingnei&pk=".concat(c,"&moduleId=").concat(e,"&title=分送记录")})},distributeSendBackSubRecord:function(t,e,a,n,o,s){var e=e.parameters,c=e.pk,e=e.moduleId;n.$router.push({path:"/commonList?fileType=Tzhuanfa&pk=".concat(c,"&moduleId=").concat(e,"&title=分送回退记录")})},distributeSendbackRecord:function(t,e,a,n,o,s){var e=e.parameters,c=e.pk,e=e.moduleId;n.$router.push({path:"/commonTabs/distributionBackRecords?pk=".concat(c,"&moduleId=").concat(e,"&title=分送回退记录")})},distributeSendback:function(t,e,a,n,o,s){var e=e.parameters,c=e.pk,r=e.flowId,d=e.pId,e=e.pnId;if(""==r||""==d||""==e||""==c)return dsf.layer.toast("流程信息不完整，无法退回"),!1;var i={pk:c,flowId:r,pid:d,pnid:e},l=!1;dsf.http.post("ctrl/distribute/getDistributeRecordList",{pk:a.main.A0003.value,handleType:1,infoId:c}).then(function(t){0<t.data.count&&(l=!0),n.$refs.rejectDialog.show("退回",!l||"").then(function(t){i.backReason=t,f.log("reason",t);var e=dsf.layer.loading();dsf.http.post("ctrl/distribute/sendBack",i).then(function(t){dsf.layer.closeLoading(e),"success"===t.data.type?dsf.layer.toast("退回成功！",!0,function(){return n.backSucces()}):dsf.layer.toast("退回失败！")}).catch(function(t){dsf.layer.closeLoading(e),f.log(t)})})}).catch(function(t){dsf.layer.closeLoading(loading),f.log(t)})},openReturnApprovalForm:function(t,e,a,n,o,s){var e=e.parameters,c=e.pk,r=e.flowId,d=e.pId,e=e.pnId;n.$router.push({path:"/commonForm/240106185335dKPmYEgDVNmKj6xMZDk?pnId=".concat(e,"&pId=").concat(d,"&flowId=").concat(r,"&pk=").concat(c)})},convergencePlatFormAccept:function(t,e,a,n,o,s){var a={pk:a.main.A0001.value,documentIdentifier:a.main.A0002.value,operation:"Accepted",orgCode:a.main["240106212322dbjK3oHMMRWwAVXlHl5"].value,lhfw:a.main["240108192756ZD85WULZFnSzqZwLsfE"].value},c=dsf.layer.loading();dsf.http.post("fn/convergencePlatformInside/feedback",a).then(function(t){var a;dsf.layer.closeLoading(c),"success"===t.data.type?(a=t.data.data,dsf.layer.toast("签收成功",!0,function(){var t,e;null!=a&&(t=a.pk,e=a.moduleId,e="/commonForm/".concat(e,"/").concat(t),null!=a.pnid&&(e+="?todoId="+a.pid+"_"+a.pnid+"&agencyType=0&agencyUserId="+a.uid+"&agencyUserName="+a.uname),n.$router.push({path:e}))})):dsf.layer.toast(t.data.message)}).catch(function(t){dsf.layer.closeLoading(c),f.log(t)})},convergencePlatFormReject:function(t,e,a,n,o,s){var c={pk:a.main.A0001.value,documentIdentifier:a.main.A0002.value,operation:"Rejected",orgCode:a.main["240106212322dbjK3oHMMRWwAVXlHl5"].value};n.$refs.rejectDialog.showDialog=!0,n.$refs.rejectDialog.title="拒收",n.$refs.rejectDialog.placeholder="请输入拒绝原因",n.$refs.rejectDialog.subTitle="",n.$refs.rejectDialog.confirmCallBack=function(t){c.opinion=t;var e=dsf.layer.loading();dsf.http.post("fn/convergencePlatformInside/feedback",c).then(function(t){dsf.layer.closeLoading(e),"success"===t.data.type?dsf.layer.toast("拒收成功",!0,function(){n.backSucces()}):dsf.layer.toast(t.data.message)}).catch(function(t){dsf.layer.closeLoading(e),f.log(t)})}},recycle:function(t,a,e,n,o){var s={pk:n.pk,pid:a.parameters.pid||a.parameters.pId,bt:e.main.B0001.value};dsf.layer.confirm({message:"<div style='font-size: 18px;'>确定回收该文件吗？</div>",confirmButtonText:"确定"},function(){dsf.http.post("ctrl/flow/checkRecycle",s).then(function(t){var e=t.data;"success"==e.type?"1"==e.message?dsf.http.post("ctrl/flow/recycle",e.data).then(function(t){dsf.http.post("fn/remind2512/batchRecycle",{pk:a.parameters.pk,pnIds:e.data.pnId,remindModes:""}),dsf.http.post("fn/distribute/recycleSendBackApply",{pk:a.parameters.pk}),"success"==t.data.type?dsf.layer.toast(t.data.message,function(){n.backSucces()}):dsf.layer.toast(t.data.message)}):dsf.http.post("ctrl/flow/recycleListData",{pk:n.pk}).then(function(t){t=t.data;0==t.count?dsf.layer.toast("暂无回收节点！"):(n.formParams.superRecycleData=t.data,n.formParams.isSuperRecycle=!1,n.componentName="sxSuperRecycle")}):dsf.layer.toast(e.message)})})},"xform.todoExSend":function(t,e,a,n,o,s){var c=n.$route.query.todoId||e.parameters.pId+"_"+e.parameters.pnId;c&&""!=c||dsf.layer.toast("非待办文件，不能增发"),n.buttonHandle.send(t,e,a,n,o)},transpondDept:function(t,e,a,o,n,s){var c=a.main.A0003.value,r=o.formParams.pk,d=o.formParams.moduleId,a=o.nowButtonParameters.customUserSelectScope,i=a&&""!=a?"6":"2";o.showPerson=!0,o.extra={multiple:!1,tabs:[{action:"fn/user/select/data?types=department&rootObject="+i+"&action=custom_user_select_scope&async=true&customUserSelectScope="+a,name:"自定义用户选择范围",subTabKey:"department"}]},o.getSelectUser=function(t){var e,a="",n="";t.forEach(function(t,e){a+=0==e?t.id:","+t.id,n+=0==e?t.name:","+t.name}),""==a?dsf.layer.toast("未选择部门"):(e=dsf.layer.loading("转派中"),t={pk:r,moduleId:d,sourceId:c,dept:a,deptName:n},dsf.http.get("fn/convergencePlatformInside/transpondDept",t).then(function(t){f.log(t),dsf.layer.closeLoading(e),"success"==t.data.type?(o.showPerson=!1,dsf.layer.toast("转派成功",!0,function(){o.backSucces()})):dsf.layer.toast(t.data.message)}))}},distributeSituationTab:function(t,e,a,n,o,s){var e=e.parameters,c=e.pk,e=e.moduleId;n.$router.push({path:"/commonTabs/distributeSituationTab?pk=".concat(c,"&moduleId=").concat(e,"&title=分送情况")})},cancelBJ:function(t,a,e,n,o,s){dsf.layer.confirm({message:"<div style='font-size: 18px;'>确认取消办结并将文件回收到最后的处理人手中？</div>",confirmButtonText:"确认"},function(){var e=dsf.layer.loading("取消办结中");dsf.http.post("fn/flowEvent/cancelEndInstance",{pk:a.parameters.pk}).then(function(t){dsf.layer.closeLoading(e),"success"==t.data.type?dsf.layer.toast("取消办结成功",!0,function(){n.backSucces()}):dsf.layer.toast(t.data.message)})})}}}}]);