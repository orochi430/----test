"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[49803],{41775:function(t,e,a){a.d(e,{Z:function(){return d}});a(23307);var e=a(81392),s=a(26243),n=a.n(s),s=a(79529),l=a.n(s),s=a(46297),i=a(84628),o=a(50856),r=a(25108),s={components:{DsCard:s.Z,DsButtonGroup:i.Z,DsButtonToolbox:o.Z,Icon:e.Z},props:{tabObj:{type:Object},data:{type:Array,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},type:{type:String},keyColumn:{type:String},formMethod:{type:String},isHiddenBtn:{type:Boolean,default:function(){}}},data:function(){return{}},created:function(){},computed:{aSubTitles:function(){return r.log(this.columns.filter(function(t){return/^subTitle\w?$/i.test(t.showCategory)})),this.columns.filter(function(t){return/^subTitle\w?$/i.test(t.showCategory)})},bSubTitles:function(){return this.columns.filter(function(t){return/^content$/i.test(t.showCategory)})},needTitles:function(){return this.columns.filter(function(t){return/^needTitle\w?$/i.test(t.showCategory)})},titleIcon:function(){return this.columns.filter(function(t){return/^titleIcon\w?$/i.test(t.showCategory)})}},mounted:function(){r.log(this.bSubTitles)},methods:{isShowColumn:function(t,e){return e.dataValue[t.showMetaColumn]||0===e.dataValue[t.showMetaColumn]},isShowListBtn:function(t){var e=null==this.isHiddenBtn,a=!1,a=!(!t.buttons||!(t.buttons.commonButtons&&0<t.buttons.commonButtons.length||t.buttons.mainButtons&&0<t.buttons.mainButtons.length));return e&&a},link:function(t){var e,a,s,n;t.dataValue.allowMobile&&1!=t.dataValue.allowMobile?dsf.layer.toast("该文件只能在电脑端处理"):("isRead"in t.dataValue&&!t.dataValue.isRead&&(t.dataValue.isRead=!0),e=(t=t.dataValue)[this.keyColumn]||t.info_id||t.id||t.A0001||t.fid||t["SW_XZD.A0001"],a=this.keyColumn?this.keyColumn.split(".")[0]+".A0004":"",a=t.moduleId||t.A0004||t["SW_XZD.A0004"]||t[a],"db"==this.type&&(a=t.masterModuleId||t.moduleId||t.A0004),n=t.masterId||"",a=a+"/"+e,s={},"gw"==this.type&&(a+="/1",s.todoId=t.todoId),this.type&&(a+="?type=".concat(this.type)),"SigninList"==this.$route.name&&(a+="?&listId=1903161124289nXBk8iVSmTMGYxn9bi&exchangeList=signedList"),"db"==this.type&&(n&&(a+="&masterId=".concat(n)),r.log(this.formMethod),this.formMethod)&&(a+="&formMethod=info"),"dy"==this.type&&(a+="&distribId=".concat(t.distribId),dsf.http.post("fn/mobileToRead/markRead",{pks:t.distribId}).then(function(t){r.log(t)})),this.tabObj&&this.tabObj.targetUrl?(n=this.tabObj.targetUrl.replace("[pk]",e),this.$router.push({path:n})):this.$router.push({path:"/commonForm/"+a,query:s}))},getTitle:function(){return this.columns.find(function(t){return"mainTitle"===t.showCategory})||{}},handleCommonClick:function(t,e,a){e.dataValue.allowMobile&&1!=e.dataValue.allowMobile?dsf.layer.toast("该文件只能在电脑端处理"):this.$emit("commonClick",t,e,a)},handleMainClick:function(t,e,a){e.dataValue.allowMobile&&1!=e.dataValue.allowMobile?dsf.layer.toast("该文件只能在电脑端处理"):this.$emit("mainClick",t,e,a)},titleIconColor:function(t,e){t=t.dataValue[e.showMetaColumn].substr(0,1);return dsf.config.listTitleIcon&&-1<n()(dsf.config.listTitleIcon).indexOf(t)?(e=dsf.config.listTitleIcon[t],{backgroundColor:this.colorRgba(e,.12),color:e,borderColor:e}):""},colorRgba:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=t.toLowerCase();if(a&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(a)){if(4===a.length){for(var s="#",n=1;n<4;n+=1)s+=a.slice(n,n+1).concat(a.slice(n,n+1));a=s}for(var i=[],o=1;o<7;o+=2)i.push(l()("0x"+a.slice(o,o+2)));return"rgba("+i.join(",")+","+e+")"}return a}}},d=(0,a(51900).Z)(s,function(){var s=this,n=s._self._c;return n("div",{staticClass:"ds-list"},[s._l(s.data,function(a,e){return n("div",{key:a.id||"item-".concat(e),staticClass:"ds-item"},[n("DsCard",["isRead"in a.dataValue&&!a.dataValue.isRead?n("span",{staticClass:"isStatus"}):s._e(),s._v(" "),"readStatus"in a.dataValue&&"2"!=a.dataValue.readStatus?n("span",{staticClass:"isStatus"}):s._e(),s._v(" "),a.dataValue[s.getTitle().showMetaColumn]?n("div",{class:{ellipsis:s.dsf.config.commonList&&s.dsf.config.commonList.titleEllipsis},attrs:{slot:"header"},on:{click:function(t){return s.link(a)}},slot:"header"},[n("span",{class:{"col-title":"isRead"in a.dataValue&&!a.dataValue.isRead||"readStatus"in a.dataValue&&"2"!=a.dataValue.readStatus},style:{color:s.getTitle().color||"","word-wrap":"break-word","word-break":"break-all"}},[s._v("\n                "+s._s(a.dataValue[s.getTitle().showMetaColumn]))])]):s._e(),s._v(" "),n("div",{staticClass:"content",attrs:{slot:"content"},on:{click:function(t){return s.link(a)}},slot:"content"},[s._t("item-content",function(){return[n("div",{staticClass:"flex1"},[0<s.aSubTitles.length?n("div",{staticClass:"aSubTitles"},[s._l(s.aSubTitles,function(t,e){return[s.isShowColumn(t,a)?n("div",{key:"aSubTitles-".concat(e),staticClass:"subTitle"},[t.icon?n("Icon",{class:["iconfont",t.icon]}):s._e(),s._v(" "),n("span",{staticClass:"label",style:{color:t.color}},[s._v(s._s(a.dataValue[t.showMetaColumn]))])],1):s._e()]})],2):s._e(),s._v(" "),0<s.bSubTitles.length?n("div",{staticClass:"bSubTitles"},[s._l(s.bSubTitles,function(t,e){return[s.isShowColumn(t,a)?n("div",{key:"bSubTitles-".concat(e),staticClass:"subTitle"},[t.icon?n("Icon",{class:["iconfont",t.icon]}):s._e(),s._v(" "),n("span",{class:["label","ds-elips-".concat(t.showRows||1)],style:{color:t.color}},[s._v(s._s(a.dataValue[t.showMetaColumn]))])],1):s._e()]})],2):s._e(),s._v(" "),0<s.needTitles.length?n("div",{staticClass:"needTitles"},[s._l(s.needTitles,function(t,e){return[s.isShowColumn(t,a)?n("div",{key:"needTitles-".concat(e),staticClass:"subTitle"},[n("span",{staticClass:"name label ellipsis"},[s._v(s._s(t.showName))]),s._v(" "),n("span",{staticClass:"label val elips",style:{color:t.color}},[s._v(s._s(a.dataValue[t.showMetaColumn]))])]):s._e()]})],2):s._e()]),s._v(" "),0<s.titleIcon.length?n("div",[s._l(s.titleIcon,function(t,e){return[s.isShowColumn(t,a)?n("div",{key:"titleIcon-".concat(e),staticClass:"moduleIcon",style:s.titleIconColor(a,t)},[n("span",[s._v(s._s(a.dataValue[t.showMetaColumn].substr(0,1)))])]):s._e()]})],2):s._e()]},{item:a}),s._v(" "),s._t("item-extend",null,{item:a})],2),s._v(" "),s.isShowListBtn(a)?n("div",{attrs:{slot:"footer"},slot:"footer"},[s._t("item-footer",function(){return[n("DsButtonToolbox",{attrs:{buttons:a.buttons||{},more:!0,size:"small"},on:{commonClick:function(t){s.handleCommonClick(t,a,e)},mainClick:function(t){s.handleMainClick(t,a,e)}}})]},{item:{}})],2):s._e()])],1)}),s._v(" "),s.data.length||s.$parent.loading?s._e():n("commonempty")],2)},[],!1,null,"7d9709ac",null).exports},46297:function(t,e,a){a.d(e,{Z:function(){return s}});var s=(0,a(51900).Z)({},function(t,e){return t("div",{staticClass:"ds-card"},[e._t("default"),e._v(" "),t("div",{staticClass:"tabspage"},[e.$slots.tabspageCheck?t("div",{staticClass:"tabspageCheck"},[e._t("tabspageCheck")],2):e._e(),e._v(" "),t("div",{staticStyle:{flex:"1",overflow:"hidden"}},[e.$slots.header?t("div",{staticClass:"ds-card-header"},[e._t("header")],2):e._e(),e._v(" "),e.$slots.content?t("div",{staticClass:"ds-card-content"},[e._t("content")],2):e._e()]),e._v(" "),e.$slots.rightIcon?t("div",{staticClass:"rightIcon"},[e._t("rightIcon")],2):e._e()]),e._v(" "),e.$slots.footer?t("div",{staticClass:"ds-card-footer"},[e._t("footer")],2):e._e(),e._v(" "),e.$slots.footermin?t("div",{staticClass:"ds-card-footer ds-card-footer2"},[e._t("footermin")],2):e._e()],2)},[],!0,null,"1b02e7ea",null).exports},93925:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var e=a(26243),n=a.n(e),e=a(62680),i=a.n(e),e=a(95366),o=a.n(e),e=a(6919),s=a.n(e),l=a(66250),r=a(77193),e=a(33453),d=a.n(e),e=a(20629),c=a(84528),u=a(41775),f=a(25108);function h(e,t){var a,s=n()(e);return i()&&(a=i()(e),t&&(a=a.filter(function(t){return o()(e,t).enumerable})),s.push.apply(s,a)),s}var c={name:"signIn",components:{DingBtn:c.default,DsList:u.Z},data:function(){return{tabIndex:0,activeNum:1,activeText:"未签收",list:[],loading:!1,finished:!1,refreshing:!1,finishedText:"",date:moment().format("MM月DD日     HH:mm"),params:{},fid:"",signStatus:"0",url:"fn/list/230627191434qbstw10c1QF94PXtxXi/mobile/q?moduleId=190316150842gGFeRKU0VtkcDlBltcJ&page=1&limit=100",tabs:[{name:"未签收",badge:0},{name:"已签收",badge:0},{name:"已退回",badge:0}]}},filters:{badgeCount:function(t){return 100<t?"99+":t<1?"":t}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach(function(t){(0,r.Z)(e,t,a[t])}):s()?Object.defineProperties(e,s()(a)):h(Object(a)).forEach(function(t){Object.defineProperty(e,t,o()(a,t))})}return e}({},(0,e.rn)({isShowAppFooter:function(t){return t.isShowAppFooter},isShowAppHeader:function(t){return t.isShowAppHeader}})),created:function(){this.fid=this.$route.query.fid,this.getTotal(0),this.getTotal(1),this.getTotal(2)},mounted:function(){},methods:{getTotal:function(e){var a=this,t=(this.finished=!1,this.list=[],""),t=0==e?"0":1===e?"1":"-2,-4,-5",t={fid:this.fid,SIGN_STATUS:t};dsf.http.get(this.url,t).done(function(t){a.tabs[e].badge=t.total})},changeTab:function(){this.finishedText="",this.activeNum=this.tabIndex+1,this.finished=!1,this.list=[],1===this.activeNum?(this.activeText="未签收",this.signStatus="0"):2===this.activeNum?(this.activeText="已签收",this.signStatus="1"):(this.activeText="已退回",this.signStatus="-2,-4,-5")},gofankui:function(t){var e=this;"1"==(t.dataValue["C-R-SEND-DETAIL-0005.value"]||"")&&dsf.http.post("/fn/remoteExchangeData/getFeedbackForm?feedbackRcvId=".concat(t.dataValue["C-R-SEND-DETAIL-0015"])).then(function(t){f.log(t),e.$router.push({name:"commonForm",params:{moduleId:t.data.data.moduleId,pk:t.data.data.pk},query:{qianshoufankui:"ExchangeRecvList",method:"view",validateByList:"1"}})})},onLoad:function(){var e=this;return(0,l.Z)(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onhandleHttp(e.params);case 2:e.loading=!1,e.list.length>=e.total&&(e.finished=!0);case 4:case"end":return t.stop()}},t)}))()},onhandleHttp:function(){var s=this;return(0,l.Z)(d().mark(function t(){var a,e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={fid:(a=s).fid,SIGN_STATUS:s.signStatus},t.next=4,dsf.http.get(s.url,e).done(function(t){var e=t.datas;a.list=e,a.total=t.total,a.refreshing=!1,a.list.length}).error(function(t){f.log("error",t),a.dsf.layer.toast("请求异常",!1)});case 4:case"end":return t.stop()}},t)}))()},onRefresh:function(){this.finishedText="",this.finished=!1,this.loading=!0,this.onLoad()},viewSendBackDoc:function(e,a){var s=this,t={pk:e};dsf.layer.loading(),dsf.http.post("ctrl/common/getFileInfo",t).then(function(t){dsf.layer.clear();t=t.data.moduleId;-4==a?s.$router.push({path:"/commonForm/".concat(t,"/").concat(e,"?reloadParentFormOnSave=true&listId=ExchangeRecvList&method=view&validateByList=1")}):-5==a?dsf.http.post("ctrl/remoteExchangeData/getAttachInfo",{pk:e},function(t){var e,a;t.data&&"success"===t.data.type?(e=t.data.data.fileName,(a=t.data.data.id)?this.$router.push({path:"/filePreview/".concat(a,"/210104164115YE5FsFODVtUQG3cWkTt"),query:{title:e}}):dsf.layer.toast("未找到正文")):t.data&&"error"===t.data.type?dsf.layer.toast(t.data.message):dsf.layer.toast("请求出错")}):dsf.layer.toast("不支持查看")})}},beforeRouteLeave:function(t,e,a){"commonForm"!=t.name&&this.$deleteCache(this),a()}},m=(0,a(51900).Z)(c,function(){var a=this,s=a._self._c;return s("div",{staticClass:"ds-signin"},[s("van-tabs",{attrs:{sticky:"","offset-top":a.dsf.util.getOffsetTop()},on:{change:a.changeTab},model:{value:a.tabIndex,callback:function(t){a.tabIndex=t},expression:"tabIndex"}},a._l(a.tabs,function(t,e){return s("van-tab",{key:e,attrs:{title:t.name,badge:a._f("badgeCount")(t.badge)}})}),1),a._v(" "),s("div",{staticClass:"ds-list"},[s("van-pull-refresh",{on:{refresh:a.onRefresh},model:{value:a.refreshing,callback:function(t){a.refreshing=t},expression:"refreshing"}},[s("van-list",{attrs:{finished:a.finished,"finished-text":a.finishedText},on:{load:a.onLoad},model:{value:a.loading,callback:function(t){a.loading=t},expression:"loading"}},[0<a.list.length?s("div",[1==a.activeNum?a._l(a.list,function(t,e){return s("div",{key:e,staticClass:"ds-list-box",attrs:{title:t}},[s("span",{class:1==a.activeNum?"ds-list-text-allLine":"ds-list-text1"},[a._v("\n\t\t\t\t\t\t\t\t\t"+a._s("".concat(t.dataValue["C-R-SEND-DETAIL-0002"]))+"\n\t\t\t\t\t\t\t\t")])])}):2==a.activeNum?a._l(a.list,function(t,e){return s("div",{key:e,staticClass:"ds-list-box ds-list-box2",attrs:{title:t}},[s("span",{staticClass:"ds-list-text"},[a._v("\n\t\t\t\t\t\t\t\t\t"+a._s(t.dataValue["C-R-SEND-DETAIL-0002"]||"")+"\n\t\t\t\t\t\t\t\t")]),a._v(" "),s("div",{staticClass:"ds-list-text-div"},[s("p",{staticClass:"ds-list-date ds-list-time"},[s("span",[a._v("时间:")]),a._v("\n\t\t\t\t\t\t\t\t\t\t"+a._s(t.dataValue["C-R-SEND-DETAIL-0003"])+"\n\t\t\t\t\t\t\t\t\t")]),a._v(" "),s("p",{staticClass:"ds-list-date ds-list-date-reason float_n"},[a._v("\n\t\t\t\t\t\t\t\t\t\t接收人:\n\t\t\t\t\t\t\t\t\t\t"),s("span",[a._v(a._s(t.dataValue["C-R-SEND-DETAIL-0010"]||""))])])])])}):a._l(a.list,function(e,t){return s("div",{key:t,staticClass:"ds-list-box ds-list-box2",attrs:{title:e}},[s("span",{staticClass:"ds-list-text"},[a._v("\n\t\t\t\t\t\t\t\t\t"+a._s(e.dataValue["C-R-SEND-DETAIL-0002"]||"")+"\n\t\t\t\t\t\t\t\t")]),a._v(" "),s("div",{staticClass:"ds-list-text-div"},[s("p",{staticClass:"ds-list-date ds-list-time"},[s("span",[a._v("时间:")]),a._v("\n\t\t\t\t\t\t\t\t\t\t"+a._s(e.dataValue["C-R-SEND-DETAIL-0040"])+"\n\t\t\t\t\t\t\t\t\t")]),a._v(" "),"-2"==e.dataValue["C-R-SEND-DETAIL-0004.value"]?s("p",{staticClass:"ds-list-date ds-list-date-reason float_n"},[a._v("\n\t\t\t\t\t\t\t\t\t\t原因:\n\t\t\t\t\t\t\t\t\t\t"),s("span",[a._v(a._s(e.dataValue["C-R-SEND-DETAIL-0011"]||""))])]):s("p",{staticClass:"ds-list-date ds-list-date-reason",staticStyle:{color:"var(--normal)"},on:{click:function(t){return a.viewSendBackDoc(e.dataValue["C-R-SEND-DETAIL-0022"],e.dataValue["C-R-SEND-DETAIL-0004.value"])}}},[a._v("查看退文单")])])])})],2):a._e(),a._v(" "),0===a.list.length&&a.finished?s("commonempty"):a._e()],1)],1)],1)],1)},[],!1,null,"016b52a9",null).exports}}]);