"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[77976],{77976:function(t,e,a){a.r(e),a.d(e,{default:function(){return r}});var e=a(91777),s=(a(23336),a(25108)),e={name:"collaboratorList",components:{recordHistory:e.Z},props:{taskId:{type:String,default:""},isApp:{type:Boolean,default:!1}},data:function(){return{collaboratorList:[],xtr:2,collaboratorTabs:[{tab:"未查看",type:1,list:[]},{tab:"推进中",type:2,list:[]},{tab:"有困难",type:3,list:[]},{tab:"已完成",type:4,list:[]}],isShowRecord:!0,recordUpdate:!1,personalPropel:{propulsor:"",progressState:0,propel:[],percentage:0,propulsorId:"",progressStateText:""},pk:""}},created:function(){},mounted:function(){this.isShowRecord=0!=this.$route.params.isRecord,s.log(this.isShowRecord),this.pk=this.$route.params.pk||this.taskId,this.getAllCollaborator()},methods:{changeColTab:function(t,e){this.collaboratorList=this.collaboratorTabs[t-1].list},urgeRecord:function(t){var e=this;this.recordUpdate=!0,dsf.http.post("/ctrl/taskman/task/getPersonalPropel?taskId=".concat(e.pk,"&propulsorId=").concat(t,"&timer=")+(new Date).getTime()).then(function(t){s.log(t),t&&t.data.data&&(e.personalPropel=t.data.data)})},personalUrge:function(t){t={title:"新建催办",data:{users:[{userId:t["C-TASKINFO-COLLABORATE-0001.value"],userName:t["C-TASKINFO-COLLABORATE-0001.text"],userAvatar:""}]}};window.top&&window.top.createRemindInIm?window.top.createRemindInIm(t):(s.log(t),this.urgePerson(t))},urgePerson:function(t){window.native&&window.native.createRemind(t)},getCollaboratorByType:function(e){var a=this;dsf.http.post("fn/list/230110095530ie2dAay1DHZs7qTZAht/mobile/q?moduleId=230103192045EncoYZoaQ9Zee0afJmh&pk=".concat(a.pk,"&taskmanProgressState=").concat(e,"&timer=")+(new Date).getTime(),{page:1,limit:100}).then(function(t){t&&t.data&&(a.collaboratorTabs[e-1].list=t.data.datas,2==e)&&(a.collaboratorList=a.collaboratorTabs[1].list)})},getAllCollaborator:function(){this.getCollaboratorByType(1),this.getCollaboratorByType(2),this.getCollaboratorByType(3),this.getCollaboratorByType(4)},close:function(){this.$emit("close")}},computed:{},watch:{}},r=(0,a(51900).Z)(e,function(){var a=this,s=a._self._c;return s("div",{staticClass:"collaboratorlist"},[s("div",{staticClass:"listcontent"},[a.isApp?s("div",{staticClass:"headcontent"},[s("van-icon",{attrs:{name:"arrow-left"},on:{click:a.close}}),a._v(" "),s("span",[a._v("协同人")])],1):a._e(),a._v(" "),s("div",{staticClass:"users_tab"},[s("van-tabs",{attrs:{color:"#0091FF"},on:{change:a.changeColTab},model:{value:a.xtr,callback:function(t){a.xtr=t},expression:"xtr"}},a._l(a.collaboratorTabs,function(t,e){return s("van-tab",{key:e,attrs:{title:t.tab+" "+t.list.length,name:t.type}})}),1),a._v(" "),s("div",{staticClass:"users_list",class:{appHeight:a.isApp}},a._l(a.collaboratorList,function(e,t){return s("div",{key:t},[s("van-image",{attrs:{round:"",src:"./static/images/logo.jpg"}}),a._v(" "),s("div",{staticClass:"dept"},[s("div",{staticClass:"username"},[s("span",{staticClass:"name"},[a._v(a._s(e.dataValue["C-TASKINFO-COLLABORATE-0001.text"]))])]),a._v(" "),s("div",{staticClass:"deptname"},[a._v(a._s(e.dataValue["C-TASKINFO-COLLABORATE-0002.text"]||"暂未填写")+"-"+a._s(e.dataValue["C-TASKINFO-COLLABORATE-0003.value"]||"暂未填写"))])]),a._v(" "),s("div",{staticClass:"buttons"},[a.isShowRecord?s("span",{staticClass:"cbjl",on:{click:function(t){return a.urgeRecord(e.dataValue["C-TASKINFO-COLLABORATE-0001.value"])}}},[a._v("推进记录")]):a._e()])],1)}),0)],1)]),a._v(" "),s("van-popup",{staticClass:"listPcPop",attrs:{closeable:"",position:a.isApp?"bottom":"center",round:"","overlay-class":"overlayClass"},model:{value:a.recordUpdate,callback:function(t){a.recordUpdate=t},expression:"recordUpdate"}},[s("div",{staticClass:"taskList"},[s("div",{staticClass:"head"},[a._v(a._s(a.personalPropel.propulsor)+"推进记录")]),a._v(" "),s("div",{staticClass:"taskContent"},[s("div",{staticClass:"myjz"},[s("span",{staticClass:"text"},[a._v("我的进展")]),a._v(" "),s("span",{class:{status:!0,wck:1==a.personalPropel.progressState,tjz:2==a.personalPropel.progressState,ykn:3==a.personalPropel.progressState,ywc:4==a.personalPropel.progressState}},[a._v(a._s(a.personalPropel.progressStateText))])]),a._v(" "),s("div",{staticClass:"percent"},[s("van-slider",{attrs:{disabled:"","bar-height":"10px","active-color":1==a.personalPropel.progressState?"#C0C2C3":2==a.personalPropel.progressState?"#1064CD":3==a.personalPropel.progressState?"#EB6A0E":"#14C154"},model:{value:a.personalPropel.percentage,callback:function(t){a.$set(a.personalPropel,"percentage",t)},expression:"personalPropel.percentage"}}),a._v(" "),s("span",{class:{wck:1==a.personalPropel.progressState,tjz:2==a.personalPropel.progressState,ykn:3==a.personalPropel.progressState,ywc:4==a.personalPropel.progressState}},[a._v(a._s(a.personalPropel.percentage)+"%")])],1),a._v(" "),s("recordHistory",{attrs:{recordData:a.personalPropel.propel}})],1)])])],1)},[],!1,null,"006ed44e",null).exports},91777:function(t,e,a){a.d(e,{Z:function(){return s}});var e={name:"recordHistory",components:{},props:{recordData:{type:Array,default:function(){return[]}}},data:function(){return{}},computed:{list:function(){return this.recordData.forEach(function(t){t.createTime=moment(new Date(t.createTime)).format("MM-DD HH:mm")}),this.recordData}},watch:{},methods:{},created:function(){},mounted:function(){},destroyed:function(){}},s=(0,a(51900).Z)(e,function(){var a=this,s=a._self._c;return s("div",{staticClass:"recordHistory"},[s("div",{staticClass:"lists"},[s("div",{staticClass:"records"},a._l(a.list,function(t,e){return s("div",{key:e,class:{record_list:!0,active:0<a.recordData.length&&0==e}},[s("div",{staticClass:"line"}),a._v(" "),s("span",{staticClass:"porcent"},[a._v(a._s(t.totalPercentage)+"%")]),a._v(" "),s("span",{staticClass:"circle"}),a._v(" "),s("p",{staticClass:"right"},[s("span",{staticClass:"texts"},[a._v(a._s(t.propelContent))]),a._v(" "),s("span",{staticClass:"timer"},[a._v(a._s(t.createTime))])])])}),0)])])},[],!1,null,"3124c270",null).exports}}]);