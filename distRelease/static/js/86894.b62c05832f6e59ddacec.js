"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[86894],{86894:function(e,n,t){t.r(n),t.d(n,{default:function(){return i}});var n=t(73473),o=t.n(n),a=t(25108),n={data:function(){return{loading:!0,errored:!1,name:this.$route.query.name,mobile:this.$route.query.mobile,cardId:"",renda:null,toUrl:this.$route.query.tourl,deviceId:"postman",deviceName:"postman",user:dsf.util.loadSessionStore("user")}},created:function(){dsf.util.removeSessionStore("meeting"),this.init()},methods:{init:function(){var e,n=this;null!=(e=dsf.config.staticJson)&&e.enable?(n.name="李敬梭",n.mobile="15335312882",n.login()):n.name&&n.mobile?n.login():null!=(e=n.user)&&e.name&&null!=(e=n.user)&&e.mobile?(n.name=n.user.name,n.mobile=n.user.mobile,n.login()):n.loadJsSdk(function(e){a.log("JsSdk =",e),n.renda=e,n.renda&&n.renda.getUserByToken&&n.renda.getUserByToken({success:function(e){a.log("getUserByToken =",e),n.mobile=e.phone,n.name=e.certName,n.cardId=e.certNo||"",n.login()},fail:function(e){a.log("getUserByToken-err =",e),n.errored=!0,dsf.layer.toast("".concat(e.msg),!1,function(){return n.navigateToApp()})}})})},login:function(){var n=this,e=dsf.md5("人大会务".concat(n.mobile).concat(n.name).concat(n.cardId,"系统"));!n.errored&&n.name&&n.mobile?dsf.http.post("fn/peopleCongress/autoLogin",{mobile:dsf.base64.encode(n.mobile),name:dsf.base64.encode(n.name),cardId:dsf.base64.encode(n.cardId),token:e,device_id:n.deviceId,device_desc:n.deviceName}).done(function(e){"success"==e.type?(n.loading=!1,e.data.name=n.name,dsf.util.saveToSessionStore("user",e.data),dsf.util.saveToSessionStore("loginToken",e.data.auth.token),n.toUrl?n.toUrl=decodeURIComponent(n.toUrl):e.data.meetingType&&1==e.data.meetingType.length?n.toUrl="/peopleCongress/".concat(e.data.meetingType[0].id):n.toUrl="/prePeopleCongress",n.$router.replace(n.toUrl)):(n.errored=!0,dsf.layer.toast("".concat(e.message),!1,function(){return n.navigateToApp()}))}).error(function(e){a.log("autoLogin-error =",e),n.errored=!0,dsf.layer.toast("登录失败",!1,function(){return n.navigateToApp()})}).always(function(){}):(n.errored=!0,n.navigateToApp())},loadJsSdk:function(e){var n=navigator.userAgent,t=/miniProgram/i.test(n)&&/micromessenger/i.test(n),n=n.includes("AlipayClient"),o=document.createElement("script"),t=(o.type="text/javascript",t?o.src="./static/js/jweixin-1.6.0.js":n&&(o.src="https://appx/web-view.min.js"),document.head.appendChild(o),document.createElement("script"));t.type="text/javascript",t.src="https://szrd.jxrd.gov.cn/jsApi/sdk.mini.js",document.head.appendChild(t),t.onload=function(){e&&e(renda)}},loadJsSdkP:function(){return new(o())(function(e,n){if("undefined"!=typeof renda)return e(renda);var t=document.createElement("script");t.type="text/javascript",t.src="https://szrd.jxrd.gov.cn/jsApi/sdk.mini.js",document.head.appendChild(t),t.onload=function(){e(renda)}})},navigateToApp:function(e,n){e=e||"home",n=n||3;var t=this;t.renda&&(t.renda.isWx||t.renda.isZfb)&&t.renda.navigateToApp&&setTimeout(function(){t.renda.navigateToApp(e)},1e3*n)}}},i=(0,t(51900).Z)(n,function(){var e=this,n=e._self._c;return n("div",[e.errored?n("div",{staticClass:"init-div"},[e._v("您暂无权限使用该系统！")]):n("div",{staticClass:"init-div"},[e.loading?n("div",[e._v("正在登录...")]):n("div")])])},[],!1,null,"a3fe15ac",null).exports}}]);