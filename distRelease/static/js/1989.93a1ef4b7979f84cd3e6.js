"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[1989],{1989:function(t,e,a){a.r(e),a.d(e,{default:function(){return i}});var s=a(88561),e={name:"reserveMeeting",filters:{emptyFilter:function(t,e){return t&&0<t.length?t:e},urlFilter:function(t){return-1<t.indexOf("ctrl/")||-1<t.indexOf("fn/")?dsf.config.assetsRoot+t:dsf.url.getServerUrl("/fn/file/downloadImage?fileName="+t)}},data:function(){var t=new Date;return{type:this.$route.query.type||0,expire:null,date:dsf.date.format(t,"yyyy-mm-dd"),dateStr:dsf.date.format(t,"mm月dd日 DD"),showPicker:!1,statusConfig:{0:"未审核通过/审核中",1:"审核通过",2:"被占用",3:"被锁定",4:"本人预定"},meetingData:[],moduleId:dsf.config.meetingConfig.reserveModuleId,reserveMeeting:dsf.config.meetingConfig.reserveMeeting}},created:function(){this.init()},methods:{onConfirm:function(t){this.date=dsf.date.format(t,"yyyy-mm-dd"),this.dateStr=dsf.date.format(t,"mm月dd日 DD"),this.showPicker=!1,this.init()},progressBar:function(t){var e=t.endtime,t=t.starttime,e=dsf.date.parse(e,"yyyy-mm-dd hh:ii"),s=dsf.date.parse(t,"yyyy-mm-dd hh:ii"),t=dsf.date.parse(t.split(" ")[0]+" 07:00","yyyy-mm-dd hh:ii"),e=(100*(e-s)/576e5).toFixed(2)+"%";return{left:(100*(s-t)/576e5).toFixed(2)+"%",width:e}},setExpire:function(){var t=new Date,e=dsf.date.format(t,"yyyy-mm-dd 07:00");-1===e.indexOf(this.date)?this.expire=null:this.expire=this.progressBar({starttime:e,endtime:dsf.date.format(t,"yyyy-mm-dd hh:ii")})},book:function(t){s.Z.saveToSessionStore("checkedMettingRoom",{value:t.id,text:t.name}),this.$router.push("/commonForm/".concat(this.moduleId))},init:function(){this.postData()},postData:function(){var e=this,t=dsf.layer.loading();this.setExpire(),dsf.http.post(this.reserveMeeting,{date:this.date}).done(function(t){t.code+""=="200"&&e.postDataSuccess(t.data)}).error(function(){dsf.layer.toast("请求异常")}).always(function(){dsf.layer.closeLoading(t)})},postDataSuccess:function(t){this.meetingData=t}}},i=(0,a(51900).Z)(e,function(){var s=this,i=s._self._c;return i("div",{staticClass:"reserve-meeting"},[i("van-popup",{style:{height:"500px"},attrs:{position:"bottom",round:"","get-container":"#app"},model:{value:s.showPicker,callback:function(t){s.showPicker=t},expression:"showPicker"}},[i("van-calendar",{attrs:{poppable:!1,"first-day-of-week":"1"},on:{confirm:s.onConfirm}})],1),s._v(" "),i("div",{staticClass:"_time",on:{click:function(t){s.showPicker=!0}}},[i("i",{staticClass:"iconfont"},[s._v("")]),s._v(" "),i("span",{staticClass:"ds_font6"},[s._v(s._s(s.dateStr))])]),s._v(" "),i("div",{staticClass:"_contents"},s._l(s.meetingData,function(e){return i("div",{key:e.id,staticClass:"_content",on:{click:function(t){return s.book(e)}}},[i("div",{staticClass:"_item"},[i("div",{staticClass:"_left"},[i("div",{staticClass:"_title ds_font4"},[s._v(s._s(e.name))]),s._v(" "),i("div",{staticClass:"_shebei ds_font6"},[s._v(s._s(s._f("emptyFilter")(e.configSetUp,"暂无相关设备")))]),s._v(" "),i("div",{staticClass:"_num"},[i("i",{staticClass:"iconfont"},[s._v("")]),s._v(" "),i("span",{staticClass:"ds_font6"},[s._v(s._s(e.number))])])]),s._v(" "),i("div",{staticClass:"_right"},[i("van-image",{attrs:{src:s._f("urlFilter")(e.images),fit:"cover","lazy-load":""},scopedSlots:s._u([{key:"error",fn:function(){return[i("img",{attrs:{src:a(86722)}})]},proxy:!0}],null,!0)})],1)]),s._v(" "),i("div",{staticClass:"_progress"},[i("div",{staticClass:"_progress-box"},[s.expire?i("div",{staticClass:"_progress-bar __o",style:s.expire}):s._e(),s._v(" "),s._l(e.occupydate,function(t,e){return i("div",{key:e,staticClass:"_progress-bar",class:["__"+t.status],style:s.progressBar(t)})})],2),s._v(" "),i("div",{staticClass:"_time_dot"},s._l(17,function(t){return i("div",{key:t},[s._v(s._s(t+6))])}),0)])])}),0)],1)},[],!1,null,"feccf03a",null).exports},86722:function(t,e,s){t.exports=s.p+"static/img/meetingRoom.aaf68c7..jpg"}}]);