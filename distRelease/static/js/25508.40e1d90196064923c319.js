"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[25508,90922],{92371:function(t,i,n){n.r(i),n.d(i,{default:function(){return c}});var e=n(5044),i=n(41775),s=n(9303),a=n(25108),i={name:"MeetingManage",components:{DsList:i.Z},mixins:[s.Z],data:function(){return{tab:"hy",firstLoading:!0,loading:!0,list:[],columns:[{color:null,format:null,icon:"",showCategory:"mainTitle",showMetaColumn:"bt",showName:"标题",showRows:null},{color:null,format:null,icon:"iconwenjianleixing",showCategory:"subTitle",showMetaColumn:"wjzl",showName:"文件类型",showRows:null},{color:null,format:null,icon:"iconshijian",showCategory:"Content",showMetaColumn:"time",showName:"会议时间",showRows:null},{color:null,format:null,icon:"icondidian",showCategory:"Content",showMetaColumn:"hydd",showName:"会议地点",showRows:null}],pageIndex:1,pagelimit:60,finished:!1,finishedTips:"",allCount:null,url:dsf.config.meetingConfig.meetingManageUrl}},created:function(){this.init()},methods:{handleActionClick:function(){this.tab="hy",(this["action-".concat(arguments[0])]||function(){}).apply(void 0,(0,e.Z)(Array.prototype.slice.call(arguments,1)))},post:function(t,i,n){var e=!(3<arguments.length&&void 0!==arguments[3])||arguments[3]?dsf.layer.loading():null;i["x-auth-token"]=dsf.util.loadSessionStore("loginToken"),dsf.http.post(t,i).done(n).error(function(){dsf.layer.toast("请求异常")}).always(function(){e&&dsf.layer.closeLoading(e)})},init:function(){this.onLoad()},onRefresh:function(){var i=this;this.post(this.url,{type:"meeting",page:1,limit:this.pagelimit},function(t){i.allCount=t.count,i.pageIndex=2,i.finished=!1,i.finishedTips="",Math.ceil(i.allCount/i.pagelimit)<i.pageIndex&&(i.finishedTips="暂无更多数据",i.finished=!0),i.list=[],i.list=i.postSuccess(t.rows),a.log(i.list)})},onLoad:function(){var i=this;dsf.http.post(this.url,{type:"meeting",page:i.pageIndex,limit:i.pagelimit}).then(function(t){t=t.data,i.allCount=t.count,t=t.rows;i.list=[].concat((0,e.Z)(i.list),(0,e.Z)(i.postSuccess(t))),i.pageIndex++,Math.ceil(i.allCount/i.pagelimit)<i.pageIndex&&(i.finishedTips="暂无更多数据",i.finished=!0)})},postSuccess:function(t){t=t.map(function(t){var i=t.isFavorite,n=(t.isTop,t.meetingStatus),e=t.shenhe,i=[{action:"guanZhu",icon:1===i?"iconguanzhu2":"iconguanzhu",name:1===i?"已关注":"关注"},{action:"huiYiShiPin",icon:"iconshipin",name:"视频"}],s=[],a=(s=(s=s.map(function(t,i){return t.showIndex=i+"",t})).map(function(t,i){return t.showIndex=i+"",t}),{id:t.id,moduleId:t.moduleId,todoId:t.todoId,bt:t.bt,hydd:t.hydd,hyjssj:t.hyjssj,hykssj:t.hykssj,isFavorite:t.isFavorite,isTop:t.isTop,meetingStatus:t.meetingStatus,time:t.hykssj+" 到 "+t.hyjssj,qianDaoStatus:t.qianDaoStatus,shenhe:t.shenhe,ngbm:t.ngbm,status:t.status,zcr:t.zcr});return"1"===e?(a.wjzl=t.wjzl,a.meetingStatusText=t.meetingStatusText,a.day=t.day):"0"===n?(a.unread=t.unread,a.baomin=t.baomin,a.qinjia=t.qinjia):(a.yingdao=t.yingdao,a.yidao=t.yidao,a.weidao=t.weidao),{buttons:{commonButton:i,mainButtons:s},dataValue:a}});return this.firstLoading=!1,this.loading=!1,t}}},s=n(51900),i=(0,s.Z)(i,function(){var i=this,t=i._self._c;return t("div",{staticClass:"ds-meeting-manage ds-meeting-center"},[t("van-pull-refresh",{attrs:{"success-text":"刷新成功"},on:{refresh:function(t){return i.onRefresh(!1)}},model:{value:i.loading,callback:function(t){i.loading=t},expression:"loading"}},[i.firstLoading?t("div",{staticClass:"center-loading"},[t("van-loading")],1):i._e(),i._v(" "),t("van-list",{attrs:{finished:i.finished,"finished-text":i.finishedTips,offset:500,"immediate-check":!1},on:{load:i.onLoad},model:{value:i.loading,callback:function(t){i.loading=t},expression:"loading"}},[t("ds-list",{attrs:{data:i.list,columns:i.columns,type:"hy"},on:{mainClick:i.handleActionClick,commonClick:i.handleActionClick}})],1)],1)],1)},[],!1,null,"c3b7ce9e",null).exports,o=n(86306),l=n(2728),n={name:"MeetingCenter",components:{MeetingJoin:i,MeetingManage:o.default},data:function(){return{active:0,status:{meeting:0,used:0,conflict:0},meetingCountUrl:dsf.config.meetingConfig.meetingCountUrl}},deactivated:function(){"commonForm"!=this.$route.name&&"reserveMeeting"!=this.$route.name&&this.$deleteCache(this)},activated:function(){this.postCount("meeting"),this.postCount("used"),this.postCount("conflict")},created:function(){this.docTitle=this.$route.query.title||this.$route.meta.title||"移动办公",this.setTitle()},methods:{setTitle:function(){l.Z.setTitle(this.docTitle)},post:function(t,i,n){var e=!(3<arguments.length&&void 0!==arguments[3])||arguments[3]?dsf.layer.loading():null;i["x-auth-token"]=dsf.util.loadSessionStore("loginToken"),dsf.http.post(t,i).done(n).error(function(){dsf.layer.toast("请求异常")}).always(function(){e&&dsf.layer.closeLoading(e)})},postCount:function(i){var n=this;this.post(this.meetingCountUrl,{type:i},function(t){t=t.count;n.$set(n.status,i,t)})}}},c=(0,s.Z)(n,function(){var i=this,t=i._self._c;return t("div",{staticClass:"ds-meeting-center"},[t("div",{staticClass:"__meeting-room"},[t("div",{staticClass:"__title"},[i._v("会议室")]),i._v(" "),t("div",{staticClass:"__data"},[t("div",{staticClass:"__data-item"},[t("div",{staticClass:"__data-item-num",staticStyle:{color:"#0089FF"}},[i._v(i._s(i.status.meeting))]),i._v(" "),t("div",{staticClass:"__data-item-name"},[i._v("会议室")])]),i._v(" "),t("div",{staticClass:"__data-item"},[t("div",{staticClass:"__data-item-num",staticStyle:{color:"#67C23B"}},[i._v(i._s(i.status.used))]),i._v(" "),t("div",{staticClass:"__data-item-name"},[i._v("使用中")])]),i._v(" "),t("div",{staticClass:"__data-item"},[t("div",{staticClass:"__data-item-num",staticStyle:{color:"#F66C6C"}},[i._v(i._s(i.status.conflict))]),i._v(" "),t("div",{staticClass:"__data-item-name"},[i._v("冲突")])])]),i._v(" "),t("div",{staticClass:"__footer"},[t("van-button",{attrs:{type:"primary"},on:{click:function(t){return i.$router.push({path:"/reserveMeeting"})}}},[i._v("预订")])],1)]),i._v(" "),t("van-tabs",{attrs:{animated:"",sticky:""},model:{value:i.active,callback:function(t){i.active=t},expression:"active"}},[t("van-tab",{attrs:{title:"我参与的"}},[t("meeting-join")],1),i._v(" "),t("van-tab",{attrs:{title:"我管理的"}},[t("meeting-manage")],1)],1)],1)},[],!1,null,null,null).exports}}]);