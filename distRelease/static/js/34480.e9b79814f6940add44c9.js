"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[34480],{34480:function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});var t=n(27921),r=n.n(t),t=n(85579),c=n.n(t),t=n(22013),d=n.n(t),a=n(66250),t=n(33453),s=n.n(t),t=n(58930),u=n(25108);function f(e,t){var n,o,a,l,i=void 0!==c()&&e[d()]||e["@@iterator"];if(i)return o=!(n=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){o=!0,a=e},f:function(){try{n||null==i.return||i.return()}finally{if(o)throw a}}};if(Array.isArray(e)||(i=function(e,t){var n;if(e)return"string"==typeof e?m(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?r()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),l=0,{s:t=function(){},n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var t={components:{enclosure:t.default},data:function(){return{fileTitle:"",formMeta:{},allFile:[],isShowEnclosure:{gzdt:[!1],mryq:[!1],zydt:[!1]},publication:{gzdt:{title:"工作动态",dataVal:[]},mryq:{title:"每日要情",dataVal:[]},zydt:{title:"政研动态",dataVal:[]}},listParams:[{module:"gzdt",listId:"231113152123YlS9UrRPpq5ibRAKFnq",moduleId:"231111101402AlIRsyiV1ihwqvjaeKs"},{module:"mryq",listId:"231113152136mlXkxKL1lzSqFGKzHBD",moduleId:"231111101402AlIRsyiV1ihwqvjaeKs"},{module:"zydt",listId:"231113152146J9T9kSE5Ysmu8xd5Htz",moduleId:"231111101402AlIRsyiV1ihwqvjaeKs"}]}},created:function(){this.getInfo()},methods:{getInfo:function(){var i=this;return(0,a.Z)(s().mark(function e(){var n,o,t,a,l;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o={limit:3,page:1,showTotal:!0,isFirst:1,start:1},t=f((n=i).listParams),e.prev=3,l=s().mark(function e(){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.value,e.next=3,dsf.http.post("fn/list/".concat(t.listId,"/mobile/q?moduleId=").concat(t.moduleId),o).then(function(e){200==e.status&&(n.publication[t.module].dataVal=e.data.datas)});case 3:case"end":return e.stop()}},e)}),t.s();case 6:if((a=t.n()).done){e.next=10;break}return e.delegateYield(l(),"t0",8);case 8:e.next=6;break;case 10:e.next=15;break;case 12:e.prev=12,e.t1=e.catch(3),t.e(e.t1);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[3,12,15,18]])}))()},getListImg:function(e){return dsf.url.getServerUrl("fn/file/downloadImage?fileName=".concat(e))},pubItem:function(n,o,r){var c=this;return(0,a.Z)(s().mark(function e(){var t;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.listParams.find(function(e){return e.module==o}).listId,e.next=3,dsf.http.get("fn/xform/getInfo?listId=".concat(t,"&pk=").concat(n.dataValue.A0001,"&moduleId=").concat(n.dataValue.A0004)).then(function(e){var i;200==e.status&&(c.formMeta=e.data.struct,e={info_id:(i=c.formMeta.parameters).pk,infoId:i.pk,nodeId:i.nodeId,flowId:i.flowId,moduleId:i.moduleId,start:1,limit:100},dsf.http.post("fn/mobileAttachment/getFormAttachment",e).then(function(e){u.log("elem",e);var e=e.data.rows,a=dsf.util.loadSessionStore("loginToken"),l=(new Date).getTime(),e=(e.forEach(function(n){var o=[];n.document?(n.document.forEach(function(e,t){e.downloadFileName=dsf.util.stripscript(e.downloadFileName||e.title);t={id:e.id,title:e.title,downloadFileName:e.downloadFileName,type:e.type,size:e.showFileSize||"",navtiveUrl:e.url,url:dsf.url.getServerUrl("fn/office/openMobileOffice?fileId=".concat(e.id,"&moduleId=").concat(e.moduleId,"&fileName=").concat(e.downloadFileName,"&nodeId=").concat(i.nodeId,"&flowId=").concat(i.flowId,"&x-auth-token=").concat(a)),editUrl:dsf.url.getServerUrl("fn/mobileOffice/wordEdit?fileId=".concat(e.id,"&moduleId=").concat(e.moduleId,"&fileName=").concat(e.downloadFileName,"&nodeId=").concat(i.nodeId,"&flowId=").concat(i.flowId,"&x-auth-token=").concat(a)),initUrl:"fn/file/download?infoId=".concat(e.infoId,"&fileId=").concat(e.id,"&fileName=").concat(e.downloadFileName,"&nrType=").concat(e.type,"&moduleId=").concat(e.moduleId,"&x-auth-token=").concat(a,"&fullfilename=").concat(l).concat(e.downloadFileName),handwritingUrl:dsf.url.getServerUrl("fn/office/openMobileOffice?fileId=".concat(e.id,"&moduleId=").concat(e.moduleId,"&fileName=").concat(e.downloadFileName,"&nodeId=").concat(i.nodeId,"&flowId=").concat(i.flowId,"&x-auth-token=").concat(a,"&handwriting=1&screenWidth=").concat(document.body.clientWidth)),infoId:e.infoId,moduleId:e.moduleId,isHandwrite:c.$route.query.isdjOpen?-1:e.isHandwrite,isRevise:e.isRevise,isNoModify:e.isNoModify,canEdit:e.canEdit,canDownLoad:e.canDownLoad,name:1<n.document.length?"".concat(n.name).concat(t+1):n.name};(e.title.toLowerCase().includes(".png")||e.title.toLowerCase().includes(".jpg")||e.title.toLowerCase().includes(".jpeg")||e.title.toLowerCase().includes(".bmp")||e.title.toLowerCase().includes(".gif")||e.title.toLowerCase().includes(".mp4"))&&(t.url=dsf.url.getServerUrl("fn/mobileFileDownload/download?fileId=".concat(e.id,"&moduleId=").concat(e.moduleId,"&fileName=").concat(e.downloadFileName))),"1"==n.canShow&&o.push(t)}),n.file=o):n.file=[],0<n.allowMaintain&&0!=dsf.config.commonForm.canEditFile||0!=n.file.length||(n.canShow="-1")}),c.allFile=e.filter(function(e){return 1==e.canShow}),null==(e=c.allFile[0])||null==(e=e.file[0])?void 0:e.title);c.fileTitle=e.includes(".")?e.split(".")[0]:e,c.isShowEnclosure[o][r]=!0}))});case 3:case"end":return e.stop()}},e)}))()},closePop:function(e,t){history.back()},goUrl:function(e){this.$router.push({name:"allPublications",query:{title:this.publication[e].title,type:e}})}}},o=(0,n(51900).Z)(t,function(){var a=this,l=a._self._c;return l("div",{staticClass:"infoPub"},a._l(a.publication,function(e,o){return l("van-cell-group",{key:o,staticClass:"cellGroup"},[l("van-cell",{attrs:{title:e.title,value:"","is-link":""},on:{click:function(e){return a.goUrl(o)}},scopedSlots:a._u([{key:"icon",fn:function(){return[l("div",{staticClass:"leftIcon"})]},proxy:!0}],null,!0)}),a._v(" "),l("div",{staticClass:"contenDiv"},a._l(e.dataVal,function(t,n){return l("div",{key:n,staticClass:"coverInfo",on:{click:function(e){return a.pubItem(t,o,n)}}},[l("van-image",{attrs:{width:"25vw",fit:"contain",src:a.getListImg(t.dataValue.oa_xxkw_tp)}}),a._v(" "),l("div",{staticClass:"coverTitle"},[a._v(a._s(t.dataValue.B0001))]),a._v(" "),l("van-popup",{staticClass:"flex dc",staticStyle:{height:"100vh"},attrs:{"close-on-click-overlay":!1,"lock-scroll":"",position:"bottom","get-container":"#app"},model:{value:a.isShowEnclosure[o][n],callback:function(e){a.$set(a.isShowEnclosure[o],n,e)},expression:"isShowEnclosure[key][index]"}},[l("van-nav-bar",{attrs:{"left-text":"返回","left-arrow":"",title:a.fileTitle},on:{"click-left":function(e){return a.closePop(o,n)}}}),a._v(" "),l("enclosure",{ref:"enclosure",refInFor:!0,attrs:{fileData:{info_id:a.formMeta.parameters?a.formMeta.parameters.pk:"",moduleId:a.formMeta.parameters?a.formMeta.parameters.moduleId:"",nodeId:a.formMeta.parameters?a.formMeta.parameters.nodeId:"",nodeName:a.formMeta.parameters?a.formMeta.parameters.nodeName:"",flowId:a.formMeta.parameters?a.formMeta.parameters.flowId:"",pId:a.formMeta.parameters?a.formMeta.parameters.pId:"",pnId:a.formMeta.parameters?a.formMeta.parameters.pnId:"",uploadAttach:a.formMeta.parameters?a.formMeta.parameters.uploadAttach:""},allFile:a.allFile,formMeta:a.formMeta}})],1)],1)}),0)],1)}),1)},[],!1,null,"7e856e08",null).exports}}]);