"use strict";(self.webpackChunkxianzhengding=self.webpackChunkxianzhengding||[]).push([[66857],{22897:function(t,e,a){a.r(e),a.d(e,{default:function(){return v}});var e=a(26243),s=a.n(e),e=a(62680),r=a.n(e),e=a(95366),i=a.n(e),e=a(6919),n=a.n(e),o=a(66250),l=a(77193),e=a(8450),c=a.n(e),e=a(79529),u=a.n(e),e=a(33453),d=a.n(e),e=a(1696),h=a(25108);function f(e,t){var a,n=s()(e);return r()&&(a=r()(e),t&&(a=a.filter(function(t){return i()(e,t).enumerable})),n.push.apply(n,a)),n}var e={name:"dblist",data:function(){return{isShowTypePicker:!1,dateStart:"",dateEnd:"",dateStr:"",start:!1,end:!1,minDate1:new Date(1970,0,1),maxDate1:new Date,minDate2:new Date(1970,0,1),maxDate2:new Date,searchBox:!1,loading:!1,finished:!1,refreshing:!1,searchList:[],total:0,tabslist:[{name:"在办",status:"1",count:0,selected:!0},{name:"已办",status:"2",count:0,selected:!1},{name:"超期",status:"-2",count:0,selected:!1}],currentTabIndex:0,datalist:[],controlList:[],page:1,limit:15,finishedTips:"",isFirst:!0}},components:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach(function(t){(0,l.Z)(e,t,a[t])}):n()?Object.defineProperties(e,n()(a)):f(Object(a)).forEach(function(t){Object.defineProperty(e,t,i()(a,t))})}return e}({},e.Z),watch:{},created:function(){},mounted:function(){var e=this;e.$bus.on("searchRadioSelectBus",function(t){h.log(t),"blsx"==t.metaData.metaData&&"4"==t.value&&(e.isShowTypePicker=!0)})},methods:{btnReset:function(){this.dateStart="",this.dateEnd="",this.minDate1=new Date(1970,0,1),this.maxDate1=new Date,this.minDate2=new Date(1970,0,1),this.maxDate2=new Date},btnSure:function(){this.start=!1,this.end=!1,this.isShowTypePicker=!1,this.minDate1=new Date(1970,0,1),this.maxDate1=new Date,this.minDate2=new Date(1970,0,1),this.maxDate2=new Date,this.dateStr=this.dateStart+"|"+this.dateEnd},startConfirm:function(t){this.start=!1,this.minDate2=t,this.dateStart=dsf.date.format(t,"yyyy-mm-dd")},endConfirm:function(t){this.end=!1,this.maxDate1=t,this.dateEnd=dsf.date.format(t,"yyyy-mm-dd")},searchData:function(){var e=this;return(0,o.Z)(d().mark(function t(){var a;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a=e).searchList=[],a.controlList.forEach(function(t,e){t.value&&""!=t.value&&a.searchList.push({name:t.text,value:t.value,key:t.metaData})}),h.log(a.searchList),a.searchBox=!1,t.next=7,a.getTopData();case 7:a.onRefresh();case 8:case"end":return t.stop()}},t)}))()},getTopData:function(){var n=this;return(0,o.Z)(d().mark(function t(){var e,a;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={},(e=n).getListParams(a),t.next=5,dsf.http.post("ctrl/customStatic/listInfo",a).then(function(t){h.log(t.data),"success"==t.data.type?(t=t.data.data,e.total=t.allNum,e.tabslist[0].count=t.zbNum,e.tabslist[1].count=t.ybNum,e.tabslist[2].count=t.cqNum):dsf.layer.toast("当前暂无数据")});case 5:case"end":return t.stop()}},t)}))()},initSearchList:function(t){var e=this,a=(h.log("initSearchList"),this),n=this.tabslist.find(function(t){return t.name==e.$route.query.status});n&&(this.tabslist.forEach(function(t){t.selected=!1}),n.selected=!0),h.log(c()(this.tabslist)),null!=(n=a.$route.query.leaderName)&&n.length&&(a.searchList.push({name:a.$route.query.leaderName,value:a.$route.query.leaderId,key:"leaderList"}),a.controlList.find(function(t){return"leaderList"==t.metaData}).value=a.$route.query.leaderId),null!=(n=a.$route.query.fgLeaderName)&&n.length&&(a.searchList.push({name:a.$route.query.fgLeaderName,value:a.$route.query.fgLeaderId,key:"fgld"}),a.controlList.find(function(t){return"fgld"==t.metaData}).value=a.$route.query.fgLeaderId),null!=(n=a.$route.query.searchIndex)&&n.length&&(a.searchList.push({name:t.typeList[a.$route.query.searchIndex].text,value:t.typeList[a.$route.query.searchIndex].value,key:"blsx"}),a.controlList.find(function(t){return"blsx"==t.metaData}).value=t.typeList[a.$route.query.searchIndex].value),null!=(n=a.$route.query.deptId)&&n.length&&(a.searchList.push({name:a.$route.query.deptName,value:a.$route.query.deptId,key:"zbdwList"}),a.controlList.find(function(t){return"zbdwList"==t.metaData}).value=a.$route.query.deptId),null!=(n=a.$route.query.dbsx)&&n.length&&(a.searchList.push({name:null==(n=t.fileTypeList.find(function(t){return t.value==a.$route.query.dbsx}))?void 0:n.text,value:a.$route.query.dbsx,key:"dbsx"}),a.controlList.find(function(t){return"dbsx"==t.metaData}).value=a.$route.query.dbsx)},initTopData:function(){var s=this;return(0,o.Z)(d().mark(function t(){var e,a,n;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a=s).controlList=[],n={},null!=(e=a.$route.query.leaderName)&&e.length&&(n.leaderId=a.$route.query.leaderId),null!=(e=a.$route.query.fgLeaderName)&&e.length&&(n.fgLeaderId=a.$route.query.fgLeaderId),null!=(e=a.$route.query.searchIndex)&&e.length&&(n.type=u()(a.$route.query.searchIndex)+1,3==a.$route.query.searchIndex)&&(a.dateStart=n.start=a.$route.query.dateStart,a.dateEnd=n.end=a.$route.query.dateEnd),null!=(e=a.$route.query.deptId)&&e.length&&(n.deptId=a.$route.query.deptId),null!=(e=a.$route.query.dbsx)&&e.length&&(n.fileType=a.$route.query.dbsx),t.next=10,dsf.http.post("ctrl/customStatic/listInfo",n).then(function(t){var e;h.log(t.data),"success"==t.data.type?(t=t.data.data,a.total=t.allNum,a.tabslist[0].count=t.zbNum,a.tabslist[1].count=t.ybNum,a.tabslist[2].count=t.cqNum,e={control:"search_controlRadio",metaData:"leaderList",placehold:"",selectData:t.leaderList,title:"批示领导"},a.controlList.push(e),e={control:"search_controlRadio",metaData:"fgld",placehold:"",selectData:t.fgLeaderList,title:"分管领导"},a.controlList.push(e),e={control:"search_controlRadio",metaData:"blsx",placehold:"",selectData:t.typeList,title:"办理期限"},a.controlList.push(e),e={control:"search_controlRadio",metaData:"zbdwList",placehold:"",selectData:t.zbdwList,title:"主办单位"},a.controlList.push(e),e={control:"search_controlRadio",metaData:"dbsx",placehold:"",selectData:t.fileTypeList,title:"督办事项"},a.controlList.push(e),a.initSearchList(t)):dsf.layer.toast("当前暂无数据")});case 10:case"end":return t.stop()}},t)}))()},getListParams:function(e){var a=this;h.log(c()(a.searchList)),a.searchList.forEach(function(t){"leaderList"==t.key&&(e.leaderId=t.value),"fgld"==t.key&&(e.fgLeaderId=t.value),"blsx"==t.key&&(e.type=t.value,4==t.value)&&(e.start=a.dateStart,e.end=a.dateEnd),"zbdwList"==t.key&&(e.deptId=t.value),"dbsx"==t.key&&(e.fileType=t.value)})},getListData:function(){var a=this,t=(h.log("getListData"),h.log(c()(this.tabslist)),{status:a.tabslist.find(function(t){return t.selected}).status,page:this.page,limit:this.limit});a.getListParams(t),dsf.http.post("ctrl/customStatic/listData",t).then(function(t){h.log(t.data),"success"==t.data.type?(1==a.page&&(a.datalist=[]),t.data.data.data.forEach(function(t){var e;a.datalist.push({title:t.bt,leader:t.xgldText,dept:t.zbdwText,blsx:(e=t.blqx,(e=new Date(e).toISOString()).substring(0,10)+" "+e.substring(11,16)),dbsx:t.dbxmlxText,status:t.spztText,moduleId:t.moduleId,pk:t.id,formId:t.formId})}),a.page++,a.loading=!1,a.datalist.length!=t.data.data.count&&0!=a.datalist.length||(a.finished=!0,0<a.datalist.length?a.finishedTips="没有更多了":a.finishedTips="")):dsf.layer.toast("当前暂无数据")})},onLoad:function(){var e=this;return(0,o.Z)(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.refreshing&&(e.refreshing=!1),e.isFirst)return t.next=4,e.initTopData();t.next=4;break;case 4:e.getListData(),e.isFirst=!1;case 6:case"end":return t.stop()}},t)}))()},onRefresh:function(){this.finished=!1,this.page=1,this.datalist=[],this.loading=!0,this.onLoad()},openSearch:function(){this.searchBox=!0},returnFilter:function(){var t=JSON.parse(c()(this.controlList));t.forEach(function(t){t.text="",t.value=""}),this.controlList=t},goForm:function(t){h.log(t),this.$router.push({path:"/commonForm/".concat(t.moduleId,"/").concat(t.pk),query:{formId:t.formId,listId:"210602101612cwrG8N6w79LnSWR8gSY",method:"viewNode",validateByList:1}})},changeTab:function(t){this.currentTabIndex=t,this.tabslist.forEach(function(t){t.selected=!1}),this.tabslist[t].selected=!0,this.onRefresh()}}},v=(0,a(51900).Z)(e,function(){var a=this,n=a._self._c;return n("div",{staticClass:"dblist"},[n("van-sticky",{attrs:{"get-container":"#app","offset-top":a.dsf.util.getOffsetTop()}},[n("div",{staticClass:"search"},[n("div",{staticClass:"left"},a._l(a.searchList,function(t,e){return n("span",[a._v("\n          "+a._s(t.name)+"\n        ")])}),0),a._v(" "),n("div",{staticClass:"right",on:{click:function(t){return a.openSearch()}}},[n("span",[a._v("筛选")])])]),a._v(" "),n("div",{staticClass:"total"},[a._v("\n      总计："),n("span",[a._v(a._s(a.total))]),a._v("条\n    ")]),a._v(" "),n("div",{staticClass:"tabs"},a._l(a.tabslist,function(t,e){return n("span",{key:e,class:t.selected?"tabactive":"",attrs:{name:e},on:{click:function(t){return a.changeTab(e)}}},[a._v("\n        "+a._s(t.name)+"("+a._s(t.count)+"条)\n      ")])}),0)]),a._v(" "),n("div",{staticClass:"listbody"},[n("div",{staticClass:"list"},[n("van-pull-refresh",{on:{refresh:a.onRefresh},model:{value:a.refreshing,callback:function(t){a.refreshing=t},expression:"refreshing"}},[n("van-list",{attrs:{finished:a.finished,"finished-text":a.finishedTips,offset:"100"},on:{load:a.onLoad},model:{value:a.loading,callback:function(t){a.loading=t},expression:"loading"}},[a._l(a.datalist,function(e,t){return n("div",{key:t,staticClass:"card",attrs:{name:t},on:{click:function(t){return a.goForm(e)}}},[n("div",{staticClass:"title"},[a._v("\n              "+a._s(e.title)+"\n            ")]),a._v(" "),n("div",{staticClass:"content"},[n("ul",[n("li",[a._v("分管领导:"+a._s(e.leader))]),a._v(" "),n("li",[a._v("主办处室:"+a._s(e.dept))])]),a._v(" "),n("ul",[n("li",[a._v("办理期限:"+a._s(e.blsx))]),a._v(" "),n("li",[a._v("状态:"+a._s(e.status))])]),a._v(" "),n("ul",[n("li",[a._v("督办事项:"+a._s(e.dbsx))])])])])}),a._v(" "),a.datalist.length||a.loading?a._e():n("commonempty")],2)],1)],1)]),a._v(" "),n("van-action-sheet",{staticClass:"searchSheet",attrs:{position:"bottom",round:""},model:{value:a.searchBox,callback:function(t){a.searchBox=t},expression:"searchBox"}},[n("van-nav-bar",{attrs:{title:"筛选"}}),a._v(" "),n("div",{staticClass:"sheetBox flex1"},a._l(a.controlList,function(t,e){return n(t.control,{key:e,tag:"component",attrs:{"meta-data":t}})}),1),a._v(" "),n("div",{staticClass:"disfr jsb searchBox"},[n("van-button",{staticClass:"flex1",on:{click:a.returnFilter}},[a._v("重置")]),a._v(" "),n("van-button",{staticClass:"flex1",attrs:{type:"info"},on:{click:a.searchData}},[a._v("确定")])],1)],1),a._v(" "),n("van-action-sheet",{staticClass:"searchSheet",attrs:{position:"bottom",round:""},model:{value:a.isShowTypePicker,callback:function(t){a.isShowTypePicker=t},expression:"isShowTypePicker"}},[n("van-nav-bar",{attrs:{title:"查询"}}),a._v(" "),n("div",{staticClass:"datebody"},[n("div",{staticClass:"datelabel"},[n("span",[a._v("办理期限")])]),a._v(" "),n("div",{staticClass:"dateselect"},[n("van-field",{attrs:{readonly:"",clickable:"",name:"calendar",value:a.dateStart,placeholder:"选择日期"},on:{click:function(t){a.start=!0}}}),n("i",{staticClass:"iflex"},[a._v("——")]),a._v(" "),n("van-field",{attrs:{readonly:"",clickable:"",name:"calendar",value:a.dateEnd,placeholder:"选择日期"},on:{click:function(t){a.end=!0}}})],1)]),a._v(" "),n("div",{staticClass:"datefooter"},[n("van-button",{attrs:{type:"default"},on:{click:function(t){return a.btnReset()}}},[a._v("重置")]),a._v(" "),n("van-button",{attrs:{type:"info"},on:{click:function(t){return a.btnSure()}}},[a._v("确定")])],1),a._v(" "),n("van-calendar",{attrs:{"get-container":"#app","min-date":a.minDate1,"max-date":a.maxDate1},on:{confirm:a.startConfirm},model:{value:a.start,callback:function(t){a.start=t},expression:"start"}}),a._v(" "),n("van-calendar",{attrs:{"get-container":"#app","min-date":a.minDate2,"max-date":a.maxDate2},on:{confirm:a.endConfirm},model:{value:a.end,callback:function(t){a.end=t},expression:"end"}})],1)],1)},[],!1,null,"5bca3c20",null).exports},79156:function(t,e,a){a.d(e,{Z:function(){return s}});var n=a(78149);function s(t){if(n(t))return t}},26511:function(t,e,a){function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}a.d(e,{Z:function(){return n}})},522:function(t,e,a){a.d(e,{Z:function(){return i}});var n=a(79156),u=a(85579),d=a(22013);var s=a(33422),r=a(26511);function i(t,e){return(0,n.Z)(t)||function(t,e){var a=null==t?null:void 0!==u&&t[d]||t["@@iterator"];if(null!=a){var n,s,r,i,o=[],l=!0,c=!1;try{if(r=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=r.call(a)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(t){c=!0,s=t}finally{try{if(!l&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(c)throw s}}return o}}(t,e)||(0,s.Z)(t,e)||(0,r.Z)()}}}]);